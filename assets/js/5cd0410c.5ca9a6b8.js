"use strict";(self.webpackChunkbookshell=self.webpackChunkbookshell||[]).push([[3945],{4809:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>h,frontMatter:()=>r,metadata:()=>d,toc:()=>a});var c=s(4848),t=s(8453);const r={},i=void 0,d={id:"Golang/golang\u8fdb\u9636/\u95ee\u9898\u6c47\u603b/ORM\u6570\u636e\u5e93\u6c47\u603b",title:"ORM\u6570\u636e\u5e93\u6c47\u603b",description:"\u521b\u5efa\u8868\u7684\u7ee7\u627f\u548c\u5173\u8054\u8868",source:"@site/docs/Golang/golang\u8fdb\u9636/3.\u95ee\u9898\u6c47\u603b/ORM\u6570\u636e\u5e93\u6c47\u603b.md",sourceDirName:"Golang/golang\u8fdb\u9636/3.\u95ee\u9898\u6c47\u603b",slug:"/Golang/golang\u8fdb\u9636/\u95ee\u9898\u6c47\u603b/ORM\u6570\u636e\u5e93\u6c47\u603b",permalink:"/docs/Golang/golang\u8fdb\u9636/\u95ee\u9898\u6c47\u603b/ORM\u6570\u636e\u5e93\u6c47\u603b",draft:!1,unlisted:!1,editUrl:"https://github.com/shouji1128955/bookshell/edit/main/docs/Golang/golang\u8fdb\u9636/3.\u95ee\u9898\u6c47\u603b/ORM\u6570\u636e\u5e93\u6c47\u603b.md",tags:[],version:"current",lastUpdatedBy:"zhanglaiqiang",lastUpdatedAt:172935997e4,frontMatter:{},sidebar:"GoalngJinjie",previous:{title:"Mysql",permalink:"/docs/Golang/golang\u8fdb\u9636/mysql\u6570\u636e\u5e93/Mysql\u57fa\u7840"}},l={},a=[{value:"\u521b\u5efa\u8868\u7684\u7ee7\u627f\u548c\u5173\u8054\u8868",id:"\u521b\u5efa\u8868\u7684\u7ee7\u627f\u548c\u5173\u8054\u8868",level:2},{value:"\u5173\u4e8eClass\u8868\u7684\u4e00\u4e9b\u8bf4\u660e:",id:"\u5173\u4e8eclass\u8868\u7684\u4e00\u4e9b\u8bf4\u660e",level:3},{value:"\u5173\u4e8eStudent\u8868\u7684\u4e00\u4e9b\u8bf4\u660e",id:"\u5173\u4e8estudent\u8868\u7684\u4e00\u4e9b\u8bf4\u660e",level:3},{value:"\u5916\u952e\u5173\u8054\u81ea\u52a8\u5220\u9664",id:"\u5916\u952e\u5173\u8054\u81ea\u52a8\u5220\u9664",level:3},{value:"GORM\u6839\u636e\u67e5\u8be2\u7ed3\u679c\u751f\u6210\u7b2c\u4e09\u7ae0\u6570\u636e\u8868",id:"gorm\u6839\u636e\u67e5\u8be2\u7ed3\u679c\u751f\u6210\u7b2c\u4e09\u7ae0\u6570\u636e\u8868",level:2}];function o(e){const n={code:"code",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",...(0,t.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(n.h2,{id:"\u521b\u5efa\u8868\u7684\u7ee7\u627f\u548c\u5173\u8054\u8868",children:"\u521b\u5efa\u8868\u7684\u7ee7\u627f\u548c\u5173\u8054\u8868"}),"\n",(0,c.jsx)(n.h3,{id:"\u5173\u4e8eclass\u8868\u7684\u4e00\u4e9b\u8bf4\u660e",children:"\u5173\u4e8eClass\u8868\u7684\u4e00\u4e9b\u8bf4\u660e:"}),"\n",(0,c.jsx)(n.p,{children:"Teacher --\x3e  Teacher\u7406\u89e3\uff0c\u9996\u5148Teacher\u4f1a\u81ea\u52a8\u6dfb\u52a0ID,\u7136\u540e\u53bb\u5173\u8054\u8868Teacher\u4e2d\u7684id\u5b57\u6bb5\u3002"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.img,{src:s(2754).A+"",width:"803",height:"244"})}),"\n",(0,c.jsxs)(n.p,{children:["\u5728\u6570\u636e\u5e93\u4e2d\u67e5\u770b\r\n",(0,c.jsx)(n.img,{src:s(6761).A+"",width:"1257",height:"321"})]}),"\n",(0,c.jsx)(n.h3,{id:"\u5173\u4e8estudent\u8868\u7684\u4e00\u4e9b\u8bf4\u660e",children:"\u5173\u4e8eStudent\u8868\u7684\u4e00\u4e9b\u8bf4\u660e"}),"\n",(0,c.jsx)(n.p,{children:"\u6309\u7167\u5982\u56fe\uff0c\u89e3\u91ca"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.img,{src:s(1008).A+"",width:"959",height:"454"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:'t1 := Teacher{ID=1,name="zhang",...}\r\n\r\nc1 = Class{Name:"\u8f6f\u4ef6\u4e00\u73ed", TeacherID=1}\r\n\r\nc1.Teacher (gorm: TeacherID=1 --\x3e sql --\x3e Teacher{ID=1,name="zhang",...})\r\n\n'})}),"\n",(0,c.jsx)(n.p,{children:"\u603b\u7ed3:"}),"\n",(0,c.jsxs)(n.ol,{children:["\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsx)(n.p,{children:"\u591a\u5bf9\u591a\u7684\u65f6\u5019,\u4e0a\u9762gorm\u4f1a\u81ea\u52a8\u521b\u5efa\u7b2c\u4e09\u7ae0\u5173\u8054\u8868 student2course,\u5f53\u7136\u4e5f\u53ef\u4ee5\u901a\u8fc7\u624b\u52a8\u521b\u5efa\u7ed3\u6784\u4f53\u5b9e\u73b0\uff0c\u4f46\u662f\u8fd9\u6837\u4e0d\u5229\u4e8e\u81ea\u52a8\u83b7\u53d6\u503c\u3002"}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsx)(n.p,{children:"\u591a\u5bf9\u591a\u5173\u7cfb,\u4e00\u4e2a\u5b66\u751f\u53ef\u4ee5\u6709\u591a\u95e8\u8bfe\u7a0b\uff0c\u5f53\u7136\uff0c\u4e00\u95e8\u8bfe\u7a0b\u4e5f\u53ef\u4ee5\u6709\u591a\u4e2a\u5b66\u751f\u3002\u6240\u4ee5\u5c31\u662f\u591a\u5bf9\u591a\u5173\u7cfb,\u9700\u8981\u65b0\u5efa\u4e00\u4e2a\u8868\u6765\u505a\u5173\u8054"}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(n.h3,{id:"\u5916\u952e\u5173\u8054\u81ea\u52a8\u5220\u9664",children:"\u5916\u952e\u5173\u8054\u81ea\u52a8\u5220\u9664"}),"\n",(0,c.jsxs)(n.p,{children:["constraint:OnDelete",":CASCADE"," \u6dfb\u52a0\u6b64\u914d\u7f6e,\u5c31\u662f\u8fde\u5e26\u5916\u952e\u7684\u6570\u636e\u5c31\u81ea\u52a8\u5220\u9664"]}),"\n",(0,c.jsx)(n.p,{children:"\u5982\u679c\u4e0d\u6dfb\u52a0\u6b64\u9879,\u90a3\u5c31\u662f\u5728\u5220\u9664\u7684\u65f6\u5019\uff0c\u5fc5\u987b\u5148\u8981\u5220\u9664\u5728\u5173\u8054\u4f7f\u7528\u8868\u4e2d\u7684\u6570\u636e,\u624d\u80fd\u5220\u9664"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.img,{src:s(7230).A+"",width:"1567",height:"906"})}),"\n",(0,c.jsx)(n.h2,{id:"gorm\u6839\u636e\u67e5\u8be2\u7ed3\u679c\u751f\u6210\u7b2c\u4e09\u7ae0\u6570\u636e\u8868",children:"GORM\u6839\u636e\u67e5\u8be2\u7ed3\u679c\u751f\u6210\u7b2c\u4e09\u7ae0\u6570\u636e\u8868"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-golang",children:'\t// \u67e5\u8be2\u6bcf\u4e00\u4e2ateacher_id \u7684\u8bfe\u7a0b\u4e2a\u6570\r\n\ttype Ret struct {\r\n\t\tTeacherID int\r\n\t\tAcount    int\r\n\t}\r\n\tvar ret []Ret\r\n\tfmt.Println("----------------------")\r\n\t//db.Model(&Class{}).Select("teacher_id,Count(*) as acount").Group("teacher_id").Having("acount >?", 1).Scan(&ret) //\u9700\u8981\u5de9\u56fa\u5b66\u4e60\r\n\tdb.Model(&Class{}).Select("teacher_id,Count(*) as acount").Group("teacher_id").Having("acount >?", 1).Find(&ret) //\u9700\u8981\u5de9\u56fa\u5b66\u4e60\r\n\tfmt.Println("ret::::", ret)\n'})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.img,{alt:"image-20231025183637876",src:s(786).A+"",width:"981",height:"210"})}),"\n",(0,c.jsx)(n.p,{children:"\u6267\u884c\u4ee3\u7801"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.img,{alt:"image-20231025183713688",src:s(4662).A+"",width:"1526",height:"205"})}),"\n",(0,c.jsx)(n.p,{children:"\u8be6\u7ec6\u8bf4\u660e:"}),"\n",(0,c.jsxs)(n.ol,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"db.Model(&Class{})"}),"\uff1a\u8fd9\u90e8\u5206\u4ee3\u7801\u7528\u4e8e\u6307\u5b9a\u8981\u64cd\u4f5c\u7684\u6570\u636e\u5e93\u6a21\u578b\u3002",(0,c.jsx)(n.code,{children:"&Class{}"})," \u8868\u793a\u4f60\u8981\u64cd\u4f5c\u540d\u4e3a ",(0,c.jsx)(n.code,{children:"Class"})," \u7684\u6a21\u578b\uff0c\u901a\u5e38\u5bf9\u5e94\u6570\u636e\u5e93\u4e2d\u7684\u4e00\u4e2a\u8868\u3002"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:'.Select("teacher_id,Count(*) as count")'}),"\uff1a\u8fd9\u4e00\u90e8\u5206\u7528\u4e8e\u9009\u62e9\u67e5\u8be2\u7684\u5217\u3002\u5b83\u6307\u5b9a\u4e86\u4e24\u5217\uff1a",(0,c.jsx)(n.code,{children:"teacher_id"})," \u548c ",(0,c.jsx)(n.code,{children:"Count(*) as count"}),"\u3002",(0,c.jsx)(n.code,{children:"Count(*)"})," \u662f\u4e00\u4e2a\u805a\u5408\u51fd\u6570\uff0c\u7528\u4e8e\u8ba1\u7b97\u6bcf\u4e2a\u6559\u5e08\u7684\u8bb0\u5f55\u6570\u91cf\uff0c\u800c ",(0,c.jsx)(n.code,{children:"as count"})," \u662f\u4e3a\u4e86\u7ed9\u8ba1\u6570\u7ed3\u679c\u6307\u5b9a\u4e00\u4e2a\u522b\u540d\uff0c\u4ee5\u4fbf\u5728\u540e\u7eed\u7684",(0,c.jsx)(n.code,{children:"Having"}),"\u5b50\u53e5\u4e2d\u5f15\u7528\u3002"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:'.Group("teacher_id")'}),"\uff1a\u8fd9\u4e00\u90e8\u5206\u7528\u4e8e\u5bf9\u67e5\u8be2\u7ed3\u679c\u8fdb\u884c\u5206\u7ec4\uff0c\u6309\u7167 ",(0,c.jsx)(n.code,{children:"teacher_id"})," \u5217\u7684\u503c\u5206\u7ec4\u3002\u8fd9\u662f\u56e0\u4e3a\u524d\u9762\u4f7f\u7528\u4e86\u805a\u5408\u51fd\u6570\uff0c\u6240\u4ee5\u9700\u8981\u6307\u5b9a\u5206\u7ec4\u5217\u3002"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:'.Having("count > ?", 1)'}),"\uff1a\u8fd9\u662f\u4e00\u4e2a\u7b5b\u9009\u6761\u4ef6\uff0c\u7528\u4e8e\u8fc7\u6ee4\u5206\u7ec4\u540e\u7684\u7ed3\u679c\u3002\u5b83\u6307\u5b9a\u4e86\u53ea\u8fd4\u56de\u90a3\u4e9b\u5206\u7ec4\u4e2d\u7684\u8bb0\u5f55\u6570\u91cf\uff08\u5373 ",(0,c.jsx)(n.code,{children:"count"}),"\uff09\u5927\u4e8e1\u7684\u5206\u7ec4\u3002"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:".Scan(&ret)"}),"\uff1a\u6700\u540e\uff0c\u4f7f\u7528 ",(0,c.jsx)(n.code,{children:"Scan"})," \u65b9\u6cd5\u5c06\u67e5\u8be2\u7ed3\u679c\u5b58\u50a8\u5230\u540d\u4e3a ",(0,c.jsx)(n.code,{children:"ret"})," \u7684\u5207\u7247\u4e2d\u3002",(0,c.jsx)(n.code,{children:"ret"})," \u7684\u7c7b\u578b\u5e94\u8be5\u4e0e\u67e5\u8be2\u7ed3\u679c\u7684\u7ed3\u6784\u5339\u914d\uff0c\u901a\u5e38\u662f\u4e00\u4e2a\u7ed3\u6784\u4f53\u5207\u7247\uff0c\u6bcf\u4e2a\u7ed3\u6784\u4f53\u5bf9\u5e94\u67e5\u8be2\u7684\u4e00\u884c\u8bb0\u5f55\u3002"]}),"\n"]}),"\n",(0,c.jsxs)(n.p,{children:["\u603b\u4e4b\uff0c\u8fd9\u6bb5\u4ee3\u7801\u7684\u76ee\u7684\u662f\u4ece\u6570\u636e\u5e93\u4e2d\u9009\u62e9 ",(0,c.jsx)(n.code,{children:"teacher_id"})," \u548c\u6bcf\u4e2a\u6559\u5e08\u7684\u8bb0\u5f55\u6570\u91cf\uff0c\u7136\u540e\u5bf9\u7ed3\u679c\u8fdb\u884c\u5206\u7ec4\uff0c\u6700\u540e\u7b5b\u9009\u51fa\u8bb0\u5f55\u6570\u91cf\u5927\u4e8e1\u7684\u5206\u7ec4\u3002\u67e5\u8be2\u7ed3\u679c\u5b58\u50a8\u5728 ",(0,c.jsx)(n.code,{children:"ret"})," \u4e2d\u3002"]}),"\n",(0,c.jsx)(n.p,{children:"\u5c06\u4ee3\u7801\u5b58\u50a8\u5230ret\u5217\u8868\u4e2d\u7684\u4e24\u79cd\u65b9\u5f0f\uff0c\u90fd\u53ef\u4ee5"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-golang",children:'db.Model(&Class{}).Select("teacher_id,Count(*) as acount").Group("teacher_id").Having("acount >?", 1).Scan(&ret) //\u9700\u8981\u5de9\u56fa\u5b66\u4e60\r\n\tdb.Model(&Class{}).Select("teacher_id,Count(*) as acount").Group("teacher_id").Having("acount >?", 1).Find(&ret) //\u9700\u8981\u5de9\u56fa\u5b66\u4e60\n'})})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,c.jsx)(n,{...e,children:(0,c.jsx)(o,{...e})}):o(e)}},786:(e,n,s)=>{s.d(n,{A:()=>c});const c=s.p+"assets/images/image-20231025183637876-c67a52f74d337cc41b7f927d78b906f8.png"},4662:(e,n,s)=>{s.d(n,{A:()=>c});const c=s.p+"assets/images/image-20231025183713688-e4bf23cf1d2783c5d0f5ddf35cbd565b.png"},7230:(e,n,s)=>{s.d(n,{A:()=>c});const c=s.p+"assets/images/image004-70b0e1eeeaae3398cd08034ac2460727.gif"},2754:(e,n,s)=>{s.d(n,{A:()=>c});const c=s.p+"assets/images/img001-7a81f8d4311d418ce3a3ac8677bbb14a.png"},6761:(e,n,s)=>{s.d(n,{A:()=>c});const c=s.p+"assets/images/img002-c9ebc9059c934560e4a9ca4bd6c04cee.png"},1008:(e,n,s)=>{s.d(n,{A:()=>c});const c=s.p+"assets/images/img003-6ff317983fe70bed70c1505f3f7dc560.png"},8453:(e,n,s)=>{s.d(n,{R:()=>i,x:()=>d});var c=s(6540);const t={},r=c.createContext(t);function i(e){const n=c.useContext(r);return c.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),c.createElement(r.Provider,{value:n},e.children)}}}]);