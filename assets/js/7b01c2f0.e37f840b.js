"use strict";(self.webpackChunkbookshell=self.webpackChunkbookshell||[]).push([[2364],{8871:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>a,contentTitle:()=>l,default:()=>d,frontMatter:()=>o,metadata:()=>i,toc:()=>c});var s=n(4848),t=n(8453);const o={},l=void 0,i={id:"Sre/\u9762\u8bd5\u9898/prometheus\u90e8\u7f72\u6587\u6863\u8f93\u51fa",title:"prometheus\u90e8\u7f72\u6587\u6863\u8f93\u51fa",description:"1\u3001\u4ecb\u7ecd\uff1a",source:"@site/docs/Sre/3-\u9762\u8bd5\u9898/4.prometheus\u90e8\u7f72\u6587\u6863\u8f93\u51fa.md",sourceDirName:"Sre/3-\u9762\u8bd5\u9898",slug:"/Sre/\u9762\u8bd5\u9898/prometheus\u90e8\u7f72\u6587\u6863\u8f93\u51fa",permalink:"/docs/Sre/\u9762\u8bd5\u9898/prometheus\u90e8\u7f72\u6587\u6863\u8f93\u51fa",draft:!1,unlisted:!1,editUrl:"https://github.com/shouji1128955/bookshell/edit/main/docs/Sre/3-\u9762\u8bd5\u9898/4.prometheus\u90e8\u7f72\u6587\u6863\u8f93\u51fa.md",tags:[],version:"current",lastUpdatedBy:"zhanglaiqiang",lastUpdatedAt:1729363133e3,sidebarPosition:4,frontMatter:{},sidebar:"SreMianshi",previous:{title:"\u76d1\u63a7",permalink:"/docs/Sre/\u9762\u8bd5\u9898/\u76d1\u63a7"},next:{title:"\u7f13\u5b58\u670d\u52a1",permalink:"/docs/Sre/\u9762\u8bd5\u9898/\u7f13\u5b58\u670d\u52a1"}},a={},c=[{value:"1\u3001\u4ecb\u7ecd\uff1a",id:"1\u4ecb\u7ecd",level:2},{value:"2\u3001Prometheus\u7684\u7279\u6027",id:"2prometheus\u7684\u7279\u6027",level:2},{value:"3\u3001Prometheus\u7684\u7ec4\u4ef6",id:"3prometheus\u7684\u7ec4\u4ef6",level:2},{value:"4\u3001prometheus\u90e8\u7f72",id:"4prometheus\u90e8\u7f72",level:2},{value:"PromQL\u8bed\u8a00",id:"promql\u8bed\u8a00",level:2},{value:"5\u3001back_box_exporter\u76d1\u63a7",id:"5back_box_exporter\u76d1\u63a7",level:2},{value:"10\u3001\u767d\u76d2\u76d1\u63a7\u548c\u9ed1\u76d2\u76d1\u63a7",id:"10\u767d\u76d2\u76d1\u63a7\u548c\u9ed1\u76d2\u76d1\u63a7",level:2},{value:"11\u3001\u5e38\u7528\u6307\u6807\u76d1\u63a7",id:"11\u5e38\u7528\u6307\u6807\u76d1\u63a7",level:2},{value:"11.1 round #\u56db\u820d\u4e94\u5165\u53d6\u6574",id:"111-round-\u56db\u820d\u4e94\u5165\u53d6\u6574",level:5},{value:"11.2 topk \u51fd\u6570",id:"112-topk-\u51fd\u6570",level:5},{value:"11.3 avg_over_time",id:"113-avg_over_time",level:5},{value:"11.4 sort_desc \u4ece\u5927\u5230\u5c0f\u6392\u5e8f",id:"114-sort_desc-\u4ece\u5927\u5230\u5c0f\u6392\u5e8f",level:5},{value:"11.5 sort \u4ece\u5c0f\u5230\u5927\u6392\u5e8f",id:"115-sort-\u4ece\u5c0f\u5230\u5927\u6392\u5e8f",level:5},{value:"11.6  0 OR on() vector(0) \u5982\u4f55\u5bf9\u63a7\u5236\u8bbe\u7f6e\u4e3a0",id:"116--0-or-on-vector0-\u5982\u4f55\u5bf9\u63a7\u5236\u8bbe\u7f6e\u4e3a0",level:5},{value:"12\u3001alertmanager-routing-tree-editor",id:"12alertmanager-routing-tree-editor",level:2},{value:"13\u3001prometheus  \u76d1\u63a7\u8fde\u63a5\u6570",id:"13prometheus--\u76d1\u63a7\u8fde\u63a5\u6570",level:2},{value:"1\u3001\u5b9e\u73b0\u7cfb\u7edf\u7ea7\u522b\u7684\u8fde\u63a5\u6570\u76d1\u63a7",id:"1\u5b9e\u73b0\u7cfb\u7edf\u7ea7\u522b\u7684\u8fde\u63a5\u6570\u76d1\u63a7",level:4},{value:"2\u3001tomcat\u76d1\u63a7",id:"2tomcat\u76d1\u63a7",level:4},{value:"14\u3001\u6309\u7167\u7b49\u7ea7\u8fdb\u884c\u544a\u8b66",id:"14\u6309\u7167\u7b49\u7ea7\u8fdb\u884c\u544a\u8b66",level:2},{value:"15\u3001windows_exporter\u76d1\u63a7",id:"15windows_exporter\u76d1\u63a7",level:2},{value:"\u76f8\u5173\u94fe\u63a5",id:"\u76f8\u5173\u94fe\u63a5",level:2}];function h(e){const r={a:"a",code:"code",h2:"h2",h4:"h4",h5:"h5",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.h2,{id:"1\u4ecb\u7ecd",children:"1\u3001\u4ecb\u7ecd\uff1a"}),"\n",(0,s.jsxs)(r.p,{children:["\u4ecb\u7ecd\u76f8\u5173\uff1a ",(0,s.jsx)(r.a,{href:"https://z.itpub.net/article/detail/362B4F22826584EA1D15C840CFB0FCDE",children:"https://z.itpub.net/article/detail/362B4F22826584EA1D15C840CFB0FCDE"})]}),"\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.a,{href:"https://link.segmentfault.com/?enc=RuMPLSf4T%2BVsif7sO90%2B4A%3D%3D.DvF2XHwezjEJHn2BjYz2Q%2FLjD72dEu0yoJSm08gUc06DF9JELFeTPAqyvIj4q4FTMIplELzuD4Eh13aF%2FpDC8pgIJXW7M8uS4cjU%2F0v1KH1yqJ%2F%2BFpRkpyH%2BOR7lQ%2FD2tAdkC0EVh5Ci0eU%2Bdy5YY%2FgBkl1MptM%2B8s9RhWl2WxJCFbON8W4WgwBt%2Fdm8cmHQABfdG1I3DdLBs0KH9Wf9rzuEubGUQb5J3xLoOQlXv3vVoqplJJ5hMb6NFaswqG9E5Y5M0vdgziL0RUYoOW6k4APpVBGaZqynWMgqkxF%2FwYTnFRbTNGfEXCG4dhwTNImZ",children:"Prometheus"}),"\u7684\u57fa\u672c\u539f\u7406\u662f\u901a\u8fc7HTTP\u534f\u8bae\u5468\u671f\u6027\u6293\u53d6\u88ab\u76d1\u63a7\u7ec4\u4ef6\u7684\u72b6\u6001\uff0c\u4efb\u610f\u7ec4\u4ef6\u53ea\u8981\u63d0\u4f9b\u5bf9\u5e94\u7684HTTP\u63a5\u53e3\u5c31\u53ef\u4ee5\u63a5\u5165\u76d1\u63a7\u3002\u4e0d\u9700\u8981\u4efb\u4f55SDK\u6216\u8005\u5176\u4ed6\u7684\u96c6\u6210\u8fc7\u7a0b\u3002\u8fd9\u6837\u505a\u975e\u5e38\u9002\u5408\u505a\u865a\u62df\u5316\u73af\u5883\u76d1\u63a7\u7cfb\u7edf\uff0c\u6bd4\u5982VM\u3001Docker\u3001Kubernetes\u7b49\u3002\u8f93\u51fa\u88ab\u76d1\u63a7\u7ec4\u4ef6\u4fe1\u606f\u7684HTTP\u63a5\u53e3\u88ab\u53eb\u505aexporter \u3002\u76ee\u524d\u4e92\u8054\u7f51\u516c\u53f8\u5e38\u7528\u7684\u7ec4\u4ef6\u5927\u90e8\u5206\u90fd\u6709exporter\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\uff0c\u6bd4\u5982Varnish\u3001Haproxy\u3001Nginx\u3001MySQL\u3001Linux\u7cfb\u7edf\u4fe1\u606f(\u5305\u62ec\u78c1\u76d8\u3001\u5185\u5b58\u3001CPU\u3001\u7f51\u7edc\u7b49\u7b49)\u3002"]}),"\n",(0,s.jsx)(r.p,{children:"\u5176\u5927\u6982\u7684\u5de5\u4f5c\u6d41\u7a0b\u662f\uff1a"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:"Prometheus server \u5b9a\u671f\u4ece\u914d\u7f6e\u597d\u7684 jobs \u6216\u8005 exporters \u4e2d\u62c9 metrics\uff0c\u6216\u8005\u63a5\u6536\u6765\u81ea Pushgateway \u53d1\u8fc7\u6765\u7684 metrics\uff0c\u6216\u8005\u4ece\u5176\u4ed6\u7684 Prometheus server \u4e2d\u62c9 metrics\u3002"}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.a,{href:"https://link.segmentfault.com/?enc=QAddnJwzIiGbY4UQ1BACrg%3D%3D.Azj0GiamA%2BjemgvsvUu9BAOkoO0eqYmY%2Fzq0toOlQz73bplTEd7UsCidmrUH5Xs8pgdWgiC9fscTwVU%2BGiM1ZhGABFNmiFvwZUtHADB9N0%2B2l6Y5VSAS4IvJLRnPGLPPRl%2BCjrXKfILOmmwX%2FEYbo7os0pP34Q%2FftPx%2Biz53qa4wdpSADyH6uMaWJDc33%2FJC4icg4i%2BbwRfSnd0LEDz%2F2AvXwNBIuiepKbTOZ01dhd0Uc1GfzGT%2FVU4fcEbAh%2FWNVY3iWSuZyy0WZqDZDVbU1AeyDh%2Bmlm4WIsTGL1TWpCweI52BUYBPBt5%2BrFQQItN6",children:"Prometheus"})," server \u5728\u672c\u5730\u5b58\u50a8\u6536\u96c6\u5230\u7684 metrics\uff0c\u5e76\u8fd0\u884c\u5df2\u5b9a\u4e49\u597d\u7684 alert.rules\uff0c\u8bb0\u5f55\u65b0\u7684\u65f6\u95f4\u5e8f\u5217\u6216\u8005\u5411 Alertmanager \u63a8\u9001\u8b66\u62a5\u3002"]}),"\n",(0,s.jsx)(r.li,{children:"Alertmanager \u6839\u636e\u914d\u7f6e\u6587\u4ef6\uff0c\u5bf9\u63a5\u6536\u5230\u7684\u8b66\u62a5\u8fdb\u884c\u5904\u7406\uff0c\u53d1\u51fa\u544a\u8b66\u3002"}),"\n",(0,s.jsx)(r.li,{children:"\u5728Grafana\u56fe\u5f62\u754c\u9762\u4e2d\uff0c\u53ef\u89c6\u5316\u67e5\u770b\u91c7\u96c6\u6570\u636e"}),"\n"]}),"\n",(0,s.jsx)(r.h2,{id:"2prometheus\u7684\u7279\u6027",children:"2\u3001Prometheus\u7684\u7279\u6027"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:"\u591a\u7ef4\u5ea6\u6570\u636e\u6a21\u578b\u3002"}),"\n",(0,s.jsx)(r.li,{children:"\u7075\u6d3b\u7684\u67e5\u8be2\u8bed\u8a00\u3002"}),"\n",(0,s.jsx)(r.li,{children:"\u4e0d\u4f9d\u8d56\u5206\u5e03\u5f0f\u5b58\u50a8\uff0c\u5355\u4e2a\u670d\u52a1\u5668\u8282\u70b9\u662f\u81ea\u4e3b\u7684\u3002"}),"\n",(0,s.jsx)(r.li,{children:"\u901a\u8fc7\u57fa\u4e8eHTTP\u7684pull\u65b9\u5f0f\u91c7\u96c6\u65f6\u5e8f\u6570\u636e\u3002"}),"\n",(0,s.jsx)(r.li,{children:"\u53ef\u4ee5\u901a\u8fc7\u4e2d\u95f4\u7f51\u5173\u8fdb\u884c\u65f6\u5e8f\u5217\u6570\u636e\u63a8\u9001\u3002"}),"\n",(0,s.jsx)(r.li,{children:"\u901a\u8fc7\u670d\u52a1\u53d1\u73b0\u6216\u8005\u9759\u6001\u914d\u7f6e\u6765\u53d1\u73b0\u76ee\u6807\u670d\u52a1\u5bf9\u8c61\u3002"}),"\n",(0,s.jsx)(r.li,{children:"\u652f\u6301\u591a\u79cd\u591a\u6837\u7684\u56fe\u8868\u548c\u754c\u9762\u5c55\u793a\uff0c\u6bd4\u5982Grafana\u7b49\u3002"}),"\n"]}),"\n",(0,s.jsx)(r.h2,{id:"3prometheus\u7684\u7ec4\u4ef6",children:"3\u3001Prometheus\u7684\u7ec4\u4ef6"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:"Prometheus Server \u4e3b\u8981\u8d1f\u8d23\u6570\u636e\u91c7\u96c6\u548c\u5b58\u50a8\uff0c\u63d0\u4f9bPromQL\u67e5\u8be2\u8bed\u8a00\u7684\u652f\u6301\u3002"}),"\n",(0,s.jsx)(r.li,{children:"Alertmanager \u8b66\u544a\u7ba1\u7406\u5668\uff0c\u7528\u6765\u8fdb\u884c\u62a5\u8b66\u3002"}),"\n",(0,s.jsx)(r.li,{children:"Push Gateway \u652f\u6301\u4e34\u65f6\u6027Job\u4e3b\u52a8\u63a8\u9001\u6307\u6807\u7684\u4e2d\u95f4\u7f51\u5173\u3002"}),"\n",(0,s.jsx)(r.li,{children:"Exporters \u8f93\u51fa\u88ab\u76d1\u63a7\u7ec4\u4ef6\u4fe1\u606f\u7684HTTP\u63a5\u53e3\u3002"}),"\n",(0,s.jsx)(r.li,{children:"Grafana \u76d1\u63a7\u6570\u636e\u5c55\u793aWeb UI\u3002"}),"\n"]}),"\n",(0,s.jsx)(r.p,{children:"Prometheus \u652f\u6301\u591a\u79cd\u670d\u52a1\u53d1\u73b0\u673a\u5236\uff0c\u53ef\u4ee5\u81ea\u52a8\u83b7\u53d6\u8981\u6536\u96c6\u7684 targets\uff0c\u5305\u542b\u7684\u670d\u52a1\u53d1\u73b0\u673a\u5236\u5305\u62ec\uff1aazure\u3001consul\u3001dns\u3001ec2\u3001openstack\u3001file\u3001gce\u3001kubernetes\u3001marathon\u3001triton\u3001zookeeper\uff08nerve\u3001serverset\uff09\uff0c\u914d\u7f6e\u65b9\u6cd5\u53ef\u4ee5\u53c2\u8003\u624b\u518c\u7684\u914d\u7f6e\u9875\u9762\u3002\u53ef\u4ee5\u8bf4 SD \u673a\u5236\u662f\u975e\u5e38\u4e30\u5bcc\u7684\uff0c\u4f46\u76ee\u524d\u7531\u4e8e\u5f00\u53d1\u8d44\u6e90\u6709\u9650\uff0c\u5df2\u7ecf\u4e0d\u518d\u5f00\u53d1\u65b0\u7684 SD \u673a\u5236\uff0c\u53ea\u5bf9\u57fa\u4e8e\u6587\u4ef6\u7684 SD \u673a\u5236\u8fdb\u884c\u7ef4\u62a4\u3002\u9488\u5bf9\u6211\u4eec\u73b0\u6709\u7684\u7cfb\u7edf\u60c5\u51b5\uff0c\u6211\u4eec\u9009\u62e9\u4e86\u9759\u6001\u914d\u7f6e\u65b9\u5f0f\u3002"}),"\n",(0,s.jsx)(r.p,{children:"\u4f7f\u7528docker\u90e8\u7f72\u5b98\u65b9\u53c2\u8003\u6587\u6863\uff1a"}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.a,{href:"https://github.com/prometheus/prometheus",children:"https://github.com/prometheus/prometheus"})}),"\n",(0,s.jsx)(r.h2,{id:"4prometheus\u90e8\u7f72",children:"4\u3001prometheus\u90e8\u7f72"}),"\n",(0,s.jsx)(r.p,{children:"\u81ea\u5b9a\u4e49prometheus\u955c\u50cf"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-shell",children:'[root@loaclhost data]# ls -l\r\ntotal 71384\r\ndrwxrwxrwx 3 root root       45 Nov  3 19:52 alertmanager\r\n-rw-r--r-- 1 root root      526 Nov  3 17:59 Dockerfile\r\ndrwxr-xr-x 5 root root      144 Nov  3 18:28 prometheus\r\n-rw-r--r-- 1 root root 73091480 Nov  3 16:31 prometheus-2.31.0.linux-amd64.tar.gz\r\n[root@loaclhost data]# cat Dockerfile \r\nFROM  centos:centos7\r\nADD prometheus-2.31.0.linux-amd64.tar.gz /\r\nRUN  ln -snf /usr/share/zoneinfo/Asia/Shanghai   /etc/localtime  &&  mv  prometheus-2.31.0.linux-amd64 prometheus\r\nWORKDIR  /prometheus\r\nENTRYPOINT ["/prometheus/prometheus"]\r\nCMD        [ "--config.file=/prometheus/prometheus.yml", \\\r\n             "--storage.tsdb.path=/prometheus/data", \\\r\n             "--web.console.libraries=/prometheus/console_libraries", \\\r\n             "--web.enable-lifecycle", \\\r\n             "--web.console.templates=/prometheus/consoles" ]\r\n\r\n#\u8bf4\u660e\uff0c\u521b\u5efa\u955c\u50cf\u4f7f\u7528 docker build -t myprometheus:1 . \n'})}),"\n",(0,s.jsx)(r.p,{children:"\u90e8\u7f72prometheus"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-shell",children:"1\u3001\u521b\u5efaprometheus\u4fdd\u5b58\u6587\u4ef6\u7684\u6570\u636e\u76ee\u5f55\r\nmkdir -p /data/prometheus\r\n\r\n2\u3001\u521b\u5efaprometheus\u5bb9\u5668\r\ndocker run -d   --restart=always  --name prometheus   -p 9090:9090   myprometheus:1\r\n\r\n3\u3001\u62f7\u8d1dprometheus\u7684\u914d\u7f6e\u6587\u6863\r\ndocker cp prometheus:/prometheus/  /data/prometheus\r\n\r\n4\u3001\u542f\u52a8prometheus\u5bb9\u5668\r\ndocker run -d   --restart=always  --name prometheus   -p 9090:9090  -v /data/prometheus:/prometheus  myprometheus:1\n"})}),"\n",(0,s.jsx)(r.p,{children:"\u90e8\u7f72alertmanager\u670d\u52a1"}),"\n",(0,s.jsxs)(r.p,{children:["\u53c2\u8003\u5b98\u65b9\uff1a  ",(0,s.jsx)(r.a,{href:"https://github.com/prometheus/alertmanager",children:"https://github.com/prometheus/alertmanager"})]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-shell",children:"1\u3001\u521b\u5efa\u76ee\u5f55\r\nmkdir -p /data/alertmanager /data/alertmanager/storage\r\n\r\n2\u3001\u542f\u52a8\u5bb9\u5668\r\ndocker run -d   -p 9093:9093   --name alertmanager   --restart=always   -v /etc/localtime:/etc/localtime   -v /data/alertmanager/storage:/alertmanager   prom/alertmanager\r\n\r\n3\u3001\u62f7\u8d1d\u5bb9\u5668\u4e2d\u7684alertmanager.yml\u6587\u4ef6\r\n docker cp alertmanager:/etc/alertmanager/alertmanager.yml /data/alertmanager\r\n\r\n4\u3001\u5bf9alertmanager.yml\u6587\u4ef6\u8fdb\u884c\u6302\u8f7d\r\ndocker run -d   -p 9093:9093   --name alertmanager   --restart=always   -v /etc/localtime:/etc/localtime   -v /data/alertmanager:/etc/alertmanager   -v /data/alertmanager/storage:/alertmanager   prom/alertmanager\n"})}),"\n",(0,s.jsx)(r.p,{children:"prometheus\u6dfb\u52a0alertmanager\u5730\u5740"}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/operator/image-20211103201601827.png",alt:"image-20211103201601827"})}),"\n",(0,s.jsx)(r.p,{children:"\u6dfb\u52a0\u4e4b\u540e \u53c2\u8003\u5982\u4e0b\uff1a"}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/operator/image-20211103201620941.png",alt:"image-20211103201620941"})}),"\n",(0,s.jsx)(r.p,{children:"Node_exporter\u5b89\u88c5"}),"\n",(0,s.jsxs)(r.p,{children:["1\u3001wget  ",(0,s.jsx)(r.a,{href:"https://github.com/prometheus/node_exporter/releases/download/v1.2.2/node_exporter-1.2.2.linux-amd64.tar.gz",children:"https://github.com/prometheus/node_exporter/releases/download/v1.2.2/node_exporter-1.2.2.linux-amd64.tar.gz"})]}),"\n",(0,s.jsx)(r.p,{children:"2\u3001\u4e0b\u8f7d\u4e4b\u540e cd   node_exporter-xxx    && nohup  ./node_exporter\u8fd0\u884c\u5373\u53ef"}),"\n",(0,s.jsx)(r.p,{children:"3\u3001 \u5728prometheus.yml\u4e2d\u6307\u5b9a\u6dfb\u52a0\u7684\u8282\u70b9"}),"\n",(0,s.jsx)(r.p,{children:"\u9489\u9489\u63d2\u4ef6\u5b98\u65b9\u5b89\u88c5\u94fe\u63a5\uff1a"}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.a,{href:"https://github.com/timonwong/prometheus-webhook-dingtalk/releases",children:"https://github.com/timonwong/prometheus-webhook-dingtalk/releases"})}),"\n",(0,s.jsx)(r.h2,{id:"promql\u8bed\u8a00",children:"PromQL\u8bed\u8a00"}),"\n",(0,s.jsxs)(r.p,{children:["PromQL\u662fPrometheus\u81ea\u5b9a\u4e49\u7684\u4e00\u5957\u5f3a\u5927\u7684\u6570\u636e\u67e5\u8be2\u8bed\u8a00\uff0c\u9664\u4e86\u4f7f\u7528\u76d1\u63a7\u6307\u6807\u4f5c\u4e3a\u67e5\u8be2\u5173\u952e\u5b57\u4ee5\u4e3a\uff0c\u8fd8\u5185\u7f6e\u4e86\u5927\u91cf\u7684\u51fd\u6570\uff0c\u5e2e\u52a9\u7528\u6237\u8fdb\u4e00\u6b65\u5bf9\u65f6\u5e8f\u6570\u636e\u8fdb\u884c\u5904\u7406\u3002\u4f8b\u5982\u4f7f\u7528",(0,s.jsx)(r.code,{children:"rate()"}),"\u51fd\u6570\uff0c\u53ef\u4ee5\u8ba1\u7b97\u5728\u5355\u4f4d\u65f6\u95f4\u5185\u6837\u672c\u6570\u636e\u7684\u53d8\u5316\u60c5\u51b5\u5373\u589e\u957f\u7387\uff0c\u56e0\u6b64\u901a\u8fc7\u8be5\u51fd\u6570\u6211\u4eec\u53ef\u4ee5\u8fd1\u4f3c\u7684\u901a\u8fc7CPU\u4f7f\u7528\u65f6\u95f4\u8ba1\u7b97CPU\u7684\u5229\u7528\u7387\uff1a"]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{})}),"\n",(0,s.jsx)(r.p,{children:"\u67e5\u770bnode\u662f\u5426\u542f\u52a8\uff1a"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-shell",children:'up{instance="192.168.100.232:9100",job="Host-test-232"}  #\u8fc7\u6ee4\n'})}),"\n",(0,s.jsx)(r.p,{children:"\u53c2\u8003\u6587\u6863\uff1a"}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.a,{href:"https://yunlzheng.gitbook.io/prometheus-book/parti-prometheus-ji-chu/promql/prometheus-promql-operators-v2",children:"https://yunlzheng.gitbook.io/prometheus-book/parti-prometheus-ji-chu/promql/prometheus-promql-operators-v2"})}),"\n",(0,s.jsx)(r.p,{children:"\u9489\u9489\u6d4b\u8bd5\u53d1\u9001\u6d88\u606f\uff1a"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{children:'curl  https://oapi.dingtalk.com/robot/send?access_token=d79446f315feb6b0207870151d8146f65b18fe262af19d661787408ab24ad56   -H \'Content-Type: application/json\' \\\r\n -d \'{"msgtype": "text","text": {"content":"\u6211\u5c31\u662f\u6211, \u662f\u4e0d\u4e00\u6837\u7684\u70df\u706b"}}\'\n'})}),"\n",(0,s.jsx)(r.p,{children:"\u91cd\u8f7dprometheus\u7684\u914d\u7f6e\u6587\u4ef6"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{children:"curl -XPOST  http://10.51.8.110:9090/-/reload\n"})}),"\n",(0,s.jsx)(r.h2,{id:"5back_box_exporter\u76d1\u63a7",children:"5\u3001back_box_exporter\u76d1\u63a7"}),"\n",(0,s.jsx)(r.h4,{id:""}),"\n",(0,s.jsx)(r.p,{children:"\u76ee\u524d\u5728\u4f7f\u7528\u7684TCP\uff0cICMP\uff0cHTTPS\u670d\u52a1\u72b6\u6001\u76d1\u63a7 Prometheus Blackbox Exporter\uff0c\u5728\u4e00\u4e2a\u770b\u677f\u91cc\u9762\u5c55\u793a\uff0c\u505a\u4e86\u5c55\u793a\u6548\u679c\u7684\u4f18\u5316\uff0c\u652f\u6301\u591a\u670d\u52a1\u540c\u65f6\u5c55\u793a\uff0c\u9700\u8981\u4f7f\u7528\u7684\u53ef\u4ee5\u53c2\u8003\u4e0b\uff0c\u8bb0\u5f97\u6839\u636e\u81ea\u5df1\u7684\u5b9e\u9645\u60c5\u51b5\u4fee\u6539\u4e0b\u53d8\u91cf\u3002"}),"\n",(0,s.jsx)(r.p,{children:"blackbox_exporter\u662fPrometheus \u5b98\u65b9\u63d0\u4f9b\u7684 exporter \u4e4b\u4e00\uff0c\u53ef\u4ee5\u63d0\u4f9b http\u3001dns\u3001tcp\u3001icmp \u7684\u76d1\u63a7\u6570\u636e\u91c7\u96c6\u3002"}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"blackbox_exporter \u5e94\u7528\u573a\u666f\uff1a"})}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"HTTP \u6d4b\u8bd5\uff1a"})," \u5b9a\u4e49 Request Header \u4fe1\u606f\uff0c\u5224\u65ad Http status / Http Respones Header / Http Body \u5185\u5bb9"]}),"\n",(0,s.jsx)(r.li,{children:"**TCP \u6d4b\u8bd5\uff1a**\u4e1a\u52a1\u7ec4\u4ef6\u7aef\u53e3\u72b6\u6001\u76d1\u542c\uff0c \u5e94\u7528\u5c42\u534f\u8bae\u5b9a\u4e49\u4e0e\u76d1\u542c"}),"\n",(0,s.jsx)(r.li,{children:"**ICMP \u6d4b\u8bd5\uff1a**\u4e3b\u673a\u63a2\u6d3b\u673a\u5236"}),"\n",(0,s.jsx)(r.li,{children:"**POST \u6d4b\u8bd5\uff1a**\u63a5\u53e3\u8054\u901a\u6027"}),"\n",(0,s.jsx)(r.li,{children:(0,s.jsx)(r.strong,{children:"SSL \u8bc1\u4e66\u8fc7\u671f\u65f6\u95f4"})}),"\n"]}),"\n",(0,s.jsx)(r.p,{children:"\u5b89\u88c5blackbox_exporter"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-shell",children:"# wget https://github.com/prometheus/blackbox_exporter/releases/download/v0.16.0/blackbox_exporter-0.16.0.linux-amd64.tar.gz\r\n\r\n# tar xf blackbox_exporter-0.16.0.linux-amd64.tar.gz -C /usr/local/\r\n# ln -s /usr/local/blackbox_exporter-0.16.0.linux-amd64/ /usr/local/blackbox_exporter\r\n\r\n# \u4f7f\u7528systemd\u7ba1\u7406blackbox_exporter\u670d\u52a1\r\n# vim /usr/lib/systemd/system/blackbox_exporter.service\r\n[Unit]\r\nDescription=blackbox_exporter\r\nAfter=network.target\r\n\r\n[Service]\r\nUser=root\r\nType=simple\r\nExecStart=/usr/local/blackbox_exporter/blackbox_exporter --config.file=/usr/local/blackbox_exporter/blackbox.yml\r\nRestart=on-failure\r\n\r\n[Install]\r\nWantedBy=multi-user.target\r\n\r\n# systemctl daemon-reload\r\n# systemctl start blackbox_exporter\r\n# systemctl enable blackbox_exporter\n"})}),"\n",(0,s.jsxs)(r.p,{children:["\u6a21\u677f\u4e0b\u8f7d\u5730\u5740\uff1a  ",(0,s.jsx)(r.a,{href:"https://grafana.com/grafana/dashboards/9965",children:"https://grafana.com/grafana/dashboards/9965"})]}),"\n",(0,s.jsx)(r.p,{children:"grafana\u63d2\u4ef6\u5b89\u88c5\u5730\u5740\uff1a"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-shell",children:"docker exec -it  grafana /bin/sh \r\ngrafana-cli plugins install grafana-piechart-panel\n"})}),"\n",(0,s.jsx)(r.p,{children:"\u76f8\u5173\u76d1\u63a7\u6307\u6807\u53c2\u8003\uff1a"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-shell",children:"1\u3001probe_success \u6307\u6807\u53ef\u4ee5\u5224\u65ad\u6211\u4eec\u7684 icmp\u3001tcp\u3001http\u3001post \u76d1\u6d4b\u662f\u5426\u6b63\u5e38\u3002\u503c\u4e3a 1 \u6b63\u5e38\uff0c0\u4e0d\u6b63\u5e38\u3002 \r\n2\u3001probe_http_status_code \u6307\u6807\u53ef\u4ee5\u77e5\u9053\u67d0\u4e2ahttp\u8bf7\u6c42\u8fd4\u56de\u7684\u54cd\u5e94\u7801\u3002\r\n3\u3001probe_ssl_earliest_cert_expiry \u6307\u6807\u53ef\u4ee5\u77e5\u9053ssl\u8bc1\u4e66\u4f55\u65f6\u8fc7\u671f\u3002\n"})}),"\n",(0,s.jsx)(r.h4,{id:"-1"}),"\n",(0,s.jsx)(r.p,{children:"6\u3001\u5e38\u89c1\u51fd\u6570"}),"\n",(0,s.jsxs)(r.ol,{children:["\n",(0,s.jsx)(r.li,{children:"round"}),"\n"]}),"\n",(0,s.jsx)(r.p,{children:"#counter\u7c7b\u578b\uff0c\u7edf\u8ba1\u5404\u4e2a\u7f51\u5361\u7684\u5165\u6d41\u91cf  node_network_receive_bytes_total"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{children:'\u7edf\u8ba1\u67d0\u4e00\u4e2a\u8282\u70b9\r\nround((irate(node_network_receive_bytes_total{instance="172.17.224.119"}[1m]) / 1048576  ),0.001)\r\n\r\n\u7edf\u8ba1\u6240\u6709\u8282\u70b9\u7684\u7f51\u5361\u5165\u6d41\u91cf\u5927\u4e8e20M \r\nround((irate(node_network_receive_bytes_total{device!="lo"}[1m]) / 1048576  ),0.001) > 20\n'})}),"\n",(0,s.jsx)(r.p,{children:"\u4f7f\u7528round\u53ef\u4ee5\u7cbe\u786e\u5230\u540e\u4e09\u4f4d\u3002"}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/operator/image-20220114201924748.png",alt:"image-20220114201924748"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{children:'#\u8282\u70b9\u7f51\u5361\u51fa\u6d41\u91cf\u8d85\u8fc78M\r\nround((irate(node_network_transmit_bytes_total{device!="lo"}[1m]) / 1048576  ),0.001) > 8\n'})}),"\n",(0,s.jsx)(r.h2,{id:"10\u767d\u76d2\u76d1\u63a7\u548c\u9ed1\u76d2\u76d1\u63a7",children:"10\u3001\u767d\u76d2\u76d1\u63a7\u548c\u9ed1\u76d2\u76d1\u63a7"}),"\n",(0,s.jsx)(r.p,{children:"\u6211\u4eec\u76d1\u63a7\u4e3b\u673a\u7684\u8d44\u6e90\u7528\u91cf\u3001\u5bb9\u5668\u7684\u8fd0\u884c\u72b6\u6001\u3001\u6570\u636e\u5e93\u4e2d\u95f4\u4ef6\u7684\u8fd0\u884c\u6570\u636e\u3002\u8fd9\u4e9b\u90fd\u662f\u652f\u6301\u4e1a\u52a1\u548c\u670d\u52a1\u7684\u57fa\u7840\u8bbe\u65bd\uff0c\u901a\u8fc7\u767d\u76d2\u80fd\u591f\u4e86\u89e3\u5176\u5185\u90e8\u7684\u5b9e\u9645\u8fd0\u884c\u72b6\u6001\uff0c\u901a\u8fc7\u5bf9\u76d1\u63a7\u6307\u6807\u7684\u89c2\u5bdf\u80fd\u591f\u9884\u5224\u53ef\u80fd\u51fa\u73b0\u7684\u95ee\u9898\uff0c\u4ece\u800c\u5bf9\u6f5c\u5728\u7684\u4e0d\u786e\u5b9a\u56e0\u7d20\u8fdb\u884c\u4f18\u5316\u3002\u800c\u4ece\u5b8c\u6574\u7684\u76d1\u63a7\u903b\u8f91\u7684\u89d2\u5ea6\uff0c\u9664\u4e86\u5927\u91cf\u7684\u5e94\u7528\u767d\u76d2\u76d1\u63a7\u4ee5\u5916\uff0c\u8fd8\u5e94\u8be5\u6dfb\u52a0\u9002\u5f53\u7684\u9ed1\u76d2\u76d1\u63a7\u3002\u9ed1\u76d2\u76d1\u63a7\u5373\u4ee5\u7528\u6237\u7684\u8eab\u4efd\u6d4b\u8bd5\u670d\u52a1\u7684\u5916\u90e8\u53ef\u89c1\u6027\uff0c\u5e38\u89c1\u7684\u9ed1\u76d2\u76d1\u63a7\u5305\u62ecHTTP\u63a2\u9488\u3001TCP\u63a2\u9488\u7b49\u7528\u4e8e\u68c0\u6d4b\u7ad9\u70b9\u6216\u8005\u670d\u52a1\u7684\u53ef\u8bbf\u95ee\u6027\uff0c\u4ee5\u53ca\u8bbf\u95ee\u6548\u7387\u7b49\u3002"}),"\n",(0,s.jsx)(r.p,{children:"\u9ed1\u76d2\u76d1\u63a7\u76f8\u8f83\u4e8e\u767d\u76d2\u76d1\u63a7\u6700\u5927\u7684\u4e0d\u540c\u5728\u4e8e\u9ed1\u76d2\u76d1\u63a7\u662f\u4ee5\u6545\u969c\u4e3a\u5bfc\u5411\u5f53\u6545\u969c\u53d1\u751f\u65f6\uff0c\u9ed1\u76d2\u76d1\u63a7\u80fd\u5feb\u901f\u53d1\u73b0\u6545\u969c\uff0c\u800c\u767d\u76d2\u76d1\u63a7\u5219\u4fa7\u91cd\u4e8e\u4e3b\u52a8\u53d1\u73b0\u6216\u8005\u9884\u6d4b\u6f5c\u5728\u7684\u95ee\u9898\u3002\u4e00\u4e2a\u5b8c\u5584\u7684\u76d1\u63a7\u76ee\u6807\u662f\u8981\u80fd\u591f\u4ece\u767d\u76d2\u7684\u89d2\u5ea6\u53d1\u73b0\u6f5c\u5728\u95ee\u9898\uff0c\u80fd\u591f\u5728\u9ed1\u76d2\u7684\u89d2\u5ea6\u5feb\u901f\u53d1\u73b0\u5df2\u7ecf\u53d1\u751f\u7684\u95ee\u9898\u3002"}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/operator/image-20211110104346812.png",alt:"image-20211110104346812"})}),"\n",(0,s.jsx)(r.p,{children:"11\u3001\u81ea\u5b9a\u4e49\u6a21\u677f"}),"\n",(0,s.jsxs)(r.p,{children:["\u5b98\u65b9\u8fde\u63a5\uff1a ",(0,s.jsx)(r.a,{href:"https://prometheus.io/docs/alerting/latest/notifications/#aler",children:"https://prometheus.io/docs/alerting/latest/notifications/#aler"})]}),"\n",(0,s.jsx)(r.p,{children:"\u538b\u529b\u6d4b\u8bd5:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-shell",children:"stress  -c  1 -m  1  -d 1  -t   3500\n"})}),"\n",(0,s.jsx)(r.p,{children:"\u544a\u8b66\u6a21\u677f\u914d\u7f6e\u8be6\u60c5"}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/operator/image-20220111095525131.png",alt:"image-20220111095525131"})}),"\n",(0,s.jsx)(r.p,{children:"alertmanager\u4e3b\u9898\u914d\u7f6e\u6a21\u677f\u53c2\u8003"}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/operator/image-20220111095323334.png",alt:"image-20220111095323334"})}),"\n",(0,s.jsx)(r.p,{children:"\u8bed\u6cd5\u68c0\u67e5"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{children:"alertmanager: \r\n docker exec alertmanager amtool check-config /etc/alertmanager/alertmanager.yml\r\namtool check-config  alertmanager.yml \r\n\n"})}),"\n",(0,s.jsx)(r.h2,{id:"11\u5e38\u7528\u6307\u6807\u76d1\u63a7",children:"11\u3001\u5e38\u7528\u6307\u6807\u76d1\u63a7"}),"\n",(0,s.jsx)(r.p,{children:"\u975e\u5e38\u597d\u7684\u5b66\u4e60\u7f51\u5740\uff1a"}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.a,{href:"https://www.kancloud.cn/pshizhsysu/prometheus/1803793",children:"https://www.kancloud.cn/pshizhsysu/prometheus/1803793"})}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.a,{href:"https://www.zhukun.net/archives/8285",children:"https://www.zhukun.net/archives/8285"})}),"\n",(0,s.jsx)(r.h5,{id:"111-round-\u56db\u820d\u4e94\u5165\u53d6\u6574",children:"11.1 round #\u56db\u820d\u4e94\u5165\u53d6\u6574"}),"\n",(0,s.jsx)(r.p,{children:"\u6709\u4e24\u4e2a\u4f5c\u7528\uff1a"}),"\n",(0,s.jsx)(r.p,{children:"\u7b2c\u4e00\u53d6\u6574\u6570"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-shell",children:'round(avg_over_time(node_netstat_Tcp_CurrEstab{instance=~"172.17.224.51"}[4h]))\n'})}),"\n",(0,s.jsx)(r.p,{children:"\u7b2c\u4e8c\u4fdd\u7559\u5c0f\u6570\u4f4d\u540e\u4e09\u4f4d"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-shell",children:'round(avg_over_time(node_netstat_Tcp_CurrEstab{instance=~"172.17.224.51"}[4h]),0.001)\n'})}),"\n",(0,s.jsx)(r.h5,{id:"112-topk-\u51fd\u6570",children:"11.2 topk \u51fd\u6570"}),"\n",(0,s.jsx)(r.p,{children:"topk  \uff08\u7edf\u8ba1\u6700\u5927\u7684\u51e0\u4e2a\u503c)  ---\u7edf\u8ba1\u6240\u6709url\u4e2d\u8017\u65f6\u6700\u591a\u7684\u4e00\u6761"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-shell",children:"topk(1,avg_over_time(probe_duration_seconds[4h]))*1000)\n"})}),"\n",(0,s.jsx)(r.h5,{id:"113-avg_over_time",children:"11.3 avg_over_time"}),"\n",(0,s.jsx)(r.p,{children:"#\u67e5\u8be2\u4e00\u5929\u7a7a\u95f2\u7a7a\u95f4\u7684\u5e73\u5747\u503c\uff0c\u76f8\u5173\u7684\u8fd8\u6709\u5982\u4e0b"}),"\n",(0,s.jsx)(r.p,{children:"avg_over_time()  #\u6307\u5b9a\u95f4\u9694\u5185\u6240\u6709\u70b9\u7684\u5e73\u5747\u503c\u3002\r\nmin_over_time()  #\u6307\u5b9a\u95f4\u9694\u4e2d\u6240\u6709\u70b9\u7684\u6700\u5c0f\u503c\u3002\r\nmax_over_time()  #\u6307\u5b9a\u95f4\u9694\u5185\u6240\u6709\u70b9\u7684\u6700\u5927\u503c\u3002\r\nsum_over_time()  #\u6307\u5b9a\u65f6\u95f4\u95f4\u9694\u5185\u6240\u6709\u503c\u7684\u603b\u548c"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-shell",children:"avg_over_time(probe_duration_seconds[4h])) ###\u7edf\u8ba14\u5c0f\u65f6\u4e4b\u524d\u7684\u5ef6\u8fdf\u503c\n"})}),"\n",(0,s.jsx)(r.p,{children:"max_over_time"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-shell",children:"max_over_time(rate(http_request_total[5m])[1h:1m])\r\n\r\n#\u603b\u7684\u6765\u8bf4\u5c31\u662f\u7edf\u8ba1prometheus\u4e0a/metrics\u9875\u9762\u57285\u5206\u949f\u5185\u533a\u95f4\u5411\u91cf\u7684\u5e73\u5747\u503c\u7684\u70b9\r\n#\u57281\u4e2a\u5c0f\u65f6\u4e2d\u6bcf\u4e2a\u70b9\u7684\u503c\r\n\r\nrate(http_request_total[5m])[1h:1m]  \r\n#\u5b83\u5c06\u4e94\u5206\u949f\u7684\u6570\u636e\u805a\u5408\u6210\u4e00\u4e2a\u77ac\u65f6\u5411\u91cf\u3002\r\n#[1h\u5c31\u50cf\u8303\u56f4\u5411\u91cf\u9009\u62e9\u5668\u4e00\u6837\uff0c\u5b83\u5b9a\u4e49\u4e86\u76f8\u5bf9\u4e8e\u67e5\u8be2\u6c42\u503c\u65f6\u95f4\u7684\u8303\u56f4\u5927\u5c0f\u3002\r\n\r\n#:1m]\u8981\u4f7f\u7528\u7684\u95f4\u9694\u503c\u3002\u5982\u679c\u6ca1\u6709\u5b9a\u4e49\uff0c\u5b83\u9ed8\u8ba4\u4e3a\u5168\u5c40\u8ba1\u7b97\u533a\u95f4\n"})}),"\n",(0,s.jsx)(r.h5,{id:"114-sort_desc-\u4ece\u5927\u5230\u5c0f\u6392\u5e8f",children:"11.4 sort_desc \u4ece\u5927\u5230\u5c0f\u6392\u5e8f"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-shell",children:"sort_desc(round((1 - (node_memory_MemAvailable_bytes{} / (node_memory_MemTotal_bytes{})))*100,0.01))\n"})}),"\n",(0,s.jsx)(r.h5,{id:"115-sort-\u4ece\u5c0f\u5230\u5927\u6392\u5e8f",children:"11.5 sort \u4ece\u5c0f\u5230\u5927\u6392\u5e8f"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-shell",children:"sort_desc(round((1 - (node_memory_MemAvailable_bytes{} / (node_memory_MemTotal_bytes{})))*100,0.01))\n"})}),"\n",(0,s.jsx)(r.h5,{id:"116--0-or-on-vector0-\u5982\u4f55\u5bf9\u63a7\u5236\u8bbe\u7f6e\u4e3a0",children:"11.6  0 OR on() vector(0) \u5982\u4f55\u5bf9\u63a7\u5236\u8bbe\u7f6e\u4e3a0"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-shell",children:'node_tcp_connection_states{state="syn_recv",instance="172.17.113.100"} > 0 OR on() vector(0)\n'})}),"\n",(0,s.jsx)(r.p,{children:"\u5982\u4f55\u67e5\u8a62\u4e0d\u5230\uff0c\u90a3\u4e48\u8be5\u503c\u8d4b\u503c\u4e3a0"}),"\n",(0,s.jsx)(r.p,{children:"\u5176\u4ed6\u51fd\u6570:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{children:"absent()               #\u53d6\u5e03\u5c14\u503c\r\nabs()                  #\u7edd\u5bf9\u503c\r\nsqrt()                 #\u5e73\u65b9\u6839\r\nceil()                 #\u5411\u4e0a\u53d6\u6574\r\nfloor()                #\u5411\u4e0b\u53d6\u6574\r\nchanges()              #\u663e\u793a\u53d8\u66f4\u6b21\u6570\r\nround()                #\u56db\u820d\u4e94\u5165\u53d6\u6574\r\nclamp_max()            #\u5f53\u5927\u4e8e\u6700\u5927\u503c\u65f6\uff0c\u5219\u4e3a\u6700\u5927\u503c\r\nclamp_min()            #\u5f53\u5c0f\u4e8e\u6700\u5c0f\u503c\u65f6\uff0c\u5219\u4e3a\u6700\u5c0f\u503c\r\nlable_join()           #\u65b0\u589e\u6807\u7b7e\r\nlable_replace()        #\u66ff\u6362\u6807\u7b7e\r\npredict_linear()       #\u57fa\u4e8e\u4e00\u6bb5\u65f6\u95f4\u5185\u7684\u589e\u957f\u503c\u6765\u9884\u6d4b\u591a\u4e45\u540e\u4f1a\u6ea2\u51fa\r\nrate()                 #\u8ba1\u7b97\u533a\u95f4\u5411\u91cf\u91cc\u7684\u5e73\u5747\u589e\u957f\u7387\r\nirate()                #\u8ba1\u7b97\u533a\u95f4\u5411\u91cf\u5185\u6700\u65b0\u548c\u6700\u540e\u7684\u77ac\u65f6\u5411\u91cf\u7684\u589e\u957f\u7387\r\nsort()                 #\u5347\u5e8f\u6392\u5e8f\r\nsort_desc()            #\u964d\u5e8f\u6392\u5e8f\r\ndelta()                #\u8ba1\u7b97\u533a\u95f4\u5411\u91cf\u91cc\u6700\u5927\u6700\u5c0f\u7684\u5dee\u503c\r\nincrease()             #\u8ba1\u7b97\u533a\u95f4\u5411\u91cf\u91cc\u6700\u540e\u4e00\u4e2a\u503c\u548c\u7b2c\u4e00\u4e2a\u503c\u7684\u5dee\u503c\n"})}),"\n",(0,s.jsx)(r.h2,{id:"12alertmanager-routing-tree-editor",children:"12\u3001alertmanager-routing-tree-editor"}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.a,{href:"https://prometheus.io/webtools/alerting/routing-tree-editor/"})}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/operator/image-20220330150108489.png",alt:"image-20220330150108489"})}),"\n",(0,s.jsx)(r.h2,{id:"13prometheus--\u76d1\u63a7\u8fde\u63a5\u6570",children:"13\u3001prometheus  \u76d1\u63a7\u8fde\u63a5\u6570"}),"\n",(0,s.jsx)(r.h4,{id:"1\u5b9e\u73b0\u7cfb\u7edf\u7ea7\u522b\u7684\u8fde\u63a5\u6570\u76d1\u63a7",children:"1\u3001\u5b9e\u73b0\u7cfb\u7edf\u7ea7\u522b\u7684\u8fde\u63a5\u6570\u76d1\u63a7"}),"\n",(0,s.jsx)(r.p,{children:"\u5982\u4f55\u76d1\u63a7 netstat -ant | grep ESTABLISHED | wc -l    #\u67e5\u770b\u8fde\u63a5\u6570"}),"\n",(0,s.jsx)(r.p,{children:"netstat -ntlp #\u83b7\u53d6listen"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-shell",children:"node_netstat_Tcp_CurrEstab\n"})}),"\n",(0,s.jsx)(r.p,{children:"\u89c4\u5219\u6587\u4ef6\uff1a"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{children:'  - alert: "\u6b63\u5e38\u8fde\u63a5\u6570\u8d85\u8fc710000"\r\n    expr: node_netstat_Tcp_CurrEstab{instance!~"172.17.224.50|172.17.224.51"}  > 8000\r\n    for: 3m\r\n    labels: {resType: \'Node\', severity: \'warning\'}\r\n    annotations:\r\n      summary: "\u6b63\u5e38\u8fde\u63a5\u6570\u8d85\u8fc710000[\u9636\u503c\u63d0\u9192]"\r\n      description: "{{$labels.device}}: \u6b63\u5e38\u8fde\u63a5\u6570\u8d85\u8fc710000 (\u5f53\u524d\u7684\u8fde\u63a5\u6570\u662f: {{ $value }})"\r\n      monname: "\u8fdb\u7a0b\u8fde\u63a5\u6570\u76d1\u63a7"\r\n\r\n    #\u4ee5\u4e0b\u8282\u70b9\u4e3a\u8d1f\u8f7d\uff0c\u8fde\u63a5\u6570\u8f83\u591a\u5355\u72ec\u544a\u8b66\r\n  - alert: "\u6b63\u5e38\u8fde\u63a5\u6570\u8d85\u8fc743000"\r\n    expr: node_netstat_Tcp_CurrEstab{instance=~"172.17.224.50|172.17.224.51"} > 43000\r\n    for: 3m\r\n    labels: {resType: \'Node\', severity: \'warning\'}\r\n    annotations:\r\n      summary: "\u6b63\u5e38\u8fde\u63a5\u6570\u8d85\u8fc743000[\u9636\u503c\u63d0\u9192]"\r\n      description: "{{$labels.device}}: \u6b63\u5e38\u8fde\u63a5\u6570\u8d85\u8fc743000 (\u5f53\u524d\u7684\u8fde\u63a5\u6570\u662f: {{ $value }})"\r\n      monname: "\u8fdb\u7a0b\u8fde\u63a5\u6570\u76d1\u63a7"\r\n\n'})}),"\n",(0,s.jsx)(r.h4,{id:"2tomcat\u76d1\u63a7",children:"2\u3001tomcat\u76d1\u63a7"}),"\n",(0,s.jsx)(r.p,{children:"\u914d\u7f6e"}),"\n",(0,s.jsx)(r.p,{children:"\u76d1\u63a7tomcat\u8fde\u63a5\u6570,\u5176\u4ed6\u7ec4\u4ef6\u53ef\u4ee5\u53c2\u8003\u5b98\u65b9\u6587\u6863\u5373\u53ef"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{children:"\u5b98\u65b9\u6587\u6863: https://github.com/prometheus/jmx_exporter/tree/master/example_configs\n"})}),"\n",(0,s.jsx)(r.p,{children:"\u914d\u7f6e\u53c2\u8003\uff1a"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{children:'---   \r\nlowercaseOutputLabelNames: true\r\nlowercaseOutputName: true\r\nrules:\r\n- pattern: \'Catalina<type=GlobalRequestProcessor, name=\\"(\\w+-\\w+)-(\\d+)\\"><>(\\w+):\'\r\n  name: tomcat_$3_total\r\n  labels:\r\n    port: "$2"\r\n    protocol: "$1"\r\n  help: Tomcat global $3\r\n  type: COUNTER\r\n- pattern: \'Catalina<j2eeType=Servlet, WebModule=//([-a-zA-Z0-9+&@#/%?=~_|!:.,;]*[-a-zA-Z0-9+&@#/%=~_|]), name=([-a-zA-Z0-9+/$%~_-|!.]*), J2EEApplication=none, J2EEServer=none><>(requestCount|maxTime|processingTime|errorCount):\'\r\n  name: tomcat_servlet_$3_total\r\n  labels:\r\n    module: "$1"\r\n    servlet: "$2"\r\n  help: Tomcat servlet $3 total\r\n  type: COUNTER\r\n- pattern: \'Catalina<type=ThreadPool, name="(\\w+-\\w+)-(\\d+)"><>(currentThreadCount|currentThreadsBusy|keepAliveCount|pollerThreadCount|connectionCount):\'\r\n  name: tomcat_threadpool_$3\r\n  labels:\r\n    port: "$2"\r\n    protocol: "$1"\r\n  help: Tomcat threadpool $3\r\n  type: GAUGE\r\n- pattern: \'Catalina<type=Manager, host=([-a-zA-Z0-9+&@#/%?=~_|!:.,;]*[-a-zA-Z0-9+&@#/%=~_|]), context=([-a-zA-Z0-9+/$%~_-|!.]*)><>(processingTime|sessionCounter|rejectedSessions|expiredSessions):\'\r\n  name: tomcat_session_$3_total\r\n  labels:\r\n    context: "$2"\r\n    host: "$1"\r\n  help: Tomcat session $3 total\r\n  type: COUNTER\n'})}),"\n",(0,s.jsx)(r.p,{children:"\u6307\u6807\u8bf4\u660e\uff1a"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{children:"tomcat_threadpool_connectioncount    #tomcat\u8fde\u63a5\u6570\n"})}),"\n",(0,s.jsx)(r.p,{children:"\u89c4\u5219\u6587\u4ef6"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-shell",children:'\r\n  - alert: "jvm\u5806\u5185\u5b58\u8d85\u8fc785%"\r\n    expr: jvm_memory_bytes_used{area="heap",job="jvm_tomcat_monitor"} / jvm_memory_bytes_max{area="heap",job="jvm_tomcat_monitor"} * 100 >  85\r\n    for: 30s\r\n    labels: {resType: \'Node\', severity: \'warning\'}\r\n    annotations:\r\n      summary: "jvm\u5806\u5185\u5b58\u4f7f\u7528\u7387"\r\n      description: "{{$labels.instance}}: \u5185\u5b58\u4f7f\u7528\u7387\u8d85\u8fc785% (\u5f53\u524d\u7684\u4f7f\u7528\u7387\u662f: {{ $value }}"\r\n      hostname: "{{$labels.job}}"\r\n                \r\n  - alert: "tomcat\u8fde\u63a5\u6570\u8d85\u8fc7400"\r\n    expr: tomcat_threadpool_connectioncount > 400\r\n    for: 30s\r\n    labels: {resType: \'Node\', severity: \'warning\'}\r\n    annotations:\r\n      summary: "tomcat\u8fde\u63a5\u6570\u76d1\u63a7"\r\n      description: "{{$labels.instance}}: tomcat\u8fde\u63a5\u6570\u8d85\u8fc7400  (\u5f53\u524d\u8fde\u63a5\u6570\u662f: {{ $value }}"\r\n      hostname: "{{$labels.job}}"\n'})}),"\n",(0,s.jsx)(r.h2,{id:"14\u6309\u7167\u7b49\u7ea7\u8fdb\u884c\u544a\u8b66",children:"14\u3001\u6309\u7167\u7b49\u7ea7\u8fdb\u884c\u544a\u8b66"}),"\n",(0,s.jsx)(r.p,{children:"\u5728rules.yml\u6587\u4ef6\u4e2d\uff0cseverity\u76f4\u63a5\u5199\u5728labels\u4e2d\uff0c\u6709\u4e09\u79cd\u7b49\u7ea7\uff0c\u5206\u522b\u4e3awarning\u3001critical\u548cemergency\u3002\u4e25\u91cd\u7b49\u7ea7\u4f9d\u6b21\u9012\u589e\u3002\u5982\u679c\u540c\u4e00\u4e2arule\u89c4\u5219\u544a\u8b66\uff0c\u6ee1\u8db3\u591a\u4e2a\u7b49\u7ea7\u7684\u65f6\u5019\uff0c\u544a\u8b66\u7684\u65f6\u5019\u6309\u7167\u767b\u8bb0\u6700\u9ad8\u7684\u544a\u8b66"}),"\n",(0,s.jsx)(r.p,{children:"\u5982\uff1a\u7f51\u5361\u544a\u8b66\u5728rule\u4e2d\u5b9a\u4e49"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-shell",children:'    ###\u7f51\u5361\u5165\u53e3\u6d41\u91cf\r\n  - alert: "\u8282\u70b9\u7f51\u5361\u5165\u6d41\u91cf\u8d85\u8fc725M"\r\n    expr: round((irate(node_network_receive_bytes_total{device!="lo",instance!="172.17.113.105",instance!="172.17.224.119"}[1m]) / 1048576  ),0.001) > 25\r\n    for: 30s\r\n    labels: {resType: \'Node\', severity: \'warning\'}\r\n    annotations:\r\n      summary: "\u660e\u7ec6\u7f51\u5361\u5165\u53e3\u6d41\u91cf\u8d85\u8fc725M"\r\n      description: "{{$labels.device}}: \u7f51\u5361\u5165\u53e3\u6d41\u91cf\u8d85\u8fc725M\uff0c\u660e\u7ec6\u6d41\u91cf\u53ef\u4ee5\u6839\u636e\u60c5\u51b5\u5ffd\u7565 !!!(\u5f53\u524d1\u5206\u949f\u7684\u4f7f\u7528\u7387\u662f: {{ $value }}M)"\r\n      hostname: "{{$labels.job}}"\r\n\r\n\r\n  - alert: "\u8282\u70b9\u7f51\u5361\u5165\u6d41\u91cf\u8d85\u8fc750M"\r\n    expr: round((irate(node_network_receive_bytes_total{device!="lo",instance!="172.17.113.105",instance!="172.17.224.119"}[1m]) / 1048576  ),0.001) > 50\r\n    for: 30s\r\n    labels: {resType: \'Node\', severity: \'critical\'}\r\n    annotations:\r\n      summary: "\u7f51\u5361\u5165\u53e3\u6d41\u91cf\u8d85\u8fc750M"\r\n      description: "{{$labels.device}}: \u7f51\u5361\u5165\u53e3\u6d41\u91cf\u8d85\u8fc750M,\u7b49\u7ea7-\u4e25\u91cd,\u8bf7\u524d\u5f80\u670d\u52a1\u5668\u67e5\u770b !!!(\u5f53\u524d1\u5206\u949f\u7684\u4f7f\u7528\u7387\u662f: {{ $value }}M)"\r\n      hostname: "{{$labels.job}}"\r\n\n'})}),"\n",(0,s.jsx)(r.p,{children:"\u5728alertmanager\u4e2d\u914d\u7f6e"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-yaml",children:"inhibit_rules:\r\n  - source_match:\r\n      severity: 'critical'\r\n    target_match:\r\n      severity: 'warning'\r\n    equal: ['instance']\n"})}),"\n",(0,s.jsx)(r.p,{children:"\u4ee5\u4e0a\u544a\u8b66\u6ee1\u8db3equal\u540c\u4e00\u8282\u70b9\uff0c\u6ce8\u610f\uff0cequal\u5982\u679c\u6709\u591a\u4e2a\uff0c\u5fc5\u987b\u540c\u65f6\u6ee1\u8db3\uff1b \u4f1a\u6291\u5236\u544a\u8b66\uff0c\u53ea\u4f1a\u544a\u8b66critical\u3002"}),"\n",(0,s.jsx)(r.h2,{id:"15windows_exporter\u76d1\u63a7",children:"15\u3001windows_exporter\u76d1\u63a7"}),"\n",(0,s.jsx)(r.p,{children:"\u5b98\u65b9\u5730\u5740:"}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.a,{href:"https://github.com/prometheus-community/windows_exporter",children:"https://github.com/prometheus-community/windows_exporter"})}),"\n",(0,s.jsx)(r.p,{children:"\u4e0b\u8f7d\u5b98\u65b9msi\u6587\u4ef6"}),"\n",(0,s.jsx)(r.p,{children:"prometheus\u914d\u7f6ewindows_exporter"}),"\n",(0,s.jsx)(r.p,{children:"\u5728c\u76d8\u521b\u5efa  C:\\windows_exporter \u76ee\u5f55"}),"\n",(0,s.jsx)(r.p,{children:"\u8bbf\u95ee\u6587\u4ef6  windows_exporter-0.18.0-386.msi"}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/operator/image-20230220120000395.png",alt:"image-20230220120000395"})}),"\n",(0,s.jsx)(r.p,{children:"\u5b89\u88c5: \u7cbe\u7b80\u7248 - \u4e0d\u652f\u6301\u7edf\u8ba1\u8fdb\u7a0b-\u76ee\u524d\u751f\u4ea7\u5728\u7528"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-shell",children:"C:\\Users\\Administrator>msiexec /i C:\\windows_exporter\\windows_exporter-0.18.0-386.msi ENABLED_COLLECTORS=ad,memory,os,cs,cpu,logical_disk  LISTEN_PORT=9100\n"})}),"\n",(0,s.jsx)(r.p,{children:"\u6807\u51c6\u76d1\u63a7\u6307\u6807"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-shell",children:"msiexec /i C:\\windows_exporter\\windows_exporter-0.18.0-386.msi ENABLED_COLLECTORS=ad,iis,logon,memory,process,os,cs,cpu,logical_disk  LISTEN_PORT=9100\n"})}),"\n",(0,s.jsx)(r.p,{children:"\u5b89\u88dd\u5b8c\u4e4b\u540e\u53ef\u4ee5\u9a8c\u8bc1"}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/operator/image-20230220120244275.png",alt:"image-20230220120244275"})}),"\n",(0,s.jsx)(r.p,{children:"\u5177\u4f53\u5b89\u88c5\u6587\u6863\u53ef\u4ee5\u53c2\u8003\u5b98\u65b9:"}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.a,{href:"https://github.com/prometheus-community/windows_exporter?spm=a2c4g.11186623.0.0.84e8490bysmVRG#using-a-configuration-file",children:"https://github.com/prometheus-community/windows_exporter?spm=a2c4g.11186623.0.0.84e8490bysmVRG#using-a-configuration-file"})}),"\n",(0,s.jsxs)(r.p,{children:["\u8bbf\u95ee: ",(0,s.jsx)(r.a,{href:"http://x.x.x.x:9100/metrics",children:"http://x.x.x.x:9100/metrics"})]}),"\n",(0,s.jsx)(r.p,{children:"\u9ed8\u8ba4\u7aef\u53e3  9182"}),"\n",(0,s.jsx)(r.p,{children:"CPU\u9ad8\u8d1f\u8377"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-shell",children:'100 - (avg by (instance,job) (irate(windows_cpu_time_total{mode="idle"}[2m])) * 100) > 30\n'})}),"\n",(0,s.jsx)(r.p,{children:"\u5185\u5b58\u4f7f\u7528\u7387\u8fc7\u9ad8"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{children:"100 - 100 * windows_os_physical_memory_free_bytes / windows_cs_physical_memory_bytes > 90\n"})}),"\n",(0,s.jsx)(r.p,{children:"\u5185\u5b58\u5229\u7528\u7387"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{children:"100 - 100 * windows_os_physical_memory_free_bytes / windows_cs_physical_memory_bytes\n"})}),"\n",(0,s.jsx)(r.p,{children:"\u786c\u76d8\u4f7f\u7528\u7387"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{children:"100- 100 * (windows_logical_disk_free_bytes / windows_logical_disk_size_bytes)\n"})}),"\n",(0,s.jsx)(r.p,{children:"\u7f51\u5361sent\u901f\u7387"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{children:"((sum(rate (windows_net_bytes_sent_total{device!~'tap.*|veth.*|br.*|docker.*|virbr*|lo*'}[5m])) by (instance,job)) / 100)\r\n\n"})}),"\n",(0,s.jsx)(r.p,{children:"\u7f51\u5361received\u901f\u7387"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{children:"((sum(rate (windows_net_bytes_received_total{device!~'tap.*|veth.*|br.*|docker.*|virbr*|lo*'}[5m])) by (instance,job)) / 100)\n"})}),"\n",(0,s.jsx)(r.p,{children:"\u76f8\u5173\u6307\u6807\u76d1\u63a7\u94fe\u63a5:"}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.a,{href:"https://www.modb.pro/db/569736",children:"https://www.modb.pro/db/569736"})}),"\n",(0,s.jsx)(r.p,{children:"16\u3001\u751f\u4ea7\u5de1\u68c0\u7edf\u8ba1"}),"\n",(0,s.jsx)(r.p,{children:"\u901a\u8fc7api\u7edf\u8ba1\u6240\u6709\u4e3b\u673a\u7684IP \uff0c\u5982\u679c\u53ea\u60f3\u663e\u793a\u4e00\u5217hostname,\u6216\u8005Ip,\u9700\u8981\u505a\u6c47\u805a"}),"\n",(0,s.jsx)(r.p,{children:"\u901a\u8fc7post\u65b9\u5f0f\u6765\u5b9e\u73b0\u83b7\u53d6\u6240\u6709\u7684\u4e3b\u673a\u540d"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-shell",children:"curl  -sd 'query=sum(node_uname_info) by(hostname)' -d \"time=1674973283\"  -d \"end=1674973283\" -d 'step=15s' -X  POST  http://39.105.15.20:9090/api/v1/query?  |jq -r '.data.result' | jq .[].metric.hostname\n"})}),"\n",(0,s.jsx)(r.p,{children:"\u83b7\u53d6\u6240\u6709\u7684ip"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-powershell",children:"curl  -sd 'query=sum(node_uname_info) by(instance)' -d \"time=1674973283\"  -d \"end=1674973283\" -d 'step=15s' -X  POST  http://39.105.15.20:9090/api/v1/query?  |jq -r '.data.result' | jq .[].metric.instance\n"})}),"\n",(0,s.jsx)(r.h2,{id:"\u76f8\u5173\u94fe\u63a5",children:"\u76f8\u5173\u94fe\u63a5"}),"\n",(0,s.jsxs)(r.p,{children:["jq\u53c2\u8003\u94fe\u63a5:",(0,s.jsx)(r.a,{href:"https://www.cnblogs.com/liwenchao1995/p/16284648.html",children:"https://www.cnblogs.com/liwenchao1995/p/16284648.html"})]}),"\n",(0,s.jsx)(r.p,{children:"prometheus rule\u76f8\u5173\u53c2\u8003\u6587\u6863\uff1a**"}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.a,{href:"https://segmentfault.com/a/1190000023533570",children:"https://segmentfault.com/a/1190000023533570"})}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"docker-compose\u53c2\u8003\u6587\u6863\uff1a"})}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.a,{href:"https://blog.51cto.com/hongchen99/2308932",children:"https://blog.51cto.com/hongchen99/2308932"})}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.a,{href:"https://www.cnblogs.com/namedgx/p/14919857.html",children:"https://www.cnblogs.com/namedgx/p/14919857.html"})}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.a,{href:"https://blog.51cto.com/hongchen99/2308932",children:"https://blog.51cto.com/hongchen99/2308932"})}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.a,{href:"https://prometheus.io/docs/instrumenting/writing_clientlibs/",children:"https://prometheus.io/docs/instrumenting/writing_clientlibs/"})}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"blackbox Exporter\u53c2\u8003\u6587\u6863"})}),"\n",(0,s.jsx)(r.p,{children:"\u200b    #\u5b98\u65b9\u6587\u6863"}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.a,{href:"https://prometheus.io/docs/guides/multi-target-exporter/",children:"https://prometheus.io/docs/guides/multi-target-exporter/"})}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.a,{href:"https://github.com/prometheus/blackbox_exporter/blob/master/example.yml",children:"https://github.com/prometheus/blackbox_exporter/blob/master/example.yml"})}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.a,{href:"https://github.com/prometheus/blackbox_exporter/blob/master/CONFIGURATION.md",children:"https://github.com/prometheus/blackbox_exporter/blob/master/CONFIGURATION.md"})}),"\n",(0,s.jsx)(r.p,{children:"\u200b     #\u76f8\u5173\u6307\u6807\u7684\u89e3\u91ca"}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.a,{href:"http://itocm.com/a/FE5EB54826E3475C97E77A671E2AF533",children:"http://itocm.com/a/FE5EB54826E3475C97E77A671E2AF533"})}),"\n",(0,s.jsx)(r.p,{children:"\u200b     #\u914d\u7f6e\u6848\u4f8b"}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.a,{href:"https://yunlzheng.gitbook.io/prometheus-book/part-ii-prometheus-jin-jie/exporter/commonly-eporter-usage/install_blackbox_exporter",children:"https://yunlzheng.gitbook.io/prometheus-book/part-ii-prometheus-jin-jie/exporter/commonly-eporter-usage/install_blackbox_exporter"})}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.a,{href:"https://yunlzheng.gitbook.io/prometheus-book/part-ii-prometheus-jin-jie/exporter/commonly-eporter-usage/install_blackbox_exporter",children:"https://yunlzheng.gitbook.io/prometheus-book/part-ii-prometheus-jin-jie/exporter/commonly-eporter-usage/install_blackbox_exporter"})}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.a,{href:"https://www.cnblogs.com/abner123/p/13226239.html",children:"https://www.cnblogs.com/abner123/p/13226239.html"})}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"alertmanager\u53c2\u8003\u6587\u6863"})}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.a,{href:"https://www.ibm.com/docs/en/netcoolomnibus/8?topic=monitoring-configuring-prometheus-in-kubernetes-from-command-line",children:"https://www.ibm.com/docs/en/netcoolomnibus/8?topic=monitoring-configuring-prometheus-in-kubernetes-from-command-line"})}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"dingtalk\u53c2\u8003"})}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.a,{href:"https://www.cnblogs.com/Atonement/p/14688870.html",children:"https://www.cnblogs.com/Atonement/p/14688870.html"})}),"\n",(0,s.jsx)(r.p,{children:"promehteus\u5b58\u50a8\u76f8\u5173"}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.a,{href:"https://prometheus.io/docs/prometheus/latest/storage/",children:"https://prometheus.io/docs/prometheus/latest/storage/"})})]})}function d(e={}){const{wrapper:r}={...(0,t.R)(),...e.components};return r?(0,s.jsx)(r,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},8453:(e,r,n)=>{n.d(r,{R:()=>l,x:()=>i});var s=n(6540);const t={},o=s.createContext(t);function l(e){const r=s.useContext(o);return s.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function i(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),s.createElement(o.Provider,{value:r},e.children)}}}]);