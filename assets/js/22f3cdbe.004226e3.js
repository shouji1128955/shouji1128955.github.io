"use strict";(self.webpackChunkbookshell=self.webpackChunkbookshell||[]).push([[7540],{1213:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>o,contentTitle:()=>i,default:()=>h,frontMatter:()=>l,metadata:()=>d,toc:()=>a});var t=r(4848),s=r(8453);const l={},i="Gin\u6846\u67b6\u5165\u95e8\u5230\u7cbe\u901a",d={id:"Golang/golang\u8fdb\u9636/gin\u6846\u67b62023/Gin\u6846\u67b6",title:"Gin\u6846\u67b6",description:"\u9884\u5907\u77e5\u8bc6\u70b9",source:"@site/docs/Golang/golang\u8fdb\u9636/1.gin\u6846\u67b62023/Gin\u6846\u67b6.md",sourceDirName:"Golang/golang\u8fdb\u9636/1.gin\u6846\u67b62023",slug:"/Golang/golang\u8fdb\u9636/gin\u6846\u67b62023/Gin\u6846\u67b6",permalink:"/docs/Golang/golang\u8fdb\u9636/gin\u6846\u67b62023/Gin\u6846\u67b6",draft:!1,unlisted:!1,editUrl:"https://github.com/shouji1128955/bookshell/edit/main/docs/Golang/golang\u8fdb\u9636/1.gin\u6846\u67b62023/Gin\u6846\u67b6.md",tags:[],version:"current",lastUpdatedBy:"zhanglaiqiang",lastUpdatedAt:1729357765e3,frontMatter:{},sidebar:"GoalngJinjie",next:{title:"Mysql",permalink:"/docs/Golang/golang\u8fdb\u9636/mysql\u6570\u636e\u5e93/Mysql\u57fa\u7840"}},o={},a=[{value:"1.1\u3001web\u5e94\u7528\u7a0b\u5e8f",id:"11web\u5e94\u7528\u7a0b\u5e8f",level:2},{value:"1.2\u3001http\u534f\u8bae",id:"12http\u534f\u8bae",level:2},{value:"\uff081\uff09\u7b80\u4ecb",id:"1\u7b80\u4ecb",level:4},{value:"\uff082\uff09http\u534f\u8bae\u7279\u6027",id:"2http\u534f\u8bae\u7279\u6027",level:4},{value:"\uff083\uff09http\u8bf7\u6c42\u534f\u8bae\u4e0e\u54cd\u5e94\u534f\u8bae",id:"3http\u8bf7\u6c42\u534f\u8bae\u4e0e\u54cd\u5e94\u534f\u8bae",level:4},{value:"1.3\u3001quick start",id:"13quick-start",level:2},{value:"1.3.1\u3001\u5b89\u88c5",id:"131\u5b89\u88c5",level:3},{value:"1.3.2\u3001quick start",id:"132quick-start",level:3},{value:"1.3.3\u3001mvc",id:"133mvc",level:3},{value:"1.3.3\u3001timer\u6848\u4f8b",id:"133timer\u6848\u4f8b",level:3},{value:"1.3.4\u3001\u767b\u9646\u6848\u4f8b",id:"134\u767b\u9646\u6848\u4f8b",level:3},{value:"2.1\u3001\u8def\u7531\u65b9\u6cd5",id:"21\u8def\u7531\u65b9\u6cd5",level:2},{value:"2.2\u3001\u8def\u7531\u5206\u7ec4",id:"22\u8def\u7531\u5206\u7ec4",level:2},{value:"3.1\u3001\u8bf7\u6c42\u6570\u636e",id:"31\u8bf7\u6c42\u6570\u636e",level:2},{value:"\uff081\uff09\u83b7\u53d6\u57fa\u672c\u8bf7\u6c42\u6570\u636e",id:"1\u83b7\u53d6\u57fa\u672c\u8bf7\u6c42\u6570\u636e",level:3},{value:"\uff082\uff09\u83b7\u53d6\u8def\u5f84\u53c2\u6570",id:"2\u83b7\u53d6\u8def\u5f84\u53c2\u6570",level:3},{value:"\uff083\uff09\u83b7\u53d6\u67e5\u8be2\u53c2\u6570",id:"3\u83b7\u53d6\u67e5\u8be2\u53c2\u6570",level:3},{value:"\uff084\uff09\u83b7\u53d6PostForm\u6570\u636e",id:"4\u83b7\u53d6postform\u6570\u636e",level:3},{value:"\uff085\uff09ShouldBind\u51fd\u6570",id:"5shouldbind\u51fd\u6570",level:3},{value:"3.2\u3001\u54cd\u5e94\u6570\u636e",id:"32\u54cd\u5e94\u6570\u636e",level:2},{value:"3.2.1\u3001\u54cd\u5e94\u4e0d\u540c\u7684\u6570\u636e\u683c\u5f0f",id:"321\u54cd\u5e94\u4e0d\u540c\u7684\u6570\u636e\u683c\u5f0f",level:3},{value:"\uff081\uff09\u54cd\u5e94\u7b80\u5355\u5b57\u7b26\u4e32",id:"1\u54cd\u5e94\u7b80\u5355\u5b57\u7b26\u4e32",level:4},{value:"\uff082\uff09\u54cd\u5e94html\u9875\u9762",id:"2\u54cd\u5e94html\u9875\u9762",level:4},{value:"\uff083\uff09\u54cd\u5e94json",id:"3\u54cd\u5e94json",level:4},{value:"\uff084\uff09\u54cd\u5e94xml\u6570\u636e",id:"4\u54cd\u5e94xml\u6570\u636e",level:4},{value:"\uff085\uff09\u54cd\u5e94protobuf\u683c\u5f0f",id:"5\u54cd\u5e94protobuf\u683c\u5f0f",level:4},{value:"3.2.2\u3001\u9759\u6001\u6587\u4ef6",id:"322\u9759\u6001\u6587\u4ef6",level:3},{value:"3.2.3\u3001\u91cd\u5b9a\u5411",id:"323\u91cd\u5b9a\u5411",level:3},{value:"3.2.4\u3001\u5f02\u6b65\u54cd\u5e94",id:"324\u5f02\u6b65\u54cd\u5e94",level:3},{value:"4.1 \u3001\u53d8\u91cf\u6e32\u67d3",id:"41-\u53d8\u91cf\u6e32\u67d3",level:2},{value:"4.2 \u3001\u63a7\u5236\u7ed3\u6784",id:"42-\u63a7\u5236\u7ed3\u6784",level:2},{value:"\uff081\uff09\u5206\u652f\u7ed3\u6784",id:"1\u5206\u652f\u7ed3\u6784",level:4},{value:"\uff082\uff09\u5faa\u73af\u7ed3\u6784",id:"2\u5faa\u73af\u7ed3\u6784",level:4},{value:"\uff083\uff09\u53d8\u91cf\u8d4b\u503c",id:"3\u53d8\u91cf\u8d4b\u503c",level:4},{value:"\uff084\uff09\u6ce8\u91ca",id:"4\u6ce8\u91ca",level:4},{value:"4.3\u3001Gin\u7684\u6a21\u677f\u51fd\u6570",id:"43gin\u7684\u6a21\u677f\u51fd\u6570",level:2},{value:"\uff081\uff09\u9ed8\u8ba4\u6a21\u677f\u51fd\u6570",id:"1\u9ed8\u8ba4\u6a21\u677f\u51fd\u6570",level:4},{value:"\uff082\uff09\u81ea\u5b9a\u4e49\u6a21\u677f\u51fd\u6570",id:"2\u81ea\u5b9a\u4e49\u6a21\u677f\u51fd\u6570",level:4},{value:"4.4\u3001\u5d4c\u5957\u4e0e\u7ee7\u627f",id:"44\u5d4c\u5957\u4e0e\u7ee7\u627f",level:2},{value:"\uff081\uff09 \u5d4c\u5957\uff1adefine\u548ctemplate",id:"1-\u5d4c\u5957define\u548ctemplate",level:4},{value:"\uff082\uff09\u7ee7\u627f\uff1ablock\u5757",id:"2\u7ee7\u627fblock\u5757",level:4},{value:"\uff083\uff09\u7ee7\u627f\u6848\u4f8b",id:"3\u7ee7\u627f\u6848\u4f8b",level:4},{value:"5.1\u3001gorm\u4ecb\u7ecd",id:"51gorm\u4ecb\u7ecd",level:2},{value:"5.2\u3001\u8fde\u63a5\u6570\u636e\u5e93",id:"52\u8fde\u63a5\u6570\u636e\u5e93",level:2},{value:"5.2.1\u3001\u8fde\u63a5\u6570\u636e\u5e93",id:"521\u8fde\u63a5\u6570\u636e\u5e93",level:3},{value:"5.2.2\u3001\u914d\u7f6e\u65e5\u5fd7\u8fde\u63a5",id:"522\u914d\u7f6e\u65e5\u5fd7\u8fde\u63a5",level:3},{value:"5.2.3\u3001\u6570\u636e\u5e93\u8fde\u63a5\u6c60",id:"523\u6570\u636e\u5e93\u8fde\u63a5\u6c60",level:3},{value:"5.3\u3001\u6570\u636e\u5e93\u8868\u64cd\u4f5c",id:"53\u6570\u636e\u5e93\u8868\u64cd\u4f5c",level:2},{value:"5.3.1\u3001\u6a21\u578b\u58f0\u660e",id:"531\u6a21\u578b\u58f0\u660e",level:3},{value:"5.3.2\u3001\u6a21\u578b\u8fc1\u79fb",id:"532\u6a21\u578b\u8fc1\u79fb",level:3},{value:"5.3.3\u3001\u8868\u5b57\u6bb5\u64cd\u4f5c",id:"533\u8868\u5b57\u6bb5\u64cd\u4f5c",level:3},{value:"5.4\u3001\u6570\u636e\u5e93\u8868\u8bb0\u5f55\u64cd\u4f5c",id:"54\u6570\u636e\u5e93\u8868\u8bb0\u5f55\u64cd\u4f5c",level:2},{value:"5.4.1\u3001\u6dfb\u52a0\u8bb0\u5f55",id:"541\u6dfb\u52a0\u8bb0\u5f55",level:3},{value:"\uff081\uff09\u6dfb\u52a0\u5355\u8868\u8bb0\u5f55",id:"1\u6dfb\u52a0\u5355\u8868\u8bb0\u5f55",level:4},{value:"\uff082\uff09\u6279\u91cf\u6dfb\u52a0\u591a\u5bf9\u4e00\u5173\u8054\u8868\u7684\u8bb0\u5f55",id:"2\u6279\u91cf\u6dfb\u52a0\u591a\u5bf9\u4e00\u5173\u8054\u8868\u7684\u8bb0\u5f55",level:4},{value:"\uff083\uff09\u6dfb\u52a0\u591a\u5bf9\u591a\u5173\u8054\u8868\u7684\u8bb0\u5f55",id:"3\u6dfb\u52a0\u591a\u5bf9\u591a\u5173\u8054\u8868\u7684\u8bb0\u5f55",level:4},{value:"5.4.2\u3001\u5355\u8868\u67e5\u8be2",id:"542\u5355\u8868\u67e5\u8be2",level:3},{value:"\uff081\uff09 \u67e5\u8be2\u5168\u90e8\u8bb0\u5f55",id:"1-\u67e5\u8be2\u5168\u90e8\u8bb0\u5f55",level:4},{value:"\uff082\uff09\u67e5\u8be2\u5355\u6761\u8bb0\u5f55",id:"2\u67e5\u8be2\u5355\u6761\u8bb0\u5f55",level:4},{value:"\uff083\uff09 Where\u67e5\u8be2",id:"3-where\u67e5\u8be2",level:4},{value:"\uff084\uff09\u5176\u4ed6\u67e5\u8be2\u8bed\u53e5",id:"4\u5176\u4ed6\u67e5\u8be2\u8bed\u53e5",level:4},{value:"5.4.3\u3001\u5220\u9664\u8bb0\u5f55",id:"543\u5220\u9664\u8bb0\u5f55",level:3},{value:"5.4.4\u3001\u66f4\u65b0\u8bb0\u5f55",id:"544\u66f4\u65b0\u8bb0\u5f55",level:3},{value:"5.4.5\u3001\u5173\u8054\u8868\u67e5\u8be2",id:"545\u5173\u8054\u8868\u67e5\u8be2",level:3},{value:"\uff081\uff09Preload",id:"1preload",level:4},{value:"\uff082\uff09Joins \u67e5\u8be2",id:"2joins-\u67e5\u8be2",level:4},{value:"5.5\u3001\u7ae0\u8282\u4f5c\u4e1a",id:"55\u7ae0\u8282\u4f5c\u4e1a",level:2},{value:"7.1\u3001\u4f1a\u8bdd\u6280\u672f",id:"71\u4f1a\u8bdd\u6280\u672f",level:2},{value:"7.1.1\u3001Cookie",id:"711cookie",level:3},{value:"<strong>1.</strong> Cookie\u662f\u4ec0\u4e48",id:"1-cookie\u662f\u4ec0\u4e48",level:4},{value:"<strong>2.</strong> \u8bfb\u5199Cookie",id:"2-\u8bfb\u5199cookie",level:4},{value:"\uff081\uff09\u767b\u5f55\u6848\u4f8b",id:"1\u767b\u5f55\u6848\u4f8b",level:4},{value:"\uff082\uff09\u6700\u540e\u8bbf\u95ee\u65f6\u95f4\u6848\u4f8b",id:"2\u6700\u540e\u8bbf\u95ee\u65f6\u95f4\u6848\u4f8b",level:4},{value:"7.1.2\u3001session",id:"712session",level:3},{value:"7.1.3\u3001\u57fa\u4e8esession\u7684\u767b\u5f55\u9a8c\u8bc1",id:"713\u57fa\u4e8esession\u7684\u767b\u5f55\u9a8c\u8bc1",level:3},{value:"7.2\u3001\u4e2d\u95f4\u4ef6",id:"72\u4e2d\u95f4\u4ef6",level:2},{value:"7.2.1\u3001\u4e2d\u95f4\u4ef6\u8bed\u6cd5",id:"721\u4e2d\u95f4\u4ef6\u8bed\u6cd5",level:3},{value:"7.2.2\u3001\u4e2d\u95f4\u4ef6\u5e94\u7528\u4e00\uff1aCORS",id:"722\u4e2d\u95f4\u4ef6\u5e94\u7528\u4e00cors",level:3},{value:"7.2.3\u3001\u4e2d\u95f4\u4ef6\u5e94\u7528\u4e8c\uff1a\u6743\u9650\u8bbf\u95ee\u63a7\u5236",id:"723\u4e2d\u95f4\u4ef6\u5e94\u7528\u4e8c\u6743\u9650\u8bbf\u95ee\u63a7\u5236",level:3},{value:"7.3\u3001validator",id:"73validator",level:2},{value:"\u5b89\u88c5",id:"\u5b89\u88c5",level:3},{value:"\u57fa\u672c\u4f7f\u7528",id:"\u57fa\u672c\u4f7f\u7528",level:3},{value:"\u81ea\u5b9a\u4e49\u9a8c\u8bc1\u5668",id:"\u81ea\u5b9a\u4e49\u9a8c\u8bc1\u5668",level:3},{value:"\u8de8\u5b57\u6bb5\u9a8c\u8bc1",id:"\u8de8\u5b57\u6bb5\u9a8c\u8bc1",level:3},{value:"\u7ed3\u8bba",id:"\u7ed3\u8bba",level:3},{value:"7.4 \u3001Ajax\u65b9\u6cd5",id:"74-ajax\u65b9\u6cd5",level:2},{value:"Ajax\u4ecb\u7ecd",id:"ajax\u4ecb\u7ecd",level:3},{value:"axios\u6a21\u5757",id:"axios\u6a21\u5757",level:3},{value:"\u5e94\u7528\u6848\u4f8b",id:"\u5e94\u7528\u6848\u4f8b",level:3},{value:"8.1\u3001web\u5e94\u7528\u6a21\u5f0f",id:"81web\u5e94\u7528\u6a21\u5f0f",level:2},{value:"8.2\u3001restful api\u89c4\u8303",id:"82restful-api\u89c4\u8303",level:2}];function c(n){const e={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-handlebars",children:"-- \u4eca\u5929\u662f2025\u5e741\u67081\u65e5\r\n\r\n-- \u8bfe\u7a0b\u76ee\u6807\uff1a\u901a\u8fc7gin\u6846\u67b6\u7684\u5b66\u4e60\u5b9e\u73b0\u4e00\u4e2a\u5b66\u751f\u9009\u8bfe\u7cfb\u7edf\u7684\u5b9e\u6218\u9879\u76ee\r\n-- 1. \u5b66\u4e60gin\u7684\u8def\u7531\uff0c\u8bf7\u6c42\u4e0e\u54cd\u5e94\uff0c\u6a21\u677f\u4ee5\u53ca\u6700\u91cd\u8981\u7684gorm\u5b8c\u6210\u9009\u8bfe\u7cfb\u7edf\u7684\u5173\u4e8e\u73ed\u7ea7\uff0c\u8bfe\u7a0b\u4ee5\u53ca\u5b66\u5458\u7684\u57fa\u672c\u589e\u5220\u6539\u67e5\r\n-- 2. \u901a\u8fc7gorm\u7684\u8fdb\u9636\u5b66\u4e60\u3010\u5168\u7ad9\u6700\u597d\u7684gorm\u8bfe\u7a0b\u3011,\u5b8c\u6210\u4e86\u50cf\u641c\u7d22\u6846\u4ee5\u53ca\u9009\u8bfe\u7b49\u6570\u636e\u5e93\u67e5\u8be2\r\n-- 3. \u5b66\u4e60cookie\uff0csession\u4f1a\u8bdd\u6280\u672f\u5b9e\u73b0\u9879\u76ee\u7684\u767b\u5f55\u9a8c\u8bc1\r\n-- 4. \u901a\u8fc7\u4e2d\u95f4\u4ef6\u7684\u5b66\u4e60\u5b9e\u73b0\u57fa\u4e8erbac\u7684\u6743\u9650\u8bbf\u95ee\u63a7\u5236\r\n\r\n-- \u5373\u4e00\u8fb9\u5b66\u8bfe\u7a0b\uff0c\u4e00\u8fb9\u5199\u9879\u76ee\uff0c\u8bfe\u7a0b\u7ed3\u675f\uff0cgolang\u5f00\u53d1\u4fbf\u662f\u5c0f\u83dc\u4e00\u789f\n"})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"\u9884\u5907\u77e5\u8bc6\u70b9"})}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.strong,{children:"Golang\u57fa\u7840\uff08\u6570\u636e\u7c7b\u578b\uff0c\u6d41\u7a0b\u63a7\u5236\u8bed\u53e5\uff0c\u51fd\u6570\uff0c\u7ed3\u6784\u4f53\u7b49\uff09"})}),"\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.strong,{children:"Mysql\u7684\u57fa\u672csql\u8bed\u53e5"})}),"\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.strong,{children:"HTML + CSS"})}),"\n"]}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"\u4ec0\u4e48\u662f\u6846\u67b6\uff0c\u7c7b\u4f3c\u5199\u4f5c\u6587\u7684\u6a21\u677f\u4e00\u6837\uff0c\u6bd4\u5982\u5165\u515a\u7533\u8bf7\u4e66...."})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/golang/assets/gin%E5%92%8Cgo-0245512-0245514.png",alt:""})}),"\n",(0,t.jsx)(e.header,{children:(0,t.jsx)(e.h1,{id:"gin\u6846\u67b6\u5165\u95e8\u5230\u7cbe\u901a",children:"Gin\u6846\u67b6\u5165\u95e8\u5230\u7cbe\u901a"})}),"\n",(0,t.jsx)(e.h1,{id:"\u4e00gin\u5f00\u7bc7",children:"\u4e00\u3001Gin\u5f00\u7bc7"}),"\n",(0,t.jsx)(e.h2,{id:"11web\u5e94\u7528\u7a0b\u5e8f",children:"1.1\u3001web\u5e94\u7528\u7a0b\u5e8f"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/golang/assets/image-20220901214542004.png",alt:"image-20220901214542004"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:'package main\r\n\r\nimport (\r\n\t"fmt"\r\n\t"net"\r\n)\r\n\r\nfunc main() {\r\n\r\n\tlistener, err := net.Listen("tcp", "127.0.0.1:8888")\r\n\tif err != nil {\r\n\t\tfmt.Println(err)\r\n\t\treturn\r\n\t}\r\n\tdefer listener.Close()\r\n\t// 2.\u670d\u52a1\u7aef\u4e0d\u65ad\u7b49\u5f85\u8bf7\u6c42\u5904\u7406\r\n\tfor {\r\n\t\t// \u963b\u585e\u7b49\u5f85\u5ba2\u6237\u7aef\u8fde\u63a5\r\n\t\tfmt.Println("server is waiting...")\r\n\t\tconn, err := listener.Accept()\r\n\t\tif err != nil {\r\n\t\t\tfmt.Println(err)\r\n\t\t\tcontinue\r\n\t\t}\r\n\t\tdata := make([]byte, 1024)\r\n\t\tn, err := conn.Read(data)\r\n\t\tfmt.Println("receive data:\\n", string(data[:n]))\r\n\t\tconn.Write([]byte("HTTP/1.1 200 OK\\r\\n\\r\\n<h1>Welcome to Web World!</h1>"))\r\n\t\tconn.Close()\r\n\t}\r\n\r\n}\n'})}),"\n",(0,t.jsx)(e.h2,{id:"12http\u534f\u8bae",children:"1.2\u3001http\u534f\u8bae"}),"\n",(0,t.jsx)(e.h4,{id:"1\u7b80\u4ecb",children:"\uff081\uff09\u7b80\u4ecb"}),"\n",(0,t.jsxs)(e.p,{children:["HTTP\u534f\u8bae\u662fHyper Text Transfer Protocol\uff08\u8d85\u6587\u672c\u4f20\u8f93\u534f\u8bae\uff09\u7684\u7f29\u5199,\u662f\u7528\u4e8e\u4e07\u7ef4\u7f51\uff08WWW",":World"," Wide Web \uff09\u670d\u52a1\u5668\u4e0e\u672c\u5730\u6d4f\u89c8\u5668\u4e4b\u95f4\u4f20\u8f93\u8d85\u6587\u672c\u7684\u4f20\u9001\u534f\u8bae\u3002HTTP\u662f\u4e00\u4e2a\u5c5e\u4e8e\u5e94\u7528\u5c42\u7684\u9762\u5411\u5bf9\u8c61\u7684\u534f\u8bae\uff0c\u7531\u4e8e\u5176\u7b80\u6377\u3001\u5feb\u901f\u7684\u65b9\u5f0f\uff0c\u9002\u7528\u4e8e\u5206\u5e03\u5f0f\u8d85\u5a92\u4f53\u4fe1\u606f\u7cfb\u7edf\u3002\u5b83\u4e8e1990\u5e74\u63d0\u51fa\uff0c\u7ecf\u8fc7\u51e0\u5e74\u7684\u4f7f\u7528\u4e0e\u53d1\u5c55\uff0c\u5f97\u5230\u4e0d\u65ad\u5730\u5b8c\u5584\u548c\u6269\u5c55\u3002HTTP\u534f\u8bae\u5de5\u4f5c\u4e8e\u5ba2\u6237\u7aef-\u670d\u52a1\u7aef\u67b6\u6784\u4e3a\u4e0a\u3002\u6d4f\u89c8\u5668\u4f5c\u4e3aHTTP\u5ba2\u6237\u7aef\u901a\u8fc7URL\u5411HTTP\u670d\u52a1\u7aef\u5373WEB\u670d\u52a1\u5668\u53d1\u9001\u6240\u6709\u8bf7\u6c42\u3002Web\u670d\u52a1\u5668\u6839\u636e\u63a5\u6536\u5230\u7684\u8bf7\u6c42\u540e\uff0c\u5411\u5ba2\u6237\u7aef\u53d1\u9001\u54cd\u5e94\u4fe1\u606f\u3002"]}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/golang/assets/%E6%88%AA%E5%B1%8F2022-08-28%2020.18.31.png",alt:"\u622a\u5c4f2022-08-28 20.18.31"})}),"\n",(0,t.jsx)(e.h4,{id:"2http\u534f\u8bae\u7279\u6027",children:"\uff082\uff09http\u534f\u8bae\u7279\u6027"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-text",children:"(1) \u57fa\u4e8eTCP/IP\u534f\u8bae\r\n\r\nhttp\u534f\u8bae\u662f\u57fa\u4e8eTCP/IP\u534f\u8bae\u4e4b\u4e0a\u7684\u5e94\u7528\u5c42\u534f\u8bae\u3002\r\n\r\n(2) \u57fa\u4e8e\u8bf7\u6c42\uff0d\u54cd\u5e94\u6a21\u5f0f\r\n\r\nHTTP\u534f\u8bae\u89c4\u5b9a,\u8bf7\u6c42\u4ece\u5ba2\u6237\u7aef\u53d1\u51fa,\u6700\u540e\u670d\u52a1\u5668\u7aef\u54cd\u5e94\u8be5\u8bf7\u6c42\u5e76 \u8fd4\u56de\u3002\u6362\u53e5\u8bdd\u8bf4,\u80af\u5b9a\u662f\u5148\u4ece\u5ba2\u6237\u7aef\u5f00\u59cb\u5efa\u7acb\u901a\u4fe1\u7684,\u670d\u52a1\u5668\u7aef\u5728\u6ca1\u6709 \u63a5\u6536\u5230\u8bf7\u6c42\u4e4b\u524d\u4e0d\u4f1a\u53d1\u9001\u54cd\u5e94\r\n\r\n(3) \u65e0\u72b6\u6001\u4fdd\u5b58\r\n\r\nHTTP\u662f\u4e00\u79cd\u4e0d\u4fdd\u5b58\u72b6\u6001,\u5373\u65e0\u72b6\u6001(stateless)\u534f\u8bae\u3002HTTP\u534f\u8bae \u81ea\u8eab\u4e0d\u5bf9\u8bf7\u6c42\u548c\u54cd\u5e94\u4e4b\u95f4\u7684\u901a\u4fe1\u72b6\u6001\u8fdb\u884c\u4fdd\u5b58\u3002\u4e5f\u5c31\u662f\u8bf4\u5728HTTP\u8fd9\u4e2a \u7ea7\u522b,\u534f\u8bae\u5bf9\u4e8e\u53d1\u9001\u8fc7\u7684\u8bf7\u6c42\u6216\u54cd\u5e94\u90fd\u4e0d\u505a\u6301\u4e45\u5316\u5904\u7406\u3002\r\n\r\n\u4f7f\u7528HTTP\u534f\u8bae,\u6bcf\u5f53\u6709\u65b0\u7684\u8bf7\u6c42\u53d1\u9001\u65f6,\u5c31\u4f1a\u6709\u5bf9\u5e94\u7684\u65b0\u54cd\u5e94\u4ea7 \u751f\u3002\u534f\u8bae\u672c\u8eab\u5e76\u4e0d\u4fdd\u7559\u4e4b\u524d\u4e00\u5207\u7684\u8bf7\u6c42\u6216\u54cd\u5e94\u62a5\u6587\u7684\u4fe1\u606f\u3002\u8fd9\u662f\u4e3a\u4e86\u66f4\u5feb\u5730\u5904\u7406\u5927\u91cf\u4e8b\u52a1,\u786e\u4fdd\u534f\u8bae\u7684\u53ef\u4f38\u7f29\u6027,\u800c\u7279\u610f\u628aHTTP\u534f\u8bae\u8bbe\u8ba1\u6210 \u5982\u6b64\u7b80\u5355\u7684\u3002\r\n\r\n(4) \u77ed\u8fde\u63a5\u548c\u957f\u8fde\u63a5\r\n\r\nHTTP1.0\u9ed8\u8ba4\u4f7f\u7528\u7684\u662f\u77ed\u8fde\u63a5\u3002\u6d4f\u89c8\u5668\u548c\u670d\u52a1\u5668\u6bcf\u8fdb\u884c\u4e00\u6b21HTTP\u64cd\u4f5c\uff0c\u5c31\u5efa\u7acb\u4e00\u6b21\u8fde\u63a5\uff0c\u4efb\u52a1\u7ed3\u675f\u5c31\u4e2d\u65ad\u8fde\u63a5\u3002\r\nHTTP/1.1\u8d77\uff0c\u9ed8\u8ba4\u4f7f\u7528\u957f\u8fde\u63a5\u3002\u8981\u4f7f\u7528\u957f\u8fde\u63a5\uff0c\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u7684HTTP\u9996\u90e8\u7684Connection\u90fd\u8981\u8bbe\u7f6e\u4e3akeep-alive\uff0c\u624d\u80fd\u652f\u6301\u957f\u8fde\u63a5\u3002\r\nHTTP\u957f\u8fde\u63a5\uff0c\u6307\u7684\u662f\u590d\u7528TCP\u8fde\u63a5\u3002\u591a\u4e2aHTTP\u8bf7\u6c42\u53ef\u4ee5\u590d\u7528\u540c\u4e00\u4e2aTCP\u8fde\u63a5\uff0c\u8fd9\u5c31\u8282\u7701\u4e86TCP\u8fde\u63a5\u5efa\u7acb\u548c\u65ad\u5f00\u7684\u6d88\u8017\u3002\n"})}),"\n",(0,t.jsx)(e.h4,{id:"3http\u8bf7\u6c42\u534f\u8bae\u4e0e\u54cd\u5e94\u534f\u8bae",children:"\uff083\uff09http\u8bf7\u6c42\u534f\u8bae\u4e0e\u54cd\u5e94\u534f\u8bae"}),"\n",(0,t.jsx)(e.p,{children:"http\u534f\u8bae\u5305\u542b\u7531\u6d4f\u89c8\u5668\u53d1\u9001\u6570\u636e\u5230\u670d\u52a1\u5668\u9700\u8981\u9075\u5faa\u7684\u8bf7\u6c42\u534f\u8bae\u4e0e\u670d\u52a1\u5668\u53d1\u9001\u6570\u636e\u5230\u6d4f\u89c8\u5668\u9700\u8981\u9075\u5faa\u7684\u8bf7\u6c42\u534f\u8bae\u3002\u7528\u4e8eHTTP\u534f\u8bae\u4ea4\u4e92\u7684\u4fe1\u88ab\u4e3aHTTP\u62a5\u6587\u3002\u8bf7\u6c42\u7aef(\u5ba2\u6237\u7aef)\u7684HTTP\u62a5\u6587 \u505a\u8bf7\u6c42\u62a5\u6587,\u54cd\u5e94\u7aef(\u670d\u52a1\u5668\u7aef)\u7684 \u505a\u54cd\u5e94\u62a5\u6587\u3002HTTP\u62a5\u6587\u672c\u8eab\u662f\u7531\u591a\u884c\u6570\u636e\u6784\u6210\u7684\u5b57\u6587\u672c\u3002"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/golang/assets/http%E5%8D%8F%E8%AE%AE.png",alt:"http\u534f\u8bae"})}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsx)(e.li,{children:"\u4e00\u4e2a\u5b8c\u6574\u7684URL\u5305\u62ec\uff1a\u534f\u8bae\u3001ip\u3001\u7aef\u53e3\u3001\u8def\u5f84\u3001\u53c2\u6570"}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:"\u4f8b\u5982\uff1a https://www.baidu.com/s?wd=yuan     \u5176\u4e2dhttps\u662f\u534f\u8bae\uff0cwww.baidu.com\xa0\u662fIP\uff0c\u7aef\u53e3\u9ed8\u8ba480\uff0c/s\u662f\u8def\u5f84\uff0c\u53c2\u6570\u662fwd=yuan\n"})}),"\n",(0,t.jsxs)(e.ol,{start:"2",children:["\n",(0,t.jsx)(e.li,{children:"\u8bf7\u6c42\u65b9\u5f0f: get\u4e0epost\u8bf7\u6c42"}),"\n"]}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"GET\u63d0\u4ea4\u7684\u6570\u636e\u4f1a\u653e\u5728URL\u4e4b\u540e\uff0c\u4ee5?\u5206\u5272URL\u548c\u4f20\u8f93\u6570\u636e\uff0c\u53c2\u6570\u4e4b\u95f4\u4ee5&\u76f8\u8fde\uff0c\u5982EditBook?name=test1&id=123456. POST\u65b9\u6cd5\u662f\u628a\u63d0\u4ea4\u7684\u6570\u636e\u653e\u5728HTTP\u5305\u7684\u8bf7\u6c42\u4f53\u4e2d."}),"\n",(0,t.jsx)(e.li,{children:"GET\u63d0\u4ea4\u7684\u6570\u636e\u5927\u5c0f\u6709\u9650\u5236\uff08\u56e0\u4e3a\u6d4f\u89c8\u5668\u5bf9URL\u7684\u957f\u5ea6\u6709\u9650\u5236\uff09\uff0c\u800cPOST\u65b9\u6cd5\u63d0\u4ea4\u7684\u6570\u636e\u6ca1\u6709\u9650\u5236"}),"\n"]}),"\n",(0,t.jsxs)(e.ol,{start:"3",children:["\n",(0,t.jsx)(e.li,{children:"\u54cd\u5e94\u72b6\u6001\u7801\uff1a\u72b6\u6001\u7801\u7684\u804c \u662f\u5f53\u5ba2\u6237\u7aef\u5411\u670d\u52a1\u5668\u7aef\u53d1\u9001\u8bf7\u6c42\u65f6, \u8fd4\u56de\u7684\u8bf7\u6c42 \u7ed3\u679c\u3002\u501f\u52a9\u72b6\u6001\u7801,\u7528\u6237\u53ef\u4ee5\u77e5\u9053\u670d\u52a1\u5668\u7aef\u662f\u6b63\u5e38 \u7406\u4e86\u8bf7\u6c42,\u8fd8\u662f\u51fa \u73b0\u4e86 \u3002\u72b6\u6001\u7801\u5982200 OK,\u4ee53\u4f4d\u6570\u5b57\u548c\u539f\u56e0 \u7ec4\u6210\u3002"}),"\n"]}),"\n",(0,t.jsx)(e.h2,{id:"13quick-start",children:"1.3\u3001quick start"}),"\n",(0,t.jsxs)(e.p,{children:["Gin \u662f\u4e00\u4e2a\u7528 Go (Golang) \u7f16\u5199\u7684 web \u6846\u67b6\uff08web\u6846\u67b6\u5c31\u662fweb\u5e94\u7528\u7a0b\u5e8f\u6846\u67b6\uff09\u3002 \u5b83\u662f\u4e00\u4e2a\u7c7b\u4f3c\u4e8e ",(0,t.jsx)(e.a,{href:"https://github.com/go-martini/martini",children:"martini"})," \u4f46\u62e5\u6709\u66f4\u597d\u6027\u80fd\u7684 API \u6846\u67b6, \u7531\u4e8e ",(0,t.jsx)(e.a,{href:"https://github.com/julienschmidt/httprouter",children:"httprouter"}),"\uff0c\u901f\u5ea6\u63d0\u9ad8\u4e86\u8fd1 40 \u500d\u3002 \u5982\u679c\u4f60\u662f\u6027\u80fd\u548c\u9ad8\u6548\u7684\u8ffd\u6c42\u8005, \u4f60\u4f1a\u7231\u4e0a Gin."]}),"\n",(0,t.jsx)(e.h3,{id:"131\u5b89\u88c5",children:"1.3.1\u3001\u5b89\u88c5"}),"\n",(0,t.jsx)(e.p,{children:"\u8981\u5b89\u88c5 Gin \u8f6f\u4ef6\u5305\uff0c\u9700\u8981\u5148\u5b89\u88c5 Go \u5e76\u8bbe\u7f6e Go \u5de5\u4f5c\u533a\u3002"}),"\n",(0,t.jsx)(e.p,{children:"1.\u4e0b\u8f7d\u5e76\u5b89\u88c5 gin\uff1a"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-sh",children:"$ go get -u github.com/gin-gonic/gin\n"})}),"\n",(0,t.jsx)(e.p,{children:"2.\u5c06 gin \u5f15\u5165\u5230\u4ee3\u7801\u4e2d\uff1a"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:'import "github.com/gin-gonic/gin"\n'})}),"\n",(0,t.jsxs)(e.p,{children:["3.\uff08\u53ef\u9009\uff09\u5982\u679c\u4f7f\u7528\u8bf8\u5982 ",(0,t.jsx)(e.code,{children:"http.StatusOK"})," \u4e4b\u7c7b\u7684\u5e38\u91cf\uff0c\u5219\u9700\u8981\u5f15\u5165 ",(0,t.jsx)(e.code,{children:"net/http"})," \u5305\uff1a"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:'import "net/http"\n'})}),"\n",(0,t.jsx)(e.h3,{id:"132quick-start",children:"1.3.2\u3001quick start"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:'package main\r\n\r\nimport (\r\n\t"github.com/gin-gonic/gin"\r\n\t"net/http"\r\n)\r\n\r\nfunc main() {\r\n\tr := gin.Default()\r\n\t// \u8fd4\u56de\u4e00\u4e2ajson\u6570\u636e\r\n\tr.GET("/user", func(c *gin.Context) {\r\n\t\tc.JSON(200, gin.H{\r\n\t\t\t"user": "yuan",\r\n\t\t})\r\n\t})\r\n\r\n\t// \u8fd4\u56de\u4e00\u4e2ahtml\u9875\u9762\r\n\tr.LoadHTMLGlob("templates/*")\r\n\tr.GET("/index", func(c *gin.Context) {\r\n\t\tc.HTML(http.StatusOK, "index.html", nil)\r\n\t})\r\n\r\n\tr.Run() // \u76d1\u542c\u5e76\u5728 0.0.0.0:8080 \u4e0a\u542f\u52a8\u670d\u52a1\r\n}\n'})}),"\n",(0,t.jsx)(e.h3,{id:"133mvc",children:"1.3.3\u3001mvc"}),"\n",(0,t.jsx)(e.p,{children:"\u5e7f\u4e49\u770bMVC\uff0cM\u662f\u6307\u4e1a\u52a1\u6a21\u578b\uff0cV\u662f\u6307\u7528\u6237\u754c\u9762\uff0cC\u5219\u662f\u63a7\u5236\u5668\uff0c\u4f7f\u7528MVC\u7684\u76ee\u7684\u662f\u5c06M\u548cV\u7684\u5b9e\u73b0\u4ee3\u7801\u5206\u79bb\uff0c\u4ece\u800c\u4f7f\u540c\u4e00\u4e2a\u7a0b\u5e8f\u53ef\u4ee5\u4f7f\u7528\u4e0d\u540c\u7684\u8868\u73b0\u5f62\u5f0f\u3002\u5176\u4e2d\uff0cView\u7684\u5b9a\u4e49\u6bd4\u8f83\u6e05\u6670\uff0c\u5c31\u662f\u7528\u6237\u754c\u9762\u3002"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/golang/assets/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ3NzE0Mjg4,size_16,color_FFFFFF,t_70-9027201-9027242.png",alt:"img"})}),"\n",(0,t.jsxs)(e.blockquote,{children:["\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"\u89c6\u56fe\u5c42\uff08View\uff09\uff1a\u8d1f\u8d23\u683c\u5f0f\u5316\u6570\u636e\u5e76\u628a\u5b83\u4eec\u5448\u73b0\u7ed9\u7528\u6237\uff0c\u5305\u62ec\u6570\u636e\u5c55\u793a\u3001\u7528\u6237\u4ea4\u4e92\u3001\u6570\u636e\u9a8c\u8bc1\u3001\u754c\u9762\u8bbe\u8ba1\u7b49\u529f\u80fd\u3002"}),"\n",(0,t.jsx)(e.li,{children:"\u63a7\u5236\u5c42\uff08Controller\uff09\uff1a\u8d1f\u8d23\u63a5\u6536\u5e76\u8f6c\u53d1\u8bf7\u6c42\uff0c\u5bf9\u8bf7\u6c42\u8fdb\u884c\u5904\u7406\u540e\uff0c\u6307\u5b9a\u89c6\u56fe\u5e76\u5c06\u54cd\u5e94\u7ed3\u679c\u53d1\u9001\u7ed9\u5ba2\u6237\u7aef\u3002"}),"\n",(0,t.jsx)(e.li,{children:"\u6570\u636e\u6a21\u578b\u5c42\uff08Model\uff09\uff1a\u6a21\u578b\u5bf9\u8c61\u62e5\u6709\u6700\u591a\u7684\u5904\u7406\u4efb\u52a1\uff0c\u662f\u5e94\u7528\u7a0b\u5e8f\u7684\u4e3b\u4f53\u90e8\u5206\uff0c\u5b83\u8d1f\u8d23\u6570\u636e\u903b\u8f91\uff08\u4e1a\u52a1\u89c4\u5219\uff09\u7684\u5904\u7406\u548c\u5b9e\u73b0\u6570\u636e\u64cd\u4f5c\uff08\u5373\u5bf9\u6570\u636e\u5e93\u4e2d\u7684\u6570\u636e\u589e\u5220\u6539\u67e5\uff09\u3002"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(e.p,{children:"MVC(Model-View-Controller) \u6a21\u5f0f\u7684\u57fa\u672c\u601d\u60f3\u662f\uff1a\u6570\u636e \uff0c\u663e\u793a\u548c\u5904\u7406\u76f8\u5206\u79bb\u3002"}),"\n",(0,t.jsx)(e.p,{children:"Gin\u6846\u67b6\u7684\u6d41\u7a0b\u56fe:"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/golang/assets/Gin%E6%A1%86%E6%9E%B6%E6%B5%81%E7%A8%8B%E5%9B%BE-5321444-5321446.png",alt:"Gin\u6846\u67b6\u6d41\u7a0b\u56fe"})}),"\n",(0,t.jsx)(e.h3,{id:"133timer\u6848\u4f8b",children:"1.3.3\u3001timer\u6848\u4f8b"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{})}),"\n",(0,t.jsx)(e.h3,{id:"134\u767b\u9646\u6848\u4f8b",children:"1.3.4\u3001\u767b\u9646\u6848\u4f8b"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{})}),"\n",(0,t.jsx)(e.h1,{id:"\u4e8cgin\u8def\u7531",children:"\u4e8c\u3001Gin\u8def\u7531"}),"\n",(0,t.jsx)(e.h2,{id:"21\u8def\u7531\u65b9\u6cd5",children:"2.1\u3001\u8def\u7531\u65b9\u6cd5"}),"\n",(0,t.jsx)(e.p,{children:"\u8def\u7531\u7cfb\u7edf\u652f\u6301\u4efb\u610f\u65b9\u5f0f\u7684\u8bf7\u6c42\uff0c\u5982\u4e0b\u7684\u65b9\u6cd5\u7528\u6765\u63d0\u4f9b\u5bf9\u5e94\u65b9\u6cd5\u6765\u63a5\u6536\u8bf7\u6c42\uff1a"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:"\r\nfunc (group *RouterGroup) DELETE(relativePath string, handlers ...HandlerFunc) IRoutes\r\nfunc (group *RouterGroup) GET(relativePath string, handlers ...HandlerFunc) IRoutes\r\nfunc (group *RouterGroup) HEAD(relativePath string, handlers ...HandlerFunc) IRoutes\r\nfunc (group *RouterGroup) OPTIONS(relativePath string, handlers ...HandlerFunc) IRoutes\r\nfunc (group *RouterGroup) PATCH(relativePath string, handlers ...HandlerFunc) IRoutes\r\nfunc (group *RouterGroup) POST(relativePath string, handlers ...HandlerFunc) IRoutes\r\nfunc (group *RouterGroup) PUT(relativePath string, handlers ...HandlerFunc) IRoutes\r\n// \u4efb\u610f\u8def\u7531\r\nfunc (group *RouterGroup) ANY(relativePath string, handlers ...HandlerFunc) IRoutes\r\n\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u6848\u4f8b\uff1a"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-golang",children:'func main() {\r\n\tr := gin.Default()\r\n\tr.GET("/book", func(c *gin.Context) {\r\n\t\tc.JSON(200, gin.H{\r\n\t\t\t"message": "GET",\r\n\t\t})\r\n\t})\r\n\r\n\tr.POST("/book", func(c *gin.Context) {\r\n\t\tc.JSON(200, gin.H{\r\n\t\t\t"message": "POST",\r\n\t\t})\r\n\t})\r\n\r\n\tr.PUT("/book", func(c *gin.Context) {\r\n\t\tc.JSON(200, gin.H{\r\n\t\t\t"message": "PUT",\r\n\t\t})\r\n\t})\r\n\r\n\tr.DELETE("/book", func(c *gin.Context) {\r\n\t\tc.JSON(200, gin.H{\r\n\t\t\t"message": "DELETE",\r\n\t\t})\r\n\t})\r\n  \r\n  // \u8def\u7531\u5339\u914d\u4e0d\u6210\u529f\r\n\tr.NoRoute(func(c *gin.Context) {\r\n\t\tc.HTML(http.StatusNotFound, "404.html", nil)\r\n\t})\r\n  \r\n}\n'})}),"\n",(0,t.jsx)(e.h2,{id:"22\u8def\u7531\u5206\u7ec4",children:"2.2\u3001\u8def\u7531\u5206\u7ec4"}),"\n",(0,t.jsx)(e.p,{children:"\u8def\u7531\u5206\u7ec4\u7528\u4e8e\u5c06\u591a\u4e2a\u8def\u7531\u8fdb\u884c\u7edf\u4e00\u7684\u5904\u7406"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:'// \u4e66\u7c4d\u76f8\u5173\u7684\u8def\u7531\r\nr := gin.Default()\r\n\r\nbookRoute := r.Group("/books")\r\n{\r\n  bookRoute.GET("/", GetBook)\r\n\tbookRoute.POST("/add", AddBook)\r\n\tbookRoute.GET("/edit", EditBook)\r\n\tbookRoute.GET("/delete", DeleteBook)\r\n}\r\n\r\n// \u51fa\u7248\u793e\u76f8\u5173\u7684\u8def\u7531\r\npublishRoute := r.Group("/publish")\r\n{\r\n  publishRoute.GET("/", GetPublish)\r\n\tpublishRoute.POST("/add", AddPublish)\r\n\tpublishRoute.GET("/edit",EditPublish)\r\n\tpublishRoute.GET("/delete",DeletePublish)\r\n}\r\nr.Run(":8080")\r\n\r\n\n'})}),"\n",(0,t.jsx)(e.h1,{id:"\u4e09\u8bf7\u6c42\u4e0e\u54cd\u5e94",children:"\u4e09\u3001\u8bf7\u6c42\u4e0e\u54cd\u5e94"}),"\n",(0,t.jsx)(e.h2,{id:"31\u8bf7\u6c42\u6570\u636e",children:"3.1\u3001\u8bf7\u6c42\u6570\u636e"}),"\n",(0,t.jsx)(e.h3,{id:"1\u83b7\u53d6\u57fa\u672c\u8bf7\u6c42\u6570\u636e",children:"\uff081\uff09\u83b7\u53d6\u57fa\u672c\u8bf7\u6c42\u6570\u636e"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-golang",children:'  r.GET("/test", func(c *gin.Context) {\r\n  // \u83b7\u53d6\u57fa\u672c\u8bf7\u6c42\u4fe1\u606f\r\n  fmt.Println(c.Request.Method)     // GET\r\n  fmt.Println(c.Request.URL)        // /test\r\n  fmt.Println(c.Request.RemoteAddr) // 127.0.0.1:58581\r\n  fmt.Println(c.ClientIP())         // 127.0.0.1\r\n  // \u83b7\u53d6\u8bf7\u6c42\u5934\r\n  fmt.Println(c.Request.Header)\r\n  fmt.Println(c.Request.Header["User-Agent"])\r\n  fmt.Println(c.GetHeader("User-Agent"))\r\n\r\n  c.String(200, "test OK!") \r\n\r\n})\n'})}),"\n",(0,t.jsx)(e.h3,{id:"2\u83b7\u53d6\u8def\u5f84\u53c2\u6570",children:"\uff082\uff09\u83b7\u53d6\u8def\u5f84\u53c2\u6570"}),"\n",(0,t.jsxs)(e.p,{children:["\u83b7\u53d6URL\u8def\u5f84\u53c2\u6570\uff0c\u6307\u7684\u662f\u83b7\u53d6/user/",":id","\u8fd9\u7c7b\u578b\u8def\u7531\u7ed1\u5b9a\u7684\u53c2\u6570\uff0c\u8fd9\u4e2a\u4f8b\u2f26\u7ed1\u5b9a\u4e86\u2f00\u4e2a\u53c2\u6570id\uff0c\u83b7\u53d6url\u8def\u5f84\u53c2\u6570\u5e38\u2f64\u51fd\u6570\uff1a"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:"func(c*Context)Param(keystring)string\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:'// \u4f8b\u2f26\uff1a\r\nr:=gin.Default()\r\nr.GET("/user/:id",func(c*gin.Context){\r\n    //\u83b7\u53d6url\u53c2\u6570id\r\n    id:=c.Param("id")\r\n})\n'})}),"\n",(0,t.jsx)(e.h3,{id:"3\u83b7\u53d6\u67e5\u8be2\u53c2\u6570",children:"\uff083\uff09\u83b7\u53d6\u67e5\u8be2\u53c2\u6570"}),"\n",(0,t.jsxs)(e.p,{children:["Get\u8bf7\u6c42url\u4f8b\u5b50\uff1a",(0,t.jsx)(e.code,{children:"/path?kd=yuan"})]}),"\n",(0,t.jsx)(e.p,{children:"\u83b7\u53d6Get\u8bf7\u6c42\u53c2\u6570\u7684\u5e38\u7528\u51fd\u6570\uff1a"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-haskell",children:"func(c*Context)Query(keystring)string\r\nfunc(c*Context)DefaultQuery(key,defaultValuestring)string\r\nfunc(c*Context)GetQuery(keystring)(string,bool)\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-golang",children:'// \u4f8b\u2f26\uff1a\r\nfuncHandler(c *gin.Context){\r\n    //\u83b7\u53d6name\u53c2\u6570,\u901a\u8fc7Query\u83b7\u53d6\u7684\u53c2\u6570\u503c\u662fString\u7c7b\u578b\u3002\r\n    name:=c.Query("name")\r\n    //\u83b7\u53d6name\u53c2\u6570,\u8ddfQuery\u51fd\u6570\u7684\u533a\u522b\u662f\uff0c\u53ef\u4ee5\u901a\u8fc7\u7b2c\u2f06\u4e2a\u53c2\u6570\u8bbe\u7f6e\u9ed8\u8ba4\u503c\u3002\r\n    name:=c.DefaultQuery("name","root")\r\n    //\u83b7\u53d6id\u53c2\u6570,\u901a\u8fc7GetQuery\u83b7\u53d6\u7684\u53c2\u6570\u503c\u4e5f\u662fString\u7c7b\u578b,\r\n    //\u533a\u522b\u662fGetQuery\u8fd4\u56de\u4e24\u4e2a\u53c2\u6570\uff0c\u7b2c\u2f00\u4e2a\u662f\u53c2\u6570\u503c\uff0c\u7b2c\u2f06\u4e2a\u53c2\u6570\u662f\u53c2\u6570\u662f\u5426\u5b58\u5728\u7684bool\u503c\uff0c\u53ef\u4ee5\u2f64\u6765\u5224\u65ad\u53c2\u6570\u662f\u5426\u5b58\u5728\u3002\r\n    id,ok:=c.GetQuery("id")\r\n    if!ok{\r\n    //\u53c2\u6570\u4e0d\u5b58\u5728\r\n    }\r\n}\r\n// \u63d0\u2f70\uff1aGetQuery\u51fd\u6570\uff0c\u5224\u65ad\u53c2\u6570\u662f\u5426\u5b58\u5728\u7684\u903b\u8f91\u662f\uff0c\u53c2\u6570\u503c\u4e3a\u7a7a\uff0c\u53c2\u6570\u4e5f\u7b97\u5b58\u5728\uff0c\u53ea\u6709\u6ca1\u6709\u63d0\u4ea4\u53c2\u6570\uff0c\u624d\u7b97\u53c2\u6570\u4e0d\u5b58\u5728\u3002\n'})}),"\n",(0,t.jsx)(e.h3,{id:"4\u83b7\u53d6postform\u6570\u636e",children:"\uff084\uff09\u83b7\u53d6PostForm\u6570\u636e"}),"\n",(0,t.jsx)(e.p,{children:"\u83b7\u53d6Post\u8bf7\u6c42\u53c2\u6570\u7684\u5e38\u7528\u51fd\u6570\uff1a"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-golang",children:"func(c*Context)PostForm(keystring)string\r\nfunc(c*Context)DefaultPostForm(key,defaultValuestring)string\r\nfunc(c*Context)GetPostForm(keystring)(string,bool)\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-golang",children:'// \u4f8b\u2f26\uff1a\r\nfuncHandler(c *gin.Context){\r\n    //\u83b7\u53d6name\u53c2\u6570,\u901a\u8fc7PostForm\u83b7\u53d6\u7684\u53c2\u6570\u503c\u662fString\u7c7b\u578b\u3002\r\n    name:=c.PostForm("name")\r\n    //\u8ddfPostForm\u7684\u533a\u522b\u662f\u53ef\u4ee5\u901a\u8fc7\u7b2c\u2f06\u4e2a\u53c2\u6570\u8bbe\u7f6e\u53c2\u6570\u9ed8\u8ba4\u503c\r\n    name:=c.DefaultPostForm("name","root")\r\n    //\u83b7\u53d6id\u53c2\u6570,\u901a\u8fc7GetPostForm\u83b7\u53d6\u7684\u53c2\u6570\u503c\u4e5f\u662fString\u7c7b\u578b,\r\n        //\u533a\u522b\u662fGetPostForm\u8fd4\u56de\u4e24\u4e2a\u53c2\u6570\uff0c\u7b2c\u2f00\u4e2a\u662f\u53c2\u6570\u503c\uff0c\u7b2c\u2f06\u4e2a\u53c2\u6570\u662f\u53c2\u6570\u662f\u5426\u5b58\u5728\u7684bool\u503c\uff0c\u53ef\u4ee5\u2f64\u6765\u5224\u65ad\u53c2\u6570\u662f\u5426\u5b58\u5728\u3002\r\n    id,ok:=c.GetPostForm("id")\r\n    if!ok{\r\n    //\u53c2\u6570\u4e0d\u5b58\u5728\r\n    }\r\n    // \u83b7\u53d6PostForm\u7684\u6570\u7ec4\u503c\r\n    names:=c.PostFormArray("names")\r\n}\n'})}),"\n",(0,t.jsx)(e.h3,{id:"5shouldbind\u51fd\u6570",children:"\uff085\uff09ShouldBind\u51fd\u6570"}),"\n",(0,t.jsx)(e.p,{children:"\u524d\u2faf\u83b7\u53d6\u53c2\u6570\u7684\u2f45\u5f0f\u90fd\u662f\u2f00\u4e2a\u4e2a\u53c2\u6570\u7684\u8bfb\u53d6\uff0c\u2f50\u8f83\u2fc7\u70e6\uff0cGin\u6846\u67b6\u2f40\u6301\u5c06\u8bf7\u6c42\u53c2\u6570\u2f83\u52a8\u7ed1\u5b9a\u5230\u2f00\u4e2astruct\u5bf9\u8c61\uff0c\u8fd9\u79cd\u2f45\u5f0f\u2f40\u6301Get/Post\u8bf7\u6c42\uff0c\u4e5f\u2f40\u6301http\u8bf7\u6c42body\u5185\u5bb9\u4e3ajson/xml\u683c\u5f0f\u7684\u53c2\u6570\u3002"}),"\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:"ShouldBind"}),"\u5f3a\u5927\u7684\u529f\u80fd\uff0c\u53ef\u4ee5\u57fa\u4e8e\u8bf7\u6c42\u7684",(0,t.jsx)(e.strong,{children:"Content-Type"}),"\u8bc6\u522b\u8bf7\u6c42\u6570\u636e\u7c7b\u578b\u5e76\u5229\u7528\u53cd\u5c04\u673a\u5236\u81ea\u52a8\u63d0\u53d6\u8bf7\u6c42\u4e2dquerystring\u3001form\u8868\u5355\u3001JSON\u3001XML\u7b49\u53c2\u6570\u5230\u7ed3\u6784\u4f53\u4e2d\u3002\u80fd\u591f\u57fa\u4e8e\u8bf7\u6c42\u81ea\u52a8\u63d0\u53d6JSON\u3001form\u8868\u5355\u548cquerystring\u7c7b\u578b\u7684\u6570\u636e\uff0c\u5e76\u628a\u503c\u7ed1\u5b9a\u5230\u6307\u5b9a\u7684\u7ed3\u6784\u4f53\u5bf9\u8c61\u3002"]}),"\n",(0,t.jsxs)(e.blockquote,{children:["\n",(0,t.jsx)(e.p,{children:'struct\u6807\u7b7e\u8bf4\u660e\uff1a\r\n\uff081\uff09json:"name" \u6570\u636e\u683c\u5f0f\u4e3ajson\u683c\u5f0f\uff0c\u5e76\u4e14json\u5b57\u6bb5\u540d\u4e3aname\r\n\uff082\uff09form:"name" \u8868\u5355\u53c2\u6570\u540d\u4e3aname\r\n\u63d0\u2f70\uff1a\u4f60\u53ef\u4ee5\u6839\u636e\u2f83\u2f30\u7684\u9700\u8981\u9009\u62e9\u2f40\u6301\u7684\u6570\u636e\u7c7b\u578b\uff0c\u4f8b\u5982\u9700\u8981\u2f40\u6301json\u6570\u636e\u683c\u5f0f\uff0c\u53ef\u4ee5\u8fd9\u6837\u5b9a\u4e49\u5b57\u6bb5\u6807\u7b7e:json:"name"'}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-golang",children:'package main\r\n\r\nimport (\r\n\t"github.com/gin-gonic/gin"\r\n\t"log"\r\n)\r\n\r\ntype User struct {\r\n\tName  string `json:"name" form:"name"`\r\n\tAge   int    `json:"age" form:"age"`\r\n\tEmail string `json:"email" form:"email"`\r\n}\r\n\r\nfunc main() {\r\n\t// 1.\u521b\u5efa\u8def\u7531\r\n\tr := gin.Default()\r\n\r\n\tr.POST("/user/", func(c *gin.Context) {\r\n\t\t//\u521d\u59cb\u5316User\r\n\t\tuser := User{}\r\n\t\t//\u901a\u8fc7ShouldBind\u51fd\u6570\uff0c\u5c06\u8bf7\u6c42\u53c2\u6570\u7ed1\u5b9a\u5230struct\u5bf9\u8c61\uff0c\u5904\u7406json\u8bf7\u6c42\u4ee3\u7801\u662f\u2f00\u6837\u7684\u3002\r\n\t\t//\u5982\u679c\u662fpost\u8bf7\u6c42\u5219\u6839\u636eContent-Type\u5224\u65ad\uff0c\u63a5\u6536\u7684\u662fjson\u6570\u636e\uff0c\u8fd8\u662f\u666e\u901a\u7684http\u8bf7\u6c42\u53c2\u6570\r\n\t\tif c.ShouldBind(&user) == nil {\r\n\t\t\t//\u7ed1\u5b9a\u6210\u529f\uff0c\u6253\u5370\u8bf7\u6c42\u53c2\u6570\r\n\t\t\tlog.Println("user:", user)\r\n\t\t}\r\n\t\t//http\u8bf7\u6c42\u8fd4\u56de\u2f00\u4e2a\u5b57\u7b26\u4e32\r\n\t\tc.JSON(200, gin.H{\r\n\t\t\t"msg":             "parser Success",\r\n\t\t\t"\u8bf7\u6c42\u7684content-type": c.ContentType(),\r\n\t\t\t"\u89e3\u6784\u540e\u7684\u6570\u636e":          user,\r\n\t\t})\r\n\t})\r\n\r\n\tr.Run(":8080")\r\n}\n'})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/golang/assets/image-20221202134138674-9959700-9959848.png",alt:"image-20221202134138674"})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/golang/assets/image-20221202134224622-9959745-9959864.png",alt:"image-20221202134224622"})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/golang/assets/image-20221202134317876-9959799.png",alt:"image-20221202134317876"})}),"\n",(0,t.jsx)(e.p,{children:"ShouldBind\u6709\u2f00\u7cfb\u5217\u51fd\u6570\uff0c\u2f24\u81f4\u5c31\u662f\u628a\u524d\u2faf\u7684\u2f45\u5f0f\u7ed1\u5b9a\u5230\u7ed3\u6784\u4f53\u7684\u2f45\u5f0f\uff0c\u5982\uff1aShouldBindUri()\u3001ShouldBindQuery()\u7b49\u7b49\uff0c\u2f64\u6cd5\u548cShouldBind\u7c7b\u4f3c\uff0c\u8fd9\u2fa5\u5c31\u4e0d\u5c55\u5f00\u4ecb\u7ecd\u4e86\u3002"}),"\n",(0,t.jsxs)(e.blockquote,{children:["\n",(0,t.jsx)(e.p,{children:"\u63d0\u2f70\uff1a\u5982\u679c\u4f60\u901a\u8fc7http\u8bf7\u6c42body\u4f20\u9012json\u683c\u5f0f\u7684\u8bf7\u6c42\u53c2\u6570\uff0c\u5e76\u4e14\u901a\u8fc7post\u8bf7\u6c42\u7684\u2f45\u5f0f\u63d0\u4ea4\u53c2\u6570\uff0c\u5219\u9700\u8981\u5c06Content-Type\u8bbe\u7f6e\u4e3aapplication/json,\u5982\u679c\u662fxml\u683c\u5f0f\u7684\u6570\u636e\uff0c\u5219\u8bbe\u7f6e\u4e3aapplication/xml"}),"\n"]}),"\n",(0,t.jsx)(e.h2,{id:"32\u54cd\u5e94\u6570\u636e",children:"3.2\u3001\u54cd\u5e94\u6570\u636e"}),"\n",(0,t.jsx)(e.h3,{id:"321\u54cd\u5e94\u4e0d\u540c\u7684\u6570\u636e\u683c\u5f0f",children:"3.2.1\u3001\u54cd\u5e94\u4e0d\u540c\u7684\u6570\u636e\u683c\u5f0f"}),"\n",(0,t.jsx)(e.h4,{id:"1\u54cd\u5e94\u7b80\u5355\u5b57\u7b26\u4e32",children:"\uff081\uff09\u54cd\u5e94\u7b80\u5355\u5b57\u7b26\u4e32"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-golang",children:'r.GET("/str", func(c *gin.Context) {\r\n\t\tc.String(200, "hello world!")\r\n})\n'})}),"\n",(0,t.jsx)(e.h4,{id:"2\u54cd\u5e94html\u9875\u9762",children:"\uff082\uff09\u54cd\u5e94html\u9875\u9762"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-golang",children:'  r.LoadHTMLGlob("templates/*")\r\n\tr.GET("/index", func(c *gin.Context) {\r\n\t\tc.HTML(http.StatusOK, "index.html",nil)\r\n\t})\n'})}),"\n",(0,t.jsx)(e.h4,{id:"3\u54cd\u5e94json",children:"\uff083\uff09\u54cd\u5e94json"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:'// \u8fd4\u56de\u4e00\u4e2ajson\u6570\u636e\r\n\tr.GET("/json", func(c *gin.Context) {\r\n\t\tc.JSON(200, gin.H{\r\n\t\t\t"message": "json\u6570\u636e",\r\n\t\t})\r\n\t})\n'})}),"\n",(0,t.jsx)(e.h4,{id:"4\u54cd\u5e94xml\u6570\u636e",children:"\uff084\uff09\u54cd\u5e94xml\u6570\u636e"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-golang",children:'// \u8fd4\u56de\u4e00\u4e2axml\u6570\u636e\r\n\tr.GET("/xml", func(c *gin.Context) {\r\n\t\tc.XML(http.StatusOK, gin.H{"message": "xml\u6d88\u606f"})\r\n\t})\n'})}),"\n",(0,t.jsx)(e.h4,{id:"5\u54cd\u5e94protobuf\u683c\u5f0f",children:"\uff085\uff09\u54cd\u5e94protobuf\u683c\u5f0f"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-golang",children:'func indexHandler(c *gin.Context) {\r\n\r\n\t//c.XML(http.StatusOK, gin.H{"message":"\u6d88\u606f"})\r\n\t//c.YAML(http.StatusOK, gin.H{"message":"\u6d88\u606f"})\r\n\treps := []int64{int64(9),int64(55)}\r\n\r\n\t// \u81ea\u5b9a\u4e49\u6570\u636e\r\n\tlabel := "\u4f60\u597d\u554a,\u4eca\u5929\u5929\u6c14\u633a\u597d\u7684"\r\n\r\n\t// \u4f20protobuf\u683c\u5f0f\u6570\u636e\r\n\tdata := &protoexample.Test{\r\n\t\tLabel: &label,\r\n\t\tReps: reps,\r\n\t}\r\n\tfmt.Println(data)\r\n\tc.ProtoBuf(200,data)\r\n}\n'})}),"\n",(0,t.jsx)(e.h3,{id:"322\u9759\u6001\u6587\u4ef6",children:"3.2.2\u3001\u9759\u6001\u6587\u4ef6"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:'// \u9759\u6001\u6587\u4ef6\u914d\u7f6e\r\nr.Static("/static", "./static")\n'})}),"\n",(0,t.jsx)(e.h3,{id:"323\u91cd\u5b9a\u5411",children:"3.2.3\u3001\u91cd\u5b9a\u5411"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:'c.Redirect(http.StatusMovedPermanently, "http://www.baidu.com")\r\nc.Redirect(http.StatusMovedPermanently, "/xml")\n'})}),"\n",(0,t.jsx)(e.h3,{id:"324\u5f02\u6b65\u54cd\u5e94",children:"3.2.4\u3001\u5f02\u6b65\u54cd\u5e94"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-golang",children:'package main\r\n\r\nimport (\r\n\t"log"\r\n\t"time"\r\n\t"github.com/gin-gonic/gin"\r\n)\r\n\r\nfunc main() {\r\n\t// 1.\u521b\u5efa\u8def\u7531\r\n\t// \u9ed8\u8ba4\u4f7f\u7528\u4e862\u4e2a\u4e2d\u95f4\u4ef6Logger(), Recovery()\r\n\tr := gin.Default()\r\n\t// 1.\u5f02\u6b65\r\n\tr.GET("/async", func(c *gin.Context) {\r\n\t\t// \u9700\u8981\u641e\u4e00\u4e2a\u526f\u672c\r\n\t\tcopyContext := c.Copy()\r\n\t\t// \u5f02\u6b65\u5904\u7406\r\n\t\tgo func() {\r\n\t\t\ttime.Sleep(3 * time.Second)\r\n\t\t\tlog.Println("\u5f02\u6b65\u6267\u884c\uff1a" + copyContext.Request.URL.Path)\r\n\t\t}()\r\n\r\n\t\tc.JSON(200, gin.H{"msg": "\u5f02\u6b65\u6267\u884c\u4e2d"})\r\n\r\n\t})\r\n\t// 2.\u540c\u6b65\r\n\tr.GET("/sync", func(c *gin.Context) {\r\n\t\ttime.Sleep(3 * time.Second)\r\n\t\tlog.Println("\u540c\u6b65\u6267\u884c\uff1a" + c.Request.URL.Path)\r\n\t\tc.JSON(200, gin.H{"msg": "\u540c\u6b65\u6267\u884c\u7ed3\u675f"})\r\n\t})\r\n\r\n\tr.Run(":8080")\r\n}\r\n\n'})}),"\n",(0,t.jsx)(e.h1,{id:"\u56dbgin\u6a21\u677f",children:"\u56db\u3001Gin\u6a21\u677f"}),"\n",(0,t.jsx)(e.p,{children:"\u6a21\u677f\u5728web\u5f00\u53d1\u4e2d\u2f34\u6cdb\u4f7f\u2f64\uff0c\u5b83\u80fd\u591f\u6709\u6548\u7684\u5c06\u4e1a\u52a1\u903b\u8f91\u548c\u9875\u2faf\u903b\u8f91\u5206\u5f00\uff0c\u4f7f\u4ee3\u7801\u53ef\u8bfb\u6027\u589e\u5f3a\u3001\u5e76\u4e14\u66f4\u52a0\u5bb9\u6613\u7406\u89e3\u548c\u7ef4\u62a4\u3002 \u6a21\u677f\u7b80\u5355\u6765\u8bf4\u5c31\u662f\u2f00\u4e2a\u5176\u4e2d\u5305\u6db5\u5360\u4f4d\u53d8\u91cf\u8868\u2f70\u52a8\u6001\u7684\u90e8\u5206\u7684\u2f42\u4ef6\uff0c\u6a21\u677f\u2f42\u4ef6\u5728\u7ecf\u8fc7\u52a8\u6001\u8d4b\u503c\u540e\uff0c\u8fd4\u56de\u7ed9\u2f64\u6237\u3002"}),"\n",(0,t.jsx)(e.h2,{id:"41-\u53d8\u91cf\u6e32\u67d3",children:"4.1 \u3001\u53d8\u91cf\u6e32\u67d3"}),"\n",(0,t.jsx)(e.p,{children:"\u89c6\u56fe\u90e8\u5206\uff1a"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:'package main\r\n\r\nimport "github.com/gin-gonic/gin"\r\n\r\ntype Student struct {\r\n\tName string\r\n\tAge  int\r\n}\r\n\r\nfunc main() {\r\n\t// \u57fa\u4e8e\u83b7\u53d6\u5f15\u64ce\u5bf9\u8c61\uff0c\u53ef\u4ee5\u7406\u89e3\u4e3a\u8def\u7531\u5bf9\u8c61\r\n\tr := gin.Default()\r\n\t// \u52a0\u8f7d\u6a21\u677f\u6587\u4ef6\r\n\tr.LoadHTMLGlob("templates/*")\r\n\r\n\tr.GET("/index", func(context *gin.Context) {\r\n\r\n\t\tcontext.HTML(200, "index.html", gin.H{\r\n\t\t\t"user":       "yuan",\r\n\t\t\t"state":      "\u5728\u7ebf",\r\n\t\t\t"booksSlice": []string{"\u91d1\u74f6\u6885", "\u804a\u658b", "\u526a\u706f\u65b0\u8bdd", "\u56fd\u8272\u5929\u9999"},\r\n\t\t\t"stuMap": map[string]interface{}{\r\n\t\t\t\t"name":  "rain",\r\n\t\t\t\t"age":   22,\r\n\t\t\t\t"hobby": []string{"\u8db3\u7403", "\u7bee\u7403", "\u53cc\u8272\u7403"},\r\n\t\t\t},\r\n\t\t\t"stuStruct": Student{Name: "yuan", Age: 22},\r\n\t\t})\r\n\t})\r\n\r\n\t// \u542f\u52a8:\u9ed8\u8ba4\u672c\u673a\u76848080\u7aef\u53e3\r\n\tr.Run()\r\n}\r\n\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u6a21\u677fhtml\u6587\u4ef6\uff1a"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-html",children:'<!DOCTYPE html>\r\n<html lang="en">\r\n<head>\r\n    <meta charset="UTF-8">\r\n    <title>Title</title>\r\n</head>\r\n<body>\r\n<h3>\u53d8\u91cf\u6e32\u67d3</h3>\r\n{{ . }}\r\n<p>{{.booksSlice}}</p>\r\n<p>{{index .booksSlice 0 }}</p>\r\n<p>{{index .booksSlice 1}}</p>\r\n<p>{{index .booksSlice 2}}</p>\r\n<p>{{.stuMap}}</p>\r\n<p>{{.stuMap.name}}</p>\r\n<p>{{.stuStruct}}</p>\r\n<p>{{.stuStruct.Name}}</p>\r\n\r\n</body>\r\n</html>\n'})}),"\n",(0,t.jsxs)(e.blockquote,{children:["\n",(0,t.jsx)(e.p,{children:"\u5207\u7247\u7684\u6df1\u5ea6\u67e5\u8be2\u4f9d\u9760\u5185\u7f6e\u51fd\u6570index\uff0cmap\u5bf9\u8c61\u548c\u7ed3\u6784\u4f53\u5bf9\u8c61\u7684\u6df1\u5ea6\u67e5\u8be2\u901a\u8fc7\u53e5\u70b9\u7b26\u5b9e\u73b0\uff01"}),"\n"]}),"\n",(0,t.jsx)(e.h2,{id:"42-\u63a7\u5236\u7ed3\u6784",children:"4.2 \u3001\u63a7\u5236\u7ed3\u6784"}),"\n",(0,t.jsx)(e.h4,{id:"1\u5206\u652f\u7ed3\u6784",children:"\uff081\uff09\u5206\u652f\u7ed3\u6784"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:"{{if  pipeline}} T1 {{end}}\r\n{{if  pipeline}} T1 {{else}} T0 {{end}}\r\n{{if  pipeline}} T1 {{else if pipeline}} T0 {{end}}\n"})}),"\n",(0,t.jsxs)(e.blockquote,{children:["\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsx)(e.li,{children:"if\u7c7b\u4f3c\u4e0eGo\u7684if\u8bed\u53e5\uff0c\u5b83\u4e5f\u5177\u6709\u5355\u5206\u2f40\uff0c\u591a\u5206\u2f40\u7b49\u591a\u79cd\u7ed3\u6784\uff0c\u4e0d\u540c\u7684\u662f\u9700\u8981\u4f7f\u2f64end\u5173\u952e\u5b57\u7ed3\u675f\u3002"}),"\n",(0,t.jsx)(e.li,{children:"\u8868\u8fbe\u5f0f\u4e3afalse\u7684\u60c5\u51b5\u662f\u5404\u79cd\u6570\u636e\u5bf9\u8c61\u76840\u503c\uff1a\u6570\u503c0\uff0c\u6307\u9488\u6216\u63a5\u53e3\u662fnil\uff0c\u6570\u7ec4\u3001slice\u3001map\u6216string\u5219\u662flen\u4e3a0\u3002"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-golang",children:"<h3>\u5206\u652f\u7ed3\u6784</h3>\r\n{{if gt .stuStruct.Age 18 }}\r\n<p>{{index .booksSlice 0 }}</p>\r\n<p>{{index .booksSlice 1}}</p>\r\n<p>{{index .booksSlice 2}}</p>\r\n<p>{{index .booksSlice 3}}</p>\r\n{{else}}\r\n<p>\u672a\u6210\u5e74\u533a</p>\r\n{{end}}\n"})}),"\n",(0,t.jsx)(e.h4,{id:"2\u5faa\u73af\u7ed3\u6784",children:"\uff082\uff09\u5faa\u73af\u7ed3\u6784"}),"\n",(0,t.jsxs)(e.blockquote,{children:["\n",(0,t.jsx)(e.p,{children:"\u8868\u8fbe\u5f0f\u4e3afalse\u7684\u60c5\u51b5\u662f\u5404\u79cd\u6570\u636e\u5bf9\u8c61\u76840\u503c\uff1a\u6570\u503c0\uff0c\u6307\u9488\u6216\u63a5\u53e3\u662fnil\uff0c\u6570\u7ec4\u3001slice\u3001map\u6216string\u5219\u662flen\u4e3a0\u3002"}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:"{{range $value := .}} {{end}}\r\n{{range $key,$value := .}} {{end}}\n"})}),"\n",(0,t.jsxs)(e.blockquote,{children:["\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsx)(e.li,{children:"\u5982\u679crange\u4e2d\u53ea\u8d4b\u503c\u7ed9\u4e00\u4e2a\u53d8\u91cf\uff0c\u5219\u8fd9\u4e2a\u53d8\u91cf\u662f\u5f53\u524d\u6b63\u5728\u8fed\u4ee3\u5143\u7d20\u7684\u503c\u3002\u5982\u679c\u8d4b\u503c\u7ed9\u4e24\u4e2a\u53d8\u91cf\uff0c\u5219\u7b2c\u4e00\u4e2a\u53d8\u91cf\u662f\u7d22\u5f15\u503c\uff0c\u7b2c\u4e8c\u4e2a\u53d8\u91cf\u662f\u5f53\u524d\u6b63\u5728\u8fed\u4ee3\u5143\u7d20\u7684\u503c\u3002"}),"\n",(0,t.jsxs)(e.li,{children:["\u53d8\u91cf\u540d\u4ee5",(0,t.jsx)(e.code,{children:"$"}),"\u5f00\u5934"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:"<h3>\u5faa\u73af\u7ed3\u6784</h3>\r\n<p>\u56db\u5927\u540d\u8457</p>\r\n{{range $index,$value := .booksSlice}}\r\n<p>{{$index}} : {{$value}} </p>\r\n{{end}}\r\n\r\n<p>stuMap\u5b66\u751f\u7684\u6240\u6709\u7231\u597d</p>\r\n{{range $index,$value := .stuMap.hobby}}\r\n<p>{{$index}} : {{$value}} </p>\r\n{{end}}\n"})}),"\n",(0,t.jsx)(e.h4,{id:"3\u53d8\u91cf\u8d4b\u503c",children:"\uff083\uff09\u53d8\u91cf\u8d4b\u503c"}),"\n",(0,t.jsx)(e.p,{children:"\u53ef\u4ee5\u5728template\u4e2d\u5b9a\u4e49\u53d8\u91cf\uff1a"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:"// \u672a\u5b9a\u4e49\u8fc7\u7684\u53d8\u91cf\r\n{{$var := pipeline}}\n"})}),"\n",(0,t.jsxs)(e.blockquote,{children:["\n",(0,t.jsx)(e.p,{children:". \u662f\u6709\u4f5c\u7528\u57df\u7684"}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-golang",children:'// \u5c55\u793a\u5e74\u9f84\u5927\u4e8erain\u7684\u6240\u6709\u5b66\u751f\r\n// "students": []Student{{Name: "yuan", Age: 22}, {Name: "alvin", Age: 16}, {Name: "eric", Age: 23}},\r\n\r\n// \u9519\u8bef\u5199\u6cd5\r\n{{range $index,$student := .students}}\r\n\r\n{{if gt $student.Age .stuMap.age }}   // \u6b64\u65f6\u7684.\u5df2\u7ecf\u4e0d\u662f\u5168\u5c40\u7684\u5bf9\u8c61\uff0c\u800c\u662f\u5f53\u524d\u904d\u5386\u7684$student\u5bf9\u8c61\r\n<p>{{$student.Name}},{{$student.Age}}</p>\r\n{{end}}\r\n\r\n{{end}}\r\n\r\n// \u6b63\u786e\u5199\u6cd5\r\n{{$rainAge := .stuMap.age}}\r\n{{range $index,$student := .students}}\r\n{{if gt $student.Age $rainAge }}\r\n<p>{{$student.Name}},{{$student.Age}}</p>\r\n{{end}}\r\n{{end}}\n'})}),"\n",(0,t.jsx)(e.h4,{id:"4\u6ce8\u91ca",children:"\uff084\uff09\u6ce8\u91ca"}),"\n",(0,t.jsx)(e.p,{children:"\u6ce8\u91ca\uff0c\u6267\u884c\u65f6\u4f1a\u5ffd\u7565\u3002\u53ef\u4ee5\u591a\u884c\u3002\u6ce8\u91ca\u4e0d\u80fd\u5d4c\u5957\uff0c\u5e76\u4e14\u5fc5\u987b\u7d27\u8d34\u5206\u754c\u7b26\u59cb\u6b62\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:"{{/* a comment */}}   \r\n\r\n> {/ \u4e00\u5b9a\u8981\u7d27\u8d34\r\n\n"})}),"\n",(0,t.jsx)(e.h2,{id:"43gin\u7684\u6a21\u677f\u51fd\u6570",children:"4.3\u3001Gin\u7684\u6a21\u677f\u51fd\u6570"}),"\n",(0,t.jsx)(e.h4,{id:"1\u9ed8\u8ba4\u6a21\u677f\u51fd\u6570",children:"\uff081\uff09\u9ed8\u8ba4\u6a21\u677f\u51fd\u6570"}),"\n",(0,t.jsx)(e.p,{children:"\u8bed\u6cd5\u683c\u5f0f\uff1a"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:"functionName [Argument...]\n"})}),"\n",(0,t.jsx)(e.p,{children:"Argument\u53c2\u6570\u662f\u53ef\u9009\u7684\uff0c\u5982\u679c\u6709\u591a\u4e2a\u53c2\u6570\uff0c\u53c2\u6570\u76f4\u63a5\u7528\u7a7a\u683c\u5206\u9694\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:"| \u51fd\u6570\u540d   | \u51fd\u6570\u8c03\u7528\u683c\u5f0f        | \u5bf9\u5e94\u5173\u7cfb\u8fd0\u7b97         | \u8bf4\u660e                                       |\r\n| :------- | :------------------ | :------------------- | :----------------------------------------- |\r\n| eq       | eq arg1 arg2        | arg1 == arg2         | arg1\u7b49\u4e8earg2\u5219\u8fd4\u56detrue                     |\r\n| ne       | ne arg1 arg2        | arg1 != arg2         | arg1\u4e0d\u7b49\u4e8earg2\u5219\u8fd4\u56detrue                   |\r\n| lt       | lt arg1 arg2        | arg1 < arg2          | arg1\u5c0f\u4e8earg2\u5219\u8fd4\u56detrue                     |\r\n| le       | le arg1 arg2        | arg1 <= arg2         | arg1\u5c0f\u4e8e\u7b49\u4e8earg2\u5219\u8fd4\u56detrue                 |\r\n| gt       | gt arg1 arg2        | arg1 > arg2          | arg1\u5927\u4e8earg2\u5219\u8fd4\u56detrue                     |\r\n| ge       | ge arg1 arg2        | arg1 >= arg2         | arg1\u5927\u4e8e\u7b49\u4e8earg2\u5219\u8fd4\u56detrue                 |\r\n| and      | and \u8868\u8fbe\u5f0f1 \u8868\u8fbe\u5f0f2 | \u8868\u8fbe\u5f0f1 && \u8868\u8fbe\u5f0f2   | \u8868\u8fbe\u5f0f1\u548c\u8868\u8fbe\u5f0f2\u90fd\u4e3a\u771f\u7684\u65f6\u5019\u8fd4\u56detrue       |\r\n| or       | or \u8868\u8fbe\u5f0f1 \u8868\u8fbe\u5f0f2  | \u8868\u8fbe\u5f0f1 \\|\\| \u8868\u8fbe\u5f0f2 | \u8868\u8fbe\u5f0f1\u548c\u8868\u8fbe\u5f0f2\u5176\u4e2d\u4e00\u4e2a\u4e3a\u771f\u7684\u65f6\u5019\u8fd4\u56detrue |\r\n| not      | not \u8868\u8fbe\u5f0f          | !\u8868\u8fbe\u5f0f              | \u8868\u8fbe\u5f0f\u4e3afalse\u5219\u8fd4\u56detrue, \u53cd\u4e4b\u8fd4\u56defalse     |\r\n| index    | index  arg \u7d22\u5f15/\u952e  | index x 2 \u5373x[2]     | \u6bcf\u4e2a\u88ab\u7d22\u5f15\u7684\u4e3b\u4f53\u5fc5\u987b\u662f\u6570\u7ec4\u3001\u5207\u7247\u6216\u8005\u5b57\u5178   |\r\n| len      | len arg             | len x \u5373x\u7684\u5143\u7d20\u4e2a\u6570  | \u7528\u4e8e\u8ba1\u7b97\u6570\u7ec4\u5927\u5c0f                           |\r\n| urlquery | urlquery arg        | urlquery url         | \u7528\u4e8eurl\u7f16\u7801                                |\n"})}),"\n",(0,t.jsx)(e.h4,{id:"2\u81ea\u5b9a\u4e49\u6a21\u677f\u51fd\u6570",children:"\uff082\uff09\u81ea\u5b9a\u4e49\u6a21\u677f\u51fd\u6570"}),"\n",(0,t.jsx)(e.p,{children:"\u89c6\u56fe\u90e8\u5206\uff1a"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:'func main() {\r\n\r\n\trouter := gin.Default()\r\n\trouter.SetFuncMap(template.FuncMap{\r\n\t\t"add": func(x, y int) int {\r\n\t\t\treturn x + y\r\n\t\t},\r\n\t})\r\n\t// \u8fd4\u56de\u4e00\u4e2ahtml\u9875\u9762\r\n\trouter.LoadHTMLGlob("templates/*")\r\n\trouter.GET("/index", index)\r\n\trouter.Run() // \u76d1\u542c\u5e76\u5728 0.0.0.0:8080 \u4e0a\u542f\u52a8\u670d\u52a1\r\n}\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u6a21\u677f\u90e8\u5206\uff1a"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:"{{add 2 3}}\n"})}),"\n",(0,t.jsx)(e.h2,{id:"44\u5d4c\u5957\u4e0e\u7ee7\u627f",children:"4.4\u3001\u5d4c\u5957\u4e0e\u7ee7\u627f"}),"\n",(0,t.jsxs)(e.p,{children:["Gin\u6846\u67b6\u9ed8\u8ba4\u90fd\u662f\u4f7f\u7528\u5355\u6a21\u677f\uff0c\u5982\u679c\u9700\u8981\u4f7f\u7528",(0,t.jsx)(e.code,{children:"block template"}),"\u529f\u80fd\uff0c\u53ef\u4ee5\u901a\u8fc7",(0,t.jsx)(e.code,{children:'"https://github.com/gin-contrib/multitemplate"'}),"\u5e93\u5b9e\u73b0"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-golang",children:'import (\r\n\t"github.com/gin-contrib/multitemplate"\r\n\t"github.com/gin-gonic/gin"\r\n)\n'})}),"\n",(0,t.jsx)(e.h4,{id:"1-\u5d4c\u5957define\u548ctemplate",children:"\uff081\uff09 \u5d4c\u5957\uff1adefine\u548ctemplate"}),"\n",(0,t.jsx)(e.p,{children:"\u5728\u5b9e\u9645\u9879\u76ee\u4e2d\uff0c\u6211\u4eec\u4e0d\u53ef\u80fd\u53ea\u6709\u4e00\u4e2a\u6a21\u677f\uff0c\u4e00\u822c\u6765\u8bf4\u90fd\u6709\u5f88\u591a\u4e2a\u6a21\u677f\uff0c\u800c\u4e14\u8fd9\u4e9b\u6a21\u677f\u4e5f\u4f1a\u5171\u4eab\u4e00\u4e9b\u516c\u5171\u7684\u6a21\u677f\uff0c\u8fd9\u4e9b\u516c\u5171\u7684\u6a21\u677f\u6211\u4eec\u90fd\u53ef\u4ee5\u5b9a\u4e49\u6210\u5b50\u6a21\u677f\uff0c\u5728\u9700\u8981\u7684\u65f6\u5019\u8c03\u7528\u5b50\u6a21\u677f\uff0c\u5c31\u53ef\u4ee5\u5c06\u5b50\u6a21\u677f\u7684\u5185\u5bb9\u5d4c\u5165\u5f53\u524d\u6a21\u677f\u4e2d\u3002"}),"\n",(0,t.jsxs)(e.blockquote,{children:["\n",(0,t.jsx)(e.p,{children:"\u63d0\u793a\uff1a\u5728\u9879\u76ee\u4e2d\u4f7f\u7528\u5b50\u6a21\u677f\uff0c\u53ef\u4ee5\u8ba9\u9879\u76ee\u6a21\u677f\u5177\u6709\u6a21\u5757\u5316\u7684\u80fd\u529b\uff0c\u63d0\u9ad8\u6a21\u5757\u590d\u7528\u80fd\u529b\u548c\u53ef\u7ef4\u62a4\u6027\u3002"}),"\n"]}),"\n",(0,t.jsx)(e.p,{children:"define\u53ef\u4ee5\u76f4\u63a5\u5728\u5f85\u89e3\u6790\u5185\u5bb9\u4e2d\u5b9a\u4e49\u4e00\u4e2a\u6a21\u677f,\u5b9a\u4e49\u4e86\u6a21\u677f\u4e4b\u540e\uff0c\u53ef\u4ee5\u4f7f\u7528template\u8fd9\u4e2aaction\u6765\u6267\u884c\u6a21\u677f\u3002template\u6709\u4e24\u79cd\u683c\u5f0f\uff1a"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:'{{template "name"}}\r\n{{template "name" pipeline}}\n'})}),"\n",(0,t.jsx)(e.p,{children:'\u7b2c\u4e00\u79cd\u662f\u76f4\u63a5\u6267\u884c\u540d\u4e3aname\u7684template\uff0c\u70b9\u8bbe\u7f6e\u4e3anil\u3002\u7b2c\u4e8c\u79cd\u662f\u70b9"."\u8bbe\u7f6e\u4e3apipeline\u7684\u503c\uff0c\u5e76\u6267\u884c\u540d\u4e3aname\u7684template\u3002\u53ef\u4ee5\u5c06template\u770b\u4f5c\u662f\u51fd\u6570\uff1a'}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:'template("name)\r\ntemplate("name",pipeline)\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u793a\u4f8b\uff1a\u5728t1\u9875\u9762\u4e2d\u548ct2\u9875\u9762\u4e2d\u5d4c\u5165\u4e00\u4e2a\u5e7f\u544a\u9875\u9762\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:'package main\r\n\r\nimport (\r\n\t"github.com/gin-contrib/multitemplate"\r\n\t"github.com/gin-gonic/gin"\r\n)\r\n\r\nfunc createMyRender() multitemplate.Renderer {\r\n\tr := multitemplate.NewRenderer()\r\n\tr.AddFromFiles("t1.html", "templates/t1.html", "templates/adv.html")\r\n\tr.AddFromFiles("t2.html", "templates/t2.html", "templates/adv.html")\r\n\treturn r\r\n}\r\n\r\nfunc main() {\r\n\t// \u57fa\u4e8e\u83b7\u53d6\u5f15\u64ce\u5bf9\u8c61\uff0c\u53ef\u4ee5\u7406\u89e3\u4e3a\u8def\u7531\u5bf9\u8c61\r\n\tr := gin.Default()\r\n\t// \u52a0\u8f7d\u6a21\u677f\u6587\u4ef6\r\n\t//r.LoadHTMLGlob("templates/*")\r\n\tr.HTMLRender = createMyRender()\r\n\r\n\tr.GET("/test01", func(context *gin.Context) {\r\n\t\tcontext.HTML(200, "t1.html", nil)\r\n\t})\r\n\tr.GET("/test02", func(context *gin.Context) {\r\n\t\tcontext.HTML(200, "t2.html", nil)\r\n\t})\r\n\r\n\t// \u542f\u52a8:\u9ed8\u8ba4\u672c\u673a\u76848080\u7aef\u53e3\r\n\tr.Run()\r\n}\r\n\n'})}),"\n",(0,t.jsx)(e.p,{children:"t1.html,t2.html"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-html",children:'<!DOCTYPE html>\r\n<html lang="en">\r\n\r\n<head>\r\n    <meta charset="utf-8">\r\n    <meta http-equiv="X-UA-Compatible" content="IE=9">\r\n    <title>Go Web Programming</title>\r\n</head>\r\n\r\n<body>\r\n\r\n<div>This is t1.html</div>\r\n{{ template "adv.html" }}\r\n\r\n</body>\r\n\r\n</html>\n'})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-html",children:'<!DOCTYPE html>\r\n<html lang="en">\r\n\r\n<head>\r\n    <meta charset="utf-8">\r\n    <meta http-equiv="X-UA-Compatible" content="IE=9">\r\n    <title>Go Web Programming</title>\r\n</head>\r\n\r\n<body>\r\n\r\n<div>This is t2.html</div>\r\n{{ template "adv.html" }}\r\n\r\n</body>\r\n\r\n</html>\n'})}),"\n",(0,t.jsx)(e.p,{children:"adv.html"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-html",children:'<div style="background-color: rebeccapurple;line-height: 200px;color: white;text-align: center">\r\n    \u8fd9\u662f\u4e00\u6761\u5e7f\u544a\u4fe1\u606f<br/>\r\n</div>\n'})}),"\n",(0,t.jsx)(e.h4,{id:"2\u7ee7\u627fblock\u5757",children:"\uff082\uff09\u7ee7\u627f\uff1ablock\u5757"}),"\n",(0,t.jsx)(e.p,{children:'\u6839\u636e\u5b98\u65b9\u6587\u6863\u7684\u89e3\u91ca\uff1ablock\u7b49\u4ef7\u4e8edefine\u5b9a\u4e49\u4e00\u4e2a\u6a21\u677f\uff0c\u5e76\u5728"\u6709\u9700\u8981"\u7684\u5730\u65b9\u6267\u884c\u8fd9\u4e2a\u6a21\u677f\uff0c\u6267\u884c\u65f6\u5c06"."\u8bbe\u7f6e\u4e3apipeline\u7684\u503c\u3002'}),"\n",(0,t.jsx)(e.p,{children:"\u4f46\u5e94\u8be5\u6ce8\u610f\uff0cblock\u7684\u7b2c\u4e00\u4e2a\u52a8\u4f5c\u662f\u6267\u884c\u540d\u4e3aname\u7684\u6a21\u677f\uff0c\u5982\u679c\u4e0d\u5b58\u5728\uff0c\u5219\u5728\u6b64\u5904\u81ea\u52a8\u5b9a\u4e49\u8fd9\u4e2a\u6a21\u677f\uff0c\u5e76\u6267\u884c\u8fd9\u4e2a\u4e34\u65f6\u5b9a\u4e49\u7684\u6a21\u677f\u3002\u6362\u53e5\u8bdd\u8bf4\uff0cblock\u53ef\u4ee5\u8ba4\u4e3a\u662f\u8bbe\u7f6e\u4e00\u4e2a\u9ed8\u8ba4\u6a21\u677f\u3002"}),"\n",(0,t.jsx)(e.p,{children:"\u4f8b\u5982\uff1a"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:'{{block "T1" .}} one {{end}}\n'})}),"\n",(0,t.jsxs)(e.p,{children:["\u5b83\u9996\u5148\u8868\u793a",(0,t.jsx)(e.code,{children:'{{template "T1" .}}'}),"\uff0c\u4e5f\u5c31\u662f\u8bf4\u5148\u627e\u5230T1\u6a21\u677f\uff0c\u5982\u679cT1\u5b58\u5728\uff0c\u5219\u6267\u884c\u627e\u5230\u7684T1\uff0c\u5982\u679c\u6ca1\u627e\u5230T1\uff0c\u5219\u4e34\u65f6\u5b9a\u4e49\u4e00\u4e2a",(0,t.jsx)(e.code,{children:'{{define "T1"}} one {{end}}'}),"\uff0c\u5e76\u6267\u884c\u5b83\u3002"]}),"\n",(0,t.jsx)(e.p,{children:'\u5728\u6b64\u6587\u4ef6\u4e2d\u6307\u5b9a\u4e86\u8981\u6267\u884c\u4e00\u4e2a\u540d\u4e3a"content"\u7684\u6a21\u677f\uff0c\u4f46\u6b64\u6587\u4ef6\u4e2d\u6ca1\u6709\u4f7f\u7528define\u5b9a\u4e49\u8be5\u6a21\u677f\uff0c\u6240\u4ee5\u9700\u8981\u5728\u5176\u5b83\u6587\u4ef6\u4e2d\u5b9a\u4e49\u540d\u4e3acontent\u7684\u6a21\u677f\u3002\u73b0\u5728\u5206\u522b\u5728\u4e24\u4e2a\u6587\u4ef6\u4e2d\u5b9a\u4e49\u4e24\u4e2acontent\u6a21\u677f\uff1a'}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:'{{ define "content" }}\r\n\r\n{{ end }}\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u5982\u679c\u4f7f\u7528block\uff0c\u90a3\u4e48\u53ef\u4ee5\u8bbe\u7f6e\u9ed8\u8ba4\u7684content\u6a21\u677f\u3002\u4f8b\u5982\u5c06\u539f\u672c\u5b9a\u4e49\u5728blue.html\u4e2d\u7684content\u8bbe\u7f6e\u4e3a\u9ed8\u8ba4\u6a21\u677f\u3002"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.a,{href:"https://www.cnblogs.com/f-ck-need-u/p/10035768.html",children:"\u6a21\u677f\u89e3\u6790\u539f\u7406"})}),"\n",(0,t.jsx)(e.h4,{id:"3\u7ee7\u627f\u6848\u4f8b",children:"\uff083\uff09\u7ee7\u627f\u6848\u4f8b"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/golang/assets/%E6%88%AA%E5%B1%8F2022-11-19%2021.31.18-8864689.png",alt:"\u622a\u5c4f2022-11-19 21.31.18"})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"base.html"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-jinja2",children:'...\r\n\r\n{{block "title" .}}\r\n<title>Theme Template for Bootstrap</title>\r\n{{end}}  \r\n\r\n...\r\n\r\n<div class="content">\r\n  {{block "content" .}}\r\n  {{end}}\r\n</div>\r\n\n'})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"student.html"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-jinja2",children:'{{template "base.html" .}}\r\n\r\n{{define "title"}}\r\n<title>\u5b66\u751f\u7ba1\u7406</title>\r\n{{end}}\r\n\r\n{{define "content"}}\r\n<h3>\u5b66\u751f\u7ba1\u7406</h3>\r\n{{end}}\n'})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"course.html"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-jinja2",children:'{{template "base.html" .}}\r\n\r\n{{define "title"}}\r\n<title>\u8bfe\u7a0b\u7ba1\u7406</title>\r\n{{end}}\r\n\r\n{{define "content"}}\r\n<h3>\u8bfe\u7a0b\u7ba1\u7406</h3>\r\n{{end}}\n'})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"class.html"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-jinja2",children:'{{template "base.html" .}}\r\n\r\n{{define "content"}}\r\n<h3>\u73ed\u7ea7\u7ba1\u7406</h3>\r\n{{end}}\r\n\r\n{{define "title"}}\r\n<title>\u73ed\u7ea7\u7ba1\u7406</title>\r\n{{end}}\n'})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"main.go"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:'package main\r\n\r\nimport (\r\n\t"github.com/gin-contrib/multitemplate"\r\n\t"github.com/gin-gonic/gin"\r\n\t"net/http"\r\n)\r\n\r\nfunc index(c *gin.Context) {\r\n\tc.HTML(http.StatusOK, "index", gin.H{})\r\n}\r\nfunc student(c *gin.Context) {\r\n\tc.HTML(http.StatusOK, "student", gin.H{})\r\n}\r\n\r\nfunc course(c *gin.Context) {\r\n\tc.HTML(http.StatusOK, "course", gin.H{})\r\n}\r\n\r\nfunc class(c *gin.Context) {\r\n\tc.HTML(http.StatusOK, "class", gin.H{})\r\n}\r\n\r\nfunc createMyRender() multitemplate.Renderer {\r\n\tr := multitemplate.NewRenderer()\r\n\tr.AddFromFiles("index", "templates/base.html", "templates/index.html")\r\n\tr.AddFromFiles("student", "templates/base.html", "templates/student.html")\r\n\tr.AddFromFiles("course", "templates/base.html", "templates/course.html")\r\n\tr.AddFromFiles("class", "templates/base.html", "templates/class.html")\r\n\r\n\treturn r\r\n}\r\n\r\nfunc main() {\r\n\r\n\trouter := gin.Default()\r\n\t// \u8fd4\u56de\u4e00\u4e2ahtml\u9875\u9762\r\n\t// router.LoadHTMLGlob("templates/*")  // \u7ee7\u627f\u4f1a\u53d1\u751fblock\u8986\u76d6\r\n\trouter.HTMLRender = createMyRender()\r\n\trouter.GET("/", index)\r\n\trouter.GET("/student", student)\r\n\trouter.GET("/course", course)\r\n\trouter.GET("/class", class)\r\n\trouter.Run() // \u76d1\u542c\u5e76\u5728 0.0.0.0:8080 \u4e0a\u542f\u52a8\u670d\u52a1\r\n}\r\n\n'})}),"\n",(0,t.jsx)(e.h1,{id:"\u4e94gorm",children:"\u4e94\u3001Gorm"}),"\n",(0,t.jsx)(e.h2,{id:"51gorm\u4ecb\u7ecd",children:"5.1\u3001gorm\u4ecb\u7ecd"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/golang/assets/image-20221103182526222-7471127.png",alt:"image-20221103182526222"})}),"\n",(0,t.jsx)(e.p,{children:"\u662f\u5f53\u4eca\u6bd4\u8f83\u70ed\u95e8\u7684 golang \u7684 orm \u64cd\u4f5c\u6570\u636e\u5e93\u7684\u5de5\u5177\uff0c\u4f7f\u7528\u4e0a\u4e3b\u8981\u662f\u628a struct \u7c7b\u548c\u6570\u636e\u5e93\u8868\u8fdb\u884c\u6620\u5c04\uff0c\u64cd\u4f5c\u6570\u636e\u5e93\u65f6\u65e0\u9700\u624b\u5199 sql\u3002\u672c\u8d28\u5c31\u662f\u63d0\u4f9b\u4e00\u7ec4\u51fd\u6570\u6765\u5e2e\u52a9\u6211\u4eec\u5feb\u901f\u62fc\u63a5 sql \u8bed\u53e5\uff0c\u5c3d\u91cf\u51cf\u5c11 sql \u7684\u7f16\u5199\u3002"}),"\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.a,{href:"https://gorm.io/",children:"gorm\u6587\u6863"}),"\u548c",(0,t.jsx)(e.a,{href:"https://www.kancloud.cn/sliver_horn/gorm/1861152",children:"gorm\u4e2d\u6587\u6587\u6863"})]}),"\n",(0,t.jsx)(e.p,{children:"\u5b89\u88c5\u5305\uff1a"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-golang",children:"go get -u gorm.io/gorm\r\ngo get -u gorm.io/driver/mysql\n"})}),"\n",(0,t.jsx)(e.h2,{id:"52\u8fde\u63a5\u6570\u636e\u5e93",children:"5.2\u3001\u8fde\u63a5\u6570\u636e\u5e93"}),"\n",(0,t.jsx)(e.h3,{id:"521\u8fde\u63a5\u6570\u636e\u5e93",children:"5.2.1\u3001\u8fde\u63a5\u6570\u636e\u5e93"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:'package main\r\n\r\nimport (\r\n\t"fmt"\r\n\t"gorm.io/driver/mysql"\r\n\t"gorm.io/gorm"\r\n)\r\n\r\nfunc main() {\r\n\t// \u53c2\u8003 https://github.com/go-sql-driver/mysql#dsn-data-source-name \u83b7\u53d6\u8be6\u60c5\r\n\tdsn := "user:pwd@tcp(127.0.0.1:3306)/database?charset=utf8mb4&parseTime=True&loc=Local"\r\n\tdb, err := gorm.Open(mysql.Open(dsn), &gorm.Config{})\r\n\tfmt.Println(db, err)\r\n}\n'})}),"\n",(0,t.jsx)(e.h3,{id:"522\u914d\u7f6e\u65e5\u5fd7\u8fde\u63a5",children:"5.2.2\u3001\u914d\u7f6e\u65e5\u5fd7\u8fde\u63a5"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-golang",children:'package main\r\n\r\nimport (\r\n\t"fmt"\r\n\t"gorm.io/driver/mysql"\r\n\t"gorm.io/gorm"\r\n\t"gorm.io/gorm/logger"\r\n\t"log"\r\n\t"os"\r\n)\r\n\r\nfunc main() {\r\n\t// \u53c2\u8003 https://github.com/go-sql-driver/mysql#dsn-data-source-name \u83b7\u53d6\u8be6\u60c5\r\n\tdsn := "root:yuan0316@tcp(127.0.0.1:3306)/go10?charset=utf8mb4&parseTime=True&loc=Local"\r\n\t// \u521b\u5efa\u65e5\u5fd7\u5bf9\u8c61\r\n\tnewLogger := logger.New(\r\n\t\tlog.New(os.Stdout, "\\r\\n", log.LstdFlags), // io writer\r\n\t\tlogger.Config{\r\n\t\t\t//SlowThreshold: time.Second,   // \u6162 SQL \u9608\u503c\r\n\t\t\tLogLevel: logger.Info, // Log level\r\n\t\t},\r\n\t)\r\n\r\n\tdb, err := gorm.Open(mysql.Open(dsn), &gorm.Config{\r\n\t\tLogger: newLogger, // \u65e5\u5fd7\u914d\u7f6e\r\n\t})\r\n\r\n\tif err != nil {\r\n\t\tpanic("failed to connect database")\r\n\t}\r\n\tfmt.Println(db)\r\n}\n'})}),"\n",(0,t.jsx)(e.h3,{id:"523\u6570\u636e\u5e93\u8fde\u63a5\u6c60",children:"5.2.3\u3001\u6570\u636e\u5e93\u8fde\u63a5\u6c60"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:'// \u5168\u5c40\u6570\u636e\u5e93 db\r\nvar db *gorm.DB\r\n\r\n// \u5305\u521d\u59cb\u5316\u51fd\u6570\uff0c\u53ef\u4ee5\u7528\u6765\u521d\u59cb\u5316 gorm\r\nfunc init() {\r\n  // \u914d\u7f6e dsn\r\n\r\n  // err\r\n  var err error\r\n  // \u8fde\u63a5 mysql \u83b7\u53d6 db \u5b9e\u4f8b\r\n  db, err = gorm.Open(mysql.Open(dsn), &gorm.Config{})\r\n  if err != nil {\r\n    panic("\u8fde\u63a5\u6570\u636e\u5e93\u5931\u8d25, error=" + err.Error())\r\n  }\r\n\r\n  // \u8bbe\u7f6e\u6570\u636e\u5e93\u8fde\u63a5\u6c60\u53c2\u6570\r\n  sqlDB, _ := db.DB()\r\n  // \u8bbe\u7f6e\u6570\u636e\u5e93\u8fde\u63a5\u6c60\u6700\u5927\u8fde\u63a5\u6570\r\n  sqlDB.SetMaxOpenConns(100)\r\n  // \u8fde\u63a5\u6c60\u6700\u5927\u5141\u8bb8\u7684\u7a7a\u95f2\u8fde\u63a5\u6570\uff0c\u5982\u679c\u6ca1\u6709sql\u4efb\u52a1\u9700\u8981\u6267\u884c\u7684\u8fde\u63a5\u6570\u5927\u4e8e20\uff0c\u8d85\u8fc7\u7684\u8fde\u63a5\u4f1a\u88ab\u8fde\u63a5\u6c60\u5173\u95ed\r\n  sqlDB.SetMaxIdleConns(20)\r\n}\r\n\r\n// \u83b7\u53d6 gorm db\uff0c\u5176\u4ed6\u5305\u8c03\u7528\u6b64\u65b9\u6cd5\u5373\u53ef\u62ff\u5230 db\r\n// \u65e0\u9700\u62c5\u5fc3\u4e0d\u540c\u534f\u7a0b\u5e76\u53d1\u65f6\u4f7f\u7528\u8fd9\u4e2a db \u5bf9\u8c61\u4f1a\u516c\u7528\u4e00\u4e2a\u8fde\u63a5\uff0c\u56e0\u4e3a db \u5728\u8c03\u7528\u5176\u65b9\u6cd5\u65f6\u5019\u4f1a\u4ece\u6570\u636e\u5e93\u8fde\u63a5\u6c60\u83b7\u53d6\u65b0\u7684\u8fde\u63a5\r\nfunc GetDB() *gorm.DB {\r\n  return db\r\n}\r\n\n'})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-golang",children:"func main() {\r\n  // \u83b7\u53d6 db\r\n  db := tools.GetDB()\r\n  // \u6267\u884c\u6570\u636e\u5e93\u67e5\u8be2\u64cd\u4f5c\r\n}\n"})}),"\n",(0,t.jsx)(e.h2,{id:"53\u6570\u636e\u5e93\u8868\u64cd\u4f5c",children:"5.3\u3001\u6570\u636e\u5e93\u8868\u64cd\u4f5c"}),"\n",(0,t.jsx)(e.h3,{id:"531\u6a21\u578b\u58f0\u660e",children:"5.3.1\u3001\u6a21\u578b\u58f0\u660e"}),"\n",(0,t.jsx)(e.p,{children:"\u6211\u4eec\u4ee5\u9009\u8bfe\u7cfb\u7edf\u4e3a\u4f8b\u5b50\uff1a"}),"\n",(0,t.jsxs)(e.blockquote,{children:["\n",(0,t.jsx)(e.p,{children:"\u5b66\u751f\u8868"}),"\n",(0,t.jsx)(e.p,{children:"\u8001\u5e08\u8868"}),"\n",(0,t.jsx)(e.p,{children:"\u73ed\u7ea7\u8868"}),"\n",(0,t.jsx)(e.p,{children:"\u8bfe\u7a0b\u8868"}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:'package main\r\n\r\nimport (\r\n\t"gorm.io/driver/mysql"\r\n\t"gorm.io/gorm"\r\n\t"gorm.io/gorm/logger"\r\n\t"log"\r\n\t"os"\r\n\t"time"\r\n)\r\n\r\ntype BaseModel struct {\r\n\tID         int       `gorm:"primaryKey"`\r\n\tCreateTime *time.Time `gorm:"autoCreateTime"`\r\n\tUpdateTime *time.Time `gorm:"autoCreateTime"`\r\n\tName       string     `gorm:"type:varchar(32);unique;not null"`\r\n}\r\n\r\n\r\ntype Teacher struct {\r\n\tBaseModel\r\n\tTno    int\r\n\tPwd    string `gorm:"type:varchar(100);not null"`\r\n\tTel    string `gorm:"type:char(11);"`\r\n\tBirth  *time.Time\r\n\tRemark string `gorm:"type:varchar(255);"`\r\n}\r\n\r\n\r\ntype Class struct {\r\n\tBaseModel\r\n\tNum     int\r\n\tTutorID int\r\n\tTutor   Teacher\r\n}\r\n\r\ntype Course struct {\r\n\tBaseModel\r\n\tCredit int\r\n\tPeriod int\r\n\r\n\t// \u591a\u5bf9\u4e00\r\n\tTeacherID int\r\n\tTeacher   Teacher\r\n}\r\n\r\ntype Student struct {\r\n\tBaseModel\r\n\tSno    int\r\n\tPwd    string `gorm:"type:varchar(100);not null"`\r\n\tTel    string `gorm:"type:char(11);"`\r\n\tGender byte   `gorm:"default:1"`\r\n\tBirth  *time.Time\r\n\tRemark string `gorm:"type:varchar(255);"`\r\n\r\n\t// \u591a\u5bf9\u4e00\r\n\tClassID int\r\n\tClass   Class `gorm:"foreignKey:ClassID"`\r\n\t// \u591a\u5bf9\u591a\r\n\tCourses []Course `gorm:"many2many:student2course;constraint:OnDelete:CASCADE;"`\r\n}\r\n\r\n\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u6ce8\u610f\u4e8b\u9879\uff1a"}),"\n",(0,t.jsxs)(e.blockquote,{children:["\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:["\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cGORM \u4f7f\u7528 ",(0,t.jsx)(e.code,{children:"ID"})," \u4f5c\u4e3a\u4e3b\u952e\uff0c\u4f7f\u7528\u7ed3\u6784\u4f53\u540d\u7684 ",(0,t.jsx)(e.code,{children:"\u86c7\u5f62\u590d\u6570"})," \u4f5c\u4e3a\u8868\u540d\uff0c\u5b57\u6bb5\u540d\u7684 ",(0,t.jsx)(e.code,{children:"\u86c7\u5f62"})," \u4f5c\u4e3a\u5217\u540d\uff0c\u5e76\u4f7f\u7528 ",(0,t.jsx)(e.code,{children:"CreatedAt"}),"\u3001",(0,t.jsx)(e.code,{children:"UpdatedAt"})," \u5b57\u6bb5\u8ffd\u8e2a\u521b\u5efa\u3001\u66f4\u65b0\u65f6\u95f4\u3002"]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"\u5355\u72ec\u8bbe\u7f6e\u8868\u540d\uff1a"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:'func (u User) TableName() string {\r\n  return "user"\r\n}\n'})}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:["GORM \u5b9a\u4e49\u4e00\u4e2a ",(0,t.jsx)(e.code,{children:"gorm.Model"})," \u7ed3\u6784\u4f53\uff0c\u5176\u5305\u62ec\u5b57\u6bb5 ",(0,t.jsx)(e.code,{children:"ID"}),"\u3001",(0,t.jsx)(e.code,{children:"CreatedAt"}),"\u3001",(0,t.jsx)(e.code,{children:"UpdatedAt"}),"\u3001",(0,t.jsx)(e.code,{children:"DeletedAt"})]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:'// gorm.Model \u7684\u5b9a\u4e49\r\ntype Model struct {\r\n  ID        uint           `gorm:"primaryKey"`\r\n  CreatedAt time.Time\r\n  UpdatedAt time.Time\r\n  DeletedAt gorm.DeletedAt `gorm:"index"`\r\n}\n'})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(e.h3,{id:"532\u6a21\u578b\u8fc1\u79fb",children:"5.3.2\u3001\u6a21\u578b\u8fc1\u79fb"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-golang",children:'func main() {\r\n\r\n\tdsn := "root:yuan0316@tcp(127.0.0.1:3306)/go10?charset=utf8mb4&parseTime=True&loc=Local"\r\n\t// \u521b\u5efa\u65e5\u5fd7\u5bf9\u8c61\r\n\tnewLogger := logger.New(\r\n\t\tlog.New(os.Stdout, "\\r\\n", log.LstdFlags), // io writer\r\n\t\tlogger.Config{\r\n\t\t\t// SlowThreshold: time.Second,   // \u6162 SQL \u9608\u503c\r\n\t\t\tLogLevel: logger.Info, // Log level\r\n\t\t},\r\n\t)\r\n\r\n\tdb, err := gorm.Open(mysql.Open(dsn), &gorm.Config{\r\n\t\tLogger: newLogger, // \u65e5\u5fd7\u914d\u7f6e\r\n\t})\r\n\r\n\tif err != nil {\r\n\t\tpanic("failed to connect database")\r\n\t}\r\n\r\n\t// \u81ea\u52a8\u8fc1\u79fb\r\n\tdb.AutoMigrate(&Teacher{})\r\n\tdb.AutoMigrate(&Course{})\r\n\tdb.AutoMigrate(&Class{})\r\n\tdb.AutoMigrate(&Student{})\r\n}\r\n\n'})}),"\n",(0,t.jsx)(e.p,{children:"AutoMigrate \u652f\u6301\u5efa\u8868\uff0c\u5982\u679c\u8868\u5b58\u5728\u5219\u4e0d\u4f1a\u518d\u521b\u5efa"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-haskell",children:'-- \u5efa\u8868\r\ndb.AutoMigrate(&Teacher{})\r\n-- \u5efa\u8868\r\ndb.Migrator().CreateTable(&Teacher{})\r\n-- \u5efa 3 \u8868\r\ndb.AutoMigrate(&Teacher{}, &Class{}, &Course{})\r\n-- \u53ef\u4ee5\u901a\u8fc7 Set \u8bbe\u7f6e\u9644\u52a0\u53c2\u6570\uff0c\u4e0b\u9762\u8bbe\u7f6e\u8868\u7684\u5b58\u50a8\u5f15\u64ce\u4e3a InnoDB\r\ndb.Set("gorm:table_options", "ENGINE=InnoDB").AutoMigrate(&Teacher{})\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u68c0\u6d4b\u8868\u5b58\u5728\uff1a"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-golang",children:'// \u68c0\u6d4bTeacher\u7ed3\u6784\u4f53\u5bf9\u5e94\u7684\u8868\u662f\u5426\u5b58\u5728\r\ndb.Migrator().HasTable(&Teacher{})\r\n// \u68c0\u6d4b\u8868\u540dteachers\u662f\u5426\u5b58\u5728\r\ndb.Migrator().HasTable("teachers")\n'})}),"\n",(0,t.jsx)(e.h3,{id:"533\u8868\u5b57\u6bb5\u64cd\u4f5c",children:"5.3.3\u3001\u8868\u5b57\u6bb5\u64cd\u4f5c"}),"\n",(0,t.jsx)(e.p,{children:"AutoMigrate\u4e0d\u652f\u6301\u5b57\u6bb5\u4fee\u6539\u5220\u9664\uff0c\u4e3a\u907f\u514d\u6570\u636e\u610f\u5916\u4e22\u5931."}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-haskell",children:'-- \u5220\u9664 Teacher \u7ed3\u6784\u4f53\u5bf9\u5e94\u7684\u8868\r\ndb.Migrator().DropTable(&Teacher{})\r\n-- \u4f9d\u636e\u8868\u540d\u5220\u9664\u8868\r\ndb.Migrator().DropTable("teachers")\r\n-- \u5220\u9664\u5b57\u6bb5\r\ndb.Migrator().DropColumn(&Teacher{}, "Name")\r\n-- \u4e3a\u5b57\u6bb5\u6dfb\u52a0\u7d22\u5f15\r\ndb.Migrator().CreateIndex(&Teacher{}, "Name")\r\n-- \u4fee\u6539\u7d22\u5f15\u540d\r\ndb.Migrator().RenameIndex(&Teacher{}, "Name", "Name2")\r\n-- \u4e3a\u5b57\u6bb5\u5220\u9664\u7d22\u5f15\r\ndb.Migrator().DropIndex(&Teacher{}, "Name")\r\n-- \u68c0\u67e5\u7d22\u5f15\u5b58\u5728\r\ndb.Migrator().HasIndex(&Teacher{}, "Name")\n'})}),"\n",(0,t.jsx)(e.h2,{id:"54\u6570\u636e\u5e93\u8868\u8bb0\u5f55\u64cd\u4f5c",children:"5.4\u3001\u6570\u636e\u5e93\u8868\u8bb0\u5f55\u64cd\u4f5c"}),"\n",(0,t.jsx)(e.p,{children:"\u8fd9\u662f\u91cd\u70b9"}),"\n",(0,t.jsx)(e.h3,{id:"541\u6dfb\u52a0\u8bb0\u5f55",children:"5.4.1\u3001\u6dfb\u52a0\u8bb0\u5f55"}),"\n",(0,t.jsx)(e.h4,{id:"1\u6dfb\u52a0\u5355\u8868\u8bb0\u5f55",children:"\uff081\uff09\u6dfb\u52a0\u5355\u8868\u8bb0\u5f55"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:'t1 := Teacher{BaseModel: BaseModel{Name: "yuan"}, Tno: 1001, Pwd: "123"}\r\ndb.Create(&t1)\r\nfmt.Println(t1.ID)\r\nt2 := Teacher{BaseModel: BaseModel{Name: "rain"}, Tno: 1002, Pwd: "234"}\r\ndb.Create(&t2)\r\nt3 := Teacher{BaseModel: BaseModel{Name: "eric"}, Tno: 1002, Pwd: "345"}\r\ndb.Create(&t3)\n'})}),"\n",(0,t.jsxs)(e.p,{children:["GORM \u5c06\u751f\u6210\u4e00\u6761 SQL \u8bed\u53e5\u6765\u63d2\u5165\u6570\u636e\u5e76",(0,t.jsx)(e.strong,{children:"\u56de\u586b\u4e3b\u952e\u503c"})]}),"\n",(0,t.jsxs)(e.blockquote,{children:["\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.code,{children:"db.Debug()"})," \u4f1a\u6253\u5370sql\u65e5\u5fd7"]}),"\n"]}),"\n",(0,t.jsx)(e.h4,{id:"2\u6279\u91cf\u6dfb\u52a0\u591a\u5bf9\u4e00\u5173\u8054\u8868\u7684\u8bb0\u5f55",children:"\uff082\uff09\u6279\u91cf\u6dfb\u52a0\u591a\u5bf9\u4e00\u5173\u8054\u8868\u7684\u8bb0\u5f55"}),"\n",(0,t.jsx)(e.p,{children:"\u8981\u6709\u6548\u5730\u63d2\u5165\u5927\u91cf\u8bb0\u5f55\uff0c\u8bf7\u5c06\u5207\u7247\u4f20\u9012\u7ed9\u8be5Create\u65b9\u6cd5\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-golang",children:'class01 := Class{BaseModel: BaseModel{Name: "\u8f6f\u4ef61\u73ed"}, TutorID: 1}\r\nclass02 := Class{BaseModel: BaseModel{Name: "\u8f6f\u4ef62\u73ed"}, TutorID: 1}\r\nclass03 := Class{BaseModel: BaseModel{Name: "\u8ba1\u7b97\u673a\u79d1\u5b66\u4e0e\u6280\u672f1\u73ed"}, TutorID: 2}\r\nclass04 := Class{BaseModel: BaseModel{Name: "\u8ba1\u7b97\u673a\u79d1\u5b66\u4e0e\u6280\u672f2\u73ed"}, TutorID: 2}\r\nclasses := []Class{class01, class02, class03, class04}\r\ndb.Create(&classes)\r\n\r\nfor _, class := range classes {\r\nfmt.Println(class.ID) // 1,2,3\r\n}\r\n\r\ncourse01 := Course{BaseModel: BaseModel{Name: "\u8ba1\u7b97\u673a\u7f51\u7edc"}, Credit: 3, Period: 16, TeacherID: 1}\r\ncourse02 := Course{BaseModel: BaseModel{Name: "\u6570\u636e\u7ed3\u6784"}, Credit: 2, Period: 24, TeacherID: 1}\r\ncourse03 := Course{BaseModel: BaseModel{Name: "\u6570\u636e\u5e93"}, Credit: 2, Period: 16, TeacherID: 2}\r\ncourse04 := Course{BaseModel: BaseModel{Name: "\u6570\u5b57\u7535\u8def"}, Credit: 3, Period: 12, TeacherID: 2}\r\ncourse05 := Course{BaseModel: BaseModel{Name: "\u6a21\u62df\u7535\u8def"}, Credit: 1, Period: 8, TeacherID: 2}\r\ncourses := []Course{course01, course02, course03, course04, course05}\r\ndb.Create(&courses)\n'})}),"\n",(0,t.jsxs)(e.blockquote,{children:["\n",(0,t.jsx)(e.p,{children:"\u6307\u5b9a\u6279\u91cf\u5927\u5c0f\uff1adb.CreateInBatches(users, 100 )"}),"\n"]}),"\n",(0,t.jsx)(e.h4,{id:"3\u6dfb\u52a0\u591a\u5bf9\u591a\u5173\u8054\u8868\u7684\u8bb0\u5f55",children:"\uff083\uff09\u6dfb\u52a0\u591a\u5bf9\u591a\u5173\u8054\u8868\u7684\u8bb0\u5f55"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-golang",children:'// \u7ed1\u5b9a\u8bfe\u7a0b\u5bf9\u8c61\u5207\u7247\r\nvar courses []Course\r\ndb.Where("name in ?", []string{"\u6570\u636e\u7ed3\u6784", "\u6570\u636e\u5e93"}).Find(&courses)\r\nfmt.Println("courses:", courses)\r\n\r\n// \u6dfb\u52a0\u5b66\u751f1\r\ns1 := Student{BaseModel: BaseModel{Name: "\u5f20\u4e09"}, Sno: 2001, Pwd: "123", ClassID: 1}\r\ndb.Create(&s1)\r\n\r\n// \u591a\u5bf9\u591a\u6dfb\u52a0\u65b9\u5f0f1\r\ns2 := Student{BaseModel: BaseModel{Name: "\u674e\u56db"},\r\n              Sno:     2002,\r\n              Pwd:     "234",\r\n              ClassID: 1,\r\n              Courses: courses,\r\n             }\r\ndb.Create(&s2)\r\n\r\n// \u591a\u5bf9\u591a\u6dfb\u52a0\u65b9\u5f0f2\r\ns3 := Student{BaseModel: BaseModel{Name: "\u738b\u4e94"}, Sno: 2003, Pwd: "234", ClassID: 1}\r\ndb.Create(&s3)\r\nfmt.Println("s3 id:", s3.ID)\r\ndb.Model(&s3).Association("Courses").Append(courses) // \u6ce8\u610f\uff1aCourses\u662f\u591a\u5bf9\u591a\u5173\u8054\u5b57\u6bb5\uff0c\u4e0d\u662f\u5173\u8054\u8868\r\n\r\n// \u5148\u67e5\u8be2\u518d\u64cd\u4f5c\u6dfb\u52a0\u65b9\u5f0f3\r\nvar student = Student{}\r\ndb.Where("name = ?", "\u738b\u4e94").First(&student)\r\nfmt.Println(student)\r\ndb.Model(&student).Association("Courses").Clear()\r\nvar courses []Course\r\ndb.Where("name in ?", []string{"\u6570\u5b57\u7535\u8def", "\u6a21\u62df\u7535\u8def"}).Find(&courses)\r\ndb.Model(&student).Association("Courses").Append(courses)\r\n\n'})}),"\n",(0,t.jsx)(e.h3,{id:"542\u5355\u8868\u67e5\u8be2",children:"5.4.2\u3001\u5355\u8868\u67e5\u8be2"}),"\n",(0,t.jsx)(e.p,{children:"gorm \u4f7f\u7528\u94fe\u5f0f\u51fd\u6570\u6765\u67e5\u8be2\u7684\u3002"}),"\n",(0,t.jsx)(e.h4,{id:"1-\u67e5\u8be2\u5168\u90e8\u8bb0\u5f55",children:"\uff081\uff09 \u67e5\u8be2\u5168\u90e8\u8bb0\u5f55"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:'// Find \u67e5\u8be2\u591a\u6761\u8bb0\u5f55\uff0c\u8fd4\u56de\u6570\u7ec4\r\n// select * from students;\r\nstudents := []Student{}  // \u4f7f\u7528Find\u8981\u58f0\u660e\u6570\u7ec4\uff0c\u5982\u679c\u58f0\u660e\u4e00\u4e2a\u5bf9\u8c61\uff08var s Student\uff09\uff0c\u5c31\u4f1a\u5c06\u7b2c\u4e00\u4e2a\u5bf9\u8c61\r\nresult := db.Find(&students)\r\nfmt.Println(result.RowsAffected)\r\nfmt.Println(students)\r\n\r\nfor _, student := range students {\r\n  fmt.Println(student.ID, student.Name, student.Sno)\r\n}\r\n\r\n/*   \r\n\r\n    students := []Student{} \r\n    db.Find(&students)\r\n     \r\n    (1) select * from students;\r\n    5,2022-11-29 16:53:23.823,2022-11-29 16:53:23.823,\u5f20\u4e09,2001,123,"",1,2022-11-15 00:00:00,"",1,1\r\n    6,2022-11-29 16:53:50.756,2022-11-29 16:53:50.756,\u674e\u56db,2002,123,"",1,2022-11-10 00:00:00,"",3,2\r\n    7,2022-11-29 16:54:11.471,2022-11-29 16:54:11.471,\u738b\u4e94,2003,123,"",1,2022-11-18 00:00:00,"",2,3\r\n\r\n    (2) \r\n    [\r\n\t\tStudent{\r\n\t\t\tBaseModel\uff1a\t\t{1 2022-11-03 17:59:02.188 +0800 CST 2022-11-03 17:59:02.188 +0800 CST \u5f20\u4e09}\r\n\t\t\tSno:\t\t\t\t   2001\r\n\t\t\tPwd:\t\t\t\t   123\r\n\t\t\tGender:\t\t\t\t   1\r\n\t\t\tBirth:\t\t\t\t <nil>\r\n\t\t\tClassID:\t\t\t\t 1\r\n\t\t\tClass\u5bf9\u8c61:\t\t\t{\r\n                        BaseModel: {0 <nil> <nil> }\r\n                        Num: 0\r\n                        TutorID: 0\r\n                        Tutor\u5bf9\u8c61: {{0 <nil> <nil> } 0 <nil>}\r\n                        students: []\r\n\t\t\t\t\t\t\t  \t\t }\r\n\t\t\tCourses:\t\t\t\t[]\r\n\r\n\t\t },\r\n\t\t ...\r\n\t\t ]\r\n*/\n'})}),"\n",(0,t.jsx)(e.h4,{id:"2\u67e5\u8be2\u5355\u6761\u8bb0\u5f55",children:"\uff082\uff09\u67e5\u8be2\u5355\u6761\u8bb0\u5f55"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-golang",children:"student := Student{}\r\n// Take \u67e5\u8be2\u4e00\u6761\u8bb0\u5f55\r\n// SELECT * FROM `user` LIMIT 1\r\ndb.Take(&student)\r\n\r\n// First \u6839\u636e\u4e3b\u952e id \u6392\u5e8f\u540e\u7684\u7b2c\u4e00\u6761\r\n// SELECT * FROM `user` ORDER BY `id` LIMIT 1\r\ndb.First(&student)\r\n\r\n// Last \u6839\u636e\u4e3b\u952e id \u6392\u5e8f\u540e\u6700\u540e\u4e00\u6761\r\n// SELECT * FROM `user` ORDER BY `id` DESC LIMIT 1\r\ndb.Last(&student)\r\n\r\n// Where \u8868\u793a\u6761\u4ef6\uff0c\u5176\u4e2d\u5199 sql \u90e8\u5206\r\n// SELECT * FROM `user` WHERE (id = '10') LIMIT 1\r\ndb.Where(\"id = ?\", 10).Take(&user)\n"})}),"\n",(0,t.jsx)(e.h4,{id:"3-where\u67e5\u8be2",children:"\uff083\uff09 Where\u67e5\u8be2"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"\u57fa\u4e8estring\u7684where\u8bed\u53e5"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-golang",children:'var student Student\r\ndb.Where("name = ?", "\u674e\u56db").First(&student)\r\nfmt.Println(student)\r\n\r\nvar students []Student\r\ndb.Where("Sno between ? and ?", 2001, 2003).Find(&students)\r\nfmt.Println(students)\r\n\r\nvar students []Student\r\ndb.Where("Sno in ?", []int64{2001, 2003}).Find(&students)\r\nfmt.Println(students)\r\n\r\nvar students []Student\r\ndb.Where("name like  ?", "\u674e%").Find(&students)\r\nfmt.Println(students)\r\n\r\nvar students []Student\r\ndb.Where("create_time >  ?", "2021-01-01 00:00:00").Find(&students)\r\nfmt.Println(students)\r\n\r\nvar students []Student\r\ndb.Where("create_time > ? AND create_time < ?", "2022-01-01 00:00:00", "2022-12-31 00:00:00").Find(&students)\r\nfmt.Println(students)\n'})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"\u57fa\u4e8eStruct & Map \u6761\u4ef6\u7684where\u8bed\u53e5"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-golang",children:'// Struct\u6761\u4ef6\r\nvar students []Student\r\ndb.Where(&Student{BaseModel: BaseModel{Name: "\u5f20\u4e09"}, Gender: 1}).Find(&students)\r\nfmt.Println(students)\r\n\r\n// \u6ce8\u610f: \u4f7f\u7528\u7ed3\u6784\u4f5c\u4e3a\u6761\u4ef6\u67e5\u8be2\u65f6\uff0cGORM \u53ea\u4f1a\u67e5\u8be2\u975e\u96f6\u503c\u5b57\u6bb5\u3002\u4f8b\u5982\uff1a\r\ndb.Where(&Student{BaseModel: BaseModel{Name: "\u5f20\u4e09"}, Gender: 0}).Find(&students)\r\nfmt.Println(students)\r\n// SELECT * FROM `students` WHERE `students`.`name` = \'\u5f20\u4e09\'\r\n\r\n// Map\u6761\u4ef6\r\ndb.Where(map[string]interface{}{"Name": "\u5f20\u4e09", "Gender": 0}).Find(&students)\r\nfmt.Println(students)\n'})}),"\n",(0,t.jsx)(e.h4,{id:"4\u5176\u4ed6\u67e5\u8be2\u8bed\u53e5",children:"\uff084\uff09\u5176\u4ed6\u67e5\u8be2\u8bed\u53e5"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-haskell",children:'-- Select\u8bed\u53e5 \u8868\u793a\u9009\u62e9\uff0c\u5176\u4e2d\u5199 sql \u90e8\u5206\r\n-- SELECT name,sno FROM `students` WHERE id = 10 LIMIT 1\r\nvar student Student\r\ndb.Select("name,sno").Where("id = ?", 10).Take(&student)\r\nlog.Println(student)\r\ndb.Omit("name", "sno").Find(&students)\r\nfmt.Println(students)\r\n\r\n-- Not\u8bed\u53e5  \r\nvar students []Student\r\ndb.Not("sno between ? and ?", 2001, 2002).Find(&students) --  Not\u8bed\u53e5:\u7528\u6cd5\u7c7b\u4f3c\u4e8eWhere\r\nfmt.Println(students)\r\n\r\n-- Or\u8bed\u53e5  \r\nvar students []Student\r\ndb.Where("sno = ?", 2001).Or("name like  ?", "\u738b%").Find(&students)\r\nfmt.Println(students)\r\n\r\n-- Order \u8868\u793a\u6392\u5e8f\u65b9\u5f0f\uff0c\u5176\u4e2d\u5199 sql \u90e8\u5206\r\n-- SELECT * FROM `students` WHERE create_time >= \'2018-11-06 00:00:00\' ORDER BY create_time desc,id\r\nvar students []Student\r\ndb.Where("create_time >= ?", "2018-11-06 00:00:00").Order("create_time desc,id").Find(&students)\r\nlog.Println(students)\r\n\r\n-- Limit Offset \u5206\u9875\u5e38\u7528\r\n--SELECT * FROM `students` ORDER BY create_time desc LIMIT 10 OFFSET 1\r\nvar students []Student\r\ndb.Order("create_time desc").Limit(10).Offset(1).Find(&students)\r\nlog.Println(students)\r\n\r\n-- Count \u8ba1\u7b97\u884c\u6570\r\n-- SELECT count(*) FROM `students`\r\nvar total int64\r\ndb.Model(&Student{}).Where("age >= ?", 18).Count(&total)\r\nfmt.Println(total)\r\n\r\n-- Group Having \u5206\u7ec4\u67e5\u8be2\uff0c\u5176\u4e2d\u5199 sql \u90e8\u5206,Group \u5fc5\u987b\u548c Select \u4e00\u8d77\u8fde\u7528\r\ntype Result struct {\r\n\t\tClassID int\r\n\t\tTotal   int\r\n\t}\r\nvar results []Result\r\n--  SELECT class_id, Count(*) as total FROM `students` GROUP BY `class_id` HAVING total>1\r\ndb.Model(Student{}).Select("class_id,Count(*) as total").Group("class_id").Having("total>0").Scan(&results)\r\nlog.Println(results)\r\n\n'})}),"\n",(0,t.jsxs)(e.p,{children:["\u5728GORM\u4e2d\uff0c",(0,t.jsx)(e.code,{children:"db.Model"}),"\u65b9\u6cd5\u63a5\u53d7\u4e00\u4e2a\u53c2\u6570\uff0c\u7528\u4e8e\u6307\u5b9a\u8981\u6267\u884c\u64cd\u4f5c\u7684\u6a21\u578b\u6216\u8868\u540d\u3002\u8fd9\u4e2a\u53c2\u6570\u53ef\u4ee5\u662f\u4e00\u4e2a\u5b9e\u4f8b\u6307\u9488\uff0c\u4e5f\u53ef\u4ee5\u662f\u4e00\u4e2a\u5b57\u7b26\u4e32\u3002\u5982\u679c\u4f60\u4f20\u9012\u4e00\u4e2a\u5b9e\u4f8b\u6307\u9488\u4f5c\u4e3a\u53c2\u6570\uff0c\u4f60\u53ef\u4ee5\u9009\u62e9\u662f\u5426\u8981\u5728\u6307\u9488\u524d\u9762\u52a0\u4e0a",(0,t.jsx)(e.code,{children:"&"}),"\u7b26\u53f7\u3002\u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u8fd9\u5e76\u4e0d\u4f1a\u4ea7\u751f\u660e\u663e\u7684\u533a\u522b\uff0c\u56e0\u4e3a\u6307\u9488\u672c\u8eab\u4e5f\u662f\u4e00\u4e2a\u5730\u5740\u3002"]}),"\n",(0,t.jsxs)(e.p,{children:["\u4f8b\u5982\uff0c\u5047\u8bbe\u4f60\u6709\u4e00\u4e2a\u540d\u4e3a",(0,t.jsx)(e.code,{children:"User"}),"\u7684\u6a21\u578b\uff0c\u5e76\u4e14\u4f60\u60f3\u67e5\u8be2\u6240\u6709\u7528\u6237\u8bb0\u5f55\u3002\u4f60\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u4ee3\u7801\uff1a"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:'var users []User\r\ndb.Model(&User{}).Find(&users)\r\nvar userDetails []UserDetails\r\ndb.Model("user_details").Find(&userDetails)\n'})}),"\n",(0,t.jsxs)(e.p,{children:["\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c",(0,t.jsx)(e.code,{children:"&User{}"}),"\u8868\u793a\u4e00\u4e2a",(0,t.jsx)(e.code,{children:"User"}),"\u7c7b\u578b\u7684\u5b9e\u4f8b\u6307\u9488\uff0c\u5b83\u88ab\u4f20\u9012\u7ed9\u4e86",(0,t.jsx)(e.code,{children:"db.Model"}),"\u65b9\u6cd5\u3002\u4f60\u53ef\u4ee5\u5728",(0,t.jsx)(e.code,{children:"&User{}"}),"\u524d\u9762\u52a0\u4e0a",(0,t.jsx)(e.code,{children:"&"}),"\u7b26\u53f7\uff0c\u4e5f\u53ef\u4ee5\u7701\u7565\u5b83\uff0c\u8fd9\u4e0d\u4f1a\u5f71\u54cd\u7ed3\u679c\u3002"]}),"\n",(0,t.jsx)(e.h3,{id:"543\u5220\u9664\u8bb0\u5f55",children:"5.4.3\u3001\u5220\u9664\u8bb0\u5f55"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:'// \u5220\u9664\u4e00\u6761\u8bb0\u5f55\r\nstudent := Student{BaseModel: BaseModel{ID: 3}}\r\ndb.Delete(&student)\r\n// \u6309\u6761\u4ef6\u5220\u9664\r\ndb.Where("sno between ? and ?", 2001, 2002).Delete(Student{})\r\n// \u5220\u9664\u6240\u6709\u8bb0\u5f55\r\ndb.Where("1 = 1").Delete(&Student{})\n'})}),"\n",(0,t.jsx)(e.h3,{id:"544\u66f4\u65b0\u8bb0\u5f55",children:"5.4.4\u3001\u66f4\u65b0\u8bb0\u5f55"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:'// Save \u66f4\u65b0\u67d0\u6761\u8bb0\u5f55\u7684\u6240\u6709\u5b57\u6bb5\r\nstu01 := Student{}\r\ndb.First(&stu01)\r\nstu01.Name = "\u5f20\u4e09\u4e09"\r\ndb.Save(&stu01)\r\n\r\n// Update \u57fa\u4e8e\u4e3b\u952e\u66f4\u65b0\u67d0\u6761\u8bb0\u5f55\u7684\u5355\u4e2a\u5b57\u6bb5\r\nstu02 := Student{BaseModel: BaseModel{ID: 1}}\r\ndb.Model(&stu02).Update("name", "\u5f20\u4e09")\r\n\r\n// Update \u8ddf\u65b0\u6240\u6709\u8bb0\u5f55\u7684\u5355\u4e2a\u5b57\u6bb5\r\ndb.Model(&Student{}).Update("price", 25)\r\n\r\n// Update \u81ea\u5b9a\u4e49\u6761\u4ef6\u800c\u975e\u4e3b\u952e\u8bb0\u5f55\u66f4\u65b0\u67d0\u5b57\u6bb5\r\ndb.Model(&Student{}).Where("create_time > ?", "2018-11-06 20:00:00").Update("price", 25)\r\n\r\n// Update \u66f4\u65b0\u591a\u4e2a\u5b57\u6bb5\r\n// \u901a\u8fc7 `struct` \u66f4\u65b0\u591a\u4e2a\u5b57\u6bb5\uff0c\u4e0d\u4f1a\u66f4\u65b0\u96f6\u503c\u5b57\u6bb5\r\ndb.Model(&Student{}).Where("id = ?", 2).Updates(Student{Sno: 2002, Gender: 0})\r\n// \u901a\u8fc7 `map` \u66f4\u65b0\u591a\u4e2a\u5b57\u6bb5\uff0c\u96f6\u503c\u5b57\u6bb5\u4e5f\u4f1a\u66f4\u65b0\r\ndb.Model(&Student{}).Where("id = ?", 2).Updates(map[string]interface{}{"gender": 1, "sno": 2002})\r\n\r\n// \u66f4\u65b0\u8868\u8fbe\u5f0f\r\nUpdate("stock", gorm.Expr("stock + 1"))\r\ndb.Model(&Class{}).Update("Num", gorm.Expr("Num+1"))\r\ndb.Model(&Student{}).Update("Pwd", gorm.Expr("Sno"))\n'})}),"\n",(0,t.jsx)(e.h3,{id:"545\u5173\u8054\u8868\u67e5\u8be2",children:"5.4.5\u3001\u5173\u8054\u8868\u67e5\u8be2"}),"\n",(0,t.jsx)(e.h4,{id:"1preload",children:"\uff081\uff09Preload"}),"\n",(0,t.jsxs)(e.p,{children:["\u5728GORM\u4e2d\uff0c",(0,t.jsx)(e.code,{children:"Preload"}),"\u65b9\u6cd5\u7528\u4e8e\u9884\u52a0\u8f7d\u5173\u8054\u7684\u6570\u636e\u3002\u9884\u52a0\u8f7d\u7684\u76ee\u7684\u662f\u5728\u51cf\u5c11\u6570\u636e\u5e93\u67e5\u8be2\u7684\u540c\u65f6\uff0c\u63d0\u9ad8\u67e5\u8be2\u6548\u7387\uff0c\u907f\u514d\u51fa\u73b0N+1\u67e5\u8be2\u95ee\u9898\u3002"]}),"\n",(0,t.jsxs)(e.p,{children:["\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u5728\u67e5\u8be2\u4e3b\u8981\u6a21\u578b\u7684\u540c\u65f6\uff0c\u5982\u679c\u4f60\u9700\u8981\u67e5\u8be2\u5173\u8054\u7684\u6570\u636e\uff0c\u53ef\u4ee5\u4f7f\u7528",(0,t.jsx)(e.code,{children:"Preload"}),"\u65b9\u6cd5\u6765\u4e00\u8d77\u67e5\u8be2\u3002\u4f8b\u5982\uff0c\u5047\u8bbe\u4f60\u6709\u4e00\u4e2a\u540d\u4e3a",(0,t.jsx)(e.code,{children:"User"}),"\u7684\u6a21\u578b\uff0c\u5b83\u4e0e",(0,t.jsx)(e.code,{children:"Address"}),"\u6a21\u578b\u5b58\u5728\u4e00\u5bf9\u591a\u5173\u7cfb\uff0c\u4e00\u4e2a\u7528\u6237\u53ef\u4ee5\u6709\u591a\u4e2a\u5730\u5740\u3002\u5982\u679c\u4f60\u60f3\u67e5\u8be2\u6240\u6709\u7528\u6237\u7684\u5730\u5740\u4fe1\u606f\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u4ee3\u7801\uff1a"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:'var users []User\r\ndb.Preload("Addresses").Find(&users)\n'})}),"\n",(0,t.jsxs)(e.p,{children:["\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u6211\u4eec\u4f7f\u7528",(0,t.jsx)(e.code,{children:'Preload("Addresses")'}),"\u65b9\u6cd5\u6765\u9884\u52a0\u8f7d",(0,t.jsx)(e.code,{children:"User"}),"\u6a21\u578b\u7684",(0,t.jsx)(e.code,{children:"Addresses"}),"\u5173\u8054\u3002\u8fd9\u5c06\u5728\u67e5\u8be2\u7528\u6237\u8bb0\u5f55\u7684\u540c\u65f6\uff0c\u4e00\u8d77\u67e5\u8be2\u5b83\u4eec\u7684\u5173\u8054\u5730\u5740\u8bb0\u5f55\u3002\u8fd9\u6837\u5c31\u53ef\u4ee5\u907f\u514d\u51fa\u73b0N+1\u67e5\u8be2\u95ee\u9898\uff0c\u63d0\u9ad8\u67e5\u8be2\u6548\u7387\u3002"]}),"\n",(0,t.jsxs)(e.p,{children:["\u4f60\u4e5f\u53ef\u4ee5\u5728",(0,t.jsx)(e.code,{children:"Preload"}),"\u65b9\u6cd5\u4e2d\u6307\u5b9a\u67e5\u8be2\u6761\u4ef6\uff0c\u4f8b\u5982\uff1a"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:'db.Preload("Addresses", "city = ?", "New York").Find(&users)\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u8fd9\u5c06\u53ea\u67e5\u8be2\u4f4d\u4e8e\u7ebd\u7ea6\u7684\u5730\u5740\u8bb0\u5f55\uff0c\u5e76\u5c06\u5b83\u4eec\u4e0e\u7528\u6237\u8bb0\u5f55\u4e00\u8d77\u8fd4\u56de\u3002"}),"\n",(0,t.jsxs)(e.p,{children:["\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c",(0,t.jsx)(e.code,{children:"Preload"}),"\u65b9\u6cd5\u53ea\u80fd\u9884\u52a0\u8f7d\u76f4\u63a5\u5173\u8054\u7684\u6570\u636e\uff0c\u4e0d\u80fd\u9884\u52a0\u8f7d\u95f4\u63a5\u5173\u8054\u7684\u6570\u636e\u3002\u5982\u679c\u4f60\u9700\u8981\u9884\u52a0\u8f7d\u591a\u5c42\u5173\u8054\u7684\u6570\u636e\uff0c\u5e94\u8be5\u4f7f\u7528",(0,t.jsx)(e.code,{children:"Preload"}),"\u65b9\u6cd5\u7684\u94fe\u5f0f\u8c03\u7528\u3002\u4f8b\u5982\uff1a"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:'db.Preload("Addresses").Preload("Addresses.City").Find(&users)\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u8fd9\u5c06\u9884\u52a0\u8f7d\u7528\u6237\u7684\u5730\u5740\u548c\u5730\u5740\u7684\u57ce\u5e02\u4fe1\u606f\uff0c\u5e76\u5c06\u5b83\u4eec\u4e00\u8d77\u8fd4\u56de\u3002"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"\u6848\u4f8b1\uff1a\u67e5\u8be2\u674e\u56db\u7684\u73ed\u7ea7\u7684\u540d\u79f0"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:'// \u624b\u52a8\u67e5\u8be2\r\ns := Student{}\r\ndb.Where("name = ?", "\u674e\u56db").Find(&s)\r\nfmt.Println(s)\r\nclass := Class{}\r\ndb.Where("id = ?", s.ClassID).Find(&class)\r\nfmt.Println(class.Name)\r\n\r\n// Preload \u9884\u52a0\u8f7d\r\ns := Student{}\r\ndb.Where("name = ?", "\u674e\u56db").Preload("Class").Find(&s)\r\n// SELECT * FROM `students` WHERE name = \'\u674e\u56db\'\r\n// SELECT * FROM `classes` WHERE `classes`.`id` = 1\r\nfmt.Println(s)\r\nfmt.Println(s.Sno)\r\nfmt.Println(s.Class.Name)\r\nfmt.Println(s.Courses)\n'})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"\u6848\u4f8b2\uff1a\u67e5\u8be2\u5f20\u4e09\u7684\u73ed\u7ea7\u548c\u6240\u9009\u8bfe\u7a0b"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:'s := Student{}\r\ndb.Where("name = ?", "\u674e\u56db").Preload("Class").Preload("Courses").Find(&s)\r\n// "gorm.io/gorm/clause"\r\n// db.Where("name = ?", "lisi").Preload(clause.Associations).Find(&s)\r\n\r\n// SELECT * FROM `students` WHERE name = \'\u674e\u56db\'\r\n// SELECT * FROM `classes` WHERE `classes`.`id` = 2\r\n// SELECT * FROM `student2course` WHERE `student2course`.`student_id` = 11\r\n// SELECT * FROM `courses` WHERE `courses`.`id` IN (2,3)\r\nfmt.Println(s)\r\nfmt.Println(s.Sno)\r\nfmt.Println(s.Class.Name)\r\nfmt.Println(s.Courses)\r\nfmt.Println(s.Courses[1])\r\n\r\n\r\n// \u9884\u52a0\u8f7d\u6240\u6709\u76f4\u63a5\u5173\u8054\r\ndb.Where("name = ?", "\u674e\u56db").Preload(clause.Associations).Find(&s)\r\n\r\n// \u67e5\u8be2\u5f20\u4e09\u7684\u73ed\u7ea7,\u73ed\u4e3b\u4efb\u548c\u6240\u9009\u8bfe\u7a0b\r\ndb.Where("name = ?", "\u674e\u56db").Preload("Class").Preload("Class.Teacher").Preload("Courses").Find(&s)\r\nfmt.Println(">>>", s.Class.Teacher.Name)\n'})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"\u6848\u4f8b3\uff1a\u67e5\u8be2\u8f6f\u4ef6\u4e00\u73ed\u6240\u6709\u5b66\u751f\u3010\u53cd\u5411\u67e5\u8be2\u3011"})}),"\n",(0,t.jsxs)(e.blockquote,{children:["\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:"// class\u8868\u6dfb\u52a0\u6210\u5458\u53d8\u91cf\uff1aStudents\r\ntype Class struct {\r\n   BaseModel\r\n   Num     int\r\n   TutorID int\r\n   Tutor   Teacher\r\n   // \u4e00\u5bf9\u591a\r\n   Students []Student    // \u53cd\u5411\u67e5\u8be2\u5b57\u6bb5\r\n}\n"})}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-golang",children:'class := Class{}\r\ndb.Where("name", "\u8f6f\u4ef61\u73ed").Preload("Students").Find(&class)\r\n// SELECT * FROM `classes` WHERE `name` = \'\u8f6f\u4ef61\u73ed\'\r\n// SELECT * FROM `students` WHERE `students`.`class_id` = 1\r\nfmt.Println(class)\r\nfmt.Println(class.Students)\r\nfor _, stu := range class.Students {\r\n    fmt.Println(stu.ID,stu.Name)\r\n}\n'})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"\u6848\u4f8b4\uff1a\u67e5\u8be2\u8f6f\u4ef6\u4e00\u73ed\u6240\u6709\u5b66\u751f\u4ee5\u53ca\u6240\u5b66\u8bfe\u7a0b\u3010\u5d4c\u5957\u9884\u52a0\u8f7d\u3011"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:'class := Class{}\r\ndb.Where("name", "\u8f6f\u4ef61\u73ed").Preload("Students.Courses").Find(&class)\r\nfmt.Println(class)\r\nfmt.Println(class.Students)\r\nfor _, stu := range class.Students {\r\n  fmt.Println(stu.ID, stu.Name, stu.Courses)\r\n}\n'})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"\u6848\u4f8b5\uff1a\u54ea\u4e9b\u5b66\u751f\u62a5\u4e86\u6570\u636e\u7ed3\u6784\u8bfe\u7a0b"})}),"\n",(0,t.jsxs)(e.blockquote,{children:["\n",(0,t.jsx)(e.p,{children:"// Course\u8868\u6dfb\u52a0\u6210\u5458\u53d8\u91cf\uff1aStudents"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-golang",children:'type Course struct {\r\n\tBaseModel\r\n\tCredit int8\r\n\tPeriod int8\r\n\r\n\t// \u591a\u5bf9\u4e00\r\n\tTeacherID int\r\n\tTeacher   Teacher\r\n\r\n\t// \u591a\u5bf9\u591a\r\n     Students []Student `gorm:"many2many:student2course;"`\r\n}\n'})}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-golang",children:'course := Course{}\r\ndb.Where("name", "\u6570\u636e\u7ed3\u6784").Preload("Students").Find(&course)\r\n// db.Where("name", "\u6570\u636e\u7ed3\u6784").Preload("Students.Courses").Find(&course)\r\nfmt.Println(course)\r\nfmt.Println(course.Students)\r\nfor _, stu := range course.Students {\r\n  fmt.Println(stu.ID, stu.Name, stu.Courses)\r\n}\n'})}),"\n",(0,t.jsx)(e.h4,{id:"2joins-\u67e5\u8be2",children:"\uff082\uff09Joins \u67e5\u8be2"}),"\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.code,{children:"Preload"})," \u5728\u4e00\u4e2a\u5355\u72ec\u67e5\u8be2\u4e2d\u52a0\u8f7d\u5173\u8054\u6570\u636e\u3002\u800c ",(0,t.jsx)(e.code,{children:"Join Preload"})," \u4f1a\u4f7f\u7528 inner join \u52a0\u8f7d\u5173\u8054\u6570\u636e"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-golang",children:'var students []Student\r\ndb.Preload("Courses").Joins("JOIN student2course ON students.id = student2course.student_id").\r\n  Joins("JOIN courses ON courses.id = student2course.course_id").\r\n  Joins("JOIN teachers ON courses.teacher_id = teachers.id").\r\n  Find(&students)\r\n\r\nfmt.Println(">>", students)\n'})}),"\n",(0,t.jsx)(e.h2,{id:"55\u7ae0\u8282\u4f5c\u4e1a",children:"5.5\u3001\u7ae0\u8282\u4f5c\u4e1a"}),"\n",(0,t.jsx)(e.p,{children:"\u5b66\u751f\u9009\u8bfe\u7cfb\u7edf"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/golang/assets/%E6%88%AA%E5%B1%8F2022-11-19%2018.44.41-8854690.png",alt:"\u622a\u5c4f2022-11-19 18.44.41"})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/golang/assets/%E6%88%AA%E5%B1%8F2022-11-19%2018.43.49.png",alt:"\u622a\u5c4f2022-11-19 18.43.49"})}),"\n",(0,t.jsx)(e.h1,{id:"\u4e03\u8fdb\u9636\u8bfe\u7a0b",children:"\u4e03\u3001\u8fdb\u9636\u8bfe\u7a0b"}),"\n",(0,t.jsx)(e.h2,{id:"71\u4f1a\u8bdd\u6280\u672f",children:"7.1\u3001\u4f1a\u8bdd\u6280\u672f"}),"\n",(0,t.jsx)(e.p,{children:"\u5927\u5bb6\u5728\u5b66\u4e60 HTTP \u8d85\u6587\u672c\u4f20\u8f93\u534f\u8bae\u7684\u65f6\u5019\uff0c\u5c31\u5df2\u7ecf\u77e5\u9053 HTTP \u662f\u4e00\u79cd\u65e0\u72b6\u6001\u7684\u4f20\u8f93\u534f\u8bae\uff0c\u5bf9\u4e8e\u4e8b\u52a1\u5904\u7406\u6ca1\u6709\u8bb0\u5fc6\u80fd\u529b\u3002\u5bf9\u4e8e\u5ba2\u6237\u7aef\u6d4f\u89c8\u5668\u53d1\u51fa\u7684\u8bf7\u6c42\uff0cWeb \u670d\u52a1\u5668\u65e0\u6cd5\u533a\u5206\u662f\u4e0d\u662f\u6e90\u81ea\u4e8e\u540c\u4e00\u4e2a\u6d4f\u89c8\u5668\u3002\u6240\u4ee5\uff0c\u8fd9\u65f6\u5c31\u9700\u8981\u989d\u5916\u7684\u6570\u636e\u7528\u4e8e\u7ef4\u6301\u4f1a\u8bdd\u3002"}),"\n",(0,t.jsx)(e.h3,{id:"711cookie",children:"7.1.1\u3001Cookie"}),"\n",(0,t.jsxs)(e.h4,{id:"1-cookie\u662f\u4ec0\u4e48",children:[(0,t.jsx)(e.strong,{children:"1."})," Cookie\u662f\u4ec0\u4e48"]}),"\n",(0,t.jsxs)(e.blockquote,{children:["\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"HTTP\u662f\u65e0\u72b6\u6001\u534f\u8bae\uff0c\u670d\u52a1\u5668\u4e0d\u80fd\u8bb0\u5f55\u6d4f\u89c8\u5668\u7684\u8bbf\u95ee\u72b6\u6001\uff0c\u4e5f\u5c31\u662f\u8bf4\u670d\u52a1\u5668\u4e0d\u80fd\u533a\u5206\u4e24\u6b21\u8bf7\u6c42\u662f\u5426\u7531\u540c\u4e00\u4e2a\u5ba2\u6237\u7aef\u53d1\u51fa"}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"Cookie\u5c31\u662f\u89e3\u51b3HTTP\u534f\u8bae\u65e0\u72b6\u6001\u7684\u65b9\u6848\u4e4b\u4e00\uff0c\u4e2d\u6587\u662f\u5c0f\u751c\u997c\u7684\u610f\u601d"}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"Cookie\u5b9e\u9645\u4e0a\u5c31\u662f\u670d\u52a1\u5668\u4fdd\u5b58\u5728\u6d4f\u89c8\u5668\u4e0a\u7684\u4e00\u6bb5\u4fe1\u606f\u3002\u6d4f\u89c8\u5668\u6709\u4e86Cookie\u4e4b\u540e\uff0c\u6bcf\u6b21\u5411\u670d\u52a1\u5668\u53d1\u9001\u8bf7\u6c42\u65f6\u90fd\u4f1a\u540c\u65f6\u5c06\u8be5\u4fe1\u606f\u53d1\u9001\u7ed9\u670d\u52a1\u5668\uff0c\u670d\u52a1\u5668\u6536\u5230\u8bf7\u6c42\u540e\uff0c\u5c31\u53ef\u4ee5\u6839\u636e\u8be5\u4fe1\u606f\u5904\u7406\u8bf7\u6c42"}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"Cookie\u7531\u670d\u52a1\u5668\u521b\u5efa\uff0c\u5e76\u53d1\u9001\u7ed9\u6d4f\u89c8\u5668\uff0c\u6700\u7ec8\u7531\u6d4f\u89c8\u5668\u4fdd\u5b58"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(e.h4,{id:"2-\u8bfb\u5199cookie",children:[(0,t.jsx)(e.strong,{children:"2."})," \u8bfb\u5199Cookie"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:'// \u8bbe\u7f6eCookie\r\nc.SetCookie("xxx","yyy")\r\n// \u83b7\u53d6Cookie\r\nc.Cookie("xxx")   // "yyy"\n'})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/golang/assets/image-20210829101115420.png",alt:"image-20210829101115420"})}),"\n",(0,t.jsx)(e.h4,{id:"1\u767b\u5f55\u6848\u4f8b",children:"\uff081\uff09\u767b\u5f55\u6848\u4f8b"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-golang",children:'package main\r\n\r\nimport (\r\n\t"github.com/gin-gonic/gin"\r\n\t"net/http"\r\n)\r\n\r\nfunc index(c *gin.Context) {\r\n\r\n\tisLogin, _ := c.Cookie("isLogin")\r\n\r\n\tif isLogin == "true" {\r\n\t\tuser, _ := c.Cookie("username")\r\n\t\tc.HTML(http.StatusOK, "index.html", gin.H{\r\n\t\t\t"username":user,\r\n\t\t})\r\n\t} else {\r\n\t\tc.Redirect(302, "/login")\r\n\t}\r\n}\r\n\r\nfunc login(c *gin.Context) {\r\n\tif c.Request.Method == "GET" {\r\n\t\tc.HTML(http.StatusOK, "login.html", nil)\r\n\t} else {\r\n\t\tuser := c.PostForm("user")\r\n\t\tpwd := c.PostForm("pwd")\r\n\t\tif user == "yuan" && pwd == "123" {\r\n\t\t\t// \u7ed9\u5ba2\u6237\u7aef\u8bbe\u7f6ecookie\r\n\t\t\t// maxAge int, \u5355\u4f4d s\r\n\t\t\t// path cookie  \u6240\u5728\u76ee\u5f55\r\n\t\t\t// domain string  \u57df\u540d\r\n\t\t\t// secure  \u662f\u5426\u53ea\u80fd\u901a\u8fc7https\u8bbf\u95ee\r\n\t\t\t// httponly bool  \u662f\u5426\u5141\u8bb8\u522b\u4eba\u901a\u8fc7js\u83b7\u53d6\u81ea\u5df1\u7684cookie\r\n\t\t\tc.SetCookie("isLogin", "true", 2000000, "/", "127.0.0.1", false, true)\r\n\t\t\tc.SetCookie("username", user, 20000000, "/", "127.0.0.1", false, true)\r\n\t\t\t//c.Redirect(302, "/index")\r\n\t\t\tc.Redirect(302, "/index")\r\n\t\t} else {\r\n\t\t\tc.Redirect(302, "/login")\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunc main() {\r\n\tr := gin.Default()\r\n\t// \u8fd4\u56de\u4e00\u4e2ahtml\u9875\u9762\r\n\tr.LoadHTMLGlob("templates/*")\r\n\tr.Any("/login", login)\r\n\tr.GET("/index", index)\r\n\tr.Run() // \u76d1\u542c\u5e76\u5728 0.0.0.0:8080 \u4e0a\u542f\u52a8\u670d\u52a1\r\n}\r\n\n'})}),"\n",(0,t.jsx)(e.h4,{id:"2\u6700\u540e\u8bbf\u95ee\u65f6\u95f4\u6848\u4f8b",children:"\uff082\uff09\u6700\u540e\u8bbf\u95ee\u65f6\u95f4\u6848\u4f8b"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:'package main\r\n\r\nimport (\r\n\t"fmt"\r\n\t"github.com/gin-gonic/gin"\r\n\t"time"\r\n)\r\n\r\nfunc index(c *gin.Context) {\r\n\r\n\t// \u83b7\u53d6cookie\r\n\tlastVist, _ := c.Cookie("lastVist")\r\n\tfmt.Println("lastVist",lastVist)\r\n\r\n\t// \u8bbe\u7f6ecookie\r\n\tnow := time.Now().String()[:19]\r\n\tc.SetCookie("lastVist", now, 100, "/", "127.0.0.1", false, true)\r\n\r\n\tc.HTML(200, "index.html", gin.H{\r\n\t\t"lastVist": lastVist,\r\n\t})\r\n\r\n}\r\n\r\nfunc main() {\r\n\tr := gin.Default()\r\n\t// \u8fd4\u56de\u4e00\u4e2ahtml\u9875\u9762\r\n\tr.LoadHTMLGlob("templates/*")\r\n\tr.GET("/index", index)\r\n\tr.Run() // \u76d1\u542c\u5e76\u5728 0.0.0.0:8080 \u4e0a\u542f\u52a8\u670d\u52a1\r\n}\r\n\n'})}),"\n",(0,t.jsx)(e.h3,{id:"712session",children:"7.1.2\u3001session"}),"\n",(0,t.jsx)(e.p,{children:"gin\u6846\u67b6\u5728\u5904\u7406session\u65f6\u6709\u4e13\u95e8\u7684\u4e2d\u95f4\u4ef6\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u3002"}),"\n",(0,t.jsxs)(e.p,{children:["\u4e2d\u95f4\u4ef6\uff1a ",(0,t.jsx)(e.code,{children:"github.com/gin-contrib/sessions"})," \uff0c \u6211\u4eec\u76f4\u63a5\u5b89\u88c5\u4f9d\u8d56\uff1a ",(0,t.jsx)(e.code,{children:"go get github.com/gin-contrib/sessions"})," \u5373\u53ef\u5f15\u5165\u4f7f\u7528"]}),"\n",(0,t.jsx)(e.p,{children:"\u6211\u4eec\u53c2\u8003\u5b98\u7f51\u6848\u4f8b\uff1a"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-golang",children:'package main\r\n\r\nimport (\r\n        // \u5bfc\u5165session\u5305\r\n\t"github.com/gin-contrib/sessions"\r\n       // \u5bfc\u5165session\u5b58\u50a8\u5f15\u64ce\r\n\t"github.com/gin-contrib/sessions/cookie"\r\n        // \u5bfc\u5165gin\u6846\u67b6\u5305\r\n\t"github.com/gin-gonic/gin"\r\n)\r\n\r\nfunc main() {\r\n\tr := gin.Default()\r\n\r\n        // \u521b\u5efa\u57fa\u4e8ecookie\u7684\u5b58\u50a8\u5f15\u64ce\uff0cyuan \u53c2\u6570\u662f\u7528\u4e8e\u52a0\u5bc6\u7684\u5bc6\u94a5\uff0c\u53ef\u4ee5\u968f\u4fbf\u586b\u5199\r\n\tstore := cookie.NewStore([]byte("yuan"))\r\n\r\n        // \u8bbe\u7f6esession\u4e2d\u95f4\u4ef6\uff0c\u53c2\u6570mysession\uff0c\u6307\u7684\u662fsession\u7684\u540d\u5b57\uff0c\u4e5f\u662fcookie\u7684\u540d\u5b57\r\n       // store\u662f\u524d\u9762\u521b\u5efa\u7684\u5b58\u50a8\u5f15\u64ce\r\n\tr.Use(sessions.Sessions("mysession", store))\r\n\r\n\tr.GET("/test", func(c *gin.Context) {\r\n                // \u521d\u59cb\u5316session\u5bf9\u8c61\r\n\t\tsession := sessions.Default(c)\r\n                \r\n                // \u901a\u8fc7session.Get\u8bfb\u53d6session\u503c\r\n                // session\u662f\u952e\u503c\u5bf9\u683c\u5f0f\u6570\u636e\uff0c\u56e0\u6b64\u9700\u8981\u901a\u8fc7key\u67e5\u8be2\u6570\u636e\r\n\r\n\t\tif session.Get("hello") != "world" {\r\n                        // \u8bbe\u7f6esession\u6570\u636e,()\r\n\t\t\t                  session.Set("hello", "world")\r\n                        // \u5220\u9664session\u6570\u636e\r\n                        session.Delete("tizi365")\r\n                        // \u5220\u9664\u6574\u4e2asession\r\n                        session.Clear()\r\n                        // \u4fdd\u5b58session\u6570\u636e\r\n\t\t                   \tsession.Save()\r\n\t\t}\r\n                \r\n\t\tc.JSON(200, gin.H{"hello": session.Get("hello")})\r\n\t})\r\n\tr.Run(":8000")\r\n  \r\n}\r\n\n'})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"\u4f7f\u7528sessions \u4e2d\u95f4\u4ef6\u6ce8\u610f\u8981\u70b9\uff1a"})}),"\n",(0,t.jsxs)(e.blockquote,{children:["\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsx)(e.li,{children:"session \u4ed3\u5e93\u5176\u5b9e\u5c31\u662f\u4e00\u4e2a map[interface]interface \u5bf9\u8c61\uff0c\u6240\u6709 session\u53ef\u4ee5\u5b58\u50a8\u4efb\u610f\u6570\u636e"}),"\n",(0,t.jsxs)(e.li,{children:["session \u4f7f\u7528\u7684\u7f16\u89e3\u7801\u5668\u662f\u81ea\u5e26\u7684gob\uff0c\u6240\u4ee5\u5b58\u50a8\u7c7b\u4f3c\uff1a struct\u3001map \u8fd9\u4e9b\u5bf9\u8c61\u65f6\u9700\u8981\u5148\u6ce8\u518c\u5bf9\u8c61\uff0c\u4e0d\u7136\u4f1a\u62a5\u9519 ",(0,t.jsx)(e.code,{children:"gob: type not registered for..."})]}),"\n",(0,t.jsx)(e.li,{children:"session \u5b58\u50a8\u5f15\u64ce\u652f\u6301\uff1a cookie\u3001\u5185\u5b58\u3001mongodb\u3001redis\u3001postgres\u3001memstore\u3001memcached \u4ee5\u53ca gorm \u652f\u6301\u7684\u5404\u7c7b\u6570\u636e\u5e93\uff08mysql\u3001sqlite\uff09"}),"\n",(0,t.jsx)(e.li,{children:"session \u5728\u521b\u5efa\u65f6\u6709\u4e00\u4e2a\u914d\u7f6e\u9879\uff0c\u53ef\u4ee5\u914d\u7f6esession\u8fc7\u671f\u65f6\u95f4\u3001cookie\u3001domain\u3001secure\u3001path\u7b49\u53c2\u6570"}),"\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.strong,{children:"\u8c03\u7528 session \u65b9\u6cd5\uff1a Set()\u3001 Delete()\u3001 Clear()\u3001\u65b9\u6cd5\u540e\uff0c\u5fc5\u987b\u8c03\u7528\u4e00\u6b21 Save() \u65b9\u6cd5\u3002\u5426\u5219session\u6570\u636e\u4e0d\u4f1a\u66f4\u65b0"})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"gob\u6ce8\u518c\u6848\u4f8b"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-haskell",children:"type User struct{\r\n  Name string\r\n}\r\n\r\ngob.Register(User{})\n"})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"session\u914d\u7f6e\u9879\u6848\u4f8b"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-yaml",children:'// store \u5c31\u662f\u524d\u9762\u521b\u5efa\u7684\u5b58\u50a8\u5f15\u64ce\r\nstore.Options(sessions.Options{\r\n\t\tSecure:   true,\r\n\t\tSameSite: 4,\r\n\t\tPath:     "/",\r\n\t\tMaxAge:   m.MaxAge,\r\n\t})\n'})}),"\n",(0,t.jsx)(e.p,{children:"Cookie\u548cSession\u7684\u533a\u522b"}),"\n",(0,t.jsxs)(e.blockquote,{children:["\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"Session\u5b58\u50a8\u6570\u636e\u5728\u670d\u52a1\u5668\u7aef\uff0cCookie\u5728\u5ba2\u6237\u7aef"}),"\n",(0,t.jsx)(e.li,{children:"Session\u6ca1\u6709\u6570\u636e\u5927\u5c0f\u9650\u5236\uff0cCookie\u6709"}),"\n",(0,t.jsx)(e.li,{children:"Session\u6570\u636e\u66f4\u5b89\u5168"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(e.h3,{id:"713\u57fa\u4e8esession\u7684\u767b\u5f55\u9a8c\u8bc1",children:"7.1.3\u3001\u57fa\u4e8esession\u7684\u767b\u5f55\u9a8c\u8bc1"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-golang",children:'func LoginHtml(context *gin.Context) {\r\n\tcontext.HTML(200, "login.html", nil)\r\n}\r\nfunc Login(context *gin.Context) {\r\n\t// \u83b7\u53d6\u767b\u9646\u4fe1\u606f\r\n\t//roleId := context.PostForm("role_id")\r\n\taccount := context.PostForm("user")\r\n\tpwd := context.PostForm("pwd")\r\n\t// \u6570\u636e\u5e93\u67e5\u8be2\r\n\tvar user User\r\n\tDB.Where("account = ? and pwd = ?", account, pwd).Find(&user)\r\n\r\n\tif user.ID != 0 {\r\n\t\tuserId := strconv.Itoa(user.ID)\r\n\t\t//  \u767b\u5f55\u6210\u529f\r\n\t\t// \u521d\u59cb\u5316session\u5bf9\u8c61\r\n\t\tsession := sessions.Default(context)\r\n\t\t// \u8bbe\u7f6esession\u6570\u636e,()\r\n\t\tsession.Set("user_id", userId)\r\n\t\tsession.Save()\r\n\r\n\t\tcontext.Redirect(http.StatusMovedPermanently, "/")\r\n\r\n\t} else {\r\n\t\t// \u767b\u5f55\u5931\u8d25\r\n\t\tcontext.HTML(200, "login.html", gin.H{\r\n\t\t\t"err": "\u7528\u6237\u540d\u6216\u8005\u5bc6\u7801\u9519\u8bef",\r\n\t\t})\r\n\r\n\t}\r\n}\r\n\r\nfunc Logout(context *gin.Context) {\r\n\r\n\t// \u521d\u59cb\u5316session\u5bf9\u8c61\r\n\tsession := sessions.Default(context)\r\n\t// \u8bbe\u7f6esession\u6570\u636e,()\r\n\tsession.Delete("user_id")\r\n\r\n\tcontext.Redirect(http.StatusMovedPermanently, "/login")\r\n\r\n}\r\n\n'})}),"\n",(0,t.jsx)(e.h2,{id:"72\u4e2d\u95f4\u4ef6",children:"7.2\u3001\u4e2d\u95f4\u4ef6"}),"\n",(0,t.jsx)(e.h3,{id:"721\u4e2d\u95f4\u4ef6\u8bed\u6cd5",children:"7.2.1\u3001\u4e2d\u95f4\u4ef6\u8bed\u6cd5"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-golang",children:'package main\r\n\r\nimport (\r\n\t"fmt"\r\n\t"github.com/gin-gonic/gin"\r\n)\r\n\r\nfunc main()  {\r\n  // \u9ed8\u8ba4\u4f7f\u7528\u4e862\u4e2a\u4e2d\u95f4\u4ef6Logger(), Recovery()\r\n\tapp := gin.Default()\r\n\t// \u5168\u5c40\u6ce8\u518c\u4e2d\u95f4\u4ef6\r\n\tapp.Use(M1())\r\n\tapp.Use(M2())\r\n\tapp.GET("/", func(context *gin.Context) {\r\n\t\tfmt.Println("Hello yuan")\r\n\t\tcontext.Writer.WriteString("Hello World")\r\n\t})\r\n\tapp.Run()\r\n}\r\n\r\nfunc M1() gin.HandlerFunc {\r\n\treturn func(context *gin.Context) {\r\n\t\t// \u8def\u7531\u5904\u7406\u524d\u6267\u884c\r\n\t\tfmt.Printf("M1\u89c6\u56fe\u51fd\u6570\u524d\u6267\u884c\\n")\r\n\t\t// context.Abort()\r\n\t\tcontext.Next()\r\n\t\t// \u8def\u7531\u5904\u7406\u540e\u6267\u884c\r\n\t\tfmt.Printf("M1\u89c6\u56fe\u51fd\u6570\u540e\u6267\u884c\\n")\r\n\t}\r\n}\r\n\r\nfunc M2() gin.HandlerFunc {\r\n\treturn func(context *gin.Context) {\r\n\t\t// \u8def\u7531\u5904\u7406\u524d\u6267\u884c\r\n\t\tfmt.Printf("M2\u89c6\u56fe\u51fd\u6570\u524d\u6267\u884c\\n")\r\n\t\tcontext.Next()\r\n\t\t// \u8def\u7531\u5904\u7406\u540e\u6267\u884c\r\n\t\tfmt.Printf("M2\u89c6\u56fe\u51fd\u6570\u540e\u6267\u884c\\n")\r\n\t}\r\n}\r\n\n'})}),"\n",(0,t.jsx)(e.h3,{id:"722\u4e2d\u95f4\u4ef6\u5e94\u7528\u4e00cors",children:"7.2.2\u3001\u4e2d\u95f4\u4ef6\u5e94\u7528\u4e00\uff1aCORS"}),"\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.code,{children:"gin.Default()"}),"\u9ed8\u8ba4\u4f7f\u7528\u4e86",(0,t.jsx)(e.code,{children:"Logger"}),"\u548c",(0,t.jsx)(e.code,{children:"Recovery"}),"\u4e2d\u95f4\u4ef6\uff0c\u5176\u4e2d\uff1a"]}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.code,{children:"Logger"}),"\u4e2d\u95f4\u4ef6\u5c06\u65e5\u5fd7\u5199\u5165",(0,t.jsx)(e.code,{children:"gin.DefaultWriter"}),"\uff0c\u5373\u4f7f\u914d\u7f6e\u4e86",(0,t.jsx)(e.code,{children:"GIN_MODE=release"}),"\u3002"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.code,{children:"Recovery"}),"\u4e2d\u95f4\u4ef6\u4f1arecover\u4efb\u4f55",(0,t.jsx)(e.code,{children:"panic"}),"\u3002\u5982\u679c\u6709panic\u7684\u8bdd\uff0c\u4f1a\u5199\u5165500\u54cd\u5e94\u7801\u3002"]}),"\n"]}),"\n",(0,t.jsxs)(e.p,{children:["\u5982\u679c\u4e0d\u60f3\u4f7f\u7528\u4e0a\u9762\u4e24\u4e2a\u9ed8\u8ba4\u7684\u4e2d\u95f4\u4ef6\uff0c\u53ef\u4ee5\u4f7f\u7528",(0,t.jsx)(e.code,{children:"gin.New()"}),"\u65b0\u5efa\u4e00\u4e2a\u6ca1\u6709\u4efb\u4f55\u9ed8\u8ba4\u4e2d\u95f4\u4ef6\u7684\u8def\u7531\u3002"]}),"\n",(0,t.jsxs)(e.p,{children:["\u6ce8\u610f\uff1a\u5f53\u5728\u4e2d\u95f4\u4ef6\u6216",(0,t.jsx)(e.code,{children:"handler"}),"\u4e2d\u542f\u52a8\u65b0\u7684",(0,t.jsx)(e.code,{children:"goroutine"}),"\u65f6\uff0c",(0,t.jsx)(e.strong,{children:"\u4e0d\u80fd\u4f7f\u7528"}),"\u539f\u59cb\u7684\u4e0a\u4e0b\u6587\uff08c *gin.Context\uff09\uff0c\u5fc5\u987b\u4f7f\u7528\u5176\u53ea\u8bfb\u526f\u672c\uff08",(0,t.jsx)(e.code,{children:"c.Copy()"}),"\uff09\u3002"]}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"\u8de8\u57df\u914d\u7f6e\u4e2d\u95f4\u4ef6"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-golang",children:'// \u5b9a\u4e49\u5168\u5c40\u7684CORS\u4e2d\u95f4\u4ef6\r\nfunc Cors() gin.HandlerFunc {\r\n    return func(c *gin.Context) {\r\n        c.Writer.Header().Add("Access-Control-Allow-Origin", "*")\r\n        c.Next()\r\n    }\r\n}\n'})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"\u8de8\u57df\u914d\u7f6e\u4e2d\u95f4\u4ef6\uff08\u9ad8\u7ea7\u8bf7\u6c42\u914d\u7f6e\uff09"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:'func(c *gin.Context) {\r\n\t\tmethod := c.Request.Method\r\n\t\torigin := c.GetHeader("Origin")\r\n\t\tc.Header("Access-Control-Allow-Origin", origin) // \u6ce8\u610f\u8fd9\u4e00\u884c\uff0c\u4e0d\u80fd\u914d\u7f6e\u4e3a\u901a\u914d\u7b26\u201c*\u201d\u53f7\r\n\t\tc.Header("Access-Control-Allow-Credentials", "true") // \u6ce8\u610f\u8fd9\u4e00\u884c\uff0c\u5fc5\u987b\u8bbe\u5b9a\u4e3a true\r\n\t\tc.Header("Access-Control-Allow-Headers", "Access-Control-Allow-Headers,Cookie, Origin, X-Requested-With, Content-Type, Accept, Authorization, Token, Timestamp, UserId") // \u6211\u4eec\u81ea\u5b9a\u4e49\u7684header\u5b57\u6bb5\u90fd\u9700\u8981\u5728\u8fd9\u91cc\u58f0\u660e\r\n\t\tc.Header("Access-Control-Allow-Methods", "POST, GET, OPTIONS,DELETE,PUT")\r\n\t\tc.Header("Access-Control-Expose-Headers", "Content-Length, Access-Control-Allow-Origin, Access-Control-Allow-Headers, Content-Type,cache-control")\r\n\r\n\t\t// \u653e\u884c\u6240\u6709OPTIONS\u65b9\u6cd5\r\n\t\tif method == "OPTIONS" {\r\n\t\t\t//c.AbortWithStatus(http.StatusNoContent)\r\n\t\t\tc.AbortWithStatus(http.StatusOK)\r\n\t\t}\r\n\t\t// \u5904\u7406\u8bf7\u6c42\r\n\t\tc.Next()\r\n\t}\n'})}),"\n",(0,t.jsx)(e.h3,{id:"723\u4e2d\u95f4\u4ef6\u5e94\u7528\u4e8c\u6743\u9650\u8bbf\u95ee\u63a7\u5236",children:"7.2.3\u3001\u4e2d\u95f4\u4ef6\u5e94\u7528\u4e8c\uff1a\u6743\u9650\u8bbf\u95ee\u63a7\u5236"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-golang",children:'package model\r\n\r\ntype User struct {\r\n\tID      int    `gorm:"primaryKey"`\r\n\tAccount string // \u8d26\u53f7\r\n\tPwd     string `gorm:"type:varchar(100);not null"`\r\n\r\n\t// \u591a\u5bf9\u4e00\r\n\tRoleID int\r\n\tRole   Role\r\n}\r\n\r\ntype Role struct {\r\n\tBaseModel\r\n\tPermissions []Permission `gorm:"many2many:role2permission;constraint:OnDelete:CASCADE;"`\r\n}\r\n\r\ntype Permission struct {\r\n\tBaseModel\r\n\tUrl string `gorm:"not null;"`\r\n}\r\n\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u6743\u9650\u8bbf\u95ee\u63a7\u5236\u4e2d\u95f4\u4ef6\uff1a"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-golang",children:'package middlewares\r\n\r\nimport (\r\n\t. "css/database"\r\n\t. "css/model"\r\n\t"fmt"\r\n\t"github.com/gin-contrib/sessions"\r\n\t"github.com/gin-gonic/gin"\r\n\t"gorm.io/gorm/clause"\r\n\t"net/http"\r\n\t"regexp"\r\n\t"strconv"\r\n\t"strings"\r\n)\r\n\r\nfunc PermissionMD() gin.HandlerFunc {\r\n\treturn func(context *gin.Context) {\r\n\r\n\t\t// 1. \u83b7\u53d6\u8bf7\u6c42\u8def\u5f84\r\n\t\tpath := context.Request.URL.Path\r\n\t\tfmt.Println("path:::", path)\r\n\t\t// 2. \u6821\u9a8c\u8def\u5f84\u662f\u5426\u5728\u767d\u540d\u5355\r\n\t\tvalidUrlSlice := []string{"/login", "/reg", "^/static/.*", "/logout"}\r\n\t\tfor _, validUrl := range validUrlSlice {\r\n\t\t\t// \u81ea\u7531\u8def\u5f84\r\n\t\t\tre := regexp.MustCompile(validUrl)\r\n\t\t\tret := re.FindAllStringSubmatch(path, -1)\r\n\t\t\tif len(ret) != 0 {\r\n\t\t\t\tcontext.Next()\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t}\r\n\t\t// 3. \u6821\u9a8c\u662f\u5426\u767b\u5f55\u6210\u529f\r\n\t\t// \u521d\u59cb\u5316session\u5bf9\u8c61\r\n\t\tsession := sessions.Default(context)\r\n\t\tuserID := session.Get("user_id")\r\n\t\tfmt.Println("userID::::::", userID)\r\n\t\tif userID == nil {\r\n\t\t\tcontext.Redirect(http.StatusMovedPermanently, "/login")\r\n\t\t\treturn\r\n\t\t}\r\n\t\t// 4. \u5224\u65ad\u767b\u5f55\u7528\u6237\u662f\u5426\u62e5\u6709\u8be5\u8def\u5f84\u6743\u9650\r\n\r\n\t\tvar user User\r\n\t\tDB.Where("ID = ?", userID).Preload("Role.Permissions").Find(&user)\r\n\t\tfmt.Println("user permissions:", user.Role.Permissions)\r\n\r\n\t\tif user.RoleID == 1 || user.RoleID == 2 {\r\n\t\t\tfmt.Println("in student role......")\r\n\t\t\t// \u767b\u5f55\u4eba\u662f\u5b66\u751f\r\n\t\t\t// \u5f53\u524d\u767b\u9646\u5b66\u751f\u7684\u5b66\u53f7\r\n\t\t\tvar student Student\r\n\t\t\tDB.Where("user_id = ?", user.ID).Preload(clause.Associations).Find(&student)\r\n\t\t\tsnoStr := strconv.Itoa(student.Sno)\r\n\t\t\t// \u6743\u9650\u5339\u914d\r\n\t\t\tfor _, permission := range user.Role.Permissions {\r\n\t\t\t\tpermissionUrlReg := strings.Replace(permission.Url, "\\\\d+", snoStr, -1)\r\n\t\t\t\tfmt.Println("permissionUrlReg", permissionUrlReg, path)\r\n\r\n\t\t\t\tre := regexp.MustCompile("^" + permissionUrlReg + "$")\r\n\t\t\t\tresults := re.FindAllStringSubmatch(path, -1)\r\n\r\n\t\t\t\tif len(results) != 0 {\r\n\t\t\t\t\t// \u62e5\u6709\u8be5\u8def\u5f84\u6743\u9650\u5e76\u653e\u884c\r\n\t\t\t\t\tcontext.Keys["loginUser"] = student\r\n\t\t\t\t\tcontext.Next()\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\t\t\tfmt.Println("in admin role......")\r\n\t\t\t// \u767b\u5f55\u4eba\u4e3a\u7ba1\u7406\u5458admin\r\n\t\t\tvar admin Admin\r\n\t\t\tDB.Where("user_id = ?", user.ID).Preload(clause.Associations).Find(&admin)\r\n\t\t\t// \u6b63\u5219\u5339\u914d\u6210\u529f\u5373\u53ef\r\n\t\t\tfor _, permission := range user.Role.Permissions {\r\n\t\t\t\tre := regexp.MustCompile("^" + permission.Url + "$")\r\n\t\t\t\tresults := re.FindAllStringSubmatch(path, -1)\r\n\r\n\t\t\t\tif len(results) != 0 {\r\n\t\t\t\t\tcontext.Keys["loginUser"] = admin\r\n\t\t\t\t\tcontext.Next()\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tcontext.String(http.StatusForbidden, "Forbidden!!!")\r\n\t\tcontext.Abort()\r\n\r\n\t}\r\n}\r\n\n'})}),"\n",(0,t.jsx)(e.h2,{id:"73validator",children:"7.3\u3001validator"}),"\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.code,{children:"go-playground/validator"}),"\u662f\u4e00\u4e2a\u7528\u4e8eGo\u8bed\u8a00\u7684\u6570\u636e\u9a8c\u8bc1\u5e93\uff0c\u53ef\u4ee5\u7528\u4e8e\u9a8c\u8bc1\u5404\u79cd\u6570\u636e\u7c7b\u578b\u7684\u5185\u5bb9\uff0c\u5305\u62ec\u7ed3\u6784\u4f53\u3001\u5207\u7247\u3001\u6570\u7ec4\u3001\u6620\u5c04\u3001\u5b57\u7b26\u4e32\u7b49\u7b49\u3002"]}),"\n",(0,t.jsx)(e.h3,{id:"\u5b89\u88c5",children:"\u5b89\u88c5"}),"\n",(0,t.jsxs)(e.p,{children:["\u60a8\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5728Go\u4e2d\u5b89\u88c5",(0,t.jsx)(e.code,{children:"go-playground/validator"}),"\uff1a"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"go get github.com/go-playground/validator/v10\n"})}),"\n",(0,t.jsx)(e.h3,{id:"\u57fa\u672c\u4f7f\u7528",children:"\u57fa\u672c\u4f7f\u7528"}),"\n",(0,t.jsxs)(e.p,{children:["\u4e0b\u9762\u662f\u4e00\u4e2a\u4f7f\u7528",(0,t.jsx)(e.code,{children:"go-playground/validator"}),"\u7684\u793a\u4f8b\uff1a"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:'package main\r\n\r\nimport (\r\n\t"fmt"\r\n\t"github.com/go-playground/validator/v10"\r\n)\r\n\r\ntype User struct {\r\n\tName  string `validate:"required"`\r\n  Age   int    `validate:"required,gte=18,lte=30"`\r\n\tEmail string `validate:"required,email"`\r\n}\r\n\r\nfunc main() {\r\n\tuser := &User{\r\n\t\tName:  "John Doe",\r\n    Age:   16,\r\n\t\tEmail: "johndoe@example.com",\r\n\t}\r\n\r\n\tvalidate := validator.New()\r\n\terr := validate.Struct(user)\r\n\tif err != nil {\r\n\t\t// Handle validation error\r\n\t\tfmt.Println(err)\r\n    // Handle validation error\r\n\t\tfor _, err := range err.(validator.ValidationErrors) {\r\n\t\t\tfmt.Printf("Field %s failed validation with error \'%s\'\\n", err.Field(), err.Tag())\r\n\t\t}\r\n\t}\r\n}\n'})}),"\n",(0,t.jsxs)(e.p,{children:["\u5728\u4e0a\u9762\u7684\u793a\u4f8b\u4e2d\uff0c\u6211\u4eec\u5b9a\u4e49\u4e86\u4e00\u4e2a\u540d\u4e3a",(0,t.jsx)(e.code,{children:"User"}),"\u7684\u7ed3\u6784\u4f53\uff0c\u8be5\u7ed3\u6784\u4f53\u5305\u542b\u4e24\u4e2a\u5b57\u6bb5",(0,t.jsx)(e.code,{children:"Name"}),"\u548c",(0,t.jsx)(e.code,{children:"Email"}),"\u3002",(0,t.jsx)(e.code,{children:"Name"}),"\u5b57\u6bb5\u4f7f\u7528",(0,t.jsx)(e.code,{children:"required"}),"\u6807\u8bb0\u6765\u786e\u4fdd\u5b83\u7684\u503c\u4e0d\u4e3a\u7a7a\uff0c",(0,t.jsx)(e.code,{children:"Email"}),"\u5b57\u6bb5\u4f7f\u7528",(0,t.jsx)(e.code,{children:"required"}),"\u548c",(0,t.jsx)(e.code,{children:"email"}),"\u6807\u8bb0\u6765\u786e\u4fdd\u5b83\u7684\u503c\u4e0d\u4e3a\u7a7a\u5e76\u4e14\u662f\u4e00\u4e2a\u6709\u6548\u7684\u7535\u5b50\u90ae\u4ef6\u5730\u5740\u3002"]}),"\n",(0,t.jsxs)(e.p,{children:["\u6211\u4eec\u4f7f\u7528",(0,t.jsx)(e.code,{children:"validator.New()"}),"\u521b\u5efa\u4e86\u4e00\u4e2a\u65b0\u7684\u9a8c\u8bc1\u5668\u5b9e\u4f8b\uff0c\u7136\u540e\u4f7f\u7528",(0,t.jsx)(e.code,{children:"validate.Struct()"}),"\u65b9\u6cd5\u5bf9",(0,t.jsx)(e.code,{children:"user"}),"\u8fdb\u884c\u9a8c\u8bc1\u3002\u5982\u679c\u9a8c\u8bc1\u5931\u8d25\uff0c",(0,t.jsx)(e.code,{children:"validate.Struct()"}),"\u65b9\u6cd5\u5c06\u8fd4\u56de\u4e00\u4e2a",(0,t.jsx)(e.code,{children:"validator.ValidationErrors"}),"\u7c7b\u578b\u7684\u9519\u8bef\uff0c\u5176\u4e2d\u5305\u542b\u6709\u5173\u9a8c\u8bc1\u5931\u8d25\u7684\u5b57\u6bb5\u4ee5\u53ca\u9519\u8bef\u6d88\u606f\u7684\u8be6\u7ec6\u4fe1\u606f\u3002"]}),"\n",(0,t.jsxs)(e.p,{children:["\u53ef\u4ee5\u5728\u4e0b\u9762\u7684\u793a\u4f8b\u4e2d\u627e\u5230\u66f4\u591a\u5173\u4e8e\u5982\u4f55\u4f7f\u7528",(0,t.jsx)(e.code,{children:"go-playground/validator"}),"\u7684\u4fe1\u606f\uff1a"]}),"\n",(0,t.jsx)(e.h3,{id:"\u81ea\u5b9a\u4e49\u9a8c\u8bc1\u5668",children:"\u81ea\u5b9a\u4e49\u9a8c\u8bc1\u5668"}),"\n",(0,t.jsxs)(e.p,{children:["\u53ef\u4ee5\u4f7f\u7528",(0,t.jsx)(e.code,{children:"go-playground/validator"}),"\u521b\u5efa\u81ea\u5b9a\u4e49\u9a8c\u8bc1\u5668\u6765\u9a8c\u8bc1\u4e0d\u540c\u7c7b\u578b\u7684\u6570\u636e\u3002\u4f8b\u5982\uff0c\u4ee5\u4e0b\u662f\u4e00\u4e2a\u4f7f\u7528\u81ea\u5b9a\u4e49\u9a8c\u8bc1\u5668\u9a8c\u8bc1URL\u7684\u793a\u4f8b\uff1a"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:'package main\r\n\r\nimport (\r\n\t"fmt"\r\n\t"github.com/go-playground/validator/v10"\r\n\t"net/url"\r\n)\r\n\r\nfunc validateURL(fl validator.FieldLevel) bool {\r\n\tvalue := fl.Field().String()\r\n\t_, err := url.ParseRequestURI(value)\r\n\treturn err == nil\r\n}\r\n\r\ntype User struct {\r\n\tName string `validate:"required"`\r\n\tURL  string `validate:"required,url"`\r\n}\r\n\r\nfunc main() {\r\n\tuser := &User{\r\n\t\tName: "John Doe",\r\n\t\tURL:  "invalid-url",\r\n\t}\r\n\r\n\tvalidate := validator.New()\r\n\tvalidate.RegisterValidation("url", validateURL)\r\n\r\n\terr := validate.Struct(user)\r\n\tif err != nil {\r\n\t\t// Handle validation error\r\n\t\tfor _, err := range err.(validator.ValidationErrors) {\r\n\t\t\tfmt.Printf("Field %s failed validation with error \'%s\'\\n", err.Field(), err.Tag())\r\n\t\t}\r\n\t}\r\n}\n'})}),"\n",(0,t.jsxs)(e.p,{children:["\u5728\u4e0a\u9762\u7684\u793a\u4f8b\u4e2d\uff0c\u6211\u4eec\u5b9a\u4e49\u4e86\u4e00\u4e2a\u540d\u4e3a",(0,t.jsx)(e.code,{children:"validateURL"}),"\u7684\u81ea\u5b9a\u4e49\u9a8c\u8bc1\u5668\u51fd\u6570\uff0c\u8be5\u51fd\u6570\u63a5\u53d7",(0,t.jsx)(e.code,{children:"validator.FieldLevel"}),"\u7c7b\u578b\u7684\u53c2\u6570\uff0c\u8be5\u53c2\u6570\u5305\u542b\u4e86\u6709\u5173\u6b63\u5728\u9a8c\u8bc1\u7684\u5b57\u6bb5\u7684\u4fe1\u606f\u3002\u5728\u6b64\u793a\u4f8b\u4e2d\uff0c\u6211\u4eec\u4f7f\u7528\u8be5\u51fd\u6570\u6765\u9a8c\u8bc1",(0,t.jsx)(e.code,{children:"URL"}),"\u5b57\u6bb5\u7684\u503c\u662f\u5426\u662f\u4e00\u4e2a\u6709\u6548\u7684URL\u3002\u6211\u4eec\u4f7f\u7528",(0,t.jsx)(e.code,{children:"validator.RegisterValidation()"}),"\u65b9\u6cd5\u5c06\u8be5\u81ea\u5b9a\u4e49\u9a8c\u8bc1\u5668\u6ce8\u518c\u4e3a",(0,t.jsx)(e.code,{children:"url"}),"\u6807\u8bb0\u7684\u503c\uff0c\u4ee5\u4fbf\u5728\u7ed3\u6784\u4f53\u4e0a\u4f7f\u7528\u3002"]}),"\n",(0,t.jsx)(e.h3,{id:"\u8de8\u5b57\u6bb5\u9a8c\u8bc1",children:"\u8de8\u5b57\u6bb5\u9a8c\u8bc1"}),"\n",(0,t.jsxs)(e.p,{children:["\u6709\u65f6\uff0c\u60a8\u53ef\u80fd\u9700\u8981\u9a8c\u8bc1\u591a\u4e2a\u5b57\u6bb5\u4e4b\u95f4\u7684\u5173\u7cfb\uff0c\u4f8b\u5982\uff0c\u786e\u4fdd\u4e24\u4e2a\u5b57\u6bb5\u7684\u503c\u76f8\u7b49\u3002",(0,t.jsx)(e.code,{children:"go-playground/validator"}),"\u5141\u8bb8\u60a8\u5b9a\u4e49\u8de8\u5b57\u6bb5\u9a8c\u8bc1\u5668\u6765\u9a8c\u8bc1\u591a\u4e2a\u5b57\u6bb5\u4e4b\u95f4\u7684\u5173\u7cfb\u3002\u4ee5\u4e0b\u662f\u4e00\u4e2a\u4f7f\u7528",(0,t.jsx)(e.code,{children:"eqfield"}),"\u6807\u8bb0\u9a8c\u8bc1\u4e24\u4e2a\u5b57\u6bb5\u503c\u76f8\u7b49\u7684\u793a\u4f8b\uff1a"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:'package main\r\n\r\nimport (\r\n\t"fmt"\r\n\t"github.com/go-playground/validator/v10"\r\n)\r\n\r\ntype User struct {\r\n\tPassword         string `validate:"required"`\r\n\tPasswordConfirm  string `validate:"required,eqfield=Password"`\r\n}\r\n\r\nfunc main() {\r\n\tuser := &User{\r\n\t\tPassword:        "password",\r\n\t\tPasswordConfirm: "wrong-password",\r\n\t}\r\n\r\n\tvalidate := validator.New()\r\n\terr := validate.Struct(user)\r\n\tif err != nil {\r\n\t\t// Handle validation error\r\n\t\tfor _, err := range err.(validator.ValidationErrors) {\r\n\t\t\tfmt.Printf("Field %s failed validation with error \'%s\'\\n", err.Field(), err.Tag())\r\n\t\t}\r\n\t}\r\n}\n'})}),"\n",(0,t.jsxs)(e.p,{children:["\u5728\u4e0a\u9762\u7684\u793a\u4f8b\u4e2d\uff0c\u6211\u4eec\u5b9a\u4e49\u4e86\u4e00\u4e2a\u540d\u4e3a",(0,t.jsx)(e.code,{children:"User"}),"\u7684\u7ed3\u6784\u4f53\uff0c\u5176\u4e2d\u5305\u542b\u4e24\u4e2a\u5b57\u6bb5",(0,t.jsx)(e.code,{children:"Password"}),"\u548c",(0,t.jsx)(e.code,{children:"PasswordConfirm"}),"\u3002",(0,t.jsx)(e.code,{children:"Password"}),"\u5b57\u6bb5\u4f7f\u7528",(0,t.jsx)(e.code,{children:"required"}),"\u6807\u8bb0\u6765\u786e\u4fdd\u5b83\u7684\u503c\u4e0d\u4e3a\u7a7a\uff0c",(0,t.jsx)(e.code,{children:"PasswordConfirm"}),"\u5b57\u6bb5\u4f7f\u7528",(0,t.jsx)(e.code,{children:"required"}),"\u548c",(0,t.jsx)(e.code,{children:"eqfield=Password"}),"\u6807\u8bb0\u6765\u786e\u4fdd\u5b83\u7684\u503c\u4e0d\u4e3a\u7a7a\u5e76\u4e14\u7b49\u4e8e",(0,t.jsx)(e.code,{children:"Password"}),"\u5b57\u6bb5\u7684\u503c\u3002"]}),"\n",(0,t.jsxs)(e.p,{children:["\u6211\u4eec\u4f7f\u7528",(0,t.jsx)(e.code,{children:"validator.Struct()"}),"\u65b9\u6cd5\u5bf9",(0,t.jsx)(e.code,{children:"user"}),"\u8fdb\u884c\u9a8c\u8bc1\uff0c\u5982\u679c\u9a8c\u8bc1\u5931\u8d25\uff0c\u6211\u4eec\u5c06\u904d\u5386\u9519\u8bef\u5217\u8868\u5e76\u8f93\u51fa\u6709\u5173\u9a8c\u8bc1\u5931\u8d25\u7684\u5b57\u6bb5\u4ee5\u53ca\u9519\u8bef\u6d88\u606f\u7684\u8be6\u7ec6\u4fe1\u606f\u3002"]}),"\n",(0,t.jsx)(e.h3,{id:"\u7ed3\u8bba",children:"\u7ed3\u8bba"}),"\n",(0,t.jsxs)(e.p,{children:["\u4ee5\u4e0a\u662f",(0,t.jsx)(e.code,{children:"go-playground/validator"}),"\u7684\u8be6\u7ec6\u6587\u6863\u548c\u793a\u4f8b\u4ee3\u7801\u3002",(0,t.jsx)(e.code,{children:"go-playground/validator"}),"\u662f\u4e00\u4e2a\u975e\u5e38\u5f3a\u5927\u548c\u7075\u6d3b\u7684\u6570\u636e\u9a8c\u8bc1\u5e93\uff0c\u53ef\u4ee5\u7528\u4e8e\u9a8c\u8bc1\u5404\u79cd\u6570\u636e\u7c7b\u578b\u7684\u5185\u5bb9\u3002\u5b83\u652f\u6301\u6807\u8bb0\u9a8c\u8bc1\u5668\u3001\u81ea\u5b9a\u4e49\u9a8c\u8bc1\u5668\u548c\u8de8\u5b57\u6bb5\u9a8c\u8bc1\u5668\u7b49\u529f\u80fd\uff0c\u53ef\u4ee5\u6ee1\u8db3\u60a8\u5728\u5b9e\u9645\u9879\u76ee\u5f00\u53d1\u4e2d\u7684\u9700\u6c42\u3002"]}),"\n",(0,t.jsx)(e.h2,{id:"74-ajax\u65b9\u6cd5",children:"7.4 \u3001Ajax\u65b9\u6cd5"}),"\n",(0,t.jsx)(e.h3,{id:"ajax\u4ecb\u7ecd",children:"Ajax\u4ecb\u7ecd"}),"\n",(0,t.jsx)(e.p,{children:"\u5ba2\u6237\u7aef\uff08\u6d4f\u89c8\u5668\uff09\u5411\u670d\u52a1\u7aef\u53d1\u8d77\u8bf7\u6c42\u7684\u5f62\u5f0f\uff1a"}),"\n",(0,t.jsxs)(e.blockquote,{children:["\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsx)(e.li,{children:"\u5730\u5740\u680f\uff1aGET"}),"\n",(0,t.jsx)(e.li,{children:"\u8d85\u94fe\u63a5\u6807\u7b7e\uff1aGET"}),"\n",(0,t.jsx)(e.li,{children:"form\u8868\u5355\uff1aGET\u6216POST"}),"\n",(0,t.jsx)(e.li,{children:"Ajax\uff08\u91cd\u8981\uff09\uff1aGET\u6216POST\u6216PUT\u6216DELETE"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(e.p,{children:"AJAX\uff08Asynchronous Javascript And XML\uff09\u7ffb\u8bd1\u6210\u4e2d\u6587\u5c31\u662f\u201c\u5f02\u6b65Javascript\u548cXML\u201d\u3002\u5373\u4f7f\u7528Javascript\u8bed\u8a00\u4e0e\u670d\u52a1\u5668\u8fdb\u884c\u5f02\u6b65\u4ea4\u4e92\uff0c\u4f20\u8f93\u7684\u6570\u636e\u4e3aXML\uff08\u5f53\u7136\uff0c\u4f20\u8f93\u7684\u6570\u636e\u4e0d\u53ea\u662fXML,\u73b0\u5728\u66f4\u591a\u4f7f\u7528json\u6570\u636e\uff09\u3002"}),"\n",(0,t.jsx)(e.p,{children:"AJAX\u7684\u7279\u70b9\u548c\u4f18\u70b9\uff1a"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"\u5f02\u6b65"}),"\n",(0,t.jsx)(e.li,{children:"\u5c40\u90e8\u5237\u65b0"}),"\n"]}),"\n",(0,t.jsx)(e.p,{children:"\u5e94\u7528\uff1a"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:"http://www.yuan316.com/post/Django3.2%E6%A1%86%E6%9E%B6/assets/image-20210812104733820.png",alt:"image-20210812104733820"})}),"\n",(0,t.jsx)(e.h3,{id:"axios\u6a21\u5757",children:"axios\u6a21\u5757"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:"axios({\r\n  method: 'get', // \u8bf7\u6c42\u65b9\u6cd5\u9ed8\u8ba4\u662fget\r\n  url: 'https://example.com/api', // \u8bf7\u6c42\u7684URL\r\n  params: { // GET\u8bf7\u6c42\u65f6\u7684\u53c2\u6570\r\n    id: 123,\r\n    name: 'example'\r\n  },\r\n  data: { // POST\u8bf7\u6c42\u65f6\u7684\u6570\u636e\r\n    id: 123,\r\n    name: 'example'\r\n  },\r\n  headers: { // \u8bf7\u6c42\u5934\r\n    'Content-Type': 'application/json'\r\n  },\r\n  responseType: 'json', // \u54cd\u5e94\u6570\u636e\u7684\u7c7b\u578b\r\n  timeout: 10000, // \u8d85\u65f6\u65f6\u95f4\r\n  withCredentials: true // \u662f\u5426\u643a\u5e26cookie\r\n})\r\n.then(function (response) { // \u54cd\u5e94\u6210\u529f\u56de\u8c03\r\n  console.log(response);\r\n})\r\n.catch(function (error) { // \u54cd\u5e94\u5931\u8d25\u56de\u8c03\r\n  console.log(error);\r\n});\n"})}),"\n",(0,t.jsx)(e.h3,{id:"\u5e94\u7528\u6848\u4f8b",children:"\u5e94\u7528\u6848\u4f8b"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-html",children:'<!DOCTYPE html>\r\n<html lang="en">\r\n<head>\r\n    <meta charset="UTF-8">\r\n    <title>Title</title>\r\n    <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/3.0.5/vue.global.js"><\/script>\r\n    <script src="https://cdn.staticfile.org/axios/0.18.0/axios.min.js"><\/script>\r\n    <style>\r\n        #app {\r\n            font-family: \'Helvetica Neue\', sans-serif;\r\n            font-size: 16px;\r\n            margin: 0 auto;\r\n            max-width: 800px;\r\n            padding: 50px 20px;\r\n        }\r\n\r\n        input[type=text] {\r\n            padding: 10px;\r\n            margin-right: 10px;\r\n            border-radius: 5px;\r\n            border: none;\r\n            box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);\r\n            font-size: 14px;\r\n            width: 200px;\r\n        }\r\n\r\n        button {\r\n            background-color: #369;\r\n            color: white;\r\n            padding: 10px 20px;\r\n            border: none;\r\n            border-radius: 5px;\r\n            cursor: pointer;\r\n            font-size: 14px;\r\n        }\r\n\r\n        table {\r\n            border-collapse: collapse;\r\n            width: 100%;\r\n            margin-top: 30px;\r\n        }\r\n\r\n        th {\r\n            background-color: #369;\r\n            color: white;\r\n            font-weight: bold;\r\n            text-align: center;\r\n            padding: 10px;\r\n        }\r\n\r\n        th,\r\n        td {\r\n            border: 1px solid #ddd;\r\n            padding: 10px;\r\n            text-align: center;\r\n        }\r\n\r\n        tr:nth-child(even) {\r\n            background-color: #f2f2f2;\r\n        }\r\n\r\n        tr:hover {\r\n            background-color: #e2e2e2;\r\n        }\r\n\r\n        td:nth-child(1) {\r\n            width: 25%;\r\n        }\r\n\r\n        td:nth-child(2) {\r\n            width: 25%;\r\n        }\r\n\r\n        td:nth-child(3) {\r\n            width: 25%;\r\n        }\r\n\r\n        td:nth-child(4) {\r\n            width: 25%;\r\n        }\r\n    </style>\r\n\r\n</head>\r\n<body>\r\n\r\n<div id="app">\r\n    <div>\r\n        <p><input type="text" v-model="city">\r\n            <button @click="get_weather">\u83b7\u53d6\u5929\u6c14</button>\r\n        </p>\r\n        <table v-if="weather_list.length>1">\r\n            <tr>\r\n                <th>\u65e5\u671f</th>\r\n                <th>\u5929\u6c14</th>\r\n                <th>\u6e29\u5ea6</th>\r\n                <th>\u98ce\u5411</th>\r\n            </tr>\r\n            <tr v-for="weather in weather_list">\r\n                <td>{{weather.day}}</td>\r\n                <td>{{weather.wea_day}}</td>\r\n                <td>{{weather.tem2}}-{{weather.tem1}}</td>\r\n                <td>{{weather.air_level}}</td>\r\n            </tr>\r\n        </table>\r\n    </div>\r\n</div>\r\n\r\n<script>\r\n\r\n    vm = Vue.createApp({\r\n        data() {\r\n            return {\r\n                city: "\u5317\u4eac",\r\n                weather_list: [],\r\n            }\r\n        },\r\n        methods: {\r\n            get_weather() {\r\n                // \u53d1\u9001http\u8bf7\u6c42\u83b7\u53d6\u5929\u6c14\r\n                axios.get("https://v0.yiketianqi.com/api?unescape=1&version=v9&appid=47284135&appsecret=jlmX3A6s", {\r\n                    params: {\r\n                        city: this.city,\r\n                    }\r\n                }).then(response => {\r\n                    console.log(response.data.data);\r\n                    this.weather_list = response.data.data;\r\n                }).catch(error => {\r\n                    console.log(error);\r\n                })\r\n            }\r\n        },\r\n        created(){\r\n            this.get_weather()\r\n        }\r\n\r\n    }).mount(\'#app\')\r\n<\/script>\r\n\r\n</body>\r\n</html><!DOCTYPE html>\r\n\n'})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/golang/assets/image-20230723133607017-0090568.png",alt:"image-20230723133607017"})}),"\n",(0,t.jsx)(e.h1,{id:"\u516b\u524d\u540e\u7aef\u5206\u79bb",children:"\u516b\u3001\u524d\u540e\u7aef\u5206\u79bb"}),"\n",(0,t.jsx)(e.h2,{id:"81web\u5e94\u7528\u6a21\u5f0f",children:"8.1\u3001web\u5e94\u7528\u6a21\u5f0f"}),"\n",(0,t.jsx)(e.p,{children:"\u5728\u5f00\u53d1Web\u5e94\u7528\u4e2d\uff0c\u6709\u4e24\u79cd\u5e94\u7528\u6a21\u5f0f\uff1a"}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsx)(e.li,{children:"\u524d\u540e\u7aef\u4e0d\u5206\u79bb[\u5ba2\u6237\u7aef\u770b\u5230\u7684\u5185\u5bb9\u548c\u6240\u6709\u754c\u9762\u6548\u679c\u90fd\u662f\u7531\u670d\u52a1\u7aef\u63d0\u4f9b\u51fa\u6765\u7684\u3002]"}),"\n"]}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/golang/assets/depended_frontend_backend.png",alt:"\u524d\u540e\u7aef\u4e0d\u5206\u79bb"})}),"\n",(0,t.jsxs)(e.ol,{start:"2",children:["\n",(0,t.jsx)(e.li,{children:"\u524d\u540e\u7aef\u5206\u79bb\u3010\u628a\u524d\u7aef\u7684\u754c\u9762\u6548\u679c(html\uff0ccss\uff0cjs\u5206\u79bb\u5230\u53e6\u4e00\u4e2a\u670d\u52a1\u7aef\uff0cpython\u670d\u52a1\u7aef\u53ea\u9700\u8981\u8fd4\u56de\u6570\u636e\u5373\u53ef)\u3011"}),"\n"]}),"\n",(0,t.jsx)(e.p,{children:"\u524d\u7aef\u5f62\u6210\u4e00\u4e2a\u72ec\u7acb\u7684\u7f51\u7ad9\uff0c\u670d\u52a1\u7aef\u6784\u6210\u4e00\u4e2a\u72ec\u7acb\u7684\u7f51\u7ad9"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/golang/assets/indepent_frontend_backend-16318493319127.png",alt:"\u524d\u540e\u7aef\u5206\u79bb"})}),"\n",(0,t.jsx)(e.p,{children:"\u5e94\u7528\u7a0b\u5e8f\u7f16\u7a0b\u63a5\u53e3\uff08Application Programming Interface\uff0cAPI\u63a5\u53e3\uff09\uff0c\u5c31\u662f\u5e94\u7528\u7a0b\u5e8f\u5bf9\u5916\u63d0\u4f9b\u4e86\u4e00\u4e2a\u64cd\u4f5c\u6570\u636e\u7684\u5165\u53e3\uff0c\u8fd9\u4e2a\u5165\u53e3\u53ef\u4ee5\u662f\u4e00\u4e2a\u51fd\u6570\u6216\u7c7b\u65b9\u6cd5\uff0c\u4e5f\u53ef\u4ee5\u662f\u4e00\u4e2aurl\u5730\u5740\u6216\u8005\u4e00\u4e2a\u7f51\u7edc\u5730\u5740\u3002\u5f53\u5ba2\u6237\u7aef\u8c03\u7528\u8fd9\u4e2a\u5165\u53e3\uff0c\u5e94\u7528\u7a0b\u5e8f\u5219\u4f1a\u6267\u884c\u5bf9\u5e94\u4ee3\u7801\u64cd\u4f5c\uff0c\u7ed9\u5ba2\u6237\u7aef\u5b8c\u6210\u76f8\u5bf9\u5e94\u7684\u529f\u80fd\u3002"}),"\n",(0,t.jsx)(e.h2,{id:"82restful-api\u89c4\u8303",children:"8.2\u3001restful api\u89c4\u8303"}),"\n",(0,t.jsx)(e.p,{children:"\u5f53\u7136\uff0capi\u63a5\u53e3\u5728\u5de5\u4f5c\u4e2d\u662f\u6bd4\u8f83\u5e38\u89c1\u7684\u5f00\u53d1\u5185\u5bb9\uff0c\u6709\u65f6\u5019\uff0c\u6211\u4eec\u4f1a\u8c03\u7528\u5176\u4ed6\u4eba\u7f16\u5199\u7684api\u63a5\u53e3\uff0c\u6709\u65f6\u5019\uff0c\u6211\u4eec\u4e5f\u9700\u8981\u63d0\u4f9bapi\u63a5\u53e3\u7ed9\u5176\u4ed6\u4eba\u64cd\u4f5c\u3002\u7531\u6b64\u5c31\u4f1a\u5e26\u6765\u4e00\u4e2a\u95ee\u9898\uff0capi\u63a5\u53e3\u5f80\u5f80\u90fd\u662f\u4e00\u4e2a\u51fd\u6570\u3001\u7c7b\u65b9\u6cd5\u3001\u6216\u8005url\u6216\u5176\u4ed6\u7f51\u7edc\u5730\u5740\uff0c\u4e0d\u65ad\u662f\u54ea\u4e00\u79cd\uff0c\u5f53api\u63a5\u53e3\u7f16\u5199\u8fc7\u7a0b\u4e2d\uff0c\u6211\u4eec\u90fd\u8981\u8003\u8651\u4e00\u4e2a\u95ee\u9898\u5c31\u662f\u8fd9\u4e2a\u63a5\u53e3\u5e94\u8be5\u600e\u4e48\u7f16\u5199\uff1f\u63a5\u53e3\u600e\u4e48\u5199\u7684\u66f4\u52a0\u5bb9\u6613\u7ef4\u62a4\u548c\u6e05\u6670\uff0c\u8fd9\u5c31\u9700\u8981\u5927\u5bb6\u5728\u8c03\u7528\u6216\u8005\u7f16\u5199api\u63a5\u53e3\u7684\u65f6\u5019\u8981\u6709\u4e00\u4e2a\u660e\u786e\u7684\u7f16\u5199\u89c4\u8303\uff01\uff01\uff01"}),"\n",(0,t.jsx)(e.p,{children:"\u4e3a\u4e86\u5728\u56e2\u961f\u5185\u90e8\u5f62\u6210\u5171\u8bc6\u3001\u9632\u6b62\u4e2a\u4eba\u4e60\u60ef\u5dee\u5f02\u5f15\u8d77\u7684\u6df7\u4e71\uff0c\u6211\u4eec\u90fd\u9700\u8981\u627e\u5230\u4e00\u79cd\u5927\u5bb6\u90fd\u89c9\u5f97\u5f88\u597d\u7684\u63a5\u53e3\u5b9e\u73b0\u89c4\u8303\uff0c\u800c\u4e14\u8fd9\u79cd\u89c4\u8303\u80fd\u591f\u8ba9\u540e\u7aef\u5199\u7684\u63a5\u53e3\uff0c\u7528\u9014\u4e00\u76ee\u4e86\u7136\uff0c\u51cf\u5c11\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u53cc\u65b9\u4e4b\u95f4\u7684\u5408\u4f5c\u6210\u672c\u3002"}),"\n",(0,t.jsx)(e.p,{children:"\u76ee\u524d\u5e02\u9762\u4e0a\u5927\u90e8\u5206\u516c\u53f8\u5f00\u53d1\u4eba\u5458\u4f7f\u7528\u7684\u63a5\u53e3\u5b9e\u73b0\u89c4\u8303\u4e3b\u8981\u6709\uff1arestful\u3001RPC\u3002"}),"\n",(0,t.jsx)(e.p,{children:"REST\u5168\u79f0\u662fRepresentational State Transfer\uff0c\u4e2d\u6587\u610f\u601d\u662f\u8868\u8ff0\uff08\u7f16\u8005\u6ce8\uff1a\u901a\u5e38\u8bd1\u4e3a\u8868\u5f81\uff09\u6027\u72b6\u6001\u8f6c\u79fb\u3002 \u5b83\u9996\u6b21\u51fa\u73b0\u57282000\u5e74Roy Fielding\u7684\u535a\u58eb\u8bba\u6587\u4e2d\u3002"}),"\n",(0,t.jsx)(e.p,{children:"RESTful\u662f\u4e00\u79cd\u4e13\u95e8\u4e3aWeb \u5f00\u53d1\u800c\u5b9a\u4e49API\u63a5\u53e3\u7684\u8bbe\u8ba1\u98ce\u683c\uff0c\u5c24\u5176\u9002\u7528\u4e8e\u524d\u540e\u7aef\u5206\u79bb\u7684\u5e94\u7528\u6a21\u5f0f\u4e2d\u3002"}),"\n",(0,t.jsxs)(e.p,{children:["\u5173\u952e\uff1a",(0,t.jsx)(e.strong,{children:"\u9762\u5411\u8d44\u6e90\u5f00\u53d1"})]}),"\n",(0,t.jsx)(e.p,{children:"\u8fd9\u79cd\u98ce\u683c\u7684\u7406\u5ff5\u8ba4\u4e3a\u540e\u7aef\u5f00\u53d1\u4efb\u52a1\u5c31\u662f\u63d0\u4f9b\u6570\u636e\u7684\uff0c\u5bf9\u5916\u63d0\u4f9b\u7684\u662f\u6570\u636e\u8d44\u6e90\u7684\u8bbf\u95ee\u63a5\u53e3\uff0c\u6240\u4ee5\u5728\u5b9a\u4e49\u63a5\u53e3\u65f6\uff0c\u5ba2\u6237\u7aef\u8bbf\u95ee\u7684URL\u8def\u5f84\u5c31\u8868\u793a\u8fd9\u79cd\u8981\u64cd\u4f5c\u7684\u6570\u636e\u8d44\u6e90\u3002"}),"\n",(0,t.jsx)(e.p,{children:"\u800c\u5bf9\u4e8e\u6570\u636e\u8d44\u6e90\u5206\u522b\u4f7f\u7528POST\u3001DELETE\u3001GET\u3001UPDATE\u7b49\u8bf7\u6c42\u52a8\u4f5c\u6765\u8868\u8fbe\u5bf9\u6570\u636e\u7684\u589e\u5220\u67e5\u6539\u3002"}),"\n",(0,t.jsxs)(e.table,{children:[(0,t.jsx)(e.thead,{children:(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.th,{style:{textAlign:"left"},children:"\u8bf7\u6c42\u65b9\u6cd5"}),(0,t.jsx)(e.th,{style:{textAlign:"left"},children:"\u8bf7\u6c42\u5730\u5740"}),(0,t.jsx)(e.th,{style:{textAlign:"left"},children:"\u540e\u7aef\u64cd\u4f5c"})]})}),(0,t.jsxs)(e.tbody,{children:[(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{style:{textAlign:"left"},children:"POST"}),(0,t.jsx)(e.td,{style:{textAlign:"left"},children:"/student/"}),(0,t.jsx)(e.td,{style:{textAlign:"left"},children:"\u589e\u52a0\u5b66\u751f"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{style:{textAlign:"left"},children:"GET"}),(0,t.jsx)(e.td,{style:{textAlign:"left"},children:"/student/"}),(0,t.jsx)(e.td,{style:{textAlign:"left"},children:"\u83b7\u53d6\u6240\u6709\u5b66\u751f"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{style:{textAlign:"left"},children:"GET"}),(0,t.jsx)(e.td,{style:{textAlign:"left"},children:"/student/1"}),(0,t.jsx)(e.td,{style:{textAlign:"left"},children:"\u83b7\u53d6id\u4e3a1\u7684\u5b66\u751f"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{style:{textAlign:"left"},children:"PUT"}),(0,t.jsx)(e.td,{style:{textAlign:"left"},children:"/student/1"}),(0,t.jsx)(e.td,{style:{textAlign:"left"},children:"\u4fee\u6539id\u4e3a1\u7684\u5b66\u751f"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{style:{textAlign:"left"},children:"DELETE"}),(0,t.jsx)(e.td,{style:{textAlign:"left"},children:"/student/1"}),(0,t.jsx)(e.td,{style:{textAlign:"left"},children:"\u5220\u9664id\u4e3a1\u7684\u5b66\u751f"})]})]})]}),"\n",(0,t.jsx)(e.p,{children:"restful\u89c4\u8303\u662f\u4e00\u79cd\u901a\u7528\u7684\u89c4\u8303\uff0c\u4e0d\u9650\u5236\u8bed\u8a00\u548c\u5f00\u53d1\u6846\u67b6\u7684\u4f7f\u7528\u3002\u4e8b\u5b9e\u4e0a\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u4efb\u4f55\u4e00\u95e8\u8bed\u8a00\uff0c\u4efb\u4f55\u4e00\u4e2a\u6846\u67b6\u90fd\u53ef\u4ee5\u5b9e\u73b0\u7b26\u5408restful\u89c4\u8303\u7684API\u63a5\u53e3\u3002"})]})}function h(n={}){const{wrapper:e}={...(0,s.R)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(c,{...n})}):c(n)}},8453:(n,e,r)=>{r.d(e,{R:()=>i,x:()=>d});var t=r(6540);const s={},l=t.createContext(s);function i(n){const e=t.useContext(l);return t.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function d(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:i(n.components),t.createElement(l.Provider,{value:e},n.children)}}}]);