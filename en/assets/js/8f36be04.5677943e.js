"use strict";(self.webpackChunkbookshell=self.webpackChunkbookshell||[]).push([[4113],{8285:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>t,contentTitle:()=>i,default:()=>p,frontMatter:()=>a,metadata:()=>c,toc:()=>o});var l=s(4848),r=s(8453);const a={},i=void 0,c={id:"Sre/\u65e5\u5e38\u8fd0\u7ef4/operator",title:"operator",description:"1\u3001\u7f51\u7edc",source:"@site/docs/Sre/1-\u65e5\u5e38\u8fd0\u7ef4/1.operator.md",sourceDirName:"Sre/1-\u65e5\u5e38\u8fd0\u7ef4",slug:"/Sre/\u65e5\u5e38\u8fd0\u7ef4/operator",permalink:"/en/docs/Sre/\u65e5\u5e38\u8fd0\u7ef4/operator",draft:!1,unlisted:!1,editUrl:"https://github.com/shouji1128955/bookshell/edit/main/docs/Sre/1-\u65e5\u5e38\u8fd0\u7ef4/1.operator.md",tags:[],version:"current",lastUpdatedBy:"zhanglaiqiang",lastUpdatedAt:172935997e4,sidebarPosition:1,frontMatter:{},sidebar:"SreOper",next:{title:"\u955c\u50cf\u5217\u8868",permalink:"/en/docs/Sre/\u65e5\u5e38\u8fd0\u7ef4/\u955c\u50cf\u5217\u8868"}},t={},o=[{value:"1\u3001\u7f51\u7edc",id:"1\u7f51\u7edc",level:2},{value:"1\u3001sys\u6cdb\u7ea2\u4ee5\u53cassh\u66b4\u529b\u7834\u89e3",id:"1sys\u6cdb\u7ea2\u4ee5\u53cassh\u66b4\u529b\u7834\u89e3",level:3},{value:"2\u3001windows\u8def\u7531\u6dfb\u52a0",id:"2windows\u8def\u7531\u6dfb\u52a0",level:3},{value:"3\u3001\u7f51\u5361\u95ee\u9898",id:"3\u7f51\u5361\u95ee\u9898",level:3},{value:"4\u3001 spring-cloud\u670d\u52a1\u5728\u8bbf\u95eeredis\u65f6\u51fa\u73b0\u8fde\u63a5\u5931\u8d25(\u670d\u52a1\u6ce8\u518c)",id:"4-spring-cloud\u670d\u52a1\u5728\u8bbf\u95eeredis\u65f6\u51fa\u73b0\u8fde\u63a5\u5931\u8d25\u670d\u52a1\u6ce8\u518c",level:3},{value:"5\u3001\u90ae\u7bb1ssl\u914d\u7f6e",id:"5\u90ae\u7bb1ssl\u914d\u7f6e",level:3},{value:"5\u3001iftop \u67e5\u770b\u7f51\u5361\u6d41\u91cf",id:"5iftop-\u67e5\u770b\u7f51\u5361\u6d41\u91cf",level:3},{value:"2\u3001\u7cfb\u7edf\u670d\u52a1",id:"2\u7cfb\u7edf\u670d\u52a1",level:2},{value:"1 \u3001\u67e5\u770b\u76f4\u63a5\u901a\u8fc7system\u542f\u52a8\u7684war\u5305\u9879\u76ee",id:"1-\u67e5\u770b\u76f4\u63a5\u901a\u8fc7system\u542f\u52a8\u7684war\u5305\u9879\u76ee",level:4},{value:"2\u3001\u65e5\u5fd7\u5207\u5272",id:"2\u65e5\u5fd7\u5207\u5272",level:4},{value:"3\u3001cpu\u66b4\u6da8 -\u901a\u8fc7\u7ebf\u7a0b\u67e5\u627e\u95ee\u9898",id:"3cpu\u66b4\u6da8--\u901a\u8fc7\u7ebf\u7a0b\u67e5\u627e\u95ee\u9898",level:4},{value:"3\u3001\u7cfb\u7edf\u8d1f\u8f7d\u8ba1\u7b97",id:"3\u7cfb\u7edf\u8d1f\u8f7d\u8ba1\u7b97",level:4},{value:"4\u3001\u4e91\u670d\u52a1\u5668cpu\u6838\u6570\u7edf\u8ba1",id:"4\u4e91\u670d\u52a1\u5668cpu\u6838\u6570\u7edf\u8ba1",level:4},{value:"5\u3001\u5de1\u68c0\u811a\u672c\u914d\u7f6e\u4ee5\u53ca\u6388\u6743",id:"5\u5de1\u68c0\u811a\u672c\u914d\u7f6e\u4ee5\u53ca\u6388\u6743",level:4},{value:"6\u3001Iotop\u547d\u4ee4\u8be6\u89e3",id:"6iotop\u547d\u4ee4\u8be6\u89e3",level:4},{value:"7\u3001\u6253\u5370\u9700\u8981\u6740\u6b7b\u7684\u8fdb\u7a0b",id:"7\u6253\u5370\u9700\u8981\u6740\u6b7b\u7684\u8fdb\u7a0b",level:4},{value:"8\u3001\u6e05\u7406journalctl\u65e5\u5fd7",id:"8\u6e05\u7406journalctl\u65e5\u5fd7",level:4},{value:"9\u3001centos\u542f\u52a8\u5f02\u5e38",id:"9centos\u542f\u52a8\u5f02\u5e38",level:4},{value:"3\u3001\u78c1\u76d8\u6302\u8f7d",id:"3\u78c1\u76d8\u6302\u8f7d",level:2},{value:"1\u3001\u78c1\u76d8\u7a7a\u95f4\u5224\u65ad\u5927\u4e8e30%",id:"1\u78c1\u76d8\u7a7a\u95f4\u5224\u65ad\u5927\u4e8e30",level:4},{value:"2\u3001\u6302\u8f7dwindows\u7684\u5171\u4eab",id:"2\u6302\u8f7dwindows\u7684\u5171\u4eab",level:4},{value:"3\u3001\u78c1\u76d8",id:"3\u78c1\u76d8",level:4},{value:"4\u3001Java\u548cTomcat",id:"4java\u548ctomcat",level:2},{value:"1\u3001 catalina.sh Java_opts\u914d\u7f6e",id:"1-catalinash-java_opts\u914d\u7f6e",level:4},{value:"2\u3001tomcat:",id:"2tomcat",level:4},{value:"3\u3001 java",id:"3-java",level:4},{value:"4\u3001\u5bb9\u5668",id:"4\u5bb9\u5668",level:4},{value:"5\u3001tomcat\u6307\u5b9a\u7248\u672c\u7684jdk",id:"5tomcat\u6307\u5b9a\u7248\u672c\u7684jdk",level:4},{value:"6\u3001Docker(tomcat\u90e8\u7f72skywalking-agent)",id:"6dockertomcat\u90e8\u7f72skywalking-agent",level:4},{value:"7\u3001tomcat\u6027\u80fd\u4f18\u5316",id:"7tomcat\u6027\u80fd\u4f18\u5316",level:4},{value:"8\u3001tomcat\u8fde\u63a5\u6570\u67e5\u770b",id:"8tomcat\u8fde\u63a5\u6570\u67e5\u770b",level:4},{value:"5\u3001Jenkins",id:"5jenkins",level:2},{value:"1\u3001jenkins\u9489\u9489\u544a\u8b66\u6dfb\u52a0\u4f4d\u7f6e",id:"1jenkins\u9489\u9489\u544a\u8b66\u6dfb\u52a0\u4f4d\u7f6e",level:4},{value:"6\u3001\u5bb9\u5668",id:"6\u5bb9\u5668",level:2},{value:"1\u3001docker-compose\u5b89\u88c5",id:"1docker-compose\u5b89\u88c5",level:4},{value:"2\u3001docker\u76f8\u5173",id:"2docker\u76f8\u5173",level:4},{value:"3\u3001java\u9879\u76ee\u542f\u52a8base image Dockerfile",id:"3java\u9879\u76ee\u542f\u52a8base-image-dockerfile",level:4},{value:"4\u3001dockerfile \u62f7\u8d1d\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u5230\u5bb9\u5668\u4e2d",id:"4dockerfile-\u62f7\u8d1d\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u5230\u5bb9\u5668\u4e2d",level:4},{value:"5\u3001nginx\u5bb9\u5668",id:"5nginx\u5bb9\u5668",level:4},{value:"6\u3001\u5bb9\u5668\u6e05\u9664\uff1a",id:"6\u5bb9\u5668\u6e05\u9664",level:4},{value:"7\u3001docker\u914d\u7f6e\u52a0\u901f\u5668",id:"7docker\u914d\u7f6e\u52a0\u901f\u5668",level:4},{value:"8\u3001docker\u67e5\u770b\u65e5\u5fd7",id:"8docker\u67e5\u770b\u65e5\u5fd7",level:4},{value:"9\u3001\u6e05\u9664none\u955c\u50cf",id:"9\u6e05\u9664none\u955c\u50cf",level:4},{value:"10\u3001\u914d\u7f6edocker\u767b\u5f55harbor",id:"10\u914d\u7f6edocker\u767b\u5f55harbor",level:4},{value:"11\u3001docker\u5b89\u88c5[\u4e8c\u8fdb\u5236\u5b89\u88c5]",id:"11docker\u5b89\u88c5\u4e8c\u8fdb\u5236\u5b89\u88c5",level:4},{value:"\u76f8\u5173\u547d\u4ee4\u5b89\u88c5",id:"\u76f8\u5173\u547d\u4ee4\u5b89\u88c5",level:3},{value:"12\u3001docker\u91cd\u8f7d\u914d\u7f6e\u6587\u4ef6\uff0c\u4e0d\u91cd\u542f\u5bb9\u5668",id:"12docker\u91cd\u8f7d\u914d\u7f6e\u6587\u4ef6\u4e0d\u91cd\u542f\u5bb9\u5668",level:4},{value:"13\u3001docker\u91cd\u8f7d",id:"13docker\u91cd\u8f7d",level:4},{value:"14\u3001docker-compose\u66f4\u65b0\u914d\u7f6e",id:"14docker-compose\u66f4\u65b0\u914d\u7f6e",level:4},{value:"15\u3001Docker\u67e5\u770b\u65e5\u5fd7\u8303\u56f4",id:"15docker\u67e5\u770b\u65e5\u5fd7\u8303\u56f4",level:4},{value:"16\u3001\u56fd\u5916\u673a\u5668\u955c\u50cf\u540c\u6b65\u811a\u672c",id:"16\u56fd\u5916\u673a\u5668\u955c\u50cf\u540c\u6b65\u811a\u672c",level:4},{value:"17\u3001\u4e2a\u4eba\u955c\u50cf\u4ed3\u5e93\u79d8\u94a5",id:"17\u4e2a\u4eba\u955c\u50cf\u4ed3\u5e93\u79d8\u94a5",level:4},{value:"18\u3001\u5728\u5bb9\u5668\u4e2d\u4fee\u6539\u65f6\u95f4",id:"18\u5728\u5bb9\u5668\u4e2d\u4fee\u6539\u65f6\u95f4",level:4},{value:"7\u3001Python",id:"7python",level:2},{value:"1\u3001\u5e38\u89c4\u65b9\u5f0f",id:"1\u5e38\u89c4\u65b9\u5f0f",level:4},{value:"2\u3001\u65b9\u5f0f2",id:"2\u65b9\u5f0f2",level:4},{value:"3\u3001\u5305\u5bfc\u5165\u5bfc\u51fa",id:"3\u5305\u5bfc\u5165\u5bfc\u51fa",level:4},{value:"8\u3001git\u76f8\u5173",id:"8git\u76f8\u5173",level:2},{value:"9\u3001\u8de8\u57df\u95ee\u9898",id:"9\u8de8\u57df\u95ee\u9898",level:2},{value:"1\u3001\u9519\u8bef\u544a\u8b66",id:"1\u9519\u8bef\u544a\u8b66",level:4},{value:"2\u3001\u8de8\u57df\u7684\u914d\u7f6e",id:"2\u8de8\u57df\u7684\u914d\u7f6e",level:4},{value:"10\u3001Skywalking",id:"10skywalking",level:2},{value:"11\u3001tcpdump",id:"11tcpdump",level:2},{value:"\u5e38\u7528\u65b9\u6cd5",id:"\u5e38\u7528\u65b9\u6cd5",level:4},{value:"tcpdump\u4ecb\u7ecd",id:"tcpdump\u4ecb\u7ecd",level:4},{value:"12\u3001\u7aef\u53e3\u626b\u63cf",id:"12\u7aef\u53e3\u626b\u63cf",level:2},{value:"13\u3001Debian\u76f8\u5173",id:"13debian\u76f8\u5173",level:2},{value:"14\u3001\u8fdb\u7a0b\u548c\u76f8\u5173\u547d\u4ee4",id:"14\u8fdb\u7a0b\u548c\u76f8\u5173\u547d\u4ee4",level:2},{value:"\u5178\u578b\u7684\u533a\u522b\u5728\u4e8e:",id:"\u5178\u578b\u7684\u533a\u522b\u5728\u4e8e",level:4},{value:"pid_max",id:"pid_max",level:5},{value:"threads-max",id:"threads-max",level:5},{value:"ulimit -u",id:"ulimit--u",level:5},{value:"14.2 Socks5\u7f51\u7edc\u4ee3\u7406",id:"142-socks5\u7f51\u7edc\u4ee3\u7406",level:4},{value:"1\u3001\u9996\u5148\uff0c\u7f16\u8bd1\u5b89\u88c5SS5\u9700\u8981\u5148\u5b89\u88c5\u4e00\u4e9b\u4f9d\u8d56\u7ec4\u4ef6",id:"1\u9996\u5148\u7f16\u8bd1\u5b89\u88c5ss5\u9700\u8981\u5148\u5b89\u88c5\u4e00\u4e9b\u4f9d\u8d56\u7ec4\u4ef6",level:5},{value:"2\u3001\u53bb\u5b98\u7f51http://ss5.sourceforge.net/ \u4e0b\u8f7dSS5\u6700\u65b0\u7248\u672c\u7684\u6e90\u4ee3\u7801",id:"2\u53bb\u5b98\u7f51httpss5sourceforgenet-\u4e0b\u8f7dss5\u6700\u65b0\u7248\u672c\u7684\u6e90\u4ee3\u7801",level:5},{value:"3\u3001\u89e3\u538b\u540e\u5f00\u59cb\u7f16\u8bd1\u5b89\u88c5\uff1a",id:"3\u89e3\u538b\u540e\u5f00\u59cb\u7f16\u8bd1\u5b89\u88c5",level:5},{value:"4\u3001\u8ba9SS5\u968f\u7cfb\u7edf\u4e00\u8d77\u542f\u52a8",id:"4\u8ba9ss5\u968f\u7cfb\u7edf\u4e00\u8d77\u542f\u52a8",level:5},{value:"5\u3001\u5728ss5.conf\u4e2d\u627e\u5230auth\u548cpermit\u4e24\u884c\uff0c\u6309\u7167\u4e0b\u9762\u7684\u683c\u5f0f\u8fdb\u884c\u4fee\u6539",id:"5\u5728ss5conf\u4e2d\u627e\u5230auth\u548cpermit\u4e24\u884c\u6309\u7167\u4e0b\u9762\u7684\u683c\u5f0f\u8fdb\u884c\u4fee\u6539",level:5},{value:"6\u3001ss5 \u9ed8\u8ba4\u4f7f\u75281080\u7aef\u53e3\uff0c\u5e76\u5141\u8bb8\u4efb\u4f55\u4eba\u4f7f\u7528\uff0c\u5982\u679c\u8981\u4fee\u6539\u9ed8\u8ba4\u7aef\u53e3\uff0c\u8bf7\u4fee\u6539 vi /etc/sysconfig/ss5",id:"6ss5-\u9ed8\u8ba4\u4f7f\u75281080\u7aef\u53e3\u5e76\u5141\u8bb8\u4efb\u4f55\u4eba\u4f7f\u7528\u5982\u679c\u8981\u4fee\u6539\u9ed8\u8ba4\u7aef\u53e3\u8bf7\u4fee\u6539-vi-etcsysconfigss5",level:5},{value:"7\u3001\u542f\u52a8ss5",id:"7\u542f\u52a8ss5",level:5},{value:"8\u3001\u4e00\u5b9a\u8981\u8bb0\u5f97\u914d\u7f6e\u5b89\u5168\u7ec4\u5f00\u653eSS5\u76d1\u542c\u7684\u7aef\u53e3",id:"8\u4e00\u5b9a\u8981\u8bb0\u5f97\u914d\u7f6e\u5b89\u5168\u7ec4\u5f00\u653ess5\u76d1\u542c\u7684\u7aef\u53e3",level:5},{value:"14.3 openvpn",id:"143-openvpn",level:4},{value:"1\u3001\u538b\u6d4b",id:"1\u538b\u6d4b",level:5},{value:"nmap\u7aef\u53e3\u626b\u63cf",id:"nmap\u7aef\u53e3\u626b\u63cf",level:5},{value:"2\u3001openvpn",id:"2openvpn",level:5},{value:"3\u3001vpn_client\u914d\u7f6e",id:"3vpn_client\u914d\u7f6e",level:5},{value:"4\u3001openvpn\u7f51\u7edc\u95ee\u9898-\u5f71\u54cd\u81ea\u52a8\u5316\u53d1\u5e03",id:"4openvpn\u7f51\u7edc\u95ee\u9898-\u5f71\u54cd\u81ea\u52a8\u5316\u53d1\u5e03",level:5},{value:"1\u3001\u6d4b\u8bd5\u4e22\u5305",id:"1\u6d4b\u8bd5\u4e22\u5305",level:5},{value:"2\u3001\u5904\u7406\u65b9\u5f0f\uff1a",id:"2\u5904\u7406\u65b9\u5f0f",level:5},{value:"14.4 nfs\u90e8\u7f72",id:"144-nfs\u90e8\u7f72",level:4},{value:"ubuntu",id:"ubuntu",level:5},{value:"centos",id:"centos",level:5},{value:"15.5 grep\u5e38\u7528",id:"155-grep\u5e38\u7528",level:4},{value:"\u6bd4\u8f83\u4e24\u4e2a\u6587\u4ef6\u662f\u5426\u76f8\u540c",id:"\u6bd4\u8f83\u4e24\u4e2a\u6587\u4ef6\u662f\u5426\u76f8\u540c",level:5},{value:"15.6 \u78c1\u76d8\u6302\u8f7d",id:"156-\u78c1\u76d8\u6302\u8f7d",level:4},{value:"15\u3001\u5185\u5b58",id:"15\u5185\u5b58",level:2},{value:"16\u3001Windows\u5e38\u7528\u64cd\u4f5c",id:"16windows\u5e38\u7528\u64cd\u4f5c",level:2},{value:"16.1 \u5e38\u7528\u5de5\u5177\u5b89\u88c5",id:"161-\u5e38\u7528\u5de5\u5177\u5b89\u88c5",level:3},{value:"1\u3001windows \u4e2dmd5\u6821\u9a8c\u5de5\u5177",id:"1windows-\u4e2dmd5\u6821\u9a8c\u5de5\u5177",level:4},{value:"2\u3001windows\u4ee3\u7406\u670d\u52a1\u5668",id:"2windows\u4ee3\u7406\u670d\u52a1\u5668",level:4},{value:"3\u3001Windows\u4e0a\u5b89\u88c5jq",id:"3windows\u4e0a\u5b89\u88c5jq",level:4},{value:"16.2 \u5b89\u5168\u767b\u5f55\u914d\u7f6e",id:"162-\u5b89\u5168\u767b\u5f55\u914d\u7f6e",level:3},{value:"1. \u4fee\u6539\u4ee3\u7406\u7684\u9ed8\u8ba4\u5730\u5740",id:"1-\u4fee\u6539\u4ee3\u7406\u7684\u9ed8\u8ba4\u5730\u5740",level:4},{value:"16.3 windows\u4e2dvmware\u901a\u8fc7nat\u76f4\u63a5\u8bbf\u95ee",id:"163-windows\u4e2dvmware\u901a\u8fc7nat\u76f4\u63a5\u8bbf\u95ee",level:3},{value:"1.\u8c03\u8282NAT\u7684\u7f51\u6bb5\u4e3a10.51.8.0 /255.255.255.0",id:"1\u8c03\u8282nat\u7684\u7f51\u6bb5\u4e3a105180-2552552550",level:4},{value:"2.\u865a\u62df\u673a\u7f51\u5361\u4fe1\u606f\u914d\u7f6e",id:"2\u865a\u62df\u673a\u7f51\u5361\u4fe1\u606f\u914d\u7f6e",level:4},{value:"3.\u8c03\u6574\u865a\u62df\u673a\u7684\u7f51\u7edc\u6a21\u5f0f\u4e3aNAT\u6a21\u5f0f",id:"3\u8c03\u6574\u865a\u62df\u673a\u7684\u7f51\u7edc\u6a21\u5f0f\u4e3anat\u6a21\u5f0f",level:4},{value:"4.windows\u7535\u8111\u6dfb\u52a0\u6c38\u4e45\u8def\u7531\u4fe1\u606f",id:"4windows\u7535\u8111\u6dfb\u52a0\u6c38\u4e45\u8def\u7531\u4fe1\u606f",level:4},{value:"17\u3001\u65e5\u5fd7\u6e05\u7406",id:"17\u65e5\u5fd7\u6e05\u7406",level:2},{value:"18\u3001iptables",id:"18iptables",level:2},{value:"\u5148\u8ba1\u7b97\u63a9\u7801",id:"\u5148\u8ba1\u7b97\u63a9\u7801",level:3},{value:"\u914d\u7f6e\u89c4\u5219",id:"\u914d\u7f6e\u89c4\u5219",level:3},{value:"\u683c\u5f0f\u8f6c\u6362",id:"\u683c\u5f0f\u8f6c\u6362",level:2}];function d(n){const e={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",h4:"h4",h5:"h5",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...n.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(e.h2,{id:"1\u7f51\u7edc",children:"1\u3001\u7f51\u7edc"}),"\n",(0,l.jsx)(e.h3,{id:"1sys\u6cdb\u7ea2\u4ee5\u53cassh\u66b4\u529b\u7834\u89e3",children:"1\u3001sys\u6cdb\u7ea2\u4ee5\u53cassh\u66b4\u529b\u7834\u89e3"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"netstat -nap | grep SYN_RECV\ncat /var/log/secure | awk '/Failed/{print $(NF-3)}' | sort | uniq -c | awk '{print $2\" = \"$1;}'\n\n\ncat /var/log/secure | awk '/Failed/{print $(NF-3)}' | sort | uniq -c | awk '{print $2\" = \"$1;}'\n\n\n\uff081\uff09\u7b2c\u4e00\u6b21\u63e1\u624b\uff1aClient\u5c06\u6807\u5fd7\u4f4dSYN\u7f6e\u4e3a1\uff0c\u968f\u673a\u4ea7\u751f\u4e00\u4e2a\u503cseq=J\uff0c\u5e76\u5c06\u8be5\u6570\u636e\u5305\u53d1\u9001\u7ed9Server\uff0cClient\u8fdb\u5165SYN_SENT\u72b6\u6001\uff0c\u7b49\u5f85Server\u786e\u8ba4\u3002\n\uff082\uff09\u7b2c\u4e8c\u6b21\u63e1\u624b\uff1aServer\u6536\u5230\u6570\u636e\u5305\u540e\u7531\u6807\u5fd7\u4f4dSYN=1\u77e5\u9053Client\u8bf7\u6c42\u5efa\u7acb\u8fde\u63a5\uff0cServer\u5c06\u6807\u5fd7\u4f4dSYN\u548cACK\u90fd\u7f6e\u4e3a1\uff0cack=J+1\uff0c\u968f\u673a\u4ea7\u751f\u4e00\u4e2a\u503cseq=K\uff0c\u5e76\u5c06\u8be5\u6570\u636e\u5305\u53d1\u9001\u7ed9Client\u4ee5\u786e\u8ba4\u8fde\u63a5\u8bf7\u6c42\uff0cServer\u8fdb\u5165SYN_RCVD\u72b6\u6001\u3002\n\uff083\uff09\u7b2c\u4e09\u6b21\u63e1\u624b\uff1aClient\u6536\u5230\u786e\u8ba4\u540e\uff0c\u68c0\u67e5ack\u662f\u5426\u4e3aJ+1\uff0cACK\u662f\u5426\u4e3a1\uff0c\u5982\u679c\u6b63\u786e\u5219\u5c06\u6807\u5fd7\u4f4dACK\u7f6e\u4e3a1\uff0cack=K+1\uff0c\u5e76\u5c06\u8be5\u6570\u636e\u5305\u53d1\u9001\u7ed9Server\uff0cServer\u68c0\u67e5ack\u662f\u5426\u4e3aK+1\uff0cACK\u662f\u5426\u4e3a1\uff0c\u5982\u679c\u6b63\u786e\u5219\u8fde\u63a5\u5efa\u7acb\u6210\u529f\uff0cClient\u548cServer\u8fdb\u5165ESTABLISHED\u72b6\u6001\uff0c\u5b8c\u6210\u4e09\u6b21\u63e1\u624b\uff0c\u968f\u540eClient\u4e0eServer\u4e4b\u95f4\u53ef\u4ee5\u5f00\u59cb\u4f20\u8f93\u6570\u636e\u4e86\u3002\n        \n        SYN\u653b\u51fb\uff1a\n\u5728\u4e09\u6b21\u63e1\u624b\u8fc7\u7a0b\u4e2d\uff0cServer\u53d1\u9001SYN-ACK\u4e4b\u540e\uff0c\u6536\u5230Client\u7684ACK\u4e4b\u524d\u7684TCP\u8fde\u63a5\u79f0\u4e3a\u534a\u8fde\u63a5\uff08half-open connect\uff09\uff0c\u6b64\u65f6Server\u5904\u4e8eSYN_RCVD\u72b6\u6001\uff0c\u5f53\u6536\u5230ACK\u540e\uff0cServer\u8f6c\u5165ESTABLISHED\u72b6\u6001\u3002SYN\u653b\u51fb\u5c31\u662fClient\u5728\u77ed\u65f6\u95f4\u5185\u4f2a\u9020\u5927\u91cf\u4e0d\u5b58\u5728\u7684IP\u5730\u5740\uff0c\u5e76\u5411Server\u4e0d\u65ad\u5730\u53d1\u9001SYN\u5305\uff0cServer\u56de\u590d\u786e\u8ba4\u5305\uff0c\u5e76\u7b49\u5f85Client\u7684\u786e\u8ba4\uff0c\u7531\u4e8e\u6e90\u5730\u5740\u662f\u4e0d\u5b58\u5728\u7684\uff0c\u56e0\u6b64\uff0cServer\u9700\u8981\u4e0d\u65ad\u91cd\u53d1\u76f4\u81f3\u8d85\u65f6\uff0c\u8fd9\u4e9b\u4f2a\u9020\u7684SYN\u5305\u5c06\u4ea7\u65f6\u95f4\u5360\u7528\u672a\u8fde\u63a5\u961f\u5217\uff0c\u5bfc\u81f4\u6b63\u5e38\u7684SYN\u8bf7\u6c42\u56e0\u4e3a\u961f\u5217\u6ee1\u800c\u88ab\u4e22\u5f03\uff0c\u4ece\u800c\u5f15\u8d77\u7f51\u7edc\u5835\u585e\u751a\u81f3\u7cfb\u7edf\u762b\u75ea\u3002SYN\u653b\u51fb\u65f6\u4e00\u79cd\u5178\u578b\u7684DDOS\u653b\u51fb\uff0c\u68c0\u6d4bSYN\u653b\u51fb\u7684\u65b9\u5f0f\u975e\u5e38\u7b80\u5355\uff0c\u5373\u5f53Server\u4e0a\u6709\u5927\u91cf\u534a\u8fde\u63a5\u72b6\u6001\u4e14\u6e90IP\u5730\u5740\u662f\u968f\u673a\u7684\uff0c\u5219\u53ef\u4ee5\u65ad\u5b9a\u906d\u5230SYN\u653b\u51fb\u4e86\uff0c\u4f7f\u7528\u5982\u4e0b\u547d\u4ee4\u53ef\u4ee5\u8ba9\u4e4b\u73b0\u884c\uff1a\n#netstat -nap | grep SYN_RECV\n\nwhile [ $a=10 ] && [ $b = 20 ] ; do echo \"ok\"; break; done\n"})}),"\n",(0,l.jsx)(e.p,{children:"\u4fee\u6539\u5185\u6838\u9632\u6b62sync\u5de5\u5177\u7684\u6700\u5927\u8fde\u63a5\u6570"}),"\n",(0,l.jsx)(e.p,{children:"#\u67e5\u770b\nsysctl -a|grep net.ipv4.tcp_max_syn_backlog\n#\u4fee\u6539\nsysctl -w net.ipv4.tcp_max_syn_backlog=3000"}),"\n",(0,l.jsx)(e.h3,{id:"2windows\u8def\u7531\u6dfb\u52a0",children:"2\u3001windows\u8def\u7531\u6dfb\u52a0"}),"\n",(0,l.jsx)(e.p,{children:"\u6dfb\u52a0\u6c38\u4e45\u8def\u7531"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"route print \u6253\u5370\u8def\u7531\u4fe1\u606f\nroute add 10.188.0.0 mask 255.255.0.0 192.168.1.253 -p\nroute delete  10.10.10.0(\u76ee\u7684\u7f51\u6bb5\u7f51\u7edc\u5730\u5740)   \u8868\u793a\u5220\u9664\u8def\u7531\nroute change 192.168.0.0 mask 255.255.0.0 192.168.14.1 metric 1 if 2 (CHANGE\u53c2\u6570\u53ea\u80fd\u4fee\u6539\u201c\u7f51\u5173\u201d\u548c\u201c\u8df3\u6570\u201d)\u3002\n"})}),"\n",(0,l.jsx)(e.h3,{id:"3\u7f51\u5361\u95ee\u9898",children:"3\u3001\u7f51\u5361\u95ee\u9898"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:'\u5982\u679c\u591a\u4e2a\u7f51\u5361\u5b58\u5728\n\u5220\u9664\u7f51\u5361\uff1a \nnmcli  connection delete \u7f51\u5361id \ncd /etc/sysconfig/network-scripts/\nrm -f ifcfg-eth0 \ncp ifcfg-ens192  ifcfg-eth0\n\n\ncat ifcfg-eth0: \nTYPE="Ethernet"\nBROWSER_ONLY="no"\nDEFROUTE="yes"\nIPV4_FAILURE_FATAL="no"\nIPV6INIT="yes"\nNAME="eth0"\nDEVICE="eth0"\nONBOOT="yes"\nIPADDR="192.168.100.236"\nPREFIX="24"\nGATEWAY="192.168.100.254"\nDNS1="114.114.114.114"\nPEERDNS="no"\nIPV6_PRIVACY="no"\nDNS2="8.8.8.8"\n\nnmcli  c reload\nnmcli  c \nnmcli  c up eth0 \n\u6216\u8005\u91cd\u542f\u670d\u52a1\uff0c\u91cd\u542f\u7cfb\u7edf\n'})}),"\n",(0,l.jsx)(e.h3,{id:"4-spring-cloud\u670d\u52a1\u5728\u8bbf\u95eeredis\u65f6\u51fa\u73b0\u8fde\u63a5\u5931\u8d25\u670d\u52a1\u6ce8\u518c",children:"4\u3001 spring-cloud\u670d\u52a1\u5728\u8bbf\u95eeredis\u65f6\u51fa\u73b0\u8fde\u63a5\u5931\u8d25(\u670d\u52a1\u6ce8\u518c)"}),"\n",(0,l.jsx)(e.p,{children:"\u539f\u56e0\uff1a\u662f\u56e0\u4e3a\u57fa\u4e8edocker\u90e8\u7f72\u7684\u670d\u52a1\u5728\u6ce8\u518c\u5230nacos\u4e2d\u65f6\uff0c\u6ce8\u518c\u7684\u5730\u5740\u662f\u5bb9\u5668\u7684\u5730\u5740\uff0c\u670d\u52a1\u4e4b\u95f4\u8de8\u4e3b\u673a\u65e0\u6cd5\u8bbf\u95ee\u5bb9\u5668\u4e2d\u7684\u5730\u5740\u3002"}),"\n",(0,l.jsx)(e.p,{children:"\u5982\u679c\u662fdocker\u542f\u52a8\u7684\u5bb9\u5668\uff0c\u5728\u6620\u5c04\u7aef\u53e3\u6620\u5c04\u5230\u7269\u7406\u673a\u7684\u7aef\u53e3\u5fc5\u987b\u662f6379,\u6216\u8005\u4f7f\u7528host\u7f51\u7edc\u3002"}),"\n",(0,l.jsx)(e.h3,{id:"5\u90ae\u7bb1ssl\u914d\u7f6e",children:"5\u3001\u90ae\u7bb1ssl\u914d\u7f6e"}),"\n",(0,l.jsx)(e.p,{children:"qq\u90ae\u7bb1\u914d\u7f6e\u811a\u672c"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:'[root@xjp-001-zlq ~]# cat smtps-mailx.sh  \n#/bin/bash \nCOLOR=\'echo -e \\E[01;32m\'\nCOLOR_ERROR=\'echo -e \\E[01;31m\'\nEND=\'\\E[0m\'\nINSTALL_SMTPS(){\nset -e \nif [ ! -d "/root/.certs" ]; then\n   yum install -y nss-tools mailx\n   sleep 2\n   mkdir /root/.certs\n   echo -n | openssl s_client -connect mail.iandun.cn:465 | sed -ne \'/-BEGIN CERTIFICATE-/,/-END CERTIFICATE-/p\' > /root/.certs/iandun.crt\n   certutil -A -n "GeoTrust SSL CA" -t "C,," -d /root/.certs -i /root/.certs/iandun.crt\n   certutil -A -n "GeoTrust Global CA" -t "C,," -d /root/.certs -i /root/.certs/iandun.crt\ncat >/root/.mailrc<<-EOF\nset from=zhanglaiqiang@iandundd.cn\nset smtp=smtps://mail.iandundd.cn:465\nset smtp-auth-user=zhanglaiqiang@iandundd.cn\nset smtp-auth-password=xxxxxxxxxx  #\u6388\u6743\u7801 \u6b64\u5904\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u9700\u8981\u4fee\u6539\nset smtp-auth=login\nset ssl-verify=ignore\nset nss-config-dir=/root/.certs\nEOF\n   $COLOR  "#######\u53d1\u9001\u6d4b\u8bd5\u90ae\u4ef6\u5230\u6d4b\u8bd5\u90ae\u7bb1409003604@qq.com########" $END\n   echo "FBI Warning " | mail -v  -s hello   409003604@qq.com\n   if [ $? == 0 ]; then\n       $COLOR  "#######smtps\u670d\u52a1\u90e8\u7f72\u6210\u529f!########" $END\n   else  \n           $COLOR_ERROR  "#######smtps\u670d\u52a1\u90e8\u7f72\u5931\u8d25!########" $END\n   fi\nelse\n           $COLOR_ERROR "#######\u8bf7\u68c0\u67e5~/.certs\u76ee\u5f55\u5df2\u7ecf\u5b58\u5728########" $END\nfi\n}\nINSTALL_SMTPS\n'})}),"\n",(0,l.jsx)(e.p,{children:"\u4e0b\u9762\u662f\u914d\u7f6e163\u90ae\u7bb1\u7684"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:'rm -f .certs2/* \necho -n | openssl s_client -connect smtp.163.com:465 | sed -ne \'/-BEGIN CERTIFICATE-/,/-END CERTIFICATE-/p\' > ~/.certs2/163.crt\n\ncertutil -A -n "GeoTrust SSL CA" -t "C,," -d ~/.certs2 -i ~/.certs2/163.crt\ncertutil -A -n "GeoTrust Global CA" -t "C,," -d ~/.certs2 -i ~/.certs2/163.crt\ncertutil -L -d ./.certs2\n\ncertutil -A -n "GeoTrust SSL CA - G3" -t "Pu,Pu,Pu"  -d ./.certs2  -i  ./.certs2/163.crt\n'})}),"\n",(0,l.jsx)(e.h3,{id:"5iftop-\u67e5\u770b\u7f51\u5361\u6d41\u91cf",children:"5\u3001iftop \u67e5\u770b\u7f51\u5361\u6d41\u91cf"}),"\n",(0,l.jsx)(e.p,{children:"2049\u7aef\u53e3\u662f\u8ddfnfs\u76f8\u5173\u7684"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:" iftop -i eth0  -P\n iftop -i \n"})}),"\n",(0,l.jsxs)(e.p,{children:["\u50cf\u4e0b\u9762\u663e\u793a\u540d\u79f0\u4e3a\u540d\u79f0\u7684\u5c55\u793a\u4e3a\u670d\u52a1\u7aef\u53e3",(0,l.jsx)(e.strong,{children:"\u6309\u5927N\u952e"}),"\n",(0,l.jsx)(e.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/operator/m_0bf0b5ce614a95462dbe02a787f4a241_r.png",alt:""})]}),"\n",(0,l.jsx)(e.p,{children:(0,l.jsx)(e.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/operator/m_9f440950ac288db18fda6be27ac83027_r.png",alt:""})}),"\n",(0,l.jsx)(e.p,{children:"\u670d\u52a1\u5668\u67e5\u770b\u8fdb\u7a0b netstat -ltnp"}),"\n",(0,l.jsx)(e.p,{children:(0,l.jsx)(e.a,{href:"https://blog.csdn.net/icanflyingg/article/details/122618127",children:"https://blog.csdn.net/icanflyingg/article/details/122618127"})}),"\n",(0,l.jsxs)(e.p,{children:["\u6839\u636e\u62a5\u8b66\u5904\u7406\n",(0,l.jsx)(e.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/operator/m_f1e5684549bcb3df81a80f0fccd80c73_r.png",alt:""}),"\n\u5728\u5bb9\u5668\u4e2d\uff0c\u5bb9\u5668\u7684\u865a\u62df\u7f51\u5361\u662f\u6210\u5bf9\u51fa\u73b0\u7684\uff0c\u6bd4\u5982\u4e0b\u9762"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"[zhanglaiqiang@andun-server08 ~]$ ip a | grep -A 3 -B 3 'vethdff0645' \n       valid_lft forever preferred_lft forever\n73: veth495b6ab@if72: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue master br-03a10779cc6c state UP group default \n    link/ether 8e:e1:eb:0a:5c:8b brd ff:ff:ff:ff:ff:ff link-netnsid 2\n1370: vethdff0645@if1369: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue master docker0 state UP group default \n    link/ether 66:5f:42:73:49:c0 brd ff:ff:ff:ff:ff:ff link-netnsid 19\n862: veth6ce0423@if861: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue master br-a733af38ab32 state UP group default \n    link/ether 92:c6:0e:36:88:1c brd ff:ff:ff:ff:ff:ff link-netnsid 8\n"})}),"\n",(0,l.jsx)(e.p,{children:"1370 \u8868\u793a\u7269\u7406\u7f51\u5361\u7684\u7f51\u5361\u5e8f\u53f7\uff0c\u800cif1369\u8868\u793a\u94fe\u63a5\u5230\u5bb9\u5668\u5f53\u4e2d\u7684eth0\u7f51\u5361\u5e8f\u53f7"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"#\u901a\u8fc7\u4e0b\u9762\u7684\u65b9\u5f0f\u6765\u67e5\u770b\u5bb9\u5668\u4e2d\u7f51\u5361\u7684\u5e8f\u53f7\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7Ip a\u67e5\u770b ,\n#\u9700\u8981\u5b89\u88c5 ip\u547d\u4ee4\uff0c\u6267\u884capt-get install  iproute2\u8fdb\u884c\u5b89\u88c5\nroot@a51df0542708:/# cat /sys/class/net/eth0/ifindex \n"})}),"\n",(0,l.jsx)(e.p,{children:"\u4ee5\u4e0a\u544a\u8b66\u4e3a\u5bb9\u5668\u7f51\u5361\uff0c\u627e\u5230\u5bf9\u5e94\u7684\u5bb9\u5668"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"#\u627e\u5230\u7f51\u5361\u6240\u5728\u7684\u7269\u7406\u673a\u7f51\u5361\u5e8f\u53f7\n[zhanglaiqiang@andun-server08 ~]$ ip a | grep 'vethdff0645' | awk -F \":\" '{print $1}'\n1370\n[zhanglaiqiang@andun-server08 ~]$\n\n#\u901a\u8fc7\u627e\u5230\u5bb9\u5668\u4e2d\u94fe\u63a5\u5bbf\u4e3b\u673a\u7684\u7f51\u5361\u5e8f\u53f7\n[zhanglaiqiang@andun-server08 ~]$ for i in `docker ps  | awk '{print $NF}' | grep -v 'NAMES'` ; do  echo $i;  docker exec -it $i cat /sys/class/net/eth0/iflink | grep '1370' ; done\niandun_cmsserver\niandun_repertoryweb\niandun_repertoryserver\niandun_cmsweb\nP_W\n1370                 #\u627e\u5230\u5bf9\u5e94\u7684\u5bb9\u5668\u4e3aP_W\nplg_promtail\ndrink_dl\nppg_auto\nbloodsugar\nckwear\nextensionweb\npartnerweb\ncustomerweb\niandunlog\niandun-open-api\niandun-soul\niandun-gateway\nshowweb\nimplant\n"})}),"\n",(0,l.jsx)(e.h2,{id:"2\u7cfb\u7edf\u670d\u52a1",children:"2\u3001\u7cfb\u7edf\u670d\u52a1"}),"\n",(0,l.jsx)(e.h4,{id:"1-\u67e5\u770b\u76f4\u63a5\u901a\u8fc7system\u542f\u52a8\u7684war\u5305\u9879\u76ee",children:"1 \u3001\u67e5\u770b\u76f4\u63a5\u901a\u8fc7system\u542f\u52a8\u7684war\u5305\u9879\u76ee"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:'ps -ef | grep -o  ".config.file=/usr/local/tomcat-[a-z,-]\\+"\n.config.file=/usr/local/tomcat-app-demo\n.config.file=/usr/local/tomcat-cmsserver-demo\n.config.file=/usr/local/tomcat-customer-server-demo\n'})}),"\n",(0,l.jsx)(e.h4,{id:"2\u65e5\u5fd7\u5207\u5272",children:"2\u3001\u65e5\u5fd7\u5207\u5272"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"java\u542f\u52a8jar\u5305\u57fa\u4e8e\u8fd0\u7ef4\u7cfb\u7edf\u5c42\u9762\u7684\u65e5\u5fd7\u5207\u5272\u65b9\u5f0f\u53c2\u8003\n```\nnohup java -jar common-api.jar | /usr/local/cronolog/sbin/cronolog logs/console-%Y-%m-%d.out &\n```\n"})}),"\n",(0,l.jsx)(e.h4,{id:"3cpu\u66b4\u6da8--\u901a\u8fc7\u7ebf\u7a0b\u67e5\u627e\u95ee\u9898",children:"3\u3001cpu\u66b4\u6da8 -\u901a\u8fc7\u7ebf\u7a0b\u67e5\u627e\u95ee\u9898"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:'#\u65b9\u5f0f1\uff1a \n#\u7b2c\u4e00\u6b65\uff1a \u901a\u8fc7top\u627e\u5230\u8d44\u6e90\u4f7f\u7528\u7387\u6700\u5927\u7684\u90a3\u4e2a\u8fdb\u7a0b\uff0c\u6bd4\u598216108\n1\u3001 ps -mp 16108 -o THREAD,tid,time | sort -rn\n[zhanglaiqiang@watch-server01 ~]$ ps -mp 16108   -o THREAD,tid,time | sort -nr | head \nUSER     %CPU PRI SCNT WCHAN  USER SYSTEM   TID     TIME\nroot     68.7   -    - -         -      -     - 00:07:42\nroot      5.9  19    - -         -      - 16137 00:00:40\nroot      5.7  19    - -         -      - 16138 00:00:38\nroot      5.3  19    - -         -      - 16136 00:00:36\nroot      2.0  19    - -         -      - 16308 00:00:13\nroot      2.0  19    - -         -      - 16139 00:00:13\nroot      1.9  19    - -         -      - 16688 00:00:12\nroot      1.8  19    - -         -      - 16690 00:00:12\nroot      1.7  19    - -         -      - 16687 00:00:10\n#\u7136\u540e\u901a\u8fc7\u4e0a\u9762\u7684\u4e3b\u8fdb\u7a0b\u627e\u5230\u5bf9\u5e94\u7684\u8d44\u6e90\u4f7f\u7528\u7387\u6700\u5927\u7ebf\u7a0bid\uff0c\u6bd4\u5982\uff1a  16137 \n\n#\u8f6c\u6362\u4e3a16\u8fdb\u5236\n2\u3001printf "%x\\n" 16137\n3f09 \n\n\u5b9a\u4f4d\u5230\u90a3\u4e2a\u8fdb\u7a0b\u7684\u4ee3\u7801\u7247\u6bb5\n3\u3001jstack  16108  | grep  3f09  -A 30 \n[zhanglaiqiang@watch-server01 ~]$ sudo  /andun_work/jdk1.8.0_144/bin/jstack  16108  | grep  3f09  -A 30 \n[sudo] password for zhanglaiqiang: \n"C2 CompilerThread1" #7 daemon prio=9 os_prio=0 tid=0x00007f3c80515000 nid=0x3f09 waiting on condition [0x0000000000000000]\n   java.lang.Thread.State: RUNNABLE\n\n"C2 CompilerThread0" #6 daemon prio=9 os_prio=0 tid=0x00007f3c80513000 nid=0x3f08 waiting on condition [0x0000000000000000]\n   java.lang.Thread.State: RUNNABLE\n\n"Signal Dispatcher" #5 daemon prio=9 os_prio=0 tid=0x00007f3c80511000 nid=0x3f07 runnable [0x0000000000000000]\n   java.lang.Thread.State: RUNNABLE\n\n"Surrogate Locker Thread (Concurrent GC)" #4 daemon prio=9 os_prio=0 tid=0x00007f3c8050f800 nid=0x3f06 waiting on condition [0x0000000000000000]\n   java.lang.Thread.State: RUNNABLE\n\n"Finalizer" #3 daemon prio=8 os_prio=0 tid=0x00007f3c804dc800 nid=0x3f05 in Object.wait() [0x00007f3c1a816000]\n   java.lang.Thread.State: WAITING (on object monitor)\n\tat java.lang.Object.wait(Native Method)\n\tat java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:143)\n\t- locked <0x00000006c0906578> (a java.lang.ref.ReferenceQueue$Lock)\n\tat java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:164)\n\tat java.lang.ref.Finalizer$FinalizerThread.run(Finalizer.java:209)\n\n"Reference Handler" #2 daemon prio=10 os_prio=0 tid=0x00007f3c804d7800 nid=0x3f04 in Object.wait() [0x00007f3c1a917000]\n   java.lang.Thread.State: WAITING (on object monitor)\n\tat java.lang.Object.wait(Native Method)\n\tat java.lang.Object.wait(Object.java:502)\n\tat java.lang.ref.Reference.tryHandlePending(Reference.java:191)\n\t- locked <0x00000006c09065b8> (a java.lang.ref.Reference$Lock)\n\tat java.lang.ref.Reference$ReferenceHandler.run(Reference.java:153)\n\n"main" #1 prio=5 os_prio=0 tid=0x00007f3c80009800 nid=0x3eee runnable [0x00007f3c88013000]\n   java.lang.Thread.State: RUNNABLE\n\tat java.net.PlainSocketImpl.socketAccept(Native Method)\n\n\n\n#\u65b9\u5f0f2\ntop -H -p pid   #pid\u6307\u5b9acpu\u4f7f\u7528\u7387\u6700\u5927\u7684\u90a3\u4e2apid\u6587\u4ef6\n\n'})}),"\n",(0,l.jsx)(e.h4,{id:"3\u7cfb\u7edf\u8d1f\u8f7d\u8ba1\u7b97",children:"3\u3001\u7cfb\u7edf\u8d1f\u8f7d\u8ba1\u7b97"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"[zhanglaiqiang@demo02 iandun-system]$ top -n 1  -b  | grep  average\ntop - 11:59:30 up 17 days, 20:54,  7 users,  load average: 1.90, 2.37, 2.43\n\n#\u89e3\u91ca\n1.90\u8868\u793a\u7cfb\u7edf1\u5206\u949f\u8d1f\u8f7d\n2.37\u8868\u793a\u7cfb\u7edf5\u5206\u949f\u8d1f\u8f7d\n2.43\u8868\u793a\u7cfb\u7edf15\u5206\u949f\u8d1f\u8f7d\n"})}),"\n",(0,l.jsx)(e.p,{children:"\u6bd4\u5982\uff1a \u7cfb\u7edf\u67098\u4e2acpu,\u7cfb\u7edf\u8d1f\u8f7d\u4e0d\u80fd\u8d85\u8fc78"}),"\n",(0,l.jsx)(e.h4,{id:"4\u4e91\u670d\u52a1\u5668cpu\u6838\u6570\u7edf\u8ba1",children:"4\u3001\u4e91\u670d\u52a1\u5668cpu\u6838\u6570\u7edf\u8ba1"}),"\n",(0,l.jsx)(e.p,{children:"CPU\u603b\u6838\u6570 = \u7269\u7406CPU\u4e2a\u6570 * \u6bcf\u9897\u7269\u7406CPU\u7684\u6838\u6570\n\u603b\u903b\u8f91CPU\u6570 = \u7269\u7406CPU\u4e2a\u6570 * \u6bcf\u9897\u7269\u7406CPU\u7684\u6838\u6570 * \u8d85\u7ebf\u7a0b\u6570"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:'#\u67e5\u770bCPU\u4fe1\u606f\uff08\u578b\u53f7\uff09\n[zhanglaiqiang@demo02 iandun-system]$ cat /proc/cpuinfo| grep "cpu cores"| uniq\ncpu cores\t: 4\n\n## \u67e5\u770b\u7269\u7406CPU\u4e2a\u6570\n[zhanglaiqiang@demo02 iandun-system]$  cat /proc/cpuinfo | grep name | cut -f2 -d: | uniq -c\n      8  Intel(R) Xeon(R) Platinum 8269CY CPU @ 2.50GHz\n[zhanglaiqiang@demo02 iandun-system]$ cat /proc/cpuinfo| grep "physical id"| sort| uniq| wc -l\n1\n\n# \u67e5\u770b\u6bcf\u4e2a\u7269\u7406CPU\u4e2dcore\u7684\u4e2a\u6570(\u5373\u6838\u6570)\n[zhanglaiqiang@demo02 iandun-system]$ cat /proc/cpuinfo| grep "cpu cores"| uniq\ncpu cores\t: 4\n\n# \u67e5\u770b\u903b\u8f91CPU\u7684\u4e2a\u6570\n[zhanglaiqiang@demo02 iandun-system]$  cat /proc/cpuinfo| grep "processor"| wc -l\n8\n[zhanglaiqiang@demo02 iandun-system]$ \n'})}),"\n",(0,l.jsx)(e.p,{children:"\u8fd9\u4e9b\u90fd\u4ee3\u8868\u4ec0\u4e48\uff0c\u90a3\u5c31\u8bf7\u770bCPU\u67b6\u6784"}),"\n",(0,l.jsx)(e.p,{children:"\u591a\u4e2a\u7269\u7406CPU\uff0cCPU\u901a\u8fc7\u603b\u7ebf\u8fdb\u884c\u901a\u4fe1\uff0c\u6548\u7387\u6bd4\u8f83\u4f4e\uff0c\u5982\u4e0b\uff1a"}),"\n",(0,l.jsx)(e.p,{children:(0,l.jsx)(e.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/operator/m_9a8167c7c5c7ebe63461b36c4828b40a_r.png",alt:""})}),"\n",(0,l.jsxs)(e.p,{children:["\u591a\u6838CPU\uff0c\u4e0d\u540c\u7684\u6838\u901a\u8fc7L2 cache\u8fdb\u884c\u901a\u4fe1\uff0c\u5b58\u50a8\u548c\u5916\u8bbe\u901a\u8fc7\u603b\u7ebf\u4e0eCPU\u901a\u4fe1\uff0c\u5982\u4e0b\uff1a\n",(0,l.jsx)(e.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/operator/m_9566b09a75e58847ce3c2b581a8643f9_r.png",alt:""})]}),"\n",(0,l.jsx)(e.p,{children:"\u591a\u6838\u8d85\u7ebf\u7a0b,\u6bcf\u4e2a\u6838\u6709\u4e24\u4e2a\u903b\u8f91\u7684\u5904\u7406\u5355\u5143\uff0c\u4e24\u4e2a\u6838\u5171\u540c\u5206\u4eab\u4e00\u4e2a\u6838\u7684\u8d44\u6e90\uff0c\u5982\u4e0b\uff1a"}),"\n",(0,l.jsx)(e.p,{children:(0,l.jsx)(e.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/operator/m_83435ef66662d4c25b44aaa94c64fadb_r.png",alt:""})}),"\n",(0,l.jsx)(e.p,{children:"\u4ece\u4e0a\u9762\u6267\u884c\u7684\u7ed3\u679c\u6765\u770b\uff0c\u8bc1\u660e\u6211\u4f7f\u7528\u7684cpu\u67094* 2 = 8 \u6838\uff0c\u6bcf\u4e2a\u6838\u67092\u4e2a\u8d85\u7ebf\u7a0b\uff0c\u6240\u4ee5\u67098\u4e2a\u903b\u8f91cpu\u3002"}),"\n",(0,l.jsx)(e.p,{children:"\u4ece\u4e0a\u9762\u6267\u884c\u7684\u7ed3\u679c\u6765\u770b\uff0c\u8bc1\u660e\u6211\u4f7f\u7528\u7684cpu\u67094* 2 = 8 \u6838\uff0c\u6bcf\u4e2a\u6838\u67092\u4e2a\u8d85\u7ebf\u7a0b\uff0c\u6240\u4ee5\u67098\u4e2a\u903b\u8f91cpu\u3002"}),"\n",(0,l.jsx)(e.h4,{id:"5\u5de1\u68c0\u811a\u672c\u914d\u7f6e\u4ee5\u53ca\u6388\u6743",children:"5\u3001\u5de1\u68c0\u811a\u672c\u914d\u7f6e\u4ee5\u53ca\u6388\u6743"}),"\n",(0,l.jsx)(e.p,{children:(0,l.jsx)(e.strong,{children:"\u521b\u5efa\u7528\u6237"})}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:'useradd devops  &&  echo "123456"  | passwd  --stdin devops\n'})}),"\n",(0,l.jsx)(e.p,{children:(0,l.jsx)(e.strong,{children:"\u521b\u5efa\u6388\u6743"})}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"[root@loaclhost ~]# visudo  #\u6216\u8005 vim /etc/sudoers \u4e24\u79cd\u65b9\u5f0f\ndevops  ALL=(ALL)      NOPASSWD:/usr/bin/netstat,/bin/bash,/bin/python3\n"})}),"\n",(0,l.jsx)(e.h4,{id:"6iotop\u547d\u4ee4\u8be6\u89e3",children:"6\u3001Iotop\u547d\u4ee4\u8be6\u89e3"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"#iotop\u547d\u4ee4\u662f\u4e00\u4e2a\u7528\u6765\u76d1\u89c6\u78c1\u76d8I/O\u4f7f\u7528\u72b6\u51b5\u7684top\u7c7b\u5de5\u5177\u3002iotop\u5177\u6709\u4e0etop\u76f8\u4f3c\u7684UI\uff0c\u5176\u4e2d\u5305\u62ecPID\u3001\u7528\u6237\u3001I/O\u3001\u8fdb\u7a0b\u7b49\u76f8\u5173\u4fe1\u606f\u3002Linux\u4e0b\u7684IO\u7edf\u8ba1\u5de5\u5177\u5982iostat\uff0cnmon\u7b49\u5927\u591a\u6570\u662f\u53ea\u80fd\u7edf\u8ba1\u5230per\u8bbe\u5907\u7684\u8bfb\u5199\u60c5\u51b5\uff0c\u5982\u679c\u4f60\u60f3\u77e5\u9053\u6bcf\u4e2a\u8fdb\u7a0b\u662f\u5982\u4f55\u4f7f\u7528IO\u7684\u5c31\u6bd4\u8f83\u9ebb\u70e6\uff0c\u4f7f\u7528iotop\u547d\u4ee4\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u67e5\u770b\n#\u4e0eiostat\u5de5\u5177\u6bd4\u8f83\uff0ciostat\u662f\u7cfb\u7edf\u7ea7\u522b\u7684IO\u76d1\u63a7\uff0c\u800ciotop\u662f\u8fdb\u7a0b\u7ea7\u522bIO\u76d1\u63a7\niotop\u7684\u5b89\u88c5\u6709\u524d\u63d0\u6761\u4ef6\n1\uff1a\u5185\u6838\u7248\u672c\u4e3a2.6.20\u6216\u66f4\u9ad8\u7248\u672c\n2\uff1aPython 2.7\u6216\u66f4\u9ad8\u7684\u7248\u672c\niotop\u53c2\u6570\uff1a \n-o\uff1a\u53ea\u663e\u793a\u6709io\u64cd\u4f5c\u7684\u8fdb\u7a0b\n-b\uff1a\u6279\u91cf\u663e\u793a\uff0c\u65e0\u4ea4\u4e92\uff0c\u4e3b\u8981\u7528\u4f5c\u8bb0\u5f55\u5230\u6587\u4ef6\u3002\n-n NUM\uff1a\u663e\u793aNUM\u6b21\uff0c\u4e3b\u8981\u7528\u4e8e\u975e\u4ea4\u4e92\u5f0f\u6a21\u5f0f\u3002\n-d SEC\uff1a\u95f4\u9694SEC\u79d2\u663e\u793a\u4e00\u6b21\u3002\n-p PID\uff1a\u76d1\u63a7\u7684\u8fdb\u7a0bpid\u3002\u63a5\u8fdb\u7a0b\u53f7\uff0c\u76d1\u89c6\u6307\u5b9a\u8fdb\u7a0b\uff0c\u53ea\u4f1a\u8f93\u51fa\u8be5\u8fdb\u7a0b\u7684\u7edf\u8ba1\u4fe1\u606f\u3002\n-u USER\uff1a\u76d1\u63a7\u7684\u8fdb\u7a0b\u7528\u6237\u3002\n-k \u4f7f\u7528\u5343\u5b57\u8282\u800c\u4e0d\u662f\u4eba\u7c7b\u53cb\u597d\u5355\u4f4d\n"})}),"\n",(0,l.jsxs)(e.p,{children:["iotop\u4f7f\u7528 iotop  -k \u67e5\u770b\u5982\u4e0b\u6548\u679c\n",(0,l.jsx)(e.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/operator/m_5e2632884e13b169810ea17122898a2a_r.png",alt:""})]}),"\n",(0,l.jsx)(e.p,{children:"\u4f7f\u7528\u8bf4\u660e"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"Total DISK READ\uff1a\u603b\u78c1\u76d8\u8bfb\n    Actual DISK READ\uff1a\u5b9e\u9645\u78c1\u76d8\u8bfb\n    Total DISK WRITE \uff1a\u603b\u78c1\u76d8\u5199\u5165\n    Actual DISK WRITE\uff1a\u5b9e\u9645\u78c1\u76d8\u5199\u5165\n    TID\u5217\uff1a\u8fdb\u7a0bPID\n    USER\uff1a\u8fdb\u7a0b\u5bf9\u5e94\u7684\u7528\u6237\n"})}),"\n",(0,l.jsx)(e.p,{children:"iotop\u5feb\u6377\u952e"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"\u5de6\u53f3\u7bad\u5934\uff1a\u6539\u53d8\u6392\u5e8f\u65b9\u5f0f\uff0c\u9ed8\u8ba4\u662f\u6309IO\u6392\u5e8f\u3002\n    r\uff1a\u6539\u53d8\u6392\u5e8f\u987a\u5e8f\u3002\u53cd\u5411\u6392\u5e8f\n    o\uff1a\u53ea\u663e\u793a\u6709IO\u8f93\u51fa\u7684\u8fdb\u7a0b\u3002\n    p\uff1a\u8fdb\u7a0b/\u7ebf\u7a0b\u7684\u663e\u793a\u65b9\u5f0f\u7684\u5207\u6362\u3002\n    a\uff1a\u663e\u793a\u7d2f\u79ef\u4f7f\u7528\u91cf\u3002\n    q\uff1a\u9000\u51fa\u3002\n"})}),"\n",(0,l.jsx)(e.p,{children:"iotop\u7684\u4f8b\u5b50"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"iotop -o   #\u53ef\u4ee5\u6e05\u695a\u5730\u77e5\u6653\u662f\u4ec0\u4e48\u7a0b\u5e8f\u5728\u8bfb\u5199\u78c1\u76d8\uff0c\u901f\u5ea6\u4ee5\u53ca\u547d\u4ee4\u884c\uff0cpid \u7b49\u4fe1\u606f\n"})}),"\n",(0,l.jsx)(e.p,{children:"\u4f7f\u7528\u975e\u4ea4\u4e92\u6a21\u5f0f\u5c06iotop\u547d\u4ee4\u8f93\u51fa\u4fe1\u606f\u5199\u5165\u65e5\u5fd7"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"#nohup iotop -b -o -n 10 -d 5 -t  > /tmp/iotop.log &\n#\u501f\u52a9iotop\u547d\u4ee4\u627e\u5230\u6d88\u8017I/O\u6700\u9ad8\u7684\u8fdb\u7a0b\niotop -oP\n"})}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"\u76d1\u63a7\u7cfb\u7edfI/O\n[root@localhost ~]# iotop\n\n\u76d1\u63a7\u7528\u6237root\u7684I/O\n[root@localhost ~]# iotop -u root\n\n\u76d1\u63a7\u8fdb\u7a0b\u53f7\u662f1\u7684I/O\n[root@localhost ~]# iotop -p 1\n"})}),"\n",(0,l.jsx)(e.h4,{id:"7\u6253\u5370\u9700\u8981\u6740\u6b7b\u7684\u8fdb\u7a0b",children:"7\u3001\u6253\u5370\u9700\u8981\u6740\u6b7b\u7684\u8fdb\u7a0b"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"ps -ef|grep boco|grep -v grep|awk '{print \"kill -9 \"$2}' #\u6253\u5370\u9700\u8981\u6740\u6b7b\u8fdb\u7a0b\n"})}),"\n",(0,l.jsx)(e.h4,{id:"8\u6e05\u7406journalctl\u65e5\u5fd7",children:"8\u3001\u6e05\u7406journalctl\u65e5\u5fd7"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:"# \u67e5\u770b\u5360\u7528\u7684\u78c1\u76d8\njournalctl --disk-usage \n \n# \u8bbe\u7f6e\u5360\u7528\u7684\u78c1\u76d8\u7a7a\u95f4\uff0c\u65e5\u5fd7\u91cf\u5927\u4e8e\u8fd9\u4e9b\u540e\u81ea\u52a8\u5220\u9664\u65e7\u7684\njournalctl --vacuum-size=512M \n \n# 2d\u4e4b\u524d\u7684\u81ea\u52a8\u5220\u9664\njournalctl --vacuum-time=2d \n \n# \u67e5\u770b\u7cfb\u7edf\u5185\u6838\u65e5\u5fd7\njournalctl -k\n"})}),"\n",(0,l.jsx)(e.h4,{id:"9centos\u542f\u52a8\u5f02\u5e38",children:"9\u3001centos\u542f\u52a8\u5f02\u5e38"}),"\n",(0,l.jsxs)(e.p,{children:["1.\u62a5\u9519\uff1aEntering emergency mode. Exit the shell to continue.\n2.\u6545\u969c\u5206\u6790\uff1a\u4e0d\u6309\u89c4\u8303\u6302\u673a\u6216\u91cd\u542f\u5bfc\u81f4\u6587\u4ef6\u7cfb\u7edf\u6545\u969c\u3002\n3.\u6545\u969c\u72b6\u6001\uff1a\n",(0,l.jsx)(e.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/operator/m_8a4ba1934092b0c6cb3ca3554c760b2d_r.png",alt:""})]}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/operator/m_c37feb12bd3ee434f37c6a9ed64e0ea9_r.png",alt:""}),"\n\u5907\u6ce8\uff1a\u6ce8\u610f\u4e2d\u95f4\u8bfb\u53d6\u7684\u662fsda3\u5931\u8d25"]}),"\n",(0,l.jsx)(e.p,{children:"4.\u6545\u969c\u89e3\u51b3\uff1a"}),"\n",(0,l.jsx)(e.p,{children:"\u8f93\u5165\u547d\u4ee4\uff1axfs_repair -v -L /dev/sda3"}),"\n",(0,l.jsx)(e.p,{children:"-L \u9009\u9879\u6307\u5b9a\u5f3a\u5236\u65e5\u5fd7\u6e05\u96f6\uff0c\u5f3a\u5236xfs_repair\u5c06\u65e5\u5fd7\u5f52\u96f6\uff0c\u5373\u4f7f\u5b83\u5305\u542b\u810f\u6570\u636e\uff08\u5143\u6570\u636e\u66f4\u6539\uff09"}),"\n",(0,l.jsx)(e.h2,{id:"3\u78c1\u76d8\u6302\u8f7d",children:"3\u3001\u78c1\u76d8\u6302\u8f7d"}),"\n",(0,l.jsx)(e.h4,{id:"1\u78c1\u76d8\u7a7a\u95f4\u5224\u65ad\u5927\u4e8e30",children:"1\u3001\u78c1\u76d8\u7a7a\u95f4\u5224\u65ad\u5927\u4e8e30%"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:" df -Ph | awk '{if(+$5>20) print $5}'\n df -Ph | awk '{if(+$5>20) print $(NF-1)}'\n"})}),"\n",(0,l.jsx)(e.h4,{id:"2\u6302\u8f7dwindows\u7684\u5171\u4eab",children:"2\u3001\u6302\u8f7dwindows\u7684\u5171\u4eab"}),"\n",(0,l.jsx)(e.p,{children:"\u5982\u679c\u5171\u4eabwindows\u7684\u76ee\u5f55\uff0c\u5728linux\u4e0a\u6302\u8f7d\uff1a"}),"\n",(0,l.jsx)(e.p,{children:"centos8:"}),"\n",(0,l.jsx)(e.p,{children:"\u5ba2\u6237\u7aef\u66f4\u6539\uff1a wordpress-\u535a\u5ba2\u6848\u4f8b"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"\u63d2\u4ef6\u5b89\u88c5\uff0c\u5728windows\u4e2d\u5fc5\u987b\u521b\u5efa\u8d26\u53f7\uff0c\u5e76\u4e14\u6388\u6743\u76ee\u5f55\u5171\u4eab\u76ee\u5f55\u53ef\u4ee5\u4f7f\u7528\nyum -y install cifs-utils\n\n\u65b9\u5f0f1\uff1a \n\u5199\u5165\u5230fatab\u5f53\u4e2d\n\\\\10.8.0.101\\share /apps/wordpress/html/devops   cifs  user,uid=500,rw,suid,username=ilync,password=ifnvps8898.  0 0\n\n\u65b9\u5f0f2\uff1a \u7528\u547d\u4ee4\u6267\u884c-\u53ef\u80fd\u65b9\u5f0f1\u4e0d\u884c\u7684\u60c5\u51b5\u4e0b\u4f7f\u7528\u65b9\u6cd52 \nmount -t cifs //10.8.0.101/share /apps -o username=ilync,password=ifnvps8898.,vers=2.0\n"})}),"\n",(0,l.jsx)(e.p,{children:"centos7.3\u914d\u7f6e\uff1b"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"\u624b\u52a8\u6267\u884c\u6302\u8f7d\nmount -t cifs -o username=ilync,password=ifnvps8898.,vers=2.0  //10.8.0.101/share  /apps/\n\n\u5199\u5165\u5230/etc/fstab\u6587\u4ef6\u4e2d\n\\\\10.8.0.101\\share  /apps/   cifs   username=ilync,password=ifnvps8898.,vers=2.0  0 0\n"})}),"\n",(0,l.jsx)(e.h4,{id:"3\u78c1\u76d8",children:"3\u3001\u78c1\u76d8"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"#disk_fq=$(df -Ph | awk '{if(+$5>10) print \"\u5206\u533a:\"$1}')\ndisk_fq=$(df -m  | awk '{if(+$5>10) print \"\u5206\u533a:\"$1\" \"$5\" \"$4}' | awk 'BEGIN {max = 0} {if ($3+0 >max+0) {max=$3; content=$0}} END {print content}' | awk '{print $1}')\n\n#disk_to=$(df -Ph | awk '{if(+$5>10) print \"\u603b\u7a7a\u95f4:\"$2}')\ndisk_to=$(df -m  | awk '{if(+$5>10) print \"\u603b\u7a7a\u95f4:\" $2 }' | awk -F \":\" 'BEGIN {max = 0} {if ($2+0 >max+0) {max=$2; content=$0}} END {print content}')\n\n#disk_us=$(df -Ph | awk '{if(+$5>10) print \"\u4f7f\u7528\u7a7a\u95f4:\"$3}')\ndisk_use=`df -m | awk '{if(+$5>10) print \"\u4f7f\u7528\u7a7a\u95f4:\"$3}'  |  awk -F \":\" '{print $NF}' | sort -nr | head -n 1`\n\n#disk_fe=$(df -Ph | awk '{if(+$5>10) print \"\u53ef\u7528\u7a7a\u95f4:\"$4}')\ndisk_fe=$(df -m  | awk '{if(+$5>10) print \"\u53ef\u7528\u7a7a\u95f4:\" $4 }' | awk -F \":\" 'BEGIN {max = 0} {if ($2+0 >max+0) {max=$2; content=$0}} END {print content}' | awk '{print $1}')\n\n\n#disk_ul=$(df -Ph | awk '{if(+$5>20) print \"\u78c1\u76d8\u4f7f\u7528\u7387:\"$5}')\ndisk_ul=$(df -m  | awk '{if(+$5>10) print \"\u78c1\u76d8\u4f7f\u7528\u7387:\" $5 }' | awk -F \":\" 'BEGIN {max = 0} {if ($2+0 >max+0) {max=$2; content=$0}} END {print content}')\n"})}),"\n",(0,l.jsx)(e.h2,{id:"4java\u548ctomcat",children:"4\u3001Java\u548cTomcat"}),"\n",(0,l.jsx)(e.h4,{id:"1-catalinash-java_opts\u914d\u7f6e",children:"1\u3001 catalina.sh Java_opts\u914d\u7f6e"}),"\n",(0,l.jsxs)(e.p,{children:["cattalina.sh\u4e2d\u5728\u4e0b\u9762\u4f4d\u7f6e\u6dfb\u52a0\uff0c\u8d44\u6e90\u9650\u5236\u4f7f\u7528\n",(0,l.jsx)(e.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/operator/m_d0e503279caf0052f9b5abdc89133144_r.png",alt:""})]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:'JAVA_OPTS="-server -Xms512m -Xmx1024m -XX:+UseG1GC -Dfile.encoding=UTF-8"\n\n\u6dfb\u52a0jmx_exporter\nJAVA_OPTS="-javaagent:/home/andun_devops/jmx_prometheus_javaagent/jmx_prometheus_javaagent-0.16.1.jar=38083:/home/andun_devops/jmx_prometheus_javaagent/config.yaml -server -Xms512m -Xmx1024m -XX:+UseG1GC -Dfile.encoding=UTF-8"      \n'})}),"\n",(0,l.jsx)(e.p,{children:"docker-compose\u8d44\u6e90\u9650\u5236"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:"  deploy:\n    resources:\n      limits:\n        cpus: '1'\n        memory: 1000M\n"})}),"\n",(0,l.jsx)(e.p,{children:"skywalking-agent\u5bf9\u63a5\uff0c\u9700\u8981\u63d0\u524d\u4e0b\u8f7d,jmx_exporter\u540c\u7406"}),"\n",(0,l.jsx)(e.h4,{id:"2tomcat",children:"2\u3001tomcat:"}),"\n",(0,l.jsx)(e.p,{children:"\u5728catalina.sh\u4e2d\u627e\u5230JAVA_HOME\u4e2d\u6dfb\u52a0"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:'JAVA_OPTS="-javaagent:/home/andun_devops/skywalking_agent/skywalking-agent/skywalking-agent.jar -Dskywalking.agent.service_name=cmsserver_demo  -Dskywalking.collector.backend_service=172.17.224.52:11800   -jar xxx.jar"\n'})}),"\n",(0,l.jsx)(e.h4,{id:"3-java",children:"3\u3001 java"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"java -javaagent:/home/andun_devops/skywalking_agent/skywalking-agent/skywalking-agent.jar -Dskywalking.agent.service_name=cmsserver_demo  -Dskywalking.collector.backend_service=172.17.224.52:11800   -jar xxx.jar\n"})}),"\n",(0,l.jsx)(e.h4,{id:"4\u5bb9\u5668",children:"4\u3001\u5bb9\u5668"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:'[root@cms_project iandun-agent]# cat Dockerfile\nFROM  adoptopenjdk/openjdk8\nRUN   mkdir  /opt/project \nWORKDIR /opt/projectADD   iandun-agent.jar   /opt/project/  \nADD   agent.tar.gz      /opt/project/  \nEXPOSE  8090\nENTRYPOINT ["java","-javaagent:/opt/project/agent/skywalking-agent.jar","-Dskywalking.agent.service_name=andun-agent","-Dskywalking.collector.backend_service=122.51.39.181:11800","-jar","/opt/project/iandun-agent.jar"]\n'})}),"\n",(0,l.jsx)(e.h4,{id:"5tomcat\u6307\u5b9a\u7248\u672c\u7684jdk",children:"5\u3001tomcat\u6307\u5b9a\u7248\u672c\u7684jdk"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:'[zhanglaiqiang@andun-demo04 iandun-cmsserver-u9-demo]$ cat bin/catalina.sh  | head -n 10\n#!/bin/sh\nJAVA_HOME="/usr/local/java/jdk1.8.0_144"\nJRE_HOME="/usr/local/java/jdk1.8.0_144/jre"\n\n\n\n[zhanglaiqiang@andun-demo04 iandun-cmsserver-u9-demo]$ cat bin/setclasspath.sh  | head -n 10\n#!/bin/sh\nJAVA_HOME="/usr/local/java/jdk1.8.0_144"\nJRE_HOME="/usr/local/java/jdk1.8.0_144/jre"\n'})}),"\n",(0,l.jsx)(e.h4,{id:"6dockertomcat\u90e8\u7f72skywalking-agent",children:"6\u3001Docker(tomcat\u90e8\u7f72skywalking-agent)"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:'cat bin/catalina.sh  | head -n 10\n#\u5728\u524d\u4e00\u884c\u52a0\u5165\u4e0b\u9762\u5373\u53ef\uff0c\u8c03\u6574\u6587\u4ef6\u4f4d\u7f6e\n#!/bin/sh\nCATALINA_OPTS="-javaagent:/opt/skywalking-agent/skywalking-agent.jar -Dskywalking.agent.service_name=test_demo_002 -Dskywalking.collector.backend_service=10.51.8.110:11800"; export CATALINA_OPTS\n\n'})}),"\n",(0,l.jsx)(e.h4,{id:"7tomcat\u6027\u80fd\u4f18\u5316",children:"7\u3001tomcat\u6027\u80fd\u4f18\u5316"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:'    <Connector port="9380" protocol="HTTP/1.1" minProcessors="10" maxProcessors="1024" acceptCount="1024"\n               connectionTimeout="20000"  maxThreads="1000" minSpareThreads="100" maxSpareThreads="1000"\n               redirectPort="9443" />\n  #\u53c2\u8003 https://blog.csdn.net/qq_40741855/article/details/116009877\n # https://blog.csdn.net/qq_23994787/article/details/79479686\n acceptCount: \u9ed8\u8ba4\u503c100\n \u867d\u7136tomcat\u540c\u65f6\u53ef\u4ee5\u5904\u7406\u7684\u8fde\u63a5\u6570\u76ee\u662fmaxConnections\uff0c\u4f46\u670d\u52a1\u5668\u4e2d\u53ef\u4ee5\u540c\u65f6\u63a5\u6536\u7684\u8fde\u63a5\u6570\u4e3amaxConnections+acceptCount \u3002acceptCount\u7684\u8bbe\u7f6e\uff0c\u4e0e\u5e94\u7528\u5728\u8fde\u63a5\u8fc7\u9ad8\u60c5\u51b5\u4e0b\u5e0c\u671b\u505a\u51fa\u4ec0\u4e48\u53cd\u5e94\u6709\u5173\u7cfb\u3002\u5982\u679c\u8bbe\u7f6e\u8fc7\u5927\uff0c\u540e\u9762\u8fdb\u5165\u7684\u8bf7\u6c42\u7b49\u5f85\u65f6\u95f4\u4f1a\u5f88\u957f\uff1b\u5982\u679c\u8bbe\u7f6e\u8fc7\u5c0f\uff0c\u540e\u9762\u8fdb\u5165\u7684\u8bf7\u6c42\u7acb\u9a6c\u8fd4\u56deconnection refused\n'})}),"\n",(0,l.jsx)(e.p,{children:(0,l.jsx)(e.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/operator/m_1a286e4ba2305fd70d658e7fca435ff4_r.png",alt:""})}),"\n",(0,l.jsx)(e.p,{children:"\u67e5\u770b\u8fde\u63a5\u6570\uff1a \u5047\u5982\u7aef\u53e3\u4e3a8380"}),"\n",(0,l.jsx)(e.p,{children:"[root@iandun-app-u9-demo tomcat]# netstat  -nat | grep 8380\ntcp        0      0 0.0.0.0:8380            0.0.0.0:*               LISTEN"}),"\n",(0,l.jsx)(e.h4,{id:"8tomcat\u8fde\u63a5\u6570\u67e5\u770b",children:"8\u3001tomcat\u8fde\u63a5\u6570\u67e5\u770b"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"[zhanglaiqiang@timed-task-server02 ~]$ netstat -antp | grep 9380 | grep ESTABLISHED \n(Not all processes could be identified, non-owned process info\n will not be shown, you would have to be root to see it all.)\ntcp6       0      0 172.17.113.108:9380     172.17.224.109:52400    ESTABLISHED -                   \ntcp6       0      0 172.17.113.108:9380     172.17.224.118:43352    ESTABLISHED -                   \ntcp6       0      0 172.17.113.108:9380     172.17.224.109:52436    ESTABLISHED -                   \ntcp6       0      0 172.17.113.108:9380     172.17.224.118:43284    ESTABLISHED -                   \ntcp6       0      0 172.17.113.108:59380    172.17.224.58:22229     ESTABLISHED -                   \ntcp6       0      0 172.17.113.108:9380     172.17.224.109:52378    ESTABLISHED -                   \ntcp6       0      0 172.17.113.108:9380     172.17.224.118:43306    ESTABLISHED -   \n\n#172.17.224.118  172.17.224.109\u8868\u793anginx\u5730\u5740\n"})}),"\n",(0,l.jsx)(e.h2,{id:"5jenkins",children:"5\u3001Jenkins"}),"\n",(0,l.jsx)(e.h4,{id:"1jenkins\u9489\u9489\u544a\u8b66\u6dfb\u52a0\u4f4d\u7f6e",children:"1\u3001jenkins\u9489\u9489\u544a\u8b66\u6dfb\u52a0\u4f4d\u7f6e"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:'    post {\n      always {\n          wrap([$class: \'BuildUser\']) {\n        sh """curl \'https://oapi.dingtalk.com/robot/send?access_token=667531b61ff814f81270d3b1ab2586d6cb49a2a2beab03932794d7c3f7faee1\'  -H \'Content-Type: application/json\' -d \'{"msgtype":"text","text":{"content": "\u90e8\u7f72\u670d\u52a1\uff1a${JOB_NAME} \\n\u6784\u5efa\u5206\u652f: ${branch}\\n\u6784\u5efaID: ${BUILD_ID}\\n\u6784\u5efa\u4eba: ${BUILD_USER}\\n\u63d0\u4ea4\u4fe1\u606f\uff1a${commit}\u6784\u5efa\u72b6\u6001\uff1a${currentBuild.currentResult}"}}\'"""\n      }\n      }\n    }\n'})}),"\n",(0,l.jsx)(e.p,{children:(0,l.jsx)(e.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/operator/m_65ce013e29f8dddafc75cb2c2ceea500_r.png",alt:""})}),"\n",(0,l.jsxs)(e.p,{children:["2\u3001jenkins dockerfile\u62a5\u9519\n",(0,l.jsx)(e.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/operator/m_613f8dfb61dfa35a69f852582e9eb030_r.png",alt:""}),"\n\u6b63\u786e\u5199\u6cd51;"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:' ["./opt/apache-tomcat-9.0.44/bin/startup.sh", "run"]\n'})}),"\n",(0,l.jsx)(e.p,{children:"\u6b63\u786e\u5199\u6cd52;"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:"/opt/apache-tomcat-9.0.44/bin/startup.sh\n"})}),"\n",(0,l.jsx)(e.h2,{id:"6\u5bb9\u5668",children:"6\u3001\u5bb9\u5668"}),"\n",(0,l.jsx)(e.p,{children:"\u975e\u5e38\u5168\u9762\u7684\u6587\u6863\u53c2\u8003"}),"\n",(0,l.jsx)(e.p,{children:(0,l.jsx)(e.a,{href:"https://haicoder.net/docker/docker-logs.html",children:"https://haicoder.net/docker/docker-logs.html"})}),"\n",(0,l.jsx)(e.h4,{id:"1docker-compose\u5b89\u88c5",children:"1\u3001docker-compose\u5b89\u88c5"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:"wget -P /usr/local/bin/  --user=yunxiao --password=Yun#xia0  https://www.zlqit.com/devops/docker/docker-compose\nchmod +x /usr/local/bin/docker-compose\n"})}),"\n",(0,l.jsx)(e.h4,{id:"2docker\u76f8\u5173",children:"2\u3001docker\u76f8\u5173"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"\n\u5220\u9664\u6240\u6709\u7684\u5bb9\u5668\ndocker rm -f (docker ps -qa)\n\n\u5220\u9664\u6240\u6709\u6ca1\u6709\u5728\u4f7f\u7528\u7684\u5bb9\u5668\ndocker image prune -a \n"})}),"\n",(0,l.jsx)(e.h4,{id:"3java\u9879\u76ee\u542f\u52a8base-image-dockerfile",children:"3\u3001java\u9879\u76ee\u542f\u52a8base image Dockerfile"}),"\n",(0,l.jsx)(e.p,{children:(0,l.jsx)(e.strong,{children:"\u53d1\u9001\u7ed9\u7814\u53d1\u7684Dockerfile\u53c2\u8003\u6587\u4ef6"})}),"\n",(0,l.jsx)(e.p,{children:"\u8f93\u9001\u7ed9\u7814\u53d1\u7684Dockerfile\u8bf4\u660e\u4fe1\u606f"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:'FROM  harbor.iandun.com/devops/java:v1.8\n\n# run\u8868\u793a\u9700\u8981\u6267\u884c\u7684shell\u547d\u4ee4\uff0c\u5982\u679c\u6ca1\u6709\u53ef\u4ee5\u5ffd\u7565\nRUN   mkdir  /opt/project                             \n\n#\u9ed8\u8ba4\u5de5\u4f5c\u76ee\u5f55\nWORKDIR /opt/project\n\n#\u62f7\u8d1d\u6253\u5305\u6587\u4ef6\u5230\u5de5\u4f5c\u76ee\u5f55 \nCOPY  hudson.war  /opt/project/\n\n#EXPOSE\u9700\u8981\u66b4\u9732\u670d\u52a1\u7684\u7aef\u53e3 \uff0c\u5982\u679c\u6709\u591a\u4e2a\u7aef\u53e3\uff0c\u53ef\u4ee5\u4f7f\u7528EXPOSE\u66b4\u9732\u591a\u4e2a\u7aef\u53e3\nEXPOSE  8080                                         \nEXPOSE  50000\n\n#\u9700\u8981\u6267\u884c\u7684shell\u547d\u4ee4\nENTRYPOINT  [ "/opt/jdk1.8.0_281/bin/java" ]\n#\u5c06\u542f\u52a8\u7684\u53c2\u6570\u5199\u5165\u5230cmd\nCMD        [ "-jar", \\\n             "\u53c2\u65701", \\\n             "\u53c2\u65702", \\\n\t\t\t "...."\n    \t\t\t ]\n'})}),"\n",(0,l.jsx)(e.p,{children:"\u4f20\u9012\u547d\u4ee4\u7684\u4e24\u79cd\u65b9\u5f0f\uff1a"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:'\u65b9\u5f0f1 \nENTRYPOINT  [ "/opt/jdk1.8.0_281/bin/java" ]\n#\u5c06\u542f\u52a8\u7684\u53c2\u6570\u5199\u5165\u5230cmd\nCMD        [ "-jar", \\\n             "\u53c2\u65701", \\\n             "\u53c2\u65702", \\\n\t\t\t "...."\n    \t\t\t ]\n    \t\t\t \n\u65b9\u5f0f2     \t\t\t \nENTRYPOINT ["java","-Duser.timezone=GMT+08","-jar","/web.jar"]\n'})}),"\n",(0,l.jsx)(e.p,{children:"tomcat \u542f\u52a8dockerfile \uff1a"}),"\n",(0,l.jsx)(e.p,{children:"\u4f7f\u7528tomcat\u76f4\u63a5\u90e8\u7f72\u4e1a\u52a1"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:'FROM  centos:centos7\nMAINTAINER zhanglaiqiang\nRUN    mkdir /usr/local/tomcat-cmsserver-demo -p\nWORKDIR  /usr/local/tomcat-cmsserver-demo\nCOPY  jdk-8u281-linux-x64.tar.gz       /usr\nADD   apache-tomcat-8.5.33.tar.gz     /usr/\nRUN  chmod -R 777 /usr/*.tar.gz  &&  mkdir /var/{jenkins_home,webapps} -p  && ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime && echo \'Asia/Shanghai\' >/etc/timezone\nRUN  tar -zxvf /usr/jdk-8u281-linux-x64.tar.gz   -C /opt  && rm -rf /usr/jdk-8u281-linux-x64.tar.gz &&  mv /usr/apache-tomcat-8.5.33/*  /usr/local/tomcat-cmsserver-demo/  && rm -rf /usr/apache-tomcat-8.5.33\nENV  JAVA_HOME  /opt/jdk1.8.0_281\nENV PATH $PATH:/$JAVA_HOME/bin\nRUN  cd /usr/local/tomcat-cmsserver-demo/bin  &&  pwd  && ls -l\nCOPY  hudson.war   /usr/local/tomcat-cmsserver-demo/webapps\nEXPOSE 8080\n#\u65b9\u5f0f1\nENTRYPOINT [ "/usr/local/tomcat-cmsserver-demo/bin/catalina.sh", "run" , "&&" , "tail", "-f",  "/opt/apache-tomcat-9.0.44/logs/catalina.out" ]\n\n#\u5982\u679c\u5bb9\u5668\u6ca1\u6709\u751f\u6210catalina.out\u65e5\u5fd7\uff0c\u4f7f\u7528\u4e0b\u9762\u7684\u65b9\u5f0f\nENTRYPOINT /usr/local/tomcat/bin/startup.sh && tail -f /usr/local/tomcat/logs/catalina.out\n'})}),"\n",(0,l.jsx)(e.p,{children:"tomcat\u5bb9\u5668\uff1a"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"[root@loaclhost test]# cat /root/jenkins/Dockerfile-tomcat \nFROM  centos:centos7\nMAINTAINER zhanglaiqiang\nRUN    mkdir /usr/local/tomcat-cmsserver-demo -p\nWORKDIR  /usr/local/tomcat-cmsserver-demo\nCOPY  jdk-8u281-linux-x64.tar.gz       /usr\nADD   apache-tomcat-8.5.33.tar.gz     /usr/\nRUN  chmod -R 777 /usr/*.tar.gz  &&  mkdir /var/{jenkins_home,webapps} -p  && ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime && echo 'Asia/Shanghai' >/etc/timezone\nRUN  tar -zxvf /usr/jdk-8u281-linux-x64.tar.gz   -C /opt  && rm -rf /usr/jdk-8u281-linux-x64.tar.gz &&  mv /usr/apache-tomcat-8.5.33/*  /usr/local/tomcat-cmsserver-demo/  && rm -rf /usr/apache-tomcat-8.5.33\nENV  JAVA_HOME  /opt/jdk1.8.0_281\nENV  PATH $PATH:/$JAVA_HOME/bin\n"})}),"\n",(0,l.jsx)(e.p,{children:"tomcat-\u4e1a\u52a1\u5bb9\u5668"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:'[root@loaclhost test]# cat /test/Dockerfile-tomcat  \nFROM    harbor.iandun.com/devops/tomcat:v8.5.33\nCOPY  hudson.war  /usr/local/tomcat-cmsserver-demo/webapps/\nEXPOSE  8080\nEXPOSE  50000\nENTRYPOINT  [ "/usr/local/tomcat-cmsserver-demo/bin/catalina.sh", "run" , "&&" , "tail", "-f",  "/usr/local/tomcat-cmsserver-demo/logs/catalina.out" ]\n'})}),"\n",(0,l.jsx)(e.p,{children:"\u6d4b\u8bd5\u547d\u4ee4"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"docker run   -p 2022:22  -v /etc/hosts:/etc/hosts  --name centos   --hostname centos-test  centos tail -f /var/log/message \n"})}),"\n",(0,l.jsx)(e.p,{children:"java\u542f\u52a8jar\u5305\u65b9\u5f0f:  cms\u91cd\u6784(\u4e1a\u52a1\u5c01\u88c5)"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:'FROM  harbor.iandun.com/devops/java:1.8.0_291\nRUN   mkdir  /opt/project \nWORKDIR /opt/project\nADD   iandun-log.jar   /opt/project/  \nEXPOSE  8086\n#\u6ce8\u91cd\u542f\u52a8\u65b9\u5f0f\nENTRYPOINT ["nohup","java","-jar","/opt/project/iandun-log.jar",">/dev/null","2>&1","&"]\n'})}),"\n",(0,l.jsx)(e.h4,{id:"4dockerfile-\u62f7\u8d1d\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u5230\u5bb9\u5668\u4e2d",children:"4\u3001dockerfile \u62f7\u8d1d\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u5230\u5bb9\u5668\u4e2d"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"COPY   dist/   /data/nginx/html\n"})}),"\n",(0,l.jsx)(e.h4,{id:"5nginx\u5bb9\u5668",children:"5\u3001nginx\u5bb9\u5668"}),"\n",(0,l.jsx)(e.p,{children:"\u8bf4\u660e\uff1a \u90e8\u7f72\u5b8c\u6210\u4e4b\u540e\u9700\u8981\u5728/data/nginx/html\u4e0b\u653e\u9759\u6001\u6587\u4ef6"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:'FROM  alpine:3.14\nLABEL maintainer="andun"\nCOPY repositories /etc/apk/repositories\nADD nginx-1.19.1.tar.gz /usr/local/src\nRUN apk update &&  apk add tzdata  &&  mkdir -p /data/nginx/html &&  apk --no-cache add iotop gcc libgcc libc-dev libcurl libc-utils pcre-dev zlib-dev libnfs make  pcre pcre2 zip unzip net-tools pstree wget libevent libev &&  cd /usr/local/src/nginx-1.19.1 && ./configure --prefix=/apps/nginx && make && make install && ln -s /apps/nginx/sbin/nginx  /usr/bin/\nRUN addgroup -g 1001 -S nginx && adduser -s /sbin/nologin -S nginx -D -u 1001 -G nginx \nRUN ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime && echo \'Asia/Shanghai\' >/etc/timezone\nCOPY nginx.conf /apps/nginx/conf/nginx.conf\nRUN chown -R nginx.nginx /data/nginx/html /apps/nginx/\nEXPOSE  80 443\nENV TZ=Asia/Shanghai\nCMD ["nginx"]\n'})}),"\n",(0,l.jsx)(e.h4,{id:"6\u5bb9\u5668\u6e05\u9664",children:"6\u3001\u5bb9\u5668\u6e05\u9664\uff1a"}),"\n",(0,l.jsx)(e.p,{children:"\u6e05\u9664\u6240\u6709\u7684\u7b26\u5408\u6761\u4ef6\u7684"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:"[root@andun-jenkins iandun-system]# docker rmi --force `docker images | grep harbor.iandun.com/andun-app/tomcat-app-demo | awk '{print $3}'`\n\u5220\u9664\u6ca1\u6709\u540d\u79f0\u7684\u955c\u50cf\ndocker rmi $(docker images -f \"dangling=true\" -q)\n\u6839\u636e\u6761\u4ef6\u6765\u5220\u9664\u955c\u50cf  //\u5176\u4e2ddoss-api\u4e3a\u5173\u952e\u5b57\ndocker rmi --force `docker images | grep doss-api | awk '{print $3}'`    \n\u5220\u9664\u6ca1\u6709\u6253\u6807\u7b7e\u7684\u955c\u50cf\ndocker rmi `docker images -q | awk '/^<none>/ { print $3 }'`\n\u8fd9\u662f\u5220\u9664\u5bb9\u5668\u7684\u547d\u4ee4\ndocker rm `docker ps -a -q`\n\u5220\u9664\u6240\u6709\u955c\u50cf\ndocker rmi `docker images -q`\n\n"})}),"\n",(0,l.jsx)(e.p,{children:"docker prune\u547d\u4ee4"}),"\n",(0,l.jsx)(e.p,{children:"\u5220\u9664 \u6240\u6709\u672a\u88ab tag \u6807\u8bb0\u548c\u672a\u88ab\u5bb9\u5668\u4f7f\u7528\u7684\u955c\u50cf\uff1a"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:"docker image prune\n"})}),"\n",(0,l.jsx)(e.p,{children:"\u5220\u9664 \u6240\u6709\u672a\u88ab\u5bb9\u5668\u4f7f\u7528\u7684\u955c\u50cf\uff1a\u5e38\u7528"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"docker image prune -a\n"})}),"\n",(0,l.jsx)(e.p,{children:"\u5220\u9664 \u6240\u6709\u505c\u6b62\u8fd0\u884c\u7684\u5bb9\u5668\uff1a"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:"docker container prune\n"})}),"\n",(0,l.jsx)(e.p,{children:"\u5220\u9664 \u6240\u6709\u672a\u88ab\u6302\u8f7d\u7684\u5377\uff1a"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:"docker volume prune\n"})}),"\n",(0,l.jsx)(e.p,{children:"\u5220\u9664 \u6240\u6709\u7f51\u7edc\uff1a"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:"docker network prune\n"})}),"\n",(0,l.jsx)(e.p,{children:"\u5220\u9664 docker \u6240\u6709\u8d44\u6e90\uff1a"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:"docker system prune\n"})}),"\n",(0,l.jsx)(e.h4,{id:"7docker\u914d\u7f6e\u52a0\u901f\u5668",children:"7\u3001docker\u914d\u7f6e\u52a0\u901f\u5668"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:' #\u914d\u7f6e\u52a0\u901f\u5668\n     cat > /etc/docker/daemon.json <<EOF\n     {\n       "registry-mirrors": ["https://ee5cxtxe.mirror.aliyuncs.com"]  \n          }\n'})}),"\n",(0,l.jsx)(e.h4,{id:"8docker\u67e5\u770b\u65e5\u5fd7",children:"8\u3001docker\u67e5\u770b\u65e5\u5fd7"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:'docker logs --since="2022-01-26T11:00:00" --until "2022-01-26T11:30:00"  tomcat-app-demo >>file.txt\ndocker logs --since="2022-01-28T9:35:00" \ndocker logs -f -t --since="2022-1-17" --tail=10   cms_v2_demo\n'})}),"\n",(0,l.jsx)(e.h4,{id:"9\u6e05\u9664none\u955c\u50cf",children:"9\u3001\u6e05\u9664none\u955c\u50cf"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"docker images  | grep none | awk '{print $3}' | xargs docker rmi\n"})}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:"docker-compose   --compatibility up -d\n"})}),"\n",(0,l.jsx)(e.h4,{id:"10\u914d\u7f6edocker\u767b\u5f55harbor",children:"10\u3001\u914d\u7f6edocker\u767b\u5f55harbor"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:'[root@loaclhost ~]# cat /lib/systemd/system/docker.service  | grep ExecStart=/usr/bin/dockerd ExecStart=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock --insecure-registry=harbor.iandun.com\nsystemctl daemon-reload &&  systemctl  restart docker\necho "172.17.113.105 harbor.iandun.com" >> /etc/hosts\n'})}),"\n",(0,l.jsx)(e.h4,{id:"11docker\u5b89\u88c5\u4e8c\u8fdb\u5236\u5b89\u88c5",children:"11\u3001docker\u5b89\u88c5[\u4e8c\u8fdb\u5236\u5b89\u88c5]"}),"\n",(0,l.jsx)(e.p,{children:"centos7.9"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"tee /etc/yum.repos.d/docker.repo <<-'EOF'\n[docker]\nname=docker\nbaseurl=https://mirrors.tuna.tsinghua.edu.cn/docker-ce/linux/centos/7.9/x86_64/stable/\ngpgcheck=0\nenable=1\nEOF\nyum -y install  docker-ce-20.10.5-3.el7\nsystemctl  start docker  && systemctl  enable docker\n\n\nmkdir /etc/trojan/cert/ #\u653e\u5165\u8bc1\u4e66\nvim /etc/trojan/config.json\ndocker run --restart=always -p 443:443 --net=host  --name=trojan -v /etc/trojan:/etc/trojan -itd  zhanglaiqiang/trojan:3.11\n#docker-compose\u5b89\u88c5\ntee /etc/docker/daemon.json <<-'EOF'\n     {\n       \"registry-mirrors\": [\"https://ee5cxtxe.mirror.aliyuncs.com\"]  \n          }\nEOF       \nsystemctl  start docker  && systemctl  enable docker\n\ncurl -L https://get.daocloud.io/docker/compose/releases/download/1.29.1/docker-compose-`uname -s`-`uname -m` > /usr/local/bin/docker-compose\nsudo chmod +x /usr/local/bin/docker-compose\n\n\ndocker\u4e8c\u8fdb\u5236\u5b89\u88c5\nwget https://download.docker.com/linux/static/stable/x86_64/docker-20.10.9.tgz\n[root@VM-0-14-centos ~]# tar xf docker-20.10.9.tgz\n[root@VM-0-14-centos ~]# cp -r docker/*  /usr/bin/\n\n\n[root@VM-0-14-centos ~]# cat /usr/lib/systemd/system/docker.service\n[Unit]\nDescription=Docker Application Container Engine\nDocumentation=https://docs.docker.com\nAfter=network-online.target firewalld.service\nWants=network-online.target\n\n[Service]\nType=notify\nExecStart=/usr/bin/dockerd\nExecReload=/bin/kill -s HUP $MAINPID\nLimitNOFILE=infinity\nLimitNPROC=infinity\nTimeoutStartSec=0\nDelegate=yes\nKillMode=process\nRestart=on-failure\nStartLimitBurst=3\nStartLimitInterval=60s\n\n[Install]\nWantedBy=multi-user.target\n\n\n"})}),"\n",(0,l.jsx)(e.p,{children:"ubuntu\u5b89\u88c5"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:'#\u6dfb\u52a0GPG key\ncurl -fsSL https://mirrors.tuna.tsinghua.edu.cn/docker-ce/linux/ubuntu/gpg | sudo apt-key add -\n\n#\u9a8c\u8bc1\u6307\u7eb9\nsudo apt-key fingerprint 0EBFCD88\n\n#\u6dfb\u52a0docker-ce\u7684\u4ed3\u5e93\nsudo add-apt-repository \\\n   "deb [arch=amd64] https://mirrors.tuna.tsinghua.edu.cn/docker-ce/linux/ubuntu \\\n   $(lsb_release -cs) \\\n   stable"\n   \n#\u67e5\u770b\u53ef\u4ee5\u5b89\u88c5\u7684\u7248\u672c\napt-cache madison docker \napt install docker-ce=5:20.10.10~3-0~ubuntu-focal\n'})}),"\n",(0,l.jsx)(e.h3,{id:"\u76f8\u5173\u547d\u4ee4\u5b89\u88c5",children:"\u76f8\u5173\u547d\u4ee4\u5b89\u88c5"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"ps \u547d\u4ee4\napt-get update\napt-get  install  procps\n\n\nDebian/Ubuntu/centos  \u5b89\u88c5ping\u547d\u4ee4\napt-get update \napt-get install inetutils-ping\nyum install iputils\n\nDebian/Ubuntu\u5b89\u88c5telnet\u547d\u4ee4\napt-get install net-tools\n"})}),"\n",(0,l.jsx)(e.p,{children:"Debian GNU/Linux8"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"tee  /etc/apt/sources.list <<-'EOF'\ndeb http://mirrors.aliyun.com/debian/ jessie main non-free contrib\ndeb http://mirrors.aliyun.com/debian/ jessie-proposed-updates main non-free contrib\ndeb-src http://mirrors.aliyun.com/debian/ jessie main non-free contrib\ndeb-src http://mirrors.aliyun.com/debian/ jessie-proposed-updates main non-free contrib\nEOF\n"})}),"\n",(0,l.jsx)(e.p,{children:"Debian GNU/Linux9"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:"tee  /etc/apt/sources.list <<-'EOF'\ndeb http://mirrors.aliyun.com/debian/ stretch main non-free contrib\ndeb-src http://mirrors.aliyun.com/debian/ stretch main non-free contrib\ndeb http://mirrors.aliyun.com/debian-security stretch/updates main\ndeb-src http://mirrors.aliyun.com/debian-security stretch/updates main\ndeb http://mirrors.aliyun.com/debian/ stretch-updates main non-free contrib\ndeb-src http://mirrors.aliyun.com/debian/ stretch-updates main non-free contrib\n#deb http://mirrors.aliyun.com/debian/ stretch-backports main non-free contrib\n#deb-src http://mirrors.aliyun.com/debian/ stretch-backports main non-free contrib\nEOF\n"})}),"\n",(0,l.jsx)(e.p,{children:"Debian GNU/Linux11"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"tee  /etc/apt/sources.list <<-'EOF'\ndeb http://mirrors.aliyun.com/debian/ bullseye main non-free contrib\ndeb-src http://mirrors.aliyun.com/debian/ bullseye main non-free contrib\ndeb http://mirrors.aliyun.com/debian-security/ bullseye-security main\ndeb-src http://mirrors.aliyun.com/debian-security/ bullseye-security main\ndeb http://mirrors.aliyun.com/debian/ bullseye-updates main non-free contrib\ndeb-src http://mirrors.aliyun.com/debian/ bullseye-updates main non-free contrib\ndeb http://mirrors.aliyun.com/debian/ bullseye-backports main non-free contrib\ndeb-src http://mirrors.aliyun.com/debian/ bullseye-backports main non-free contrib\nEOF\n"})}),"\n",(0,l.jsx)(e.p,{children:"Debian GNU/Linux10"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:"tee  /etc/apt/sources.list <<-'EOF'\ndeb http://mirrors.aliyun.com/debian/ buster main non-free contrib\ndeb-src http://mirrors.aliyun.com/debian/ buster main non-free contrib\ndeb http://mirrors.aliyun.com/debian-security buster/updates main\ndeb-src http://mirrors.aliyun.com/debian-security buster/updates main\ndeb http://mirrors.aliyun.com/debian/ buster-updates main non-free contrib\ndeb-src http://mirrors.aliyun.com/debian/ buster-updates main non-free contrib\ndeb http://mirrors.aliyun.com/debian/ buster-backports main non-free contrib\ndeb-src http://mirrors.aliyun.com/debian/ buster-backports main non-free contrib\nEOF\n"})}),"\n",(0,l.jsx)(e.h4,{id:"12docker\u91cd\u8f7d\u914d\u7f6e\u6587\u4ef6\u4e0d\u91cd\u542f\u5bb9\u5668",children:"12\u3001docker\u91cd\u8f7d\u914d\u7f6e\u6587\u4ef6\uff0c\u4e0d\u91cd\u542f\u5bb9\u5668"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:'# \u65b9\u5f0f1\n# vim /etc/docker/daemon.json\n{\n    ...\n    "insecure-registries":["k8s.gcr.com"],\n    "live-restore": true,\n    ...\n}\n\n# systemctl reload docker # SIGHUP\n\n#\u65b9\u5f0f2\n#dockerd reload \u914d\u7f6e(\u4e0d\u4f1a\u91cd\u542f dockerd\uff0c\u76f4\u63a5\u4fee\u6539\u914d\u7f6e)\nkill -SIGHUP $(pidof dockerd) # \u7ed9 dockerd \u53d1\u9001 SIGHUP \u4fe1\u53f7\uff0cdockerd \u6536\u5230\u4fe1\u53f7\u540e\u4f1a reload \u914d\u7f6e\ndocker info | grep -i \u914d\u7f6e\u8fc7\u6ee4\u5173\u952e\u5b57\n'})}),"\n",(0,l.jsx)(e.h4,{id:"13docker\u91cd\u8f7d",children:"13\u3001docker\u91cd\u8f7d"}),"\n",(0,l.jsx)(e.p,{children:(0,l.jsx)(e.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/operator/m_5001693abb69be42c4c38cd464a02295_r.png",alt:""})}),"\n",(0,l.jsx)(e.p,{children:(0,l.jsx)(e.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/operator/m_4c3f65f1b117c2cbc9f0e0bd0e763565_r.png",alt:""})}),"\n",(0,l.jsx)(e.h4,{id:"14docker-compose\u66f4\u65b0\u914d\u7f6e",children:"14\u3001docker-compose\u66f4\u65b0\u914d\u7f6e"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"docker-compose  up -d \n"})}),"\n",(0,l.jsx)(e.h4,{id:"15docker\u67e5\u770b\u65e5\u5fd7\u8303\u56f4",children:"15\u3001Docker\u67e5\u770b\u65e5\u5fd7\u8303\u56f4"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:'tomcat-app-demo\ndocker logs --since="2022-01-26T11:00:00" --until "2022-01-26T11:30:00"  tomcat-app-demo\n'})}),"\n",(0,l.jsx)(e.h4,{id:"16\u56fd\u5916\u673a\u5668\u955c\u50cf\u540c\u6b65\u811a\u672c",children:"16\u3001\u56fd\u5916\u673a\u5668\u955c\u50cf\u540c\u6b65\u811a\u672c"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"$ sudo docker login --username=zlq180*******@126.com registry.cn-hangzhou.aliyuncs.com\n\n\n[root@pro-zlq ~]# cat image_download.sh \ndocker pull $1\nCOLOR='echo -e \\E[01;34m'\nnull_dir='/dev/null'\nEND='\\E[0m'\nimage=$1\nproject_name=`echo $image | awk -F '/' '{print $NF}'`\nimage_new=\"registry.cn-hangzhou.aliyuncs.com/zlq_registry/${project_name}\"\ndocker pull $1 \ndocker tag $1  ${image_new}\ndocker rmi -f $1\ndocker push $image_new\n$COLOR\"image_new:\" $image_new  $END\ndocker rmi -f  $image_new   > $null_dir\n"})}),"\n",(0,l.jsx)(e.h4,{id:"17\u4e2a\u4eba\u955c\u50cf\u4ed3\u5e93\u79d8\u94a5",children:"17\u3001\u4e2a\u4eba\u955c\u50cf\u4ed3\u5e93\u79d8\u94a5"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:'{\n        "auths": {\n                "https://index.docker.io/v1/": {\n                        "auth": "emhhbmdsYWlxaWFuZzp6bHExODAyOTA5OTkw"\n                },\n                "registry.cn-beijing.aliyuncs.com": {\n                        "auth": "eXVueGlhby1yYW5jaGVyOmFlZ2lzLXBhYXM="\n                },\n                "registry.cn-shanghai.aliyuncs.com": {\n                        "auth": "eXVueGlhby1yYW5jaGVyOmFlZ2lzLXBhYXM="\n                }\n        },\n        "HttpHeaders": {\n                "User-Agent": "Docker-Client/19.03.9 (linux)"\n        }\n}\n'})}),"\n",(0,l.jsx)(e.h4,{id:"18\u5728\u5bb9\u5668\u4e2d\u4fee\u6539\u65f6\u95f4",children:"18\u3001\u5728\u5bb9\u5668\u4e2d\u4fee\u6539\u65f6\u95f4"}),"\n",(0,l.jsx)(e.p,{children:"\u6dfb\u52a0\u73af\u5883\u53d8\u91cf /etc/profile"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:'export LD_PRELOAD=/usr/local/lib/faketime/libfaketime.so.1 \nexport FAKETIME="2022-08-01 09:09:09" \nexport FAKETIME_DONT_FAKE_MONOTONIC=1\n'})}),"\n",(0,l.jsxs)(e.p,{children:["\u53c2\u8003 ",(0,l.jsx)(e.a,{href:"https://blog.csdn.net/a910196454/article/details/108501685",children:"https://blog.csdn.net/a910196454/article/details/108501685"})]}),"\n",(0,l.jsx)(e.h2,{id:"7python",children:"7\u3001Python"}),"\n",(0,l.jsx)(e.h4,{id:"1\u5e38\u89c4\u65b9\u5f0f",children:"1\u3001\u5e38\u89c4\u65b9\u5f0f"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"linux\u4e8c\u8fdb\u5236\u4e0b\u8f7d\nhttps://www.python.org/downloads/source/\n\nyum -y install  make gcc zlib-devel openssl-devel bzip2-devel ncurses-devel gdbm-devel readline-devel sqlite-devel libffi-devel libpcap-devel libdbi-dev tk-devel xz-devel sysstat\n\n./configure --prefix=/usr/local/python3\n\nmake && make install \n"})}),"\n",(0,l.jsx)(e.h4,{id:"2\u65b9\u5f0f2",children:"2\u3001\u65b9\u5f0f2"}),"\n",(0,l.jsx)(e.p,{children:"\u4e0b\u8f7d\u6587\u4ef6\u5305"}),"\n",(0,l.jsxs)(e.p,{children:["wget ",(0,l.jsx)(e.a,{href:"https://www.python.org/ftp/python/3.7.13/Python-3.7.13.tgz",children:"https://www.python.org/ftp/python/3.7.13/Python-3.7.13.tgz"}),"\ntar xf Python-3.7.13.tgz    /usr/local/"]}),"\n",(0,l.jsx)(e.p,{children:"\u5b89\u88c5\u4f9d\u8d56"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"yum -y install zlib-devel bzip2-devel openssl-devel ncurses-devel sqlite-devel readline-devel tk-devel gdbm-devel db4-devel libpcap-devel xz-devel gcc g++ make\ncd /usr/local/Python-3.7.13\n./configure  --prefix=/usr/local/python3.7/\n\nmake && make install\n"})}),"\n",(0,l.jsx)(e.p,{children:"\u73af\u5883\u53d8\u91cf"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"[root@beijing-k8s-master-001 Python-3.7.13]# cat ~/.bash_profile \n# .bash_profile\n\n# Get the aliases and functions\nif [ -f ~/.bashrc ]; then\n\t. ~/.bashrc\nfi\n\n# User specific environment and startup programs\n\nPATH=$PATH:$HOME/bin\nPATH=$PATH:$HOME/bin:/usr/local/python3.7/bin\nexport PATH\n"})}),"\n",(0,l.jsx)(e.p,{children:"[root@beijing-k8s-master-001 Python-3.7.13]# source  ~/.bash_profile"}),"\n",(0,l.jsx)(e.p,{children:"\u901a\u8fc7yum\u5b89\u88c5"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"yum install https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm\n\n#### pip3\u7248\u672c\u68c0\u67e5\n[root@beijing-k8s-master-001 Python-3.7.13]# pip3.7  -V\npip 22.0.4 from /usr/local/python3.7/lib/python3.7/site-packages/pip (python 3.7)\n"})}),"\n",(0,l.jsx)(e.p,{children:"\u7b2c\u4e09\u65b9pip\u5355\u72ec\u5b89\u88c5\u53c2\u8003\u65b9\u5f0f ####\u6b64\u5904\u9ed8\u8ba4\u4e0d\u9700\u8981\u64cd\u4f5c"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"1\u3001\u5b89\u88c5pip\n\n\u547d\u4ee4\u5982\u4e0b\uff1a\nwget --no-check-certificate  https://pypi.python.org/packages/source/p/pip/pip-8.0.2.tar.gz#md5=3a73c4188f8dbad6a1e6f6d44d117eeb\n\ntar -zxvf pip-8.0.2.tar.gz\n\ncd pip-8.0.2\n\npython3 setup.py build\n\npython3 setup.py install\n\n\u5982\u679c\u6ca1\u6709\u610f\u5916\u7684\u8bdd\uff0cpip\u5b89\u88c5\u5b8c\u6210\u3002\n\n\u5982\u679c\u6ca1\u6709\u641e\u597d\u73af\u5883\u7684\u8bdd\uff0c\u4f1a\u78b0\u89c1\u4eb2\u5207\u7684\u62a5\u9519\uff1a\n\n\u3000\u3000pip3 install paramiko\n\n\u3000\u3000\u62a5\u8fd9\u4e2a\u9519\n\n\u3000\u3000pip is configured with locations that require TLS/SSL, however the ssl module in Python is not available.\n\n\u3000\u3000\u7136\u540e\u5f00\u59cb\u8fdb\u884c\u5982\u4e0b\u64cd\u4f5c\n\n\u3000\u3000yum install openssl\n\u3000\u3000yum install openssl-devel\n\u3000\u3000cd python3.6.1\n\u3000\u3000make && make install\n"})}),"\n",(0,l.jsx)(e.h4,{id:"3\u5305\u5bfc\u5165\u5bfc\u51fa",children:"3\u3001\u5305\u5bfc\u5165\u5bfc\u51fa"}),"\n",(0,l.jsxs)(e.ol,{children:["\n",(0,l.jsxs)(e.li,{children:["\n",(0,l.jsx)(e.p,{children:"\u67e5\u770b\u5f53\u524d\u73af\u5883\u7684\u6240\u6709\u5305\npip list \u6216 pip freeze"}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:["\n",(0,l.jsx)(e.p,{children:"\u5c06\u5f53\u524d\u73af\u5883\u7684\u6240\u6709\u5305\u5b58\u5165\u6587\u4ef6\u4e2d\npip freeze > requirements.txt"}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:["\n",(0,l.jsx)(e.p,{children:"\u5b89\u88c5\u6587\u4ef6\u91cc\u7684\u5305\npip install -r requirements.txt"}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:["\n",(0,l.jsx)(e.p,{children:"\u751f\u4ea7python Dockerfile"}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(e.p,{children:"Dockerfile-base ##\u57fa\u7840\u955c\u50cf"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"FROM  python:3.8.15-bullseye\nENV   requirements requirements.txt\nENV   proxy pypi.douban.com\nADD  ./$requirements  /opt/\nRUN  pip install   --index  https://$proxy/simple/  --trusted-host  $proxy -r /opt/$requirements\n"})}),"\n",(0,l.jsx)(e.p,{children:"Dockerfile  ##\u4e1a\u52a1\u955c\u50cf"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:'FROM  harbor.iandun.com/pro_algorithm/base_department_classify:v1.0\nWORKDIR /opt/project\nADD   ${build_file}   /opt/\nEXPOSE  ${project_port}\nWORKDIR  /opt/\nENTRYPOINT ["python3.8","-u","main.py"]\n#\u5982\u679c\u6709print\u6253\u5370\uff0c\u4f1a\u5f71\u54cd\u65e5\u5fd7\u8f93\u51fa\uff0c\u9700\u8981\u52a0-u\n'})}),"\n",(0,l.jsx)(e.h2,{id:"8git\u76f8\u5173",children:"8\u3001git\u76f8\u5173"}),"\n",(0,l.jsx)(e.p,{children:"\u62c9\u53d6\u6307\u5b9a\u5206\u652f"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"git clone -b develop XXX \n"})}),"\n",(0,l.jsx)(e.p,{children:(0,l.jsx)(e.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/operator/m_4c0962eb6c3565bd8dfe8464b9140a99_r.png",alt:""})}),"\n",(0,l.jsx)(e.h2,{id:"9\u8de8\u57df\u95ee\u9898",children:"9\u3001\u8de8\u57df\u95ee\u9898"}),"\n",(0,l.jsx)(e.h4,{id:"1\u9519\u8bef\u544a\u8b66",children:"1\u3001\u9519\u8bef\u544a\u8b66"}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/operator/m_a92a812c3871ad10e83ad752cdf808d3_r.png",alt:""}),"\n\u8bf4\u660e\uff1a\u6b64\u56fe\u5728\u684c\u9762\u6587\u4ef6\u67b6\u6784\u56fe\u5f53\u4e2d"]}),"\n",(0,l.jsx)(e.h4,{id:"2\u8de8\u57df\u7684\u914d\u7f6e",children:"2\u3001\u8de8\u57df\u7684\u914d\u7f6e"}),"\n",(0,l.jsx)(e.p,{children:(0,l.jsx)(e.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/operator/m_3dd396d1379a4448c5aba339669e8cd8_r.png",alt:""})}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"location / {  \n  add_header Access-Control-Allow-Origin *;  \n}  \n"})}),"\n",(0,l.jsx)(e.p,{children:"\u8bf7\u6c42\u540e\u7aef\u6b63\u5e38\u8fd4\u56de\u7684\u63a5\u53e3"}),"\n",(0,l.jsxs)(e.p,{children:["\u65b9\u5f0f1\u9a8c\u8bc1\uff1a \u901a\u8fc7slb\u4ee3\u7406\u8bbf\u95ee\n",(0,l.jsx)(e.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/operator/m_e4d80ec8fdc5ee934d985ee974768fdc_r.png",alt:""})]}),"\n",(0,l.jsxs)(e.p,{children:["\u65b9\u5f0f2\u9a8c\u8bc1\uff1a \u901a\u8fc7\u76f4\u63a5\u8bbf\u95ee\u4ee3\u7406\u7aef\u7684\u673a\u5668\n",(0,l.jsx)(e.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/operator/m_229024d09585bd38489db35df1799e00_r.png",alt:""})]}),"\n",(0,l.jsx)(e.p,{children:"\u4ee5\u4e0a\u9a8c\u8bc1\u7ed3\u6784\u90fd\u662f\u4e00\u81f4\u7684\u3002"}),"\n",(0,l.jsx)(e.p,{children:"\u5341\u4e8c\u3001 Xshell"}),"\n",(0,l.jsx)(e.p,{children:"ctrl + Tab  tab\u5168\u5c4f\u4e4b\u95f4\u7684\u5207\u6362"}),"\n",(0,l.jsx)(e.p,{children:"alt +  enter    \u5168\u5c4f"}),"\n",(0,l.jsx)(e.h2,{id:"10skywalking",children:"10\u3001Skywalking"}),"\n",(0,l.jsx)(e.p,{children:"skywalking\u81ea\u52a8\u542f\u52a8"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"#skywalking\u542f\u52a8\u811a\u672c\n[andun_devops@andun-jenkins config]$ cat   /home/andun_devops/skywalking/skywalking_restart.sh\n#!/bin/bash \n\n#\u505c\u6b62skywalking\u670d\u52a1\nps -ef | grep '/data/skywalking/apache-skywalking-apm-bin-es7/oap-libs/zstd-jni-1.4.3-1.jar' | grep java | awk '{print $2}' | xargs sudo kill -9\nsleep  30\n#\u542f\u52a8skywalking\u670d\u52a1\nsh /data/skywalking/apache-skywalking-apm-bin-es7/bin/startup.sh\n"})}),"\n",(0,l.jsx)(e.p,{children:"skywalking\u914d\u7f6e\u6587\u4ef6\uff1a"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"    recordDataTTL: ${SW_CORE_RECORD_DATA_TTL:4} # Unit is day\n    metricsDataTTL: ${SW_CORE_METRICS_DATA_TTL:4} # Unit is day\n"})}),"\n",(0,l.jsx)(e.p,{children:"es\u81ea\u52a8\u6e05\u7406  \u521b\u5efaandun_devops\u7ba1\u7406\u8d26\u53f7\uff0c\u6388\u6743\u6570\u636e\u76ee\u5f55\u8d26\u53f7\u4e3aandun_devops\u8d26\u53f7\uff0c\u4ee5\u53ca/data/skywalking\u76ee\u5f55\u5c5e\u6027s"}),"\n",(0,l.jsx)(e.p,{children:"es\u81ea\u52a8\u6e05\u7406\u91cd\u542f"}),"\n",(0,l.jsx)(e.p,{children:"0 3 */4 * * bash   /home/andun_devops/skywalking/skywalking_restart.sh  >/dev/null 2>&1"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"[andun_devops@andun-ELK skywalking_elsticsearch]$ cat  /home/andun_devops/skywalking_elsticsearch/elasticsearch_restart.sh\n#!/bin/bash\n#***********************************************\n#company:        Andun\n#\u7ef4\u62a4\u8005Mail:    zhanglaiqiang@iandun.cn\n#Date:          2022-03-30\n#FileName:      elasticsearch_restart.sh\n#Description:   The test script\n#***********************************************\n\n#\u505c\u6b62\u8fdb\u7a0b\nps -ef | grep 'home=/data/skywalking/elasticsearch-7.2.0' | grep java  | awk '{print $2}' | xargs sudo kill -9\nsleep 5 \ncd /share/elasticsearch_data/  && rm -rf nodes\nsleep 10\n\n#\u542f\u52a8\u8fdb\u7a0b\nsh /data/skywalking/elasticsearch-7.2.0/bin/elasticsearch -d\n"})}),"\n",(0,l.jsx)(e.h2,{id:"11tcpdump",children:"11\u3001tcpdump"}),"\n",(0,l.jsx)(e.h4,{id:"\u5e38\u7528\u65b9\u6cd5",children:"\u5e38\u7528\u65b9\u6cd5"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:"sudo  tcpdump  -i eth0 -vnn host  117.133.17.238  and   port 50060\n"})}),"\n",(0,l.jsx)(e.p,{children:"\u4e00\u822c\u5728\u505a\u6392\u9519\u7684\u65f6\u5019\u4f1a\u7528\u5230\u6293\u5305\u5de5\u5177\uff0c\u6bd4\u5982\u5728\u52a8\u6001\u611f\u77e5\u6536\u4e0d\u5230\u65e5\u5fd7\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u6293\u5305\u770b\u4e0b\u6570\u636e\u6709\u6ca1\u6709\n\u6b63\u5e38\u53d1\u9001\u5230\u670d\u52a1\u5668\uff0c\u4e5f\u53ef\u7528\u4e8e\u7f51\u7edc\u6392\u9519\u3002"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"tcpdump -i eht0 -nn src 10.0.8.1 and dst 10.8.0.1  and dst port 1124 and udp -w test.cap\n\n\n-i \u6307\u5b9a \u6307\u5b9a\u6293\u5305\u7f51\u5361\n\n-nn \u4e0d\u628a\u4e3b\u673a\u7684\u7f51\u7edc\u5730\u5740\u4e0e\u534f\u8bae\u8f6c\u6362\u6210\u540d\u5b57\n\n-w \u628a\u6570\u636e\u5305\u6570\u636e\u5199\u5165\u5230\u6587\u4ef6\nand  \u8fde\u63a5\u53c2\u6570\nhost \u6307\u660e\u4e3b\u673a\nport \u6307\u660e\u7aef\u53e3\nsrc  \u6e90\u5730\u5740\ndst  \u76ee\u6807IP\nnet  \u6307\u660e\u7f51\u6bb5\ndst port \u76ee\u6807\u7aef\u53e3\n! \u975e\uff0c\u9700\u8981\u52a0\u7a7a\u683c\nicmp  arp\n\n\u6bd4\u8f83\u5b9e\u7528\u7684\u4e00\u79cd\u65b9\u5f0f\n"})}),"\n",(0,l.jsx)(e.p,{children:(0,l.jsx)(e.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/operator/m_424f48244928babdd25893b400829a9e_r.png",alt:""})}),"\n",(0,l.jsx)(e.h4,{id:"tcpdump\u4ecb\u7ecd",children:"tcpdump\u4ecb\u7ecd"}),"\n",(0,l.jsx)(e.p,{children:"tcpdump \u662f\u4e00\u6b3e\u5f3a\u5927\u7684\u7f51\u7edc\u6293\u5305\u5de5\u5177\uff0c\u8fd0\u884c\u5728 linux \u5e73\u53f0\u4e0a\u3002\u719f\u6089 tcpdump \u7684\u4f7f\u7528\u80fd\u591f\u5e2e\u52a9\u4f60\u5206\u6790\u3001\u8c03\u8bd5\u7f51\u7edc\u6570\u636e\u3002\ntcpdump\u8bed\u6cd5"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"tcpdump [-adeflnNOpqStvx][-c<\u6570\u636e\u5305\u6570\u76ee>][-dd][-ddd][-F<\u8868\u8fbe\u6587\u4ef6>][-i<\u7f51\u7edc\u754c\u9762>][-r<\u6570\u636e\u5305\u6587\u4ef6>][-s<\u6570\u636e\u5305\u5927\u5c0f>][-tt][-T<\u6570\u636e\u5305\u7c7b\u578b>][-vv][-w<\u6570\u636e\u5305\u6587\u4ef6>][\u8f93\u51fa\u6570\u636e\u680f\u4f4d]\n"})}),"\n",(0,l.jsx)(e.p,{children:"tcpdump\u53c2\u6570"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"-a    \u5c06\u7f51\u7edc\u5730\u5740\u548c\u5e7f\u64ad\u5730\u5740\u8f6c\u53d8\u6210\u540d\u5b57\uff1b\n-d    \u5c06\u5339\u914d\u4fe1\u606f\u5305\u7684\u4ee3\u7801\u4ee5\u4eba\u4eec\u80fd\u591f\u7406\u89e3\u7684\u6c47\u7f16\u683c\u5f0f\u7ed9\u51fa\uff1b\n-dd    \u5c06\u5339\u914d\u4fe1\u606f\u5305\u7684\u4ee3\u7801\u4ee5c\u8bed\u8a00\u7a0b\u5e8f\u6bb5\u7684\u683c\u5f0f\u7ed9\u51fa\uff1b\n-ddd   \u5c06\u5339\u914d\u4fe1\u606f\u5305\u7684\u4ee3\u7801\u4ee5\u5341\u8fdb\u5236\u7684\u5f62\u5f0f\u7ed9\u51fa\uff1b\n-e    \u5728\u8f93\u51fa\u884c\u6253\u5370\u51fa\u6570\u636e\u94fe\u8def\u5c42\u7684\u5934\u90e8\u4fe1\u606f\uff0c\u5305\u62ec\u6e90mac\u548c\u76ee\u7684mac\uff0c\u4ee5\u53ca\u7f51\u7edc\u5c42\u7684\u534f\u8bae\uff1b\n-f    \u5c06\u5916\u90e8\u7684Internet\u5730\u5740\u4ee5\u6570\u5b57\u7684\u5f62\u5f0f\u6253\u5370\u51fa\u6765\uff1b\n-l    \u4f7f\u6807\u51c6\u8f93\u51fa\u53d8\u4e3a\u7f13\u51b2\u884c\u5f62\u5f0f\uff1b\n-n    \u6307\u5b9a\u5c06\u6bcf\u4e2a\u76d1\u542c\u5230\u6570\u636e\u5305\u4e2d\u7684\u57df\u540d\u8f6c\u6362\u6210IP\u5730\u5740\u540e\u663e\u793a\uff0c\u4e0d\u628a\u7f51\u7edc\u5730\u5740\u8f6c\u6362\u6210\u540d\u5b57\uff1b\n-nn\uff1a   \u6307\u5b9a\u5c06\u6bcf\u4e2a\u76d1\u542c\u5230\u7684\u6570\u636e\u5305\u4e2d\u7684\u57df\u540d\u8f6c\u6362\u6210IP\u3001\u7aef\u53e3\u4ece\u5e94\u7528\u540d\u79f0\u8f6c\u6362\u6210\u7aef\u53e3\u53f7\u540e\u663e\u793a\n-t    \u5728\u8f93\u51fa\u7684\u6bcf\u4e00\u884c\u4e0d\u6253\u5370\u65f6\u95f4\u6233\uff1b\n-v    \u8f93\u51fa\u4e00\u4e2a\u7a0d\u5fae\u8be6\u7ec6\u7684\u4fe1\u606f\uff0c\u4f8b\u5982\u5728ip\u5305\u4e2d\u53ef\u4ee5\u5305\u62ecttl\u548c\u670d\u52a1\u7c7b\u578b\u7684\u4fe1\u606f\uff1b\n-vv    \u8f93\u51fa\u8be6\u7ec6\u7684\u62a5\u6587\u4fe1\u606f\uff1b\n-c    \u5728\u6536\u5230\u6307\u5b9a\u7684\u5305\u7684\u6570\u76ee\u540e\uff0ctcpdump\u5c31\u4f1a\u505c\u6b62\uff1b\n-F    \u4ece\u6307\u5b9a\u7684\u6587\u4ef6\u4e2d\u8bfb\u53d6\u8868\u8fbe\u5f0f,\u5ffd\u7565\u5176\u5b83\u7684\u8868\u8fbe\u5f0f\uff1b\n-i    \u6307\u5b9a\u76d1\u542c\u7684\u7f51\u7edc\u63a5\u53e3\uff1b\n-p\uff1a    \u5c06\u7f51\u5361\u8bbe\u7f6e\u4e3a\u975e\u6df7\u6742\u6a21\u5f0f\uff0c\u4e0d\u80fd\u4e0ehost\u6216broadcast\u4e00\u8d77\u4f7f\u7528\n-r    \u4ece\u6307\u5b9a\u7684\u6587\u4ef6\u4e2d\u8bfb\u53d6\u5305(\u8fd9\u4e9b\u5305\u4e00\u822c\u901a\u8fc7-w\u9009\u9879\u4ea7\u751f)\uff1b\n-w    \u76f4\u63a5\u5c06\u5305\u5199\u5165\u6587\u4ef6\u4e2d\uff0c\u5e76\u4e0d\u5206\u6790\u548c\u6253\u5370\u51fa\u6765\uff1b\n-s snaplen snaplen\u8868\u793a\u4ece\u4e00\u4e2a\u5305\u4e2d\u622a\u53d6\u7684\u5b57\u8282\u6570\u30020\u8868\u793a\u5305\u4e0d\u622a\u65ad\uff0c\u6293\u5b8c\u6574\u7684\u6570\u636e\u5305\u3002\u9ed8\u8ba4\u7684\u8bdd tcpdump \u53ea\u663e\u793a\u90e8\u5206\u6570\u636e\u5305,\u9ed8\u8ba468\u5b57\u8282\u3002\n-T    \u5c06\u76d1\u542c\u5230\u7684\u5305\u76f4\u63a5\u89e3\u91ca\u4e3a\u6307\u5b9a\u7684\u7c7b\u578b\u7684\u62a5\u6587\uff0c\u5e38\u89c1\u7684\u7c7b\u578b\u6709rpc \uff08\u8fdc\u7a0b\u8fc7\u7a0b\u8c03\u7528\uff09\u548csnmp\uff08\u7b80\u5355\u7f51\u7edc\u7ba1\u7406\u534f\u8bae\uff1b\uff09\n-X      \u544a\u8bc9tcpdump\u547d\u4ee4\uff0c\u9700\u8981\u628a\u534f\u8bae\u5934\u548c\u5305\u5185\u5bb9\u90fd\u539f\u539f\u672c\u672c\u7684\u663e\u793a\u51fa\u6765\uff08tcpdump\u4f1a\u4ee516\u8fdb\u5236\u548cASCII\u7684\u5f62\u5f0f\u663e\u793a\uff09\uff0c\u8fd9\u5728\u8fdb\u884c\u534f\u8bae\u5206\u6790\u65f6\u662f\u7edd\u5bf9\u7684\u5229\u5668\u3002\n"})}),"\n",(0,l.jsx)(e.p,{children:"\u76d1\u542c\u6240\u6709\u7aef\u53e3\uff0c\u76f4\u63a5\u663e\u793a ip \u5730\u5740"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:" tcpdump -nS\n \u663e\u793a\u66f4\u8be6\u7ec6\u7684\u6570\u636e\u62a5\u6587\uff0c\u5305\u62ec tos, ttl, checksum \u7b49\u3002\n tcpdump -nnvvS\n \u663e\u793a\u6570\u636e\u62a5\u7684\u5168\u90e8\u6570\u636e\u4fe1\u606f\uff0c\u7528 hex \u548c ascii \u4e24\u5217\u5bf9\u6bd4\u8f93\u51fa\u3002\n tcpdump -nnvvXS\n host: \u8fc7\u6ee4\u67d0\u4e2a\u4e3b\u673a\u7684\u6570\u636e\u62a5\u6587\n tcpdump host 1.2.3.4\n src, dst: \u8fc7\u6ee4\u6e90\u5730\u5740\u548c\u76ee\u7684\u5730\u5740\n tcpdump src 1.2.3.4\n tcpdump dst 1.2.3.4\n net: \u8fc7\u6ee4\u67d0\u4e2a\u7f51\u6bb5\u7684\u6570\u636e\n tcpdump net 1.2.3.0/24\n \u8fc7\u6ee4\u67d0\u4e2a\u534f\u8bae\u7684\u6570\u636e\uff0c\u652f\u6301 tcp, udp \u548c icmp\n tcpdump icmp\n \u8fc7\u6ee4\u901a\u8fc7\u67d0\u4e2a\u7aef\u53e3\u7684\u6570\u636e\u62a5\n tcpdump port 3306\n src/dst, port, protocol: \u7ed3\u5408\u4e09\u8005\n tcpdump src port 22 and tcp\n tcpdump udp and src port 25\n \u6293\u53d6\u6307\u5b9a\u8303\u56f4\u7684\u7aef\u53e3\n tcpdump portrange 21-23\n \u901a\u8fc7\u62a5\u6587\u5927\u5c0f\u8fc7\u6ee4\u8bf7\u6c42,\u6570\u636e\u62a5\u5927\u5c0f\uff0c\u5355\u4f4d\u662f\u5b57\u8282\n tcpdump less 32\n tcpdump greater 128\n tcpdump > 32\n tcpdump <= 128\n \u6293\u5305\u8f93\u51fa\u5230\u6587\u4ef6\n tcpdump -w rumenz.pcap port 80\n \u4ece\u6587\u4ef6\u8bfb\u53d6\u62a5\u6587\u663e\u793a\u5230\u5c4f\u5e55\n tcpdump -nXr rumenz.pcap host web\n \u6e90\u5730\u5740\u662f 192.168.1.110\uff0c\u76ee\u7684\u7aef\u53e3\u662f3306\u7684\u6570\u636e\u62a5\n tcpdump -nnvS src 192.168.1.110 and dst port 3306\n \u4ece 192.168 \u7f51\u6bb5\u5230 10 \u6216\u8005 172.31 \u7f51\u6bb5\u7684\u6570\u636e\u62a5\n tcpdump -nvX src net 192.168.0.0/16 and dat net 10.0.0.0/8 or 172.31.0.0/16\n"})}),"\n",(0,l.jsx)(e.p,{children:"tcpdump \u7684\u8f93\u51fa\u89e3\u8bfb\n21:27:06.995846 IP (tos 0x0, ttl 64, id 45646, offset 0, flags [DF], proto TCP (6), length 64)\n192.168.1.110.40411 > 192.168.1.123.80: Flags [S], cksum 0xa730 (correct), seq 992042666, win 65535, options [mss 1460,nop,wscale 4,nop,nop,TS val 663433143 ecr 0,sackOK,eol], length 0"}),"\n",(0,l.jsx)(e.p,{children:"21:27:07.030487 IP (tos 0x0, ttl 51, id 0, offset 0, flags [DF], proto TCP (6), length 44)\n192.168.1.123.80 > 192.168.1.110.40411: Flags [S.], cksum 0xedc0 (correct), seq 2147006684, ack 992042667, win 14600, options [mss 1440], length 0"}),"\n",(0,l.jsx)(e.p,{children:"21:27:07.030527 IP (tos 0x0, ttl 64, id 59119, offset 0, flags [DF], proto TCP (6), length 40)\n192.168.1.110.40411 > 192.168.1.123.80: Flags [.], cksum 0x3e72 (correct), ack 2147006685, win 65535, length 0\n\u6700\u57fa\u672c\u4e5f\u662f\u6700\u91cd\u8981\u7684\u4fe1\u606f\u5c31\u662f\u6570\u636e\u62a5\u7684\u6e90\u5730\u5740/\u7aef\u53e3\u548c\u76ee\u7684\u5730\u5740/\u7aef\u53e3\uff0c\u4e0a\u9762\u7684\u4f8b\u5b50\u7b2c\u4e00\u6761\u6570\u636e\u62a5\u4e2d\uff0c\u6e90\u5730\u5740 ip \u662f192.168.1.110\uff0c\u6e90\u7aef\u53e3\u662f 40411\uff0c\u76ee\u7684\u5730\u5740\u662f 192.168.1.123\uff0c\u76ee\u7684\u7aef\u53e3\u662f 80\u3002> \u7b26\u53f7\u4ee3\u8868\u6570\u636e\u7684\u65b9\u5411\u3002\n\u4e0a\u9762\u7684\u4e09\u6761\u6570\u636e\u8fd8\u662f tcp \u534f\u8bae\u7684\u4e09\u6b21\u63e1\u624b\u8fc7\u7a0b,\u7b2c\u4e00\u6761\u5c31\u662f SYN \u62a5\u6587\uff0c\u8fd9\u4e2a\u53ef\u4ee5\u901a\u8fc7 Flags [S] \u770b\u51fa\u3002\u4e0b\u9762\u662f\u5e38\u89c1\u7684 TCP \u62a5\u6587\u7684 Flags:\n[S]\uff1aSYN\uff08\u5f00\u59cb\u8fde\u63a5\uff09\n[.]: \u6ca1\u6709 Flag\n[P]: PSH\uff08\u63a8\u9001\u6570\u636e\uff09\n[F]: FIN \uff08\u7ed3\u675f\u8fde\u63a5\uff09\n[R]: RST\uff08\u91cd\u7f6e\u8fde\u63a5\uff09\n\u800c\u7b2c\u4e8c\u6761\u6570\u636e\u7684 [S.] \u8868\u793a SYN-ACK\uff0c\u5c31\u662f SYN \u62a5\u6587\u7684\u5e94\u7b54\u62a5\u6587\u3002"}),"\n",(0,l.jsx)(e.h2,{id:"12\u7aef\u53e3\u626b\u63cf",children:"12\u3001\u7aef\u53e3\u626b\u63cf"}),"\n",(0,l.jsx)(e.p,{children:"\u7aef\u53e3\u626b\u63cf"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:"for i in `cat port_host.txt`; do echo \"##############\u4e3b\u673a$i\u7aef\u53e3\u626b\u63cf\u7ed3\u679c##############\"  >> result.txt && nmap -sS  -Pn -n --open -T4  $i  -p  1-65535  | tail -n +6 | sed '$d' | sed '$d'>> result.txt ; done\n\n"})}),"\n",(0,l.jsx)(e.p,{children:"\u6839\u636e\u670d\u52a1\u7aef\u53e3\u6309\u7167\u670d\u52a1\u7c7b\u578b\u7edf\u8ba1: java\u548cdocker"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"[zhanglaiqiang@watch-server05 ~]$ cat port.sh \n#/bin/bash \nCOLOR='echo -e \\E[01;32m'\nEND='\\E[0m'\nCLORED='echo -e \\E[1;31m'\nfor i in `cat port.txt  | awk -F \"/\" '{print $1}'`\n#for i  in `cat port.txt`\ndo\n     pidtype=`sudo netstat -ntlp | grep -w  $i | tail -n  1 |awk  -F \"LISTEN\"  '{print $NF}'`\n     pid_num=`echo ${pidtype} | awk -F \"/\" '{print $1}'`\n     echo ''\n     echo ''\n    \n     $COLOR############\"\u7aef\u53e3$i\u8be6\u60c5\"##############$END\n     echo \u7aef\u53e3${i}\u8fdb\u7a0b\u53f7: `echo ${pid_num}`\n     if [[ ${pidtype} =~ 'java' ]] ; then \n              echo \"\u9879\u76ee\u7c7b\u578b: JAVA\" \n              echo \"\u8be6\u7ec6\u4fe1\u606f\u5982\u4e0b: --------------------------\"\n              ps -ef | grep -w ${pid_num} | grep -v 'grep'\n     elif [[ ${pidtype} =~ 'docker' ]]; then\n              echo \"\u9879\u76ee\u7c7b\u578b: Docker\" \n              echo \"\u8be6\u7ec6\u4fe1\u606f\u5982\u4e0b: --------------------------\"\n              sudo docker ps | grep $i \n     elif [[ ${pid_num} == '-' ]]; then\n              $CLORED*****\u8fdb\u7a0b\u53f7\u4e0d\u5b58\u5728*****$END \n              echo \"\u9879\u76ee\u7c7b\u578b: Unknow\"\n     elif [[ -z  ${pidtype} ]]; then\n              $CLORED*****\u7aef\u53e3\u4e0d\u5b58\u5728*****$END\n              echo \"\u9879\u76ee\u7c7b\u578b: Unknow\"\n     else\n             echo \"\u9879\u76ee\u7c7b\u578b: Unknow\"\n             echo \"\u8be6\u7ec6\u4fe1\u606f\u5982\u4e0b: --------------------------\"\n             ps -ef | grep -w  ${pid_num} | grep -v 'grep'\n\n     fi\ndone\n$COLOR####################################$END\n"})}),"\n",(0,l.jsx)(e.p,{children:"\u7aef\u53e3\u5217\u8868"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"[zhanglaiqiang@watch-server05 ~]$ cat port.txt \n4089/tcp  open  opencore\n7082/tcp  open  unknown\n8582/tcp  open  unknown\n9044/tcp  open  unknown\n9100/tcp  open  jetdirect\n9609/tcp  open  unknown\n9680/tcp  open  unknown\n10489/tcp open  unknown\n20888/tcp open  unknown\n22225/tcp open  unknown\n22227/tcp open  unknown\n33312/tcp open  unknown\n40070/tcp open  unknown\n[zhanglaiqiang@watch-server05 ~]$\n"})}),"\n",(0,l.jsx)(e.p,{children:"\u6267\u884c  bash  port.sh"}),"\n",(0,l.jsx)(e.h2,{id:"13debian\u76f8\u5173",children:"13\u3001Debian\u76f8\u5173"}),"\n",(0,l.jsx)(e.p,{children:"debian\u5b89\u88c5\u547d\u4ee4"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:"ip ---  iproute2\n\nping --- iputils-ping\n\ntelnet --- telnet\n"})}),"\n",(0,l.jsx)(e.p,{children:"\u6570\u636e\u5e93\u67e5\u8be2\u65f6\u95f4\u4e0d\u80fd\u8d85\u8fc710s"}),"\n",(0,l.jsx)(e.h2,{id:"14\u8fdb\u7a0b\u548c\u76f8\u5173\u547d\u4ee4",children:"14\u3001\u8fdb\u7a0b\u548c\u76f8\u5173\u547d\u4ee4"}),"\n",(0,l.jsx)(e.p,{children:"pid_max\uff0culimit -u\u548cthread_max\u533a\u522b"}),"\n",(0,l.jsx)(e.h4,{id:"\u5178\u578b\u7684\u533a\u522b\u5728\u4e8e",children:"\u5178\u578b\u7684\u533a\u522b\u5728\u4e8e:"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"\u540c\u4e00\u8fdb\u7a0b\u7684\u7ebf\u7a0b\u5171\u4eab\u5185\u5b58\u7a7a\u95f4\u3002"}),"\n",(0,l.jsx)(e.li,{children:"\u800c\u8fdb\u7a0b\u5219\u5728\u4e0d\u540c\u7684\u5185\u5b58\u7a7a\u95f4\u4e2d\u8fd0\u884c"}),"\n"]}),"\n",(0,l.jsx)(e.h5,{id:"pid_max",children:"pid_max"}),"\n",(0,l.jsx)(e.p,{children:"cat /proc/sys/kernel/pid_max\n32768"}),"\n",(0,l.jsx)(e.p,{children:"\u6240\u4ee5\u4e0a\u9762\u7684\u547d\u4ee4\u8fd4\u56de32768\uff0c\u8fd9\u610f\u5473\u7740\u6211\u53ef\u4ee5\u5728\u6211\u7684\u7cfb\u7edf\u4e2d\u540c\u65f6\u6267\u884c32768\u4e2a\u8fdb\u7a0b\uff0c\u8fd9\u4e9b\u8fdb\u7a0b\u53ef\u4ee5\u5728\u4e0d\u540c\u7684\u5185\u5b58\u7a7a\u95f4\u4e2d\u8fd0\u884c\u3002"}),"\n",(0,l.jsx)(e.h5,{id:"threads-max",children:"threads-max"}),"\n",(0,l.jsx)(e.p,{children:"cat /proc/sys/kernel/threads-max\n126406"}),"\n",(0,l.jsx)(e.p,{children:"\u4e0a\u9762\u7684\u547d\u4ee4\u5c06\u8f93\u51fa\u8fd4\u56de\u4e3a126406\uff0c\u8fd9\u610f\u5473\u7740\u6211\u53ef\u4ee5\u5728\u5171\u4eab\u5185\u5b58\u7a7a\u95f4\u4e2d\u62e5\u6709126406\u4e2a\u7ebf\u7a0b\u3002"}),"\n",(0,l.jsx)(e.h5,{id:"ulimit--u",children:"ulimit -u"}),"\n",(0,l.jsx)(e.p,{children:"ulimit -u\n63203"}),"\n",(0,l.jsx)(e.p,{children:"\u73b0\u5728\uff0c\u8ba9\u6211\u4eec\u4f7f\u7528\u7b2c\u4e09\u4e2a\u53c2\u6570ulimit -u\uff0c\u5b83\u8868\u793a\u7528\u6237\u5728\u7279\u5b9a\u65f6\u95f4\u53ef\u4ee5\u62e5\u6709\u7684\u603b\u8fdb\u7a0b\u6570\u3002\u4e0a\u9762\u7684\u547d\u4ee4\u5c06\u8f93\u51fa\u8fd4\u56de\u4e3a63203\u3002\u8fd9\u610f\u5473\u7740\u7528\u6237\u53ef\u4ee5\u5728\u67d0\u4e2a\u65f6\u95f4\u70b9\u521b\u5efa\u7684\u6240\u6709\u8fdb\u7a0b\u90fd\u53ef\u4ee5\u8fd0\u884c63203\u8fdb\u7a0b\u3002"}),"\n",(0,l.jsx)(e.p,{children:"\u5047\u8bbe\u6848\u4f8b\n\u5047\u8bbe2\u4e2a\u7528\u6237\u540c\u65f6\u8fd0\u884c2\u4e2a\u8fdb\u7a0b\uff0c\u5e76\u4e14\u6bcf\u4e2a\u8fdb\u7a0b\u5927\u91cf\u6d88\u8017\u5185\u5b58\uff0c\u5219\u8fd92\u4e2a\u7528\u6237\u4e2d\u7684\u8fdb\u7a0b\u5c06\u6709\u6548\u5730\u4f7f\u752863203\u4e2a\u7ebf\u7a0b\uff08\u8fdb\u7a0b\u7684\u9650\u5236\uff09\u3002\u56e0\u6b64\uff0c\u8fd9\u79cd\u60c5\u51b5\uff0c\u90a3\u4e482\u4e2a\u7528\u6237\u5c06\u6709\u6548\u5730\u7528\u5b8c\u6574\u4e2a 126406\uff08threads-max\uff09\u7684\u5927\u5c0f\u3002"}),"\n",(0,l.jsx)(e.p,{children:"\u73b0\u5728\uff0c\u6211\u9700\u8981\u786e\u5b9a\u7528\u6237\u53ef\u4ee5\u5728\u4efb\u4f55\u65f6\u95f4\u70b9\u8fd0\u884c\u7684\u8fdb\u7a0b\u6570\u3002\u8fd9\u53ef\u4ee5\u4ece\u6587\u4ef6/etc/security/limits.conf\u4e2d\u786e\u5b9a\u3002\u56e0\u6b64\uff0c\u6b64\u6587\u4ef6\u4e2d\u57fa\u672c\u4e0a\u67092\u4e2a\u8bbe\u7f6e\uff0c\u5982\u4e0b\u6240\u8ff0\u3002"}),"\n",(0,l.jsx)(e.p,{children:"\u8f6f\u9650\u5236\u7c7b\u4f3c\u4e8e\u8b66\u544a\uff0c\u786c\u9650\u5236\u662f\u5b9e\u9645\u6700\u5927\u9650\u5236\u3002\u4f8b\u5982\uff0c\u4ee5\u4e0b\u5185\u5bb9\u5c06\u963b\u6b62\u5b66\u751f\u7ec4\u4e2d\u7684\u4efb\u4f55\u4eba\u62e5\u6709\u8d85\u8fc750\u4e2a\u8fdb\u7a0b\uff0c\u5e76\u4e14\u5c06\u572830\u4e2a\u8fdb\u7a0b\u4e2d\u53d1\u51fa\u8b66\u544a\u3002"}),"\n",(0,l.jsx)(e.p,{children:"@student        hard    nproc           50\n@student        soft    nproc           30"}),"\n",(0,l.jsx)(e.p,{children:"\u5185\u6838\u7ef4\u62a4\u786c\u9650\u5236\uff0c\u800cshell\u5f3a\u5236\u6267\u884c\u8f6f\u9650\u5236\u3002"}),"\n",(0,l.jsx)(e.h4,{id:"142-socks5\u7f51\u7edc\u4ee3\u7406",children:"14.2 Socks5\u7f51\u7edc\u4ee3\u7406"}),"\n",(0,l.jsx)(e.h5,{id:"1\u9996\u5148\u7f16\u8bd1\u5b89\u88c5ss5\u9700\u8981\u5148\u5b89\u88c5\u4e00\u4e9b\u4f9d\u8d56\u7ec4\u4ef6",children:"1\u3001\u9996\u5148\uff0c\u7f16\u8bd1\u5b89\u88c5SS5\u9700\u8981\u5148\u5b89\u88c5\u4e00\u4e9b\u4f9d\u8d56\u7ec4\u4ef6"}),"\n",(0,l.jsx)(e.p,{children:"yum -y install gcc gcc-c++ automake make pam-devel openldap-devel cyrus-sasl-devel openssl-devel"}),"\n",(0,l.jsxs)(e.h5,{id:"2\u53bb\u5b98\u7f51httpss5sourceforgenet-\u4e0b\u8f7dss5\u6700\u65b0\u7248\u672c\u7684\u6e90\u4ee3\u7801",children:["2\u3001\u53bb\u5b98\u7f51",(0,l.jsx)(e.a,{href:"http://ss5.sourceforge.net/",children:"http://ss5.sourceforge.net/"})," \u4e0b\u8f7dSS5\u6700\u65b0\u7248\u672c\u7684\u6e90\u4ee3\u7801"]}),"\n",(0,l.jsxs)(e.p,{children:["\u3000 wget ",(0,l.jsx)(e.a,{href:"https://sourceforge.net/projects/ss5/files/ss5/3.8.9-8/ss5-3.8.9-8.tar.gz",children:"https://sourceforge.net/projects/ss5/files/ss5/3.8.9-8/ss5-3.8.9-8.tar.gz"})]}),"\n",(0,l.jsx)(e.h5,{id:"3\u89e3\u538b\u540e\u5f00\u59cb\u7f16\u8bd1\u5b89\u88c5",children:"3\u3001\u89e3\u538b\u540e\u5f00\u59cb\u7f16\u8bd1\u5b89\u88c5\uff1a"}),"\n",(0,l.jsx)(e.p,{children:"tar zxvf ./ss5-3.8.9-8.tar.gz\ncd ss5-3.8.9\n./configure\nmake\nmake install"}),"\n",(0,l.jsx)(e.h5,{id:"4\u8ba9ss5\u968f\u7cfb\u7edf\u4e00\u8d77\u542f\u52a8",children:"4\u3001\u8ba9SS5\u968f\u7cfb\u7edf\u4e00\u8d77\u542f\u52a8"}),"\n",(0,l.jsx)(e.p,{children:"chmod +x /etc/init.d/ss5\nchkconfig --add ss5\nchkconfig --level 345 ss5 on"}),"\n",(0,l.jsx)(e.h5,{id:"5\u5728ss5conf\u4e2d\u627e\u5230auth\u548cpermit\u4e24\u884c\u6309\u7167\u4e0b\u9762\u7684\u683c\u5f0f\u8fdb\u884c\u4fee\u6539",children:"5\u3001\u5728ss5.conf\u4e2d\u627e\u5230auth\u548cpermit\u4e24\u884c\uff0c\u6309\u7167\u4e0b\u9762\u7684\u683c\u5f0f\u8fdb\u884c\u4fee\u6539"}),"\n",(0,l.jsxs)(e.p,{children:["/etc/opt/ss5/ss5.conf\n",(0,l.jsx)(e.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/operator/m_2ca182f7c916d490a1c1e09b1cc7e3a7_r.png",alt:""})]}),"\n",(0,l.jsx)(e.p,{children:(0,l.jsx)(e.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/operator/m_43952c46bbdf982da5460dd2a97fc598_r.png",alt:""})}),"\n",(0,l.jsx)(e.h5,{id:"6ss5-\u9ed8\u8ba4\u4f7f\u75281080\u7aef\u53e3\u5e76\u5141\u8bb8\u4efb\u4f55\u4eba\u4f7f\u7528\u5982\u679c\u8981\u4fee\u6539\u9ed8\u8ba4\u7aef\u53e3\u8bf7\u4fee\u6539-vi-etcsysconfigss5",children:"6\u3001ss5 \u9ed8\u8ba4\u4f7f\u75281080\u7aef\u53e3\uff0c\u5e76\u5141\u8bb8\u4efb\u4f55\u4eba\u4f7f\u7528\uff0c\u5982\u679c\u8981\u4fee\u6539\u9ed8\u8ba4\u7aef\u53e3\uff0c\u8bf7\u4fee\u6539 vi /etc/sysconfig/ss5"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:'\u3000\u3000\u5728/etc/sysconfig/ss5\u8fd9\u4e2a\u6587\u4ef6\u4e2d\uff0c\u6dfb\u52a0\u4e0b\u9762\u8fd9\u4e00\u884c\u547d\u4ee4\uff0c-b\u540e\u9762\u7684\u53c2\u6570\u4ee3\u8868\u76d1\u542c\u7684ip\u5730\u5740\u548c\u7aef\u53e3\u53f7\n\u3000\u3000# Add startup option here\n\u3000\u3000SS5_OPTS=" -u root -b 0.0.0.0:8080"\n'})}),"\n",(0,l.jsx)(e.h5,{id:"7\u542f\u52a8ss5",children:"7\u3001\u542f\u52a8ss5"}),"\n",(0,l.jsx)(e.p,{children:"service ss5 start"}),"\n",(0,l.jsx)(e.h5,{id:"8\u4e00\u5b9a\u8981\u8bb0\u5f97\u914d\u7f6e\u5b89\u5168\u7ec4\u5f00\u653ess5\u76d1\u542c\u7684\u7aef\u53e3",children:"8\u3001\u4e00\u5b9a\u8981\u8bb0\u5f97\u914d\u7f6e\u5b89\u5168\u7ec4\u5f00\u653eSS5\u76d1\u542c\u7684\u7aef\u53e3"}),"\n",(0,l.jsx)(e.p,{children:(0,l.jsx)(e.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/operator/m_46471e1c82506feb1d707d5ef712ca94_r.png",alt:""})}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"a\u3001\u5f00\u542f\u7528\u6237\u540d\u5bc6\u7801\u9a8c\u8bc1\u673a\u5236 vi /etc/opt/ss5/ss5.conf"}),"\n"]}),"\n",(0,l.jsx)(e.p,{children:"\u5728ss5.conf\u4e2d\u627e\u5230auth\u548cpermit\u4e24\u884c\uff0c\u6309\u7167\u4e0b\u9762\u7684\u683c\u5f0f\u8fdb\u884c\u4fee\u6539"}),"\n",(0,l.jsx)(e.p,{children:"auth 0.0.0.0/0 - u\npermit u 0.0.0.0/0 - 0.0.0.0/0 - - - - -"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"b \u3001\u8bbe\u7f6e\u7528\u6237\u540d\u548c\u5bc6\u7801 vi /etc/opt/ss5/ss5.passwd\n\u4e00\u884c\u4e00\u4e2a\u8d26\u53f7\uff0c\u7528\u6237\u540d\u548c\u5bc6\u7801\u4e4b\u95f4\u7528\u7a7a\u683c\u95f4\u9694\uff0c\u4f8b\u5982\uff1a"}),"\n"]}),"\n",(0,l.jsx)(e.p,{children:"user1 123\nuser2 234"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"c\u3001\u91cd\u542f\u670d\u52a1\u751f\u6548"}),"\n"]}),"\n",(0,l.jsx)(e.p,{children:"service ss5 restart"}),"\n",(0,l.jsx)(e.h4,{id:"143-openvpn",children:"14.3 openvpn"}),"\n",(0,l.jsx)(e.h5,{id:"1\u538b\u6d4b",children:"1\u3001\u538b\u6d4b"}),"\n",(0,l.jsx)(e.p,{children:"yum install -y epel-release\nyum install stress -y"}),"\n",(0,l.jsxs)(e.p,{children:["$ sudo apt install stress\n$ stress --version\n",(0,l.jsx)(e.a,{href:"http://t.zoukankan.com/jiftle-p-12904248.html",children:"http://t.zoukankan.com/jiftle-p-12904248.html"})]}),"\n",(0,l.jsx)(e.h5,{id:"nmap\u7aef\u53e3\u626b\u63cf",children:"nmap\u7aef\u53e3\u626b\u63cf"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"for i in `cat port_host.txt`; do echo \"##############\u4e3b\u673a$i\u7aef\u53e3\u626b\u63cf\u7ed3\u679c##############\"  >> result.txt && nmap -sS  -Pn -n --open -T4  $i  -p  1-65535  | tail -n +6 | sed '$d' | sed '$d'>> result.txt ; done\n"})}),"\n",(0,l.jsx)(e.h5,{id:"2openvpn",children:"2\u3001openvpn"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"[root@beijing-k8s-master-001 ~]# cd /etc/openvpn/\n[root@beijing-k8s-master-001 openvpn]# ls -l \ntotal 4\ndrwxr-x--- 2 root openvpn  92 Mar 22 06:36 client\n-rw-r--r-- 1 root root    522 Mar 22 06:12 client.conf\ndrwxr-x--- 2 root openvpn   6 Apr 21  2021 server\n[root@beijing-k8s-master-001 openvpn]# tree \n.\n\u251c\u2500\u2500 client\n\u2502   \u251c\u2500\u2500 andun.crt\n\u2502   \u251c\u2500\u2500 andun.key\n\u2502   \u251c\u2500\u2500 ca.crt\n\u2502   \u251c\u2500\u2500 client.conf\n\u2502   \u2514\u2500\u2500 clinet.ovpn\n\u251c\u2500\u2500 client.conf\n\u2514\u2500\u2500 server\n\n\n[root@beijing-k8s-master-001 openvpn]# cat client.conf \nclient\ndev tun\nproto tcp\nremote 42.193.116.59  1194  #\u6307\u5b9a\u670d\u52a1\u5668\u5730\u5740\nresolv-retry infinite\nnobind\npersist-key\npersist-tun\nca /etc/openvpn/client/ca.crt\nauth-nocache\ncert /etc/openvpn/client/andun.crt  #\u6b64\u5904\u9700\u8981\u4fee\u6539\u4e3a\u8bc1\u4e66\u540d\u79f0\nkey /etc/openvpn/client/andun.key   #\u6b64\u5904\u9700\u8981\u4fee\u6539\u4e3a\u8bc1\u4e66\u540d\u79f0\nremote-cert-tls server\n#tls-auth ta.key 1\nscript-security 3\n#cipher AES-256-CBC\n#\u6d88\u9664\u8b66\u544a\n#route-nopull\n#data-ciphers AES-256-CBC\nverb 3\n#explicit-exit-notify\ntun-mtu 1500\nlog-append /var/log/openvpn.log\n"})}),"\n",(0,l.jsx)(e.h5,{id:"3vpn_client\u914d\u7f6e",children:"3\u3001vpn_client\u914d\u7f6e"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"[root@beijing-k8s-master-001 ~]# cat /usr/lib/systemd/system/openvpn-client\\@client.service \n[Unit]\nDescription=OpenVPN tunnel for %I\nAfter=syslog.target network-online.target\nWants=network-online.target\nDocumentation=man:openvpn(8)\nDocumentation=https://community.openvpn.net/openvpn/wiki/Openvpn24ManPage\nDocumentation=https://community.openvpn.net/openvpn/wiki/HOWTO\n\n[Service]\nType=notify\nPrivateTmp=true\nWorkingDirectory=/etc/openvpn/client\nExecStart=/usr/sbin/openvpn --suppress-timestamps --nobind --config %i.conf\nCapabilityBoundingSet=CAP_IPC_LOCK CAP_NET_ADMIN CAP_NET_RAW CAP_SETGID CAP_SETUID CAP_SYS_CHROOT CAP_DAC_OVERRIDE\nLimitNPROC=10\nDeviceAllow=/dev/null rw\nDeviceAllow=/dev/net/tun rw\nProtectSystem=true\nProtectHome=true\nKillMode=process\n\n[Install]\nWantedBy=multi-user.target\n"})}),"\n",(0,l.jsxs)(e.p,{children:["\u6587\u6863\u8fdc\u7a0b\u53d1\u9001\nscp  -P 65266 jmx_prometheus_skywalki_agent.tar.gz  ",(0,l.jsx)(e.a,{href:"mailto:zhanglaiqiang@x.x.x.x",children:"zhanglaiqiang@x.x.x.x"}),":"]}),"\n",(0,l.jsx)(e.p,{children:"\u8fdb\u7a0b\u6740\u6b7b\u91cd\u542ftomcat"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"ps -ef|grep tomcat-app |grep java|awk '{print $2}'|xargs sudo kill -9 \n\nsh /usr/local/tomcat-app/bin/startup.sh && tail -f /usr/local/tomcat-app/logs/catalina.out\n"})}),"\n",(0,l.jsx)(e.h5,{id:"4openvpn\u7f51\u7edc\u95ee\u9898-\u5f71\u54cd\u81ea\u52a8\u5316\u53d1\u5e03",children:"4\u3001openvpn\u7f51\u7edc\u95ee\u9898-\u5f71\u54cd\u81ea\u52a8\u5316\u53d1\u5e03"}),"\n",(0,l.jsx)(e.h5,{id:"1\u6d4b\u8bd5\u4e22\u5305",children:"1\u3001\u6d4b\u8bd5\u4e22\u5305"}),"\n",(0,l.jsx)(e.p,{children:"yum -y install mtr #\u5b89\u88c5\u5de5\u5177"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"[zhanglaiqiang@andun-jenkins ~]$ mtr -r  1024  10.8.0.33\nStart: Tue Sep 13 15:11:53 2022\nHOST: andun-jenkins               Loss%   Snt   Last   Avg  Best  Wrst StDev\n  1.|-- 10.8.0.33                 50.0%    10   10.2   9.9   9.2  10.2   0.0\n"})}),"\n",(0,l.jsx)(e.p,{children:"\u6216\u8005 mtr -r -c 30 -s 1024  10.8.0.33\nLoss \u8868\u793a\u4e22\u5305\u767e\u5206\u6bd4\uff0c\u6ce8\u610f\u89c2\u5bdf\u6b64\u9879\u5c31\u884c"}),"\n",(0,l.jsxs)(e.blockquote,{children:["\n",(0,l.jsx)(e.p,{children:"\u5728\u670d\u52a1\u5668\u4e2d\u67e5\u770b\u7f51\u5361ifconfig\uff0c\u660e\u663e\u6709\u4e24\u4e2a\u5730\u5740\u5b58\u5728,\u95ee\u9898\u5c31\u5728\u4e8e\u6b64"}),"\n"]}),"\n",(0,l.jsx)(e.p,{children:(0,l.jsx)(e.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/operator/m_f622401cba6ef30fca3c19c05b23a63b_r.png",alt:""})}),"\n",(0,l.jsx)(e.h5,{id:"2\u5904\u7406\u65b9\u5f0f",children:"2\u3001\u5904\u7406\u65b9\u5f0f\uff1a"}),"\n",(0,l.jsx)(e.p,{children:"1\u3001ps -ef | grep openvpn\n\u6740\u6389kill -9  openvpn_pid \u670d\u52a1\n2\u3001\u91cd\u65b0\u542f\u52a8opevpn\u5ba2\u6237\u7aef\u5373\u53ef"}),"\n",(0,l.jsx)(e.h4,{id:"144-nfs\u90e8\u7f72",children:"14.4 nfs\u90e8\u7f72"}),"\n",(0,l.jsx)(e.p,{children:"ubuntu\u5b89\u88c5nfs-server\u4ee5\u53canfs-client"}),"\n",(0,l.jsx)(e.h5,{id:"ubuntu",children:"ubuntu"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"https://www.tecmint.com/install-nfs-server-on-ubuntu/\n\n1\u3001install  nfs-server \n    sudo apt install nfs-kernel-server\n\t\n2\u3001create dir\nsudo mkdir -p /mnt/nfs_share\n\n3\u3001 \u6388\u6743\nsudo chown -R nobody:nogroup /mnt/nfs_share/\n\n4\u3001  \u6388\u6743\n sudo chmod 777 /mnt/nfs_share/\n \n5\u3001 sudo vim /etc/exports\n/mnt/nfs_share  10.51.8.0/24(rw,sync,no_root_squash)\n6\u3001/mnt/nfs_share  10.51.8.0/24(rw,sync,no_root_squash)\n   rw: Stands for Read/Write.\n   sync: Requires changes to be written to the disk before they are applied.\n   No_subtree_check: Eliminates subtree checking.\n   \n    \u8981\u6388\u4e88\u5bf9\u5355\u4e2a\u5ba2\u6237\u7aef\u7684\u8bbf\u95ee\u6743\u9650\uff0c\u8bf7\u4f7f\u7528\u4ee5\u4e0b\u8bed\u6cd5\uff1a\n    mnt/nfs_share client_IP_1 (re,sync,no_root_squash)\n    \n\t\u5bf9\u4e8e\u591a\u4e2a\u5ba2\u6237\u7aef\uff0c\u5728\u5355\u72ec\u7684\u6587\u4ef6\u4e2d\u6307\u5b9a\u6bcf\u4e2a\u5ba2\u6237\u7aef\uff1a\n    /mnt/nfs_share client_IP_1 (re,sync,no_root_squash) \n    /mnt/nfs_share client_IP_2 (re,sync,no_root_squash)  \nno_root_squash\uff1a\u5ba2\u6237\u673a\u7528root\u8bbf\u95ee\u8be5\u5171\u4eab\u6587\u4ef6\u5939\u65f6\uff0c\u4e0d\u6620\u5c04root\u7528\u6237\u3002\uff08root_squash\uff1a\u5ba2\u6237\u673a\u7528root\u7528\u6237\u8bbf\u95ee\u8be5\u5171\u4eab\u6587\u4ef6\u5939\u65f6\uff0c\u5c06root\u7528\u6237\u6620\u5c04\u6210\u533f\u540d\u7528\u6237\uff09\nno_subtree_check\uff1a\u4e0d\u68c0\u67e5\u7236\u76ee\u5f55\u7684\u6743\u9650\u3002\n\n7\u3001start\n$ sudo exportfs -a \n$ sudo systemctl restart nfs-kernel-server\n\n\n9\u3001client\u5b89\u88c5\nsudo apt install nfs-common\nsudo mkdir -p /mnt/nfs_clientshare\n\n mount 10.51.8.151:/mnt/nfs_share  /mnt/nfs_clientshare\n"})}),"\n",(0,l.jsx)(e.h5,{id:"centos",children:"centos"}),"\n",(0,l.jsx)(e.p,{children:"yum -y install nfs-utils\n[zhanglaiqiang@andun-harbor ~]$ cat /etc/fstab\nUUID=795c9f31-f638-4308-8fab-4a7d5c606beb /                       ext4    defaults          1 1\n172.17.224.119:/share/elasticsearch_data                    /skywalking-sticsearch   nfs  defaults        0 0"}),"\n",(0,l.jsx)(e.h4,{id:"155-grep\u5e38\u7528",children:"15.5 grep\u5e38\u7528"}),"\n",(0,l.jsx)(e.h5,{id:"\u6bd4\u8f83\u4e24\u4e2a\u6587\u4ef6\u662f\u5426\u76f8\u540c",children:"\u6bd4\u8f83\u4e24\u4e2a\u6587\u4ef6\u662f\u5426\u76f8\u540c"}),"\n",(0,l.jsx)(e.p,{children:"1\u3001\u7edf\u8ba1\u4e24\u4e2a\u6587\u672c\u6587\u4ef6\u7684\u76f8\u540c\u884c"}),"\n",(0,l.jsx)(e.p,{children:"grep -Ff    file1   file2"}),"\n",(0,l.jsx)(e.p,{children:"2\u3001\u7edf\u8ba1file1\u4e2d\u6709\uff0cfile2\u4e2d\u6ca1\u6709\u7684\u884c"}),"\n",(0,l.jsx)(e.p,{children:"grep -vFf  file2 file1"}),"\n",(0,l.jsx)(e.h4,{id:"156-\u78c1\u76d8\u6302\u8f7d",children:"15.6 \u78c1\u76d8\u6302\u8f7d"}),"\n",(0,l.jsx)(e.p,{children:"\u95ee\u9898\u63cf\u8ff0\n\u6b63\u5f0f\u73af\u5883\u51fa\u73b0\u4e86\u4e0d\u80fd\u4e0a\u4f20\u56fe\u7247\uff0c\u56fe\u7247\u4e0d\u80fd\u6d4f\u89c8\u7684\u95ee\u9898\uff0c\u4e0a\u6b63\u5f0f\u73af\u5883\u8fdb\u884c\u6392\u67e5\uff0c\u5728\u4f7f\u7528df -h\u547d\u4ee4\u7684\u65f6\u5019\u5361\u4f4f\u4e0d\u52a8\u4e86\uff0c\u5176\u4ed6\u547d\u4ee4\u6ca1\u95ee\u9898\u3002\u8fd0\u884c\u5185\u5b58\u4ee5\u53cacpu\u90fd\u662f\u6b63\u5e38\u7684\u3002\n\u6b63\u5f0f\u73af\u5883\u670d\u52a1\u5668 /data/xxx/upload\u7684\u76ee\u5f55\u662f\u8fdb\u884c\u4e86nfs\u6302\u8f7d\ndf -TH\n\u5728\u53d6\u6d88\u6302\u8f7d\u4e4b\u524d\u627e\u51fa\u539f\u6302\u8f7d\u65b9\u5f0f"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"[root@node01 ~]# mount -l | grep /data/xxx/upload\n192.168.x.10:/data/upload on /data/xxx/upload type nfs4 (rw,relatime,vers=4.1,rsize=1048576,wsize=1048576,namlen=255,hard,proto=tcp,port=0,timeo=600,retrans=2,sec=sys,clientaddr=192.168.x.4,local_lock=none,addr=192.168.x.10)\n\u6216\u8005\u901a\u8fc7\n[root@node01 ~]# cat /etc/mtab | grep /data/xxx/upload\n192.168.x.10:/data/upload /data/xxx/upload nfs4 rw,relatime,vers=4.1,rsize=1048576,wsize=1048576,namlen=255,hard,proto=tcp,port=0,timeo=600,retrans=2,sec=sys,clientaddr=192.168.x.4,local_lock=none,addr=192.168.x.10 0 0\n\n"})}),"\n",(0,l.jsx)(e.p,{children:"\u53ef\u4ee5\u770b\u51fa\u670d\u52a1\u7aef\u4e0e\u5ba2\u6237\u7aef\u7684nfs\u6302\u8f7d\u65b9\u5f0f\n\u95ee\u9898\u89e3\u51b3\n\u9996\u5148\u53ef\u4ee5\u5148\u8ddf\u8e2adf -h\u547d\u4ee4\u5728\u54ea\u91cc\u5361\u4f4f\u4e86\n\u4f7f\u7528strace\u547d\u4ee4"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"strace df -h\n"})}),"\n",(0,l.jsx)(e.p,{children:"\u5982\u679c\u670d\u52a1\u5668\u6ca1\u8fd9\u4e2a\u547d\u4ee4\uff0c\u8fdb\u884c\u5b89\u88c5"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"yum -y install strace\n"})}),"\n",(0,l.jsxs)(e.p,{children:["\u5982\u4e0b\uff0c\u5c31\u51c6\u786e\u7684\u77e5\u9053df -h\u8fd9\u4e2a\u547d\u4ee4\u5361\u5728\u4e86\u54ea\u91cc\uff0c\u679c\u7136\u786e\u5b9e\u662fnfs\u6302\u8f7d\u7684\u90a3\u4e2a\u76ee\u5f55\n",(0,l.jsx)(e.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/operator/m_8679fd475da6b9b889f7cf9dc0108be7_r.png",alt:""})]}),"\n",(0,l.jsxs)(e.p,{children:["\u5c1d\u8bd5\u4f7f\u7528umount\u53d6\u6d88\u6302\u8f7d\u4f46\u662f\u4f1a\u5361\u4f4f\u4e0d\u52a8\n\u5f53\u6709\u522b\u7684\u7a0b\u5e8f\u6b63\u5728\u8bbf\u95ee\u6302\u8f7d\u7684\u6587\u4ef6\u65f6\uff0c\u4e5f\u4f1a\u63d0\u793a\u5378\u8f7d\u5931\u8d25\uff0c\u901a\u8fc7 lsof /xxx \u67e5\u770b\u662f\u54ea\u4e2a\u8fdb\u7a0b\u5360\u7528\u4e86/xxx,kill -9 $pid ,\u7136\u540e\u518d\u5378\u8f7d\uff0c\u8fdb\u7a0b\u5c11\u7684\u65f6\u5019\u8fd9\u4e2a\u65b9\u4fbf\u4e00\u4e9b\uff0c\u4e00\u65e6\u8fdb\u7a0b\u91cf\u8fc7\u5927\u5c31\u4e0d\u65b9\u4fbf\u4e86\n",(0,l.jsx)(e.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/operator/m_83c53144f27734518b5e7c1dda25fb26_r.png",alt:""}),"\n\u52a0\u53c2\u6570 -f \u4e5f\u4f1a\u62a5\u9519\n",(0,l.jsx)(e.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/operator/m_6d4a1a90ae299a0e6f7574b8725ce74b_r.png",alt:""}),"\n\u4f7f\u7528\u3010umount -l /data/xxx/upload\u3011\u547d\u4ee4\u53ef\u4ee5\u89e3\u51b3\u6302\u8f7d\u95ee\u9898\n\u4f7f\u7528\uff1aumount -l /xxx (-l : \u5378\u8f7d\u524d\u68c0\u67e5\u5360\u7528\u8be5\u6302\u8f7d\u6587\u4ef6\u7684\u7a0b\u5e8f\u5e76\u8fc5\u901fkill\u6389\uff0c\u4ee5\u8fbe\u5230\u5feb\u901f\u5378\u8f7d\u7684\u76ee\u7684)\n\u4e5f\u53ef\u4ee5umount -lf /xxx"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"[root@node01 ~]# umount -l /data/xxx/upload\n\n[root@node01 ~]# umount /data/xxx/upload\numount: /data/xxx/upload: not mounted\n"})}),"\n",(0,l.jsxs)(e.p,{children:["\u6d4b\u8bd5df -h\u547d\u4ee4\u662f\u5426\u6062\u590d\u6b63\u5e38\n",(0,l.jsx)(e.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/operator/m_f517eeb6374fef1ee8de2f59032b0622_r.png",alt:""})]}),"\n",(0,l.jsx)(e.p,{children:"\u91cd\u65b0\u8fdb\u884c\u6302\u8f7d\n\u5ba2\u6237\u7aef\uff1a"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"\u91cd\u542fnfs\uff1a\nsystemctl stop nfs\n\nsystemctl start nfs\n"})}),"\n",(0,l.jsx)(e.p,{children:"\u670d\u52a1\u5668\u7aef\uff1a"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"\u91cd\u542fnfs\u3001rpcbind\nsystemctl stop nfs\nsystemctl stop rpcbind\n\n#\u8ba9nfs\u751f\u6548\nexportfs -rv \n\u542f\u52a8\nsystemctl start nfs\nsystemctl start rpcbind\n"})}),"\n",(0,l.jsx)(e.h2,{id:"15\u5185\u5b58",children:"15\u3001\u5185\u5b58"}),"\n",(0,l.jsx)(e.p,{children:"buffer/cache\u5185\u5b58\u5360\u7528\u8fc7\u9ad8\n\u91ca\u653e\u524d\u6700\u597dsync\necho 3 > /proc/sys/vm/drop_caches #\u6e05\u9664pagecache\u548cslab\u5206\u914d\u5668\u4e2d\u7684\u7f13\u5b58\u5bf9\u8c61\u3002"}),"\n",(0,l.jsx)(e.p,{children:(0,l.jsx)(e.a,{href:"https://developer.aliyun.com/article/749727?spm=5176.2020520104.0.0.12d3709aIw40I4",children:"https://developer.aliyun.com/article/749727?spm=5176.2020520104.0.0.12d3709aIw40I4"})}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"echo 1 > /proc/sys/vm/drop_caches #\u6e05\u9664pagecache\u3002\necho 2 > /proc/sys/vm/drop_caches #\u6e05\u9664\u56de\u6536slab\u5206\u914d\u5668\u4e2d\u7684\u5bf9\u8c61\uff08\u5305\u62ec\u76ee\u5f55\u9879\u7f13\u5b58\u548cinode\u7f13\u5b58\uff09\u3002slab\u5206\u914d\u5668\u662f\u5185\u6838\u4e2d\u7ba1\u7406\u5185\u5b58\u7684\u4e00\u79cd\u673a\u5236\uff0c\u5176\u4e2d\u5f88\u591a\u7f13\u5b58\u6570\u636e\u5b9e\u73b0\u90fd\u662f\u7528\u7684pagecache\u3002\necho 3 > /proc/sys/vm/drop_caches #\u6e05\u9664pagecache\u548cslab\u5206\u914d\u5668\u4e2d\u7684\u7f13\u5b58\u5bf9\u8c61\u3002\n\n\n\n"})}),"\n",(0,l.jsx)(e.h2,{id:"16windows\u5e38\u7528\u64cd\u4f5c",children:"16\u3001Windows\u5e38\u7528\u64cd\u4f5c"}),"\n",(0,l.jsx)(e.h3,{id:"161-\u5e38\u7528\u5de5\u5177\u5b89\u88c5",children:"16.1 \u5e38\u7528\u5de5\u5177\u5b89\u88c5"}),"\n",(0,l.jsx)(e.h4,{id:"1windows-\u4e2dmd5\u6821\u9a8c\u5de5\u5177",children:"1\u3001windows \u4e2dmd5\u6821\u9a8c\u5de5\u5177"}),"\n",(0,l.jsx)(e.p,{children:(0,l.jsx)(e.a,{href:"https://github.com/gurnec/HashCheck/releases/tag/v2.4.0",children:"https://github.com/gurnec/HashCheck/releases/tag/v2.4.0"})}),"\n",(0,l.jsx)(e.h4,{id:"2windows\u4ee3\u7406\u670d\u52a1\u5668",children:"2\u3001windows\u4ee3\u7406\u670d\u52a1\u5668"}),"\n",(0,l.jsxs)(e.p,{children:["\u4e0b\u8f7d\u5730\u5740:\n",(0,l.jsx)(e.a,{href:"http://www.ccproxy.com/support.htm",children:"http://www.ccproxy.com/support.htm"})]}),"\n",(0,l.jsx)(e.p,{children:"\u7aef\u53e3\u6620\u5c04\uff1a"}),"\n",(0,l.jsxs)(e.p,{children:["\u56fe1\n",(0,l.jsx)(e.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/operator/m_4a2bc7458996621d99460dbc7f01b995_r.png",alt:""})]}),"\n",(0,l.jsxs)(e.p,{children:["\u56fe2\n",(0,l.jsx)(e.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/operator/m_11b5495547a7fe216a58e8249cc715a0_r.png",alt:""})]}),"\n",(0,l.jsx)(e.h4,{id:"3windows\u4e0a\u5b89\u88c5jq",children:"3\u3001Windows\u4e0a\u5b89\u88c5jq"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-txt",children:'- \u5982\u679c\u8981\u5728Windows\u4e0a\u987a\u5229\u7684\u4f7f\u7528jq\uff0c\u9700\u8981\u5148\u5b89\u88c5chocolatey\u3002\n- \u4ee5\u7ba1\u7406\u5458\u8eab\u4efd\u5f85\u5f00cmd\u7a97\u53e3\uff0c\u8f93\u5165@"%SystemRoot%\\System32\\WindowsPowerShell\\v1.0\\powershell.exe" -NoProfile -InputFormat None -ExecutionPolicy Bypass -Command "iex ((New-Object System.Net.WebClient).DownloadString(\'https://chocolatey.org/install.ps1\'))" && SET "PATH=%PATH%;%ALLUSERSPROFILE%\\chocolatey\\bin"\uff0c\u56de\u8f66\u3002\n- \u63a5\u7740\u8f93\u5165chocolatey install jq\n'})}),"\n",(0,l.jsx)(e.p,{children:"\u5e38\u7528\u547d\u4ee4\nchoco search xxx\uff0c\u67e5\u627e xxx \u5b89\u88c5\u5305\nchoco info xxx\uff0c\u67e5\u770b xxx \u5b89\u88c5\u5305\u4fe1\u606f\nchoco install xxx\uff0c\u5b89\u88c5 xxx \u8f6f\u4ef6\nchoco upgrade xxx\uff0c\u5347\u7ea7 xxx \u8f6f\u4ef6\nchoco uninstall xxx\uff0c \u5378\u8f7d xxx \u8f6f\u4ef6"}),"\n",(0,l.jsx)(e.p,{children:"\u5e38\u7528\u53c2\u6570\n\u2013install-directory=VALUE\uff0c\u4fee\u6539\u6307\u5b9a\u7a0b\u5e8f\u5b89\u88c5\u8def\u5f84\uff08\u53ea\u6709pro\u7248\u53ef\u7528\u514d\u8d39\u7248\u65e0\u6548\uff09\n\u2013version=value \u6307\u5b9a\u7248\u672c"}),"\n",(0,l.jsxs)(e.p,{children:["\u5b98\u65b9\u7a0b\u5e8f\u4ed3\u5e93",(0,l.jsx)(e.a,{href:"https://community.chocolatey.org/packages",children:"https://community.chocolatey.org/packages"})]}),"\n",(0,l.jsx)(e.p,{children:"\u6253\u5f00\u4ed3\u5e93\u5730\u5740\u641c\u7d22\u67e5\u770b\u60f3\u8981\u4e0b\u8f7d\u7684\u7a0b\u5e8f\uff08\u5982MongoDB-compass\u5373mongodb\u7684\u53ef\u89c6\u5316\u5de5\u5177\uff09"}),"\n",(0,l.jsx)(e.p,{children:(0,l.jsx)(e.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/operator/m_f385fd02c12ced0eaf114604730a2de0_r.png",alt:""})}),"\n",(0,l.jsx)(e.p,{children:"\u8f93\u5165\u547d\u4ee4\u4e0b\u8f7d\u5b89\u88c5choco install mongodb-compass"}),"\n",(0,l.jsx)(e.p,{children:"\u9ed8\u8ba4\u5b89\u88c5\u76ee\u5f55\u662fC:\\Program Files\u4e0b\u6253\u5361\u7a0b\u5e8f"}),"\n",(0,l.jsx)(e.p,{children:(0,l.jsx)(e.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/operator/m_b4d44aa6cf5c9a2727f56e175f2a4159_r.png",alt:""})}),"\n",(0,l.jsx)(e.p,{children:"\u5378\u8f7dchoco uninstall mongodb-compass"}),"\n",(0,l.jsx)(e.p,{children:"###4. \u78c1\u76d8\u6d4b\u901f\nCrystalDiskMark"}),"\n",(0,l.jsx)(e.h3,{id:"162-\u5b89\u5168\u767b\u5f55\u914d\u7f6e",children:"16.2 \u5b89\u5168\u767b\u5f55\u914d\u7f6e"}),"\n",(0,l.jsx)(e.h4,{id:"1-\u4fee\u6539\u4ee3\u7406\u7684\u9ed8\u8ba4\u5730\u5740",children:"1. \u4fee\u6539\u4ee3\u7406\u7684\u9ed8\u8ba4\u5730\u5740"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"###\u6ce8\u518c\u8868\n\n\u8ba1\u7b97\u673a\\HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\n"})}),"\n",(0,l.jsxs)(e.p,{children:["\u7136\u540e\u53c2\u8003\u4e0b\u9762\u8fdb\u884c\u64cd\u4f5c\u5373\u53ef\n",(0,l.jsx)(e.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/operator/m_4621882df1f186f334aea582a03c3943_r.png",alt:""})]}),"\n",(0,l.jsx)(e.h3,{id:"163-windows\u4e2dvmware\u901a\u8fc7nat\u76f4\u63a5\u8bbf\u95ee",children:"16.3 windows\u4e2dvmware\u901a\u8fc7nat\u76f4\u63a5\u8bbf\u95ee"}),"\n",(0,l.jsx)(e.h4,{id:"1\u8c03\u8282nat\u7684\u7f51\u6bb5\u4e3a105180-2552552550",children:"1.\u8c03\u8282NAT\u7684\u7f51\u6bb5\u4e3a10.51.8.0 /255.255.255.0"}),"\n",(0,l.jsx)(e.h4,{id:"2\u865a\u62df\u673a\u7f51\u5361\u4fe1\u606f\u914d\u7f6e",children:"2.\u865a\u62df\u673a\u7f51\u5361\u4fe1\u606f\u914d\u7f6e"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"[root@localhost ~]# cat /etc/sysconfig/network-scripts/ifcfg-eth0  \nDEVICE=eth0\nNAME=eth0\nBOOTPROTO=static\nIPADDR=10.51.8.110\nPREFIX=24\nGATEWAY=10.51.8.2\nDNS1=114.114.114.114\nDNS2=10.51.8.1\n# 226.6.6.6 or 180.76.76.76\nDNS2=10.51.8.1\nONBOOT=yes\n"})}),"\n",(0,l.jsx)(e.h4,{id:"3\u8c03\u6574\u865a\u62df\u673a\u7684\u7f51\u7edc\u6a21\u5f0f\u4e3anat\u6a21\u5f0f",children:"3.\u8c03\u6574\u865a\u62df\u673a\u7684\u7f51\u7edc\u6a21\u5f0f\u4e3aNAT\u6a21\u5f0f"}),"\n",(0,l.jsx)(e.h4,{id:"4windows\u7535\u8111\u6dfb\u52a0\u6c38\u4e45\u8def\u7531\u4fe1\u606f",children:"4.windows\u7535\u8111\u6dfb\u52a0\u6c38\u4e45\u8def\u7531\u4fe1\u606f"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"route add  10.51.8.0  mask 255.255.255.0 10.51.8.1  -p\n"})}),"\n",(0,l.jsx)(e.p,{children:"-p\u8868\u793a\u6c38\u4e45\u8def\u7531"}),"\n",(0,l.jsx)(e.h2,{id:"17\u65e5\u5fd7\u6e05\u7406",children:"17\u3001\u65e5\u5fd7\u6e05\u7406"}),"\n",(0,l.jsx)(e.p,{children:"\u6e05\u7406\u65e5\u5fd7,\u5bf9\u4e8e\u5927\u4e8e10M\u7684\u8fdb\u884c\u6e05\u7406\uff0c\u8fd9\u91cc\u4f7f\u7528truncate"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:'find ./* -maxdepth 2 -type f -name "*-json.log" -size +10M  -exec truncate -s 0 {} \\;\n'})}),"\n",(0,l.jsx)(e.h2,{id:"18iptables",children:"18\u3001iptables"}),"\n",(0,l.jsx)(e.p,{children:"\u9700\u6c42: \u5141\u8bb8\u670d\u52a1\u96c6\u7fa4\u4e2d\u6240\u6709\u7684\u670d\u52a1\u90fd\u80fd\u8bbf\u95eeredis,\u9650\u5236\u5c40\u57df\u7f51\u4e2d\u5176\u4ed6\u673a\u5668\u8bbf\u95ee"}),"\n",(0,l.jsx)(e.h3,{id:"\u5148\u8ba1\u7b97\u63a9\u7801",children:"\u5148\u8ba1\u7b97\u63a9\u7801"}),"\n",(0,l.jsx)(e.p,{children:(0,l.jsx)(e.a,{href:"https://www.sojson.com/convert/subnetmask.html",children:"\u5728\u7ebf\u7f51\u7edc\u8ba1\u7b97\u5668 | TCP/IP\u5b50\u7f51\u63a9\u7801\u8ba1\u7b97\u6362\u7b97 \u2014\u5728\u7ebf\u5de5\u5177 (sojson.com)"})}),"\n",(0,l.jsx)(e.p,{children:"\u53ea\u5141\u8bb810.51.8.113\u548c10.51.8.114\u4e24\u4e2a\u5730\u5740\u8bbf\u95ee"}),"\n",(0,l.jsx)(e.p,{children:(0,l.jsx)(e.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/operator/image-20231130183055043.png",alt:"image-20231130183055043"})}),"\n",(0,l.jsx)(e.h3,{id:"\u914d\u7f6e\u89c4\u5219",children:"\u914d\u7f6e\u89c4\u5219"}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"docker"}),"\u73af\u5883\u4f7f\u7528\u8fd9\u79cd\u65b9\u5f0f"]}),"\n",(0,l.jsx)(e.p,{children:"210.34.142.218\u64cd\u4f5c\u8bb0\u5f55"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"iptables -I DOCKER-USER  -p tcp --dport 6379  -j DROP\niptables -I DOCKER-USER -p tcp --dport 6379 -s 210.34.142.208/28 -j ACCEPT\niptables -I DOCKER-USER  -p tcp --dport 27017 -j DROP\niptables -I DOCKER-USER -p tcp --dport 27017  -s 210.34.142.208/28 -j ACCEPT\n"})}),"\n",(0,l.jsx)(e.p,{children:"210.34.142.219\u64cd\u4f5c\u8bb0\u5f55"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"[root@113 ~]# iptables -A INPUT -p tcp --dport 2181 -s 210.34.142.208/28  -j ACCEPT\n[root@113 ~]# iptables -A INPUT -p tcp --dport 2181 -j DROP\n\n#\u540e\u7eed\u6e05\u7406\u65b9\u5f0f\niptables -F INPUT\n"})}),"\n",(0,l.jsx)(e.p,{children:"210.34.142.220\u64cd\u4f5c\u8bb0\u5f55"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"iptables -A INPUT -p tcp --dport 25654 -s 210.34.142.208/28  -j ACCEPT\niptables -A INPUT -p tcp --dport 25654  -j DROP\n\n\niptables-save  >  /opt/ky30.bak  #\u5907\u4efdiptables\niptables-restore  /opt/ky30.bak   #\u8fd8\u539f\n\niptables -I DOCKER-USER  -p tcp -m multiport --sports 21731,25654,27766,31245  -j DROP\niptables -I DOCKER-USER -p tcp -m multiport --sports 21731,25654,27766,31245 -s 210.34.142.208/28 -j ACCEPT\n"})}),"\n",(0,l.jsx)(e.p,{children:"\u6ce8\u610f: docker-user\u8ddfinput\u94fe\u6dfb\u52a0\u987a\u5e8f\u662f\u6b63\u597d\u53cd\u7684"}),"\n",(0,l.jsx)(e.p,{children:"\u4e8c\u8fdb\u5236\u65b9\u5f0f"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"[root@113 ~]# iptables -A INPUT -p tcp --dport 6379 -s 10.51.8.113/30 -j ACCEPT\n[root@113 ~]# iptables -A INPUT -p tcp --dport 6379 -j DROP\n"})}),"\n",(0,l.jsx)(e.p,{children:"\u5220\u9664\u89c4\u5219"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"iptables -D DOCKER-USER 1     #\u5220\u9664\u7b2c\u4e00\u884c\u7684\u6570\u636e\n#\u7b2c\u4e8c\u79cd\u65b9\u5f0f\niptables -D DOCKER-USER -p tcp --dport 6379 -s 210.34.142.208/28 -j ACCEPT\n\n"})}),"\n",(0,l.jsx)(e.p,{children:"\u6d4b\u8bd5\u547d\u4ee4"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"iptables -I DOCKER -p tcp -m multiport --sports 21731,25654,27766,31245  -j DROP\niptables -I DOCKER -s 210.34.142.208/28 -p tcp -m multiport --sports 21731,25654,27766,31245   -j ACCEPT\niptables -I DOCKER -s 210.34.142.219 -p tcp -m multiport --sports 21731,25654,27766,31245   -j ACCEPT\niptables -L -n\n"})}),"\n",(0,l.jsx)(e.h2,{id:"\u683c\u5f0f\u8f6c\u6362",children:"\u683c\u5f0f\u8f6c\u6362"}),"\n",(0,l.jsx)(e.p,{children:"\u5feb\u901f\u5b9e\u73b0\u4e0b\u9762\u5bf9\u5217\u5f0f\u8f6c\u6362\u4e3a\u884c\u5f0f"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:'\u5982\uff1a \naaa\nbbb\nccc\n\u8f6c\u6362\u4e3a:\naaa|bbb|ccc\n\n\u5b9e\u73b0\u65b9\u5f0f\uff1a\npaste -sd "|" filename\n'})})]})}function p(n={}){const{wrapper:e}={...(0,r.R)(),...n.components};return e?(0,l.jsx)(e,{...n,children:(0,l.jsx)(d,{...n})}):d(n)}},8453:(n,e,s)=>{s.d(e,{R:()=>i,x:()=>c});var l=s(6540);const r={},a=l.createContext(r);function i(n){const e=l.useContext(a);return l.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function c(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:i(n.components),l.createElement(a.Provider,{value:e},n.children)}}}]);