"use strict";(self.webpackChunkbookshell=self.webpackChunkbookshell||[]).push([[8142],{9270:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>t,frontMatter:()=>i,metadata:()=>o,toc:()=>a});var s=r(4848),l=r(8453);const i={},c=void 0,o={id:"Sre/\u9762\u8bd5\u9898/\u57fa\u7840\u9762\u8bd5\u9898",title:"\u57fa\u7840\u9762\u8bd5\u9898",description:"Linux\u7cfb\u7edf",source:"@site/docs/Sre/3-\u9762\u8bd5\u9898/1.\u57fa\u7840\u9762\u8bd5\u9898.md",sourceDirName:"Sre/3-\u9762\u8bd5\u9898",slug:"/Sre/\u9762\u8bd5\u9898/\u57fa\u7840\u9762\u8bd5\u9898",permalink:"/en/docs/Sre/\u9762\u8bd5\u9898/\u57fa\u7840\u9762\u8bd5\u9898",draft:!1,unlisted:!1,editUrl:"https://github.com/shouji1128955/bookshell/edit/main/docs/Sre/3-\u9762\u8bd5\u9898/1.\u57fa\u7840\u9762\u8bd5\u9898.md",tags:[],version:"current",lastUpdatedBy:"zhanglaiqiang",lastUpdatedAt:1729361397e3,sidebarPosition:1,frontMatter:{},sidebar:"SreMianshi",next:{title:"kubernetes\u9762\u8bd5\u9898",permalink:"/en/docs/Sre/\u9762\u8bd5\u9898/kubernetes\u9762\u8bd5\u9898"}},d={},a=[{value:"Linux\u7cfb\u7edf",id:"linux\u7cfb\u7edf",level:2},{value:"\u8def\u7531\u4ea4\u6362",id:"\u8def\u7531\u4ea4\u6362",level:4},{value:"Raid,LVM\u670d\u52a1\u5668",id:"raidlvm\u670d\u52a1\u5668",level:4},{value:"KVM",id:"kvm",level:4},{value:"iptables",id:"iptables",level:4},{value:"\u786c\u94fe\u63a5\u548c\u8f6f\u94fe\u63a5\u7684\u533a\u522b",id:"\u786c\u94fe\u63a5\u548c\u8f6f\u94fe\u63a5\u7684\u533a\u522b",level:4},{value:"Linux\u4e2d\u7684\u8f6f\u9650\u5236\u548c\u786c\u9650\u5236\u7684\u533a\u522b\u662f",id:"linux\u4e2d\u7684\u8f6f\u9650\u5236\u548c\u786c\u9650\u5236\u7684\u533a\u522b\u662f",level:4},{value:"Linux \u5f00\u673a\u542f\u52a8\u8fc7\u7a0b",id:"linux-\u5f00\u673a\u542f\u52a8\u8fc7\u7a0b",level:4},{value:"Linux \u4f7f\u7528\u7684\u8fdb\u7a0b\u95f4\u901a\u4fe1\u65b9\u5f0f",id:"linux-\u4f7f\u7528\u7684\u8fdb\u7a0b\u95f4\u901a\u4fe1\u65b9\u5f0f",level:4},{value:"less\u547d\u4ee4",id:"less\u547d\u4ee4",level:4},{value:"ln \u547d\u4ee4",id:"ln-\u547d\u4ee4",level:4},{value:"locate \u547d\u4ee4",id:"locate-\u547d\u4ee4",level:4},{value:"shell\u811a\u672c",id:"shell\u811a\u672c",level:2},{value:"linux namespace",id:"linux-namespace",level:2},{value:"\u6700\u65e9\u671f - Plan 9",id:"\u6700\u65e9\u671f---plan-9",level:4},{value:"\u6700\u65e9\u671f - Plan 9",id:"\u6700\u65e9\u671f---plan-9-1",level:4},{value:"\u6700\u65e9\u671f - Plan 9",id:"\u6700\u65e9\u671f---plan-9-2",level:4},{value:"\u5f00\u59cb\u52a0\u5165 Linux Kernel",id:"\u5f00\u59cb\u52a0\u5165-linux-kernel",level:4},{value:"Linux 3.8 \u57fa\u672c\u5b9e\u73b0",id:"linux-38-\u57fa\u672c\u5b9e\u73b0",level:4},{value:"Namespace \u7c7b\u578b",id:"namespace-\u7c7b\u578b",level:4},{value:"Cgroup namespaces",id:"cgroup-namespaces",level:4},{value:"IPC namespaces",id:"ipc-namespaces",level:4},{value:"Network namespaces",id:"network-namespaces",level:4},{value:"Mount namespaces",id:"mount-namespaces",level:4},{value:"cgroup \u76f8\u5173\u53c2\u8003\u7f51\u53cb\u6587\u6863",id:"cgroup-\u76f8\u5173\u53c2\u8003\u7f51\u53cb\u6587\u6863",level:4},{value:"\u65e5\u5fd7\u6e05\u7406",id:"\u65e5\u5fd7\u6e05\u7406",level:2},{value:"TCP/IP\u534f\u8bae\u6808",id:"tcpip\u534f\u8bae\u6808",level:2},{value:"\u4e09\u6b21\u63e1\u624b",id:"\u4e09\u6b21\u63e1\u624b",level:4},{value:"\u56db\u5c42\u63e1\u624b\u7684\u51e0\u79cd\u72b6\u6001",id:"\u56db\u5c42\u63e1\u624b\u7684\u51e0\u79cd\u72b6\u6001",level:4},{value:"11\u79cd\u72b6\u6001",id:"11\u79cd\u72b6\u6001",level:5},{value:"prometheus\u4e2d\u90fd\u6709metrics\u76d1\u63a7,\u53ef\u4ee5\u6839\u636e\u60c5\u51b5\u8fdb\u884c\u76d1\u63a7",id:"prometheus\u4e2d\u90fd\u6709metrics\u76d1\u63a7\u53ef\u4ee5\u6839\u636e\u60c5\u51b5\u8fdb\u884c\u76d1\u63a7",level:5},{value:"mysql\u76f8\u5173",id:"mysql\u76f8\u5173",level:2},{value:"\u5b89\u5168\u5ba1\u8ba1",id:"\u5b89\u5168\u5ba1\u8ba1",level:2},{value:"nginx",id:"nginx",level:2},{value:"mirror",id:"mirror",level:4},{value:"rewrite",id:"rewrite",level:4},{value:"location",id:"location",level:4},{value:"\u6bd4\u8f83rewrite\u548clocation",id:"\u6bd4\u8f83rewrite\u548clocation",level:4},{value:"nginx\u9650\u6d41",id:"nginx\u9650\u6d41",level:4},{value:"nginx\u4e03\u5c42\u4ee3\u7406",id:"nginx\u4e03\u5c42\u4ee3\u7406",level:4},{value:"nginx\u56db\u5c42\u4ee3\u7406",id:"nginx\u56db\u5c42\u4ee3\u7406",level:4},{value:"\u57fa\u4e8e\u57df\u540d\u7684\u53cd\u5411\u4ee3\u7406",id:"\u57fa\u4e8e\u57df\u540d\u7684\u53cd\u5411\u4ee3\u7406",level:4},{value:"\u6b63\u5411\u4ee3\u7406\u548c\u53cd\u5411\u4ee3\u7406",id:"\u6b63\u5411\u4ee3\u7406\u548c\u53cd\u5411\u4ee3\u7406",level:4}];function h(e){const n={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h4:"h4",h5:"h5",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"linux\u7cfb\u7edf",children:"Linux\u7cfb\u7edf"}),"\n",(0,s.jsx)(n.h4,{id:"\u8def\u7531\u4ea4\u6362",children:"\u8def\u7531\u4ea4\u6362"}),"\n",(0,s.jsx)(n.p,{children:"\u4ea4\u6362\u673a\uff1a \u6d89\u53cavlan\uff0cstp\u534f\u8bae"}),"\n",(0,s.jsx)(n.p,{children:"\u8def\u7531\u5668\uff1a static router,\r\n\u52a8\u6001\u8def\u7531BGP,RIP\uff0cOSPF"}),"\n",(0,s.jsx)(n.p,{children:"\u4ecb\u7ecdvxlan\uff0c vlan\u7684\u533a\u522b\uff0c\u7269\u7406\u7f51\u7edc underlay,  overlay\u53e0\u52a0\u7f51\u7edc"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://segmentfault.com/a/1190000022365692",children:"https://segmentfault.com/a/1190000022365692"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/operator/image-20231104000823756.png",alt:"image-20231104000823756"})}),"\n",(0,s.jsx)(n.h4,{id:"raidlvm\u670d\u52a1\u5668",children:"Raid,LVM\u670d\u52a1\u5668"}),"\n",(0,s.jsx)(n.p,{children:"Raid\u76f8\u5173\u6982\u5ff5\uff1a"}),"\n",(0,s.jsx)(n.p,{children:"Raid0: \u6ca1\u6709\u5197\u4f59\uff0c\u6027\u80fd\u6700\u597d\uff0c\u5197\u4f59\u6700\u5dee\uff0c2\u5757\u8d77  \u78c1\u76d8\u4f7f\u7528\u7387100%"}),"\n",(0,s.jsx)(n.p,{children:"Raid1: \u5197\u4f59\u6700\u597d\uff0c \u4f46\u662f\u6027\u80fd\u6700\u5dee \uff0c2\u5757\u8d77\uff0c\u6700\u591a\u5141\u8bb8\u574f  \u78c1\u76d8\u4f7f\u7528\u738750%"}),"\n",(0,s.jsx)(n.p,{children:"Raid5: \u4e0d\u7ba1\u591a\u5c11\u6570\u636e\u76d8\uff0c\u6700\u591a\u53ea\u80fd\u574f\u4e00\u5757\u76d8\u3002\u78c1\u76d8\u4f7f\u7528\u7387(N-1)/N"}),"\n",(0,s.jsx)(n.p,{children:"Raid10\uff1a"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"RAID 0+1\u662f\u5b58\u50a8\u6027\u80fd\u548c\u6570\u636e\u5b89\u5168\u517c\u987e\u7684\u65b9\u6848\u3002\u5b83\u5728\u63d0\u4f9b\u4e0eRAID 1\u4e00\u6837\u7684\u6570\u636e\u5b89\u5168\u4fdd\u969c\u7684\u540c\u65f6\uff0c\u4e5f\u63d0\u4f9b\u4e86\u4e0eRAID 0\u8fd1\u4f3c\u7684\u5b58\u50a8\u6027\u80fd\u3002"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"\u7531\u4e8eRAID 0+1\u4e5f\u901a\u8fc7\u6570\u636e\u7684100%\u5907\u4efd\u63d0\u4f9b\u6570\u636e\u5b89\u5168\u4fdd\u969c\uff0c\u56e0\u6b64RAID 0+1\u7684\u78c1\u76d8\u7a7a\u95f4\u5229\u7528\u7387\u4e0eRAID 1\u76f8\u540c\uff0c\u5b58\u50a8\u6210\u672c\u9ad8\u3002"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"RAID 0+1\u7684\u7279\u70b9\u4f7f\u5176\u7279\u522b\u9002\u7528\u4e8e\u65e2\u6709\u5927\u91cf\u6570\u636e\u9700\u8981\u5b58\u53d6\uff0c\u540c\u65f6\u53c8\u5bf9\u6570\u636e\u5b89\u5168\u6027\u8981\u6c42\u4e25\u683c\u7684\u9886\u57df\uff0c\u5982\u94f6\u884c\u3001\u91d1\u878d\u3001\u5546\u4e1a\u8d85\u5e02\u3001\u4ed3\u50a8\u5e93\u623f\u3001\u5404\u79cd\u6863\u6848\u7ba1\u7406\u7b49\u3002"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"kvm",children:"KVM"}),"\n",(0,s.jsx)(n.p,{children:"\u57fa\u672c\u7406\u8bba"}),"\n",(0,s.jsx)(n.p,{children:"\u4ec0\u4e48\u662f\u865a\u62df\u5316\uff1f\u5c31\u662f\u5c06\u4e00\u53f0\u7269\u7406\u673a\u865a\u62df\u6210\u591a\u53f0\u865a\u62df\u673a\uff0c\u865a\u62df\u673a\u4e4b\u524d\u4e92\u4e0d\u5e72\u6270\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u4e3a\u4ec0\u4e48\u8981\u7528\u865a\u62df\u5316\uff1f\u5145\u5206\u5229\u7528\u7269\u7406\u8d44\u6e90\uff0c\u63d0\u4f9b\u5197\u4f59\u6027\u3001\u5411\u4e91\u8ba1\u7b97\u6f14\u8fdb\u7684\u5fc5\u8981\u57fa\u7840\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u5e38\u89c1\u7684\u865a\u62df\u5316\u8f6f\u4ef6\uff1fvmware\u3001kvm"}),"\n",(0,s.jsx)(n.p,{children:"\u67e5\u770b\u5f53\u524d\u7cfb\u7edf\u662f\u4f7f\u7528\u54ea\u5bb6\u7684\u865a\u62df\u5316\uff1flscpu"}),"\n",(0,s.jsx)(n.p,{children:"kvm\u7684\u4e09\u4e2a\u7ec4\u4ef6\u53ca\u4f5c\u7528\uff1alibvirt\uff08\u7528\u6765\u7ba1\u7406\u865a\u62df\u673a\uff09\u3001virt\uff08\u5b89\u88c5\u548c\u514b\u9686\u865a\u62df\u673a\uff09\u3001qemu\uff08\u7ba1\u7406\u865a\u62df\u673a\u78c1\u76d8\u7684\uff09"}),"\n",(0,s.jsx)(n.p,{children:"\u78c1\u76d8\u7684\u7c7b\u578b\uff08raw/qcow2\uff09\uff0craw\u4e0d\u652f\u6301\u5feb\u7167\u4f46\u6027\u80fd\u597d\uff0c\u5e38\u7528\u7684\u662fqcom2\u652f\u6301\u5feb\u7167\uff0c\u6027\u80fd\u76f8\u6bd4\u5dee\u4e00\u70b9\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u7b2c\u4e00\u4e2a\u865a\u62df\u8981\u9ed8\u8ba4\u662f\u4fa6\u542c\u57285900\u8fd9\u4e2a\u7aef\u53e3\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u6865\u63a5\u7684\u5de5\u4f5c\u539f\u7406"}),"\n",(0,s.jsx)(n.p,{children:"\u6ce8\u610f:"}),"\n",(0,s.jsx)(n.p,{children:"\u53c2\u8003\u5bb9\u5668\u7ae0\u8282-\u6bd4\u5bf9kvm\u8ddf\u5bb9\u5668\u7684\u533a\u522b"}),"\n",(0,s.jsx)(n.h4,{id:"iptables",children:"iptables"}),"\n",(0,s.jsx)(n.p,{children:"\u8868\u548c\u94fe\uff08\u56db\u8868\u4e94\u94fe\uff09\r\n1.filter \uff08\u8fc7\u6ee4\uff09 \u8fdb\u884c\u5305\u8fc7\u6ee4\u5904\u7406\u7684\u4e00\u5f20\u8868\r\n2.nat \uff08\u6620\u5c04\uff09 \u5bf9\u6570\u636e\u5730\u5740\u4fe1\u606f\u8fdb\u884c\u8f6c\u6362/\u6570\u636e\u5305\u7aef\u53e3\u4fe1\u606f\u8fdb\u884c\u8f6c\u6362\r\n\u5b9e\u73b0\u5185\u7f51\u7528\u6237\u8bbf\u95ee\u5916\u7f51\r\n\u5b9e\u73b0\u5916\u7f51\u7528\u6237\u8bbf\u95ee\u5185\u7f51\r\n3.mangle \uff08\u4e0d\u5e38\u7528\uff09\r\n\u5bf9\u6570\u636e\u5305\u4fe1\u606f\u8fdb\u884c\u6807\u8bb0\r\n4.raw\uff08\u4e0d\u5e38\u7528"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/operator/image-20231102191014927.png",alt:"image-20231102191014927"})}),"\n",(0,s.jsx)(n.p,{children:"\u53ea\u5141\u8bb8\u8fdc\u7a0b\u4e3b\u673a\u8bbf\u95ee\u672c\u673a\u768480\u7aef\u53e3"}),"\n",(0,s.jsx)(n.p,{children:"ptables  -P INPUT DROP"}),"\n",(0,s.jsx)(n.p,{children:"iptables -A INPUT --dport 80 -j ACCEPT"}),"\n",(0,s.jsx)(n.h4,{id:"\u786c\u94fe\u63a5\u548c\u8f6f\u94fe\u63a5\u7684\u533a\u522b",children:"\u786c\u94fe\u63a5\u548c\u8f6f\u94fe\u63a5\u7684\u533a\u522b"}),"\n",(0,s.jsx)(n.p,{children:"1\uff09\u786c\u94fe\u63a5"}),"\n",(0,s.jsx)(n.p,{children:"\u7531\u4e8e Linux \u4e0b\u7684\u6587\u4ef6\u662f\u901a\u8fc7\u7d22\u5f15\u8282\u70b9(inode)\u6765\u8bc6\u522b\u6587\u4ef6\uff0c\u786c\u94fe\u63a5\u53ef\u4ee5\u8ba4\u4e3a\u662f\u4e00\u4e2a\u6307\u9488\uff0c\u6307\u5411\u6587\u4ef6\u7d22\u5f15\u8282\u70b9\u7684\u6307\u9488\uff0c\u7cfb\u7edf\u5e76\u4e0d\u4e3a\u5b83\u91cd\u65b0\u5206\u914d inode \u3002\u6bcf\u6dfb\u52a0\u4e00\u4e2a\u4e00\u4e2a\u786c\u94fe\u63a5\uff0c\u6587\u4ef6\u7684\u94fe\u63a5\u6570\u5c31\u52a0 1 \u3002"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u4e0d\u8db3\uff1a1\uff09\u4e0d\u53ef\u4ee5\u5728\u4e0d\u540c\u6587\u4ef6\u7cfb\u7edf\u7684\u6587\u4ef6\u95f4\u5efa\u7acb\u94fe\u63a5\uff1b2\uff09\u53ea\u6709\u8d85\u7ea7\u7528\u6237\u624d\u53ef\u4ee5\u4e3a\u76ee\u5f55\u521b\u5efa\u786c\u94fe\u63a5\u3002"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"2\uff09\u8f6f\u94fe\u63a5"}),"\n",(0,s.jsx)(n.p,{children:"\u8f6f\u94fe\u63a5\u514b\u670d\u4e86\u786c\u94fe\u63a5\u7684\u4e0d\u8db3\uff0c\u6ca1\u6709\u4efb\u4f55\u6587\u4ef6\u7cfb\u7edf\u7684\u9650\u5236\uff0c\u4efb\u4f55\u7528\u6237\u53ef\u4ee5\u521b\u5efa\u6307\u5411\u76ee\u5f55\u7684\u7b26\u53f7\u94fe\u63a5\u3002\u56e0\u800c\u73b0\u5728\u66f4\u4e3a\u5e7f\u6cdb\u4f7f\u7528\uff0c\u5b83\u5177\u6709\u66f4\u5927\u7684\u7075\u6d3b\u6027\uff0c\u751a\u81f3\u53ef\u4ee5\u8de8\u8d8a\u4e0d\u540c\u673a\u5668\u3001\u4e0d\u540c\u7f51\u7edc\u5bf9\u6587\u4ef6\u8fdb\u884c\u94fe\u63a5\u3002"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u4e0d\u8db3\uff1a\u56e0\u4e3a\u94fe\u63a5\u6587\u4ef6\u5305\u542b\u6709\u539f\u6587\u4ef6\u7684\u8def\u5f84\u4fe1\u606f\uff0c\u6240\u4ee5\u5f53\u539f\u6587\u4ef6\u4ece\u4e00\u4e2a\u76ee\u5f55\u4e0b\u79fb\u5230\u5176\u4ed6\u76ee\u5f55\u4e2d\uff0c\u518d\u8bbf\u95ee\u94fe\u63a5\u6587\u4ef6\uff0c\u7cfb\u7edf\u5c31\u627e\u4e0d\u5230\u4e86\uff0c\u800c\u786c\u94fe\u63a5\u5c31\u6ca1\u6709\u8fd9\u4e2a\u7f3a\u9677\uff0c\u4f60\u60f3\u600e\u4e48\u79fb\u5c31\u600e\u4e48\u79fb\uff1b\u8fd8\u6709\u5b83\u8981\u7cfb\u7edf\u5206\u914d\u989d\u5916\u7684\u7a7a\u95f4\u7528\u4e8e\u5efa\u7acb\u65b0\u7684\u7d22\u5f15\u8282\u70b9\u548c\u4fdd\u5b58\u539f\u6587\u4ef6\u7684\u8def\u5f84\u3002"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u5b9e\u9645\u573a\u666f\u4e0b\uff0c\u57fa\u672c\u662f\u4f7f\u7528\u8f6f\u94fe\u63a5"}),"\u3002\u603b\u7ed3\u533a\u522b\u5982\u4e0b\uff1a"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u786c\u94fe\u63a5\u4e0d\u53ef\u4ee5\u8de8\u5206\u533a\uff0c\u8f6f\u4ef6\u94fe\u53ef\u4ee5\u8de8\u5206\u533a\u3002"}),"\n",(0,s.jsx)(n.li,{children:"\u786c\u94fe\u63a5\u6307\u5411\u4e00\u4e2a inode \u8282\u70b9\uff0c\u800c\u8f6f\u94fe\u63a5\u5219\u662f\u521b\u5efa\u4e00\u4e2a\u65b0\u7684 inode \u8282\u70b9\u3002"}),"\n",(0,s.jsx)(n.li,{children:"\u5220\u9664\u786c\u94fe\u63a5\u6587\u4ef6\uff0c\u4e0d\u4f1a\u5220\u9664\u539f\u6587\u4ef6\uff0c\u5220\u9664\u8f6f\u94fe\u63a5\u6587\u4ef6\uff0c\u4f1a\u628a\u539f\u6587\u4ef6\u5220\u9664\u3002"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"linux\u4e2d\u7684\u8f6f\u9650\u5236\u548c\u786c\u9650\u5236\u7684\u533a\u522b\u662f",children:"Linux\u4e2d\u7684\u8f6f\u9650\u5236\u548c\u786c\u9650\u5236\u7684\u533a\u522b\u662f"}),"\n",(0,s.jsx)(n.p,{children:"\u5728Linux\u4e2d\uff0c\u8f6f\u9650\u5236\u662f\u7cfb\u7edf\u4e3a\u4e86\u4fdd\u62a4\u6587\u4ef6\u7cfb\u7edf\u800c\u8bbe\u7f6e\u7684\u4e00\u4e2a\u9650\u5236\uff0c\u5f53\u8fbe\u5230\u8f6f\u9650\u5236\u65f6\uff0c\u7cfb\u7edf\u4f1a\u53d1\u51fa\u8b66\u544a\uff0c\u4f46\u4ecd\u7136\u5141\u8bb8\u64cd\u4f5c\u3002\u800c\u786c\u9650\u5236\u5219\u662f\u7cfb\u7edf\u4e3a\u4e86\u4fdd\u62a4\u6587\u4ef6\u7cfb\u7edf\u800c\u8bbe\u7f6e\u7684\u4e00\u4e2a\u7edd\u5bf9\u9650\u5236\uff0c\u5f53\u8fbe\u5230\u786c\u9650\u5236\u65f6\uff0c\u7cfb\u7edf\u5c06\u7981\u6b62\u64cd\u4f5c"}),"\n",(0,s.jsx)(n.h4,{id:"linux-\u5f00\u673a\u542f\u52a8\u8fc7\u7a0b",children:"Linux \u5f00\u673a\u542f\u52a8\u8fc7\u7a0b"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"1\u3001\u4e3b\u673a\u52a0\u7535\u81ea\u68c0\uff0c\u52a0\u8f7d BIOS \u786c\u4ef6\u4fe1\u606f"}),"\n",(0,s.jsx)(n.li,{children:"2\u3001\u8bfb\u53d6 MBR \u7684\u5f15\u5bfc\u6587\u4ef6(GRUB\u3001LILO)"}),"\n",(0,s.jsx)(n.li,{children:"3\u3001\u5f15\u5bfc Linux \u5185\u6838"}),"\n",(0,s.jsx)(n.li,{children:"4\u3001\u8fd0\u884c\u7b2c\u4e00\u4e2a\u8fdb\u7a0b init (\u8fdb\u7a0b\u53f7\u6c38\u8fdc\u4e3a 1 )"}),"\n",(0,s.jsx)(n.li,{children:"5\u3001\u8fdb\u5165\u76f8\u5e94\u7684\u8fd0\u884c\u7ea7\u522b"}),"\n",(0,s.jsx)(n.li,{children:"6\u3001\u8fd0\u884c\u7ec8\u7aef\uff0c\u8f93\u5165\u7528\u6237\u540d\u548c\u5bc6\u7801"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"linux-\u4f7f\u7528\u7684\u8fdb\u7a0b\u95f4\u901a\u4fe1\u65b9\u5f0f",children:"Linux \u4f7f\u7528\u7684\u8fdb\u7a0b\u95f4\u901a\u4fe1\u65b9\u5f0f"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"1\u3001\u7ba1\u9053(pipe)\u3001\u6d41\u7ba1\u9053(s_pipe)\u3001\u6709\u540d\u7ba1\u9053(FIFO)"}),"\n",(0,s.jsx)(n.li,{children:"2\u3001\u4fe1\u53f7(signal)"}),"\n",(0,s.jsx)(n.li,{children:"3\u3001\u6d88\u606f\u961f\u5217"}),"\n",(0,s.jsx)(n.li,{children:"4\u3001\u5171\u4eab\u5185\u5b58"}),"\n",(0,s.jsx)(n.li,{children:"5\u3001\u4fe1\u53f7\u91cf"}),"\n",(0,s.jsx)(n.li,{children:"6\u3001\u5957\u63a5\u5b57(socket)"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"less\u547d\u4ee4",children:"less\u547d\u4ee4"}),"\n",(0,s.jsx)(n.p,{children:"\uff081\uff09ps \u67e5\u770b\u8fdb\u7a0b\u4fe1\u606f\u5e76\u901a\u8fc7 less \u5206\u9875\u663e\u793a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"ps -aux | less -N\n"})}),"\n",(0,s.jsx)(n.p,{children:"\uff082\uff09\u67e5\u770b\u591a\u4e2a\u6587\u4ef6"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"less 1.log 2.log\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u53ef\u4ee5\u4f7f\u7528 n \u67e5\u770b\u4e0b\u4e00\u4e2a\uff0c\u4f7f\u7528 p \u67e5\u770b\u524d\u4e00\u4e2a\u3002"}),"\n",(0,s.jsx)(n.h4,{id:"ln-\u547d\u4ee4",children:"ln \u547d\u4ee4"}),"\n",(0,s.jsx)(n.p,{children:"\u529f\u80fd\u662f\u4e3a\u6587\u4ef6\u5728\u53e6\u5916\u4e00\u4e2a\u4f4d\u7f6e\u5efa\u7acb\u4e00\u4e2a\u540c\u6b65\u7684\u94fe\u63a5\uff0c\u5f53\u5728\u4e0d\u540c\u76ee\u5f55\u9700\u8981\u8be5\u95ee\u9898\u65f6\uff0c\u5c31\u4e0d\u9700\u8981\u4e3a\u6bcf\u4e00\u4e2a\u76ee\u5f55\u521b\u5efa\u540c\u6837\u7684\u6587\u4ef6\uff0c\u901a\u8fc7 ln \u521b\u5efa\u7684\u94fe\u63a5\uff08link\uff09\u51cf\u5c11\u78c1\u76d8\u5360\u7528\u91cf\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u94fe\u63a5\u5206\u7c7b\uff1a\u8f6f\u4ef6\u94fe\u63a5\u53ca\u786c\u94fe\u63a5"}),"\n",(0,s.jsx)(n.p,{children:"\u8f6f\u94fe\u63a5\uff1a"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"1.\u8f6f\u94fe\u63a5\uff0c\u4ee5\u8def\u5f84\u7684\u5f62\u5f0f\u5b58\u5728\u3002\u7c7b\u4f3c\u4e8eWindows\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u7684\u5feb\u6377\u65b9\u5f0f"}),"\n",(0,s.jsx)(n.li,{children:"2.\u8f6f\u94fe\u63a5\u53ef\u4ee5 \u8de8\u6587\u4ef6\u7cfb\u7edf \uff0c\u786c\u94fe\u63a5\u4e0d\u53ef\u4ee5"}),"\n",(0,s.jsx)(n.li,{children:"3.\u8f6f\u94fe\u63a5\u53ef\u4ee5\u5bf9\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684\u6587\u4ef6\u540d\u8fdb\u884c\u94fe\u63a5"}),"\n",(0,s.jsx)(n.li,{children:"4.\u8f6f\u94fe\u63a5\u53ef\u4ee5\u5bf9\u76ee\u5f55\u8fdb\u884c\u94fe\u63a5"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u786c\u94fe\u63a5:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"1.\u786c\u94fe\u63a5\uff0c\u4ee5\u6587\u4ef6\u526f\u672c\u7684\u5f62\u5f0f\u5b58\u5728\u3002\u4f46\u4e0d\u5360\u7528\u5b9e\u9645\u7a7a\u95f4\u3002"}),"\n",(0,s.jsx)(n.li,{children:"2.\u4e0d\u5141\u8bb8\u7ed9\u76ee\u5f55\u521b\u5efa\u786c\u94fe\u63a5"}),"\n",(0,s.jsx)(n.li,{children:"3.\u786c\u94fe\u63a5\u53ea\u6709\u5728\u540c\u4e00\u4e2a\u6587\u4ef6\u7cfb\u7edf\u4e2d\u624d\u80fd\u521b\u5efa"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u9700\u8981\u6ce8\u610f"}),"\uff1a"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u7b2c\u4e00\uff1aln\u547d\u4ee4\u4f1a\u4fdd\u6301\u6bcf\u4e00\u5904\u94fe\u63a5\u6587\u4ef6\u7684\u540c\u6b65\u6027\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u4e0d\u8bba\u4f60\u6539\u52a8\u4e86\u54ea\u4e00\u5904\uff0c\u5176\u5b83\u7684\u6587\u4ef6\u90fd\u4f1a\u53d1\u751f\u76f8\u540c\u7684\u53d8\u5316\uff1b"}),"\n",(0,s.jsx)(n.li,{children:"\u7b2c\u4e8c\uff1aln\u7684\u94fe\u63a5\u53c8\u5206\u8f6f\u94fe\u63a5\u548c\u786c\u94fe\u63a5\u4e24\u79cd\uff0c\u8f6f\u94fe\u63a5\u5c31\u662fln \u2013s \u6e90\u6587\u4ef6 \u76ee\u6807\u6587\u4ef6\uff0c\u5b83\u53ea\u4f1a\u5728\u4f60\u9009\u5b9a\u7684\u4f4d\u7f6e\u4e0a\u751f\u6210\u4e00\u4e2a\u6587\u4ef6\u7684\u955c\u50cf\uff0c\u4e0d\u4f1a\u5360\u7528\u78c1\u76d8\u7a7a\u95f4\uff0c\u786c\u94fe\u63a5 ln \u6e90\u6587\u4ef6 \u76ee\u6807\u6587\u4ef6\uff0c\u6ca1\u6709\u53c2\u6570-s\uff0c \u5b83\u4f1a\u5728\u4f60\u9009\u5b9a\u7684\u4f4d\u7f6e\u4e0a\u751f\u6210\u4e00\u4e2a\u548c\u6e90\u6587\u4ef6\u5927\u5c0f\u76f8\u540c\u7684\u6587\u4ef6\uff0c\u65e0\u8bba\u662f\u8f6f\u94fe\u63a5\u8fd8\u662f\u786c\u94fe\u63a5\uff0c\u6587\u4ef6\u90fd\u4fdd\u6301\u540c\u6b65\u53d8\u5316\u3002"}),"\n",(0,s.jsx)(n.li,{children:"\u7b2c\u4e09\uff1aln\u6307\u4ee4\u7528\u5728\u94fe\u63a5\u6587\u4ef6\u6216\u76ee\u5f55\uff0c\u5982\u540c\u65f6\u6307\u5b9a\u4e24\u4e2a\u4ee5\u4e0a\u7684\u6587\u4ef6\u6216\u76ee\u5f55\uff0c\u4e14\u6700\u540e\u7684\u76ee\u7684\u5730\u662f\u4e00\u4e2a\u5df2\u7ecf\u5b58\u5728\u7684\u76ee\u5f55\uff0c\u5219\u4f1a\u628a\u524d\u9762\u6307\u5b9a\u7684\u6240\u6709\u6587\u4ef6\u6216\u76ee\u5f55\u590d\u5236\u5230\u8be5\u76ee\u5f55\u4e2d\u3002\u82e5\u540c\u65f6\u6307\u5b9a\u591a\u4e2a\u6587\u4ef6\u6216\u76ee\u5f55\uff0c\u4e14\u6700\u540e\u7684\u76ee\u7684\u5730\u5e76\u975e\u662f\u4e00\u4e2a\u5df2\u5b58\u5728\u7684\u76ee\u5f55\uff0c\u5219\u4f1a\u51fa\u73b0\u9519\u8bef\u4fe1\u606f\u3002"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u5e38\u7528\u53c2\u6570"}),"\uff1a"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"-b \u5220\u9664\uff0c\u8986\u76d6\u4ee5\u524d\u5efa\u7acb\u7684\u94fe\u63a5\r\n-s \u8f6f\u94fe\u63a5\uff08\u7b26\u53f7\u94fe\u63a5\uff09\r\n-v \u663e\u793a\u8be6\u7ec6\u5904\u7406\u8fc7\u7a0b\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u5b9e\u4f8b"}),"\uff1a"]}),"\n",(0,s.jsx)(n.p,{children:"\uff081\uff09\u7ed9\u6587\u4ef6\u521b\u5efa\u8f6f\u94fe\u63a5\uff0c\u5e76\u663e\u793a\u64cd\u4f5c\u4fe1\u606f"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"ln -sv source.log link.log\n"})}),"\n",(0,s.jsx)(n.p,{children:"\uff082\uff09\u7ed9\u6587\u4ef6\u521b\u5efa\u786c\u94fe\u63a5\uff0c\u5e76\u663e\u793a\u64cd\u4f5c\u4fe1\u606f"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"ln -v source.log link1.log\n"})}),"\n",(0,s.jsx)(n.p,{children:"\uff083\uff09\u7ed9\u76ee\u5f55\u521b\u5efa\u8f6f\u94fe\u63a5"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"ln -sv /opt/soft/test/test3 /opt/soft/test/test5\n"})}),"\n",(0,s.jsx)(n.h4,{id:"locate-\u547d\u4ee4",children:"locate \u547d\u4ee4"}),"\n",(0,s.jsx)(n.p,{children:"locate \u901a\u8fc7\u641c\u5bfb\u7cfb\u7edf\u5185\u5efa\u6587\u6863\u6570\u636e\u5e93\u8fbe\u5230\u5feb\u901f\u627e\u5230\u6863\u6848\uff0c\u6570\u636e\u5e93\u7531 updatedb \u7a0b\u5e8f\u6765\u66f4\u65b0\uff0cupdatedb \u662f\u7531 cron daemon \u5468\u671f\u6027\u8c03\u7528\u7684\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b locate \u547d\u4ee4\u5728\u641c\u5bfb\u6570\u636e\u5e93\u65f6\u6bd4\u7531\u6574\u4e2a\u7531\u786c\u76d8\u8d44\u6599\u6765\u641c\u5bfb\u8d44\u6599\u6765\u5f97\u5feb\uff0c\u4f46\u8f83\u5dee\u52b2\u7684\u662f locate \u6240\u627e\u5230\u7684\u6863\u6848\u82e5\u662f\u6700\u8fd1\u624d\u5efa\u7acb\u6216 \u521a\u66f4\u540d\u7684\uff0c\u53ef\u80fd\u4f1a\u627e\u4e0d\u5230\uff0c\u5728\u5185\u5b9a\u503c\u4e2d\uff0cupdatedb \u6bcf\u5929\u4f1a\u8dd1\u4e00\u6b21\uff0c\u53ef\u4ee5\u7531\u4fee\u6539 crontab \u6765\u66f4\u65b0\u8bbe\u5b9a\u503c (etc/crontab)\u3002"}),"\n",(0,s.jsx)(n.p,{children:"locate \u4e0e find \u547d\u4ee4\u76f8\u4f3c\uff0c\u53ef\u4ee5\u4f7f\u7528\u5982 *\u3001? \u7b49\u8fdb\u884c\u6b63\u5219\u5339\u914d\u67e5\u627e"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u5e38\u7528\u53c2\u6570"}),"\uff1a"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"-l num\uff08\u8981\u663e\u793a\u7684\u884c\u6570\uff09\r\n-f   \u5c06\u7279\u5b9a\u7684\u6863\u6848\u7cfb\u7edf\u6392\u9664\u5728\u5916\uff0c\u5982\u5c06proc\u6392\u9664\u5728\u5916\r\n-r   \u4f7f\u7528\u6b63\u5219\u8fd0\u7b97\u5f0f\u505a\u4e3a\u5bfb\u627e\u6761\u4ef6\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u5b9e\u4f8b"}),"\uff1a"]}),"\n",(0,s.jsx)(n.p,{children:"\uff081\uff09\u67e5\u627e\u548c pwd \u76f8\u5173\u7684\u6240\u6709\u6587\u4ef6(\u6587\u4ef6\u540d\u4e2d\u5305\u542b pwd\uff09"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"locate pwd\n"})}),"\n",(0,s.jsx)(n.p,{children:"\uff082\uff09\u641c\u7d22 etc \u76ee\u5f55\u4e0b\u6240\u6709\u4ee5 sh \u5f00\u5934\u7684\u6587\u4ef6"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"locate /etc/sh\n"})}),"\n",(0,s.jsx)(n.p,{children:"\uff083\uff09\u67e5\u627e /var \u76ee\u5f55\u4e0b\uff0c\u4ee5 reason \u7ed3\u5c3e\u7684\u6587\u4ef6"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"locate -r '^/var.*reason$'\uff08\u5176\u4e2d.\u8868\u793a\u4e00\u4e2a\u5b57\u7b26\uff0c*\u8868\u793a\u4efb\u52a1\u591a\u4e2a\uff1b.*\u8868\u793a\u4efb\u610f\u591a\u4e2a\u5b57\u7b26\uff09\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u5176\u4ed6\u53c2\u8003"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.a,{href:"https://github.com/ThinkingHan/Java-review-gudie/blob/master/%E9%9D%A2%E8%AF%95%E9%A2%98%E9%9B%86/Linux%E9%9D%A2%E8%AF%95%E9%A2%98.md",children:"Java-review-gudie/\u9762\u8bd5\u9898\u96c6/Linux\u9762\u8bd5\u9898.md at master \xb7 ThinkingHan/Java-review-gudie \xb7 GitHub"})})}),"\n",(0,s.jsx)(n.h2,{id:"shell\u811a\u672c",children:"shell\u811a\u672c"}),"\n",(0,s.jsx)(n.p,{children:"\u53d8\u91cf\u5f15\u7528"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"$name \u6216\u8005 ${name}\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u547d\u4ee4\u5f15\u7528:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"Name=`command` \u6216\u8005 name =$(command)\r\n\r\n\u67e5\u770b\u53d8\u91cf set \r\n\r\n\u5220\u9664\u53d8\u91cf: unset name \n"})}),"\n",(0,s.jsx)(n.p,{children:"\u73af\u5883\u53d8\u91cf:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"Export name=value \u6216\u8005  declare -x name=value\r\n\r\n\u67e5\u770b\u73af\u5883\u53d8\u91cf; env ,printenv ,export,declare -x\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u53ea\u8bfb\u53d8\u91cf: \u53ea\u80fd\u7533\u660e\u5b9a\u4e49\uff0c\u540e\u7eed\u4e0d\u80fd\u4fee\u6539"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"Readonly name , declare -r name\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u53c2\u6570"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"1\u3001$#\uff1a\u8868\u793a\u6267\u884c\u811a\u672c\u4f20\u5165\u53c2\u6570\u7684\u4e2a\u6570\r\n2\u3001$*\uff1a\u8868\u793a\u6267\u884c\u811a\u672c\u4f20\u5165\u53c2\u6570\u7684\u5217\u8868\uff08\u4e0d\u5305\u62ec$0\uff09\r\n3\u3001$$\uff1a\u8868\u793a\u8fdb\u7a0b\u7684id\uff1bShell\u672c\u8eab\u7684PID\uff08ProcessID\uff0c\u5373\u811a\u672c\u8fd0\u884c\u7684\u5f53\u524d \u8fdb\u7a0bID\u53f7\uff09\r\n4\u3001$!\uff1aShell\u6700\u540e\u8fd0\u884c\u7684\u540e\u53f0Process\u7684PID(\u540e\u53f0\u8fd0\u884c\u7684\u6700\u540e\u4e00\u4e2a\u8fdb\u7a0b\u7684 \u8fdb\u7a0bID\u53f7)\r\n5\u3001$@\uff1a\u8868\u793a\u6267\u884c\u811a\u672c\u4f20\u5165\u53c2\u6570\u7684\u6240\u6709\u4e2a\u6570\uff08\u4e0d\u5305\u62ec$0\uff09\r\n6\u3001$0\uff1a\u8868\u793a\u6267\u884c\u7684\u811a\u672c\u540d\u79f0\r\n7\u3001$1\uff1a\u8868\u793a\u7b2c\u4e00\u4e2a\u53c2\u6570\r\n8\u3001$2\uff1a\u8868\u793a\u7b2c\u4e8c\u4e2a\u53c2\u6570\r\n9\u3001$?\uff1a\u8868\u793a\u811a\u672c\u6267\u884c\u7684\u72b6\u6001\uff0c0\u8868\u793a\u6b63\u5e38\uff0c\u5176\u4ed6\u8868\u793a\u9519\u8bef\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u200b      Set - - \u6e05\u7a7a\u6240\u6709\u7684\u4f4d\u7f6e\u53d8\u91cf"}),"\n",(0,s.jsx)(n.p,{children:"\u9000\u51fa\u72b6\u6001\u7801\u53d8\u91cf\uff1a"}),"\n",(0,s.jsx)(n.p,{children:"\u200b      $? \u503c\u4e3a0 \u6210\u529f\uff0c  $? 1-255\u4ee3\u8868\u5931\u8d25"}),"\n",(0,s.jsx)(n.p,{children:"\u200b      #\u751f\u6210 0 - 49 \u4e4b\u95f4\u968f\u673a\u6570 echo $[$RANDOM%50]"}),"\n",(0,s.jsx)(n.p,{children:'#\u968f\u673a\u5b57\u4f53\u989c\u8272 [root@centos8 ~]#echo -e "\\033[1;$[RANDOM%7+31]mmagedu\\033[0m"'}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-txt",children:'-gt \u662f\u5426\u5927\u4e8e\r\n-ge \u662f\u5426\u5927\u4e8e\u7b49\u4e8e\r\n-eq \u662f\u5426\u7b49\u4e8e\r\n-ne \u662f\u5426\u4e0d\u7b49\u4e8e\r\n-lt \u662f\u5426\u5c0f\u4e8e\r\n-le \u662f\u5426\u5c0f\u4e8e\u7b49\u4e8e\r\n-z "STRING" \u5b57\u7b26\u4e32\u662f\u5426\u4e3a\u7a7a\uff0c\u7a7a\u4e3a\u771f\uff0c\u4e0d\u7a7a\u4e3a\u5047 \r\n-n "STRING" \u5b57\u7b26\u4e32\u662f\u5426\u4e0d\u7a7a\uff0c\u4e0d\u7a7a\u4e3a\u771f\uff0c\u7a7a\u4e3a\u5047\r\n\\> ascii\u7801\u662f\u5426\u5927\u4e8eascii\u7801\r\n\r\n=~ \u5de6\u4fa7\u5b57\u7b26\u4e32\u662f\u5426\u80fd\u591f\u88ab\u53f3\u4fa7\u7684PATTERN\u6240\u5339\u914d \u6ce8\u610f: \u6b64\u8868\u8fbe\u5f0f\u7528\u4e8e[[ ]]\u4e2d\uff1b\u6269\u5c55\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"\u6587\u4ef6\u6d4b\u8bd5"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-txt",children:"-a FILE\uff1a\u540c -e \r\n-e FILE: \u6587\u4ef6\u5b58\u5728\u6027\u6d4b\u8bd5\uff0c\u5b58\u5728\u4e3a\u771f\uff0c\u5426\u5219\u4e3a\u5047 \r\n-b FILE\uff1a\u662f\u5426\u5b58\u5728\u4e14\u4e3a\u5757\u8bbe\u5907\u6587\u4ef6 \r\n-c FILE\uff1a\u662f\u5426\u5b58\u5728\u4e14\u4e3a\u5b57\u7b26\u8bbe\u5907\u6587\u4ef6 \r\n-d FILE\uff1a\u662f\u5426\u5b58\u5728\u4e14\u4e3a\u76ee\u5f55\u6587\u4ef6 \r\n-f FILE\uff1a\u662f\u5426\u5b58\u5728\u4e14\u4e3a\u666e\u901a\u6587\u4ef6 \r\n-h FILE \u6216 -L FILE\uff1a\u5b58\u5728\u4e14\u4e3a\u7b26\u53f7\u94fe\u63a5\u6587\u4ef6 \r\n-p FILE\uff1a\u662f\u5426\u5b58\u5728\u4e14\u4e3a\u547d\u540d\u7ba1\u9053\u6587\u4ef6 \r\n-S FILE\uff1a\u662f\u5426\u5b58\u5728\u4e14\u4e3a\u5957\u63a5\u5b57\u6587\u4ef6\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u914d\u7f6e\u6587\u4ef6\u6267\u884c\u987a\u5e8f\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"/etc/profile --\x3e /etc/profile.d/*.sh --\x3e ~/.bash_profile --\x3e ~/.bashrc --\x3e /etc/bashrc\n"})}),"\n",(0,s.jsx)(n.p,{children:"profile\u7c7b\u548cbashrc\u7c7b"}),"\n",(0,s.jsx)(n.p,{children:"profile\u7c7b\u4e3a\u4ea4\u4e92\u5f0f\u767b\u5f55\u7684shell\u63d0\u4f9b\u914d\u7f6e"}),"\n",(0,s.jsx)(n.p,{children:"\u5168\u5c40\uff1a/etc/profile, /etc/profile.d/*.sh"}),"\n",(0,s.jsx)(n.p,{children:"\u4e2a\u4eba\uff1a~/.bash_profile"}),"\n",(0,s.jsx)(n.p,{children:"\u529f\u7528\uff1a"}),"\n",(0,s.jsx)(n.p,{children:"(1) \u7528\u4e8e\u5b9a\u4e49\u73af\u5883\u53d8\u91cf"}),"\n",(0,s.jsx)(n.p,{children:"(2) \u8fd0\u884c\u547d\u4ee4\u6216\u811a\u672c"}),"\n",(0,s.jsx)(n.p,{children:"Bashrc\u7c7b"}),"\n",(0,s.jsx)(n.p,{children:"bashrc\u7c7b\uff1a\u4e3a\u975e\u4ea4\u4e92\u5f0f\u548c\u4ea4\u4e92\u5f0f\u767b\u5f55\u7684shell\u63d0\u4f9b\u914d\u7f6e"}),"\n",(0,s.jsx)(n.p,{children:"(1) \u5168\u5c40\uff1a/etc/bashrc"}),"\n",(0,s.jsx)(n.p,{children:"(2) \u4e2a\u4eba\uff1a~/.bashrc"}),"\n",(0,s.jsx)(n.p,{children:"\u529f\u7528\uff1a (1) \u5b9a\u4e49\u547d\u4ee4\u522b\u540d\u548c\u51fd\u6570 (2) \u5b9a\u4e49\u672c\u5730\u53d8\u91cf"}),"\n",(0,s.jsx)(n.p,{children:"\u6761\u4ef6\u5224\u65adcase\u8bed\u53e5"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"case \u53d8\u91cf\u5f15\u7528 in\r\n\r\nPAT1)\r\n\r\n \u5206\u652f1\r\n\r\n ;;\r\n\r\nPAT2)\r\n\r\n \u5206\u652f2\r\n\r\n ;;\r\n\r\n...\r\n\r\n*)\r\n\r\n \u9ed8\u8ba4\u5206\u652f\r\n\r\n ;;\r\n\r\nesac\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/operator/image-20231102185004617.png",alt:"image-20231102185004617"})}),"\n",(0,s.jsx)(n.p,{children:"#\u8fd4\u56de\u5b57\u7b26\u4e32\u53d8\u91cfvar\u7684\u957f\u5ea6 ${#var}"}),"\n",(0,s.jsx)(n.h2,{id:"linux-namespace",children:"linux namespace"}),"\n",(0,s.jsx)(n.p,{children:"\u5bf9\u4e8e\u5bb9\u5668\u6280\u672f\u800c\u8a00\uff0c\u5b83\u5b9e\u73b0\u8d44\u6e90\u5c42\u9762\u4e0a\u7684\u9650\u5236\u548c\u9694\u79bb\uff0c\u4f9d\u8d56\u4e8e Linux \u5185\u6838\u6240\u63d0\u4f9b\u7684 cgroup \u548c namespace \u6280\u672f\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u6211\u4eec\u5148\u5bf9\u8fd9\u4e24\u9879\u6280\u672f\u7684\u4f5c\u7528\u505a\u4e2a\u6982\u62ec\uff1a"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"cgroup \u7684\u4e3b\u8981\u4f5c\u7528\uff1a\u7ba1\u7406\u8d44\u6e90\u7684\u5206\u914d\u3001\u9650\u5236\uff1b"}),"\n",(0,s.jsx)(n.li,{children:"namespace \u7684\u4e3b\u8981\u4f5c\u7528\uff1a\u5c01\u88c5\u62bd\u8c61\uff0c\u9650\u5236\uff0c\u9694\u79bb\uff0c\u4f7f\u547d\u540d\u7a7a\u95f4\u5185\u7684\u8fdb\u7a0b\u770b\u8d77\u6765\u62e5\u6709\u4ed6\u4eec\u81ea\u5df1\u7684\u5168\u5c40\u8d44\u6e90\uff1b"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u672c\u7bc7\uff0c\u6211\u4eec\u91cd\u70b9\u6765\u804a namespace \u3002"}),"\n",(0,s.jsx)(n.h4,{id:"\u6700\u65e9\u671f---plan-9",children:"\u6700\u65e9\u671f - Plan 9"}),"\n",(0,s.jsxs)(n.p,{children:["\u6211\u4eec\u5f15\u7528 ",(0,s.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/Linux_namespaces",children:"wiki"})," \u4e0a\u5bf9 namespace \u7684\u5b9a\u4e49\uff1a"]}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"Namespaces are a feature of the Linux kernel that partitions kernel resources such that one set of processes sees one set of resources while another set of processes sees a different set of resources. The feature works by having the same namespace for a set of resources and processes, but those namespaces refer to distinct resources."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"namespace \u662f Linux \u5185\u6838\u7684\u4e00\u9879\u7279\u6027\uff0c\u5b83\u53ef\u4ee5\u5bf9\u5185\u6838\u8d44\u6e90\u8fdb\u884c\u5206\u533a\uff0c\u4f7f\u5f97\u4e00\u7ec4\u8fdb\u7a0b\u53ef\u4ee5\u770b\u5230\u4e00\u7ec4\u8d44\u6e90\uff1b\u800c\u53e6\u4e00\u7ec4\u8fdb\u7a0b\u53ef\u4ee5\u770b\u5230\u53e6\u4e00\u7ec4\u4e0d\u540c\u7684\u8d44\u6e90\u3002\u8be5\u529f\u80fd\u7684\u539f\u7406\u662f\u4e3a\u4e00\u7ec4\u8d44\u6e90\u548c\u8fdb\u7a0b\u4f7f\u7528\u76f8\u540c\u7684 namespace\uff0c\u4f46\u662f\u8fd9\u4e9b namespace \u5b9e\u9645\u4e0a\u5f15\u7528\u7684\u662f\u4e0d\u540c\u7684\u8d44\u6e90\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u8fd9\u6837\u7684\u8bf4\u6cd5\u672a\u514d\u592a\u7ed5\u4e86\u4e9b\uff0c\u7b80\u5355\u6765\u8bf4 namespace \u662f\u7531 Linux \u5185\u6838\u63d0\u4f9b\u7684\uff0c\u7528\u4e8e\u8fdb\u7a0b\u95f4\u8d44\u6e90\u9694\u79bb\u7684\u4e00\u79cd\u6280\u672f\u3002\u5c06\u5168\u5c40\u7684\u7cfb\u7edf\u8d44\u6e90\u5305\u88c5\u5728\u4e00\u4e2a\u62bd\u8c61\u91cc\uff0c\u8ba9\u8fdb\u7a0b\uff08\u770b\u8d77\u6765\uff09\u62e5\u6709\u72ec\u7acb\u7684\u5168\u5c40\u8d44\u6e90\u5b9e\u4f8b\u3002\u540c\u65f6 Linux \u4e5f\u9ed8\u8ba4\u63d0\u4f9b\u4e86\u591a\u79cd namespace\uff0c\u7528\u4e8e\u5bf9\u591a\u79cd\u4e0d\u540c\u8d44\u6e90\u8fdb\u884c\u9694\u79bb\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u5728\u4e4b\u524d\uff0c\u6211\u4eec\u5355\u72ec\u4f7f\u7528 namespace \u7684\u573a\u666f\u6bd4\u8f83\u6709\u9650\uff0c\u4f46 namespace \u5374\u662f\u5bb9\u5668\u5316\u6280\u672f\u7684\u57fa\u77f3\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u6211\u4eec\u5148\u6765\u770b\u770b\u5b83\u7684\u53d1\u5c55\u5386\u7a0b\u3002"}),"\n",(0,s.jsx)(n.h4,{id:"\u6700\u65e9\u671f---plan-9-1",children:"\u6700\u65e9\u671f - Plan 9"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/operator/rRA1dQx69butYTZ.jpg",alt:"img"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"\u56fe 1 \uff0cnamespace \u7684\u5386\u53f2\u8fc7\u7a0b"})}),"\n",(0,s.jsx)(n.h4,{id:"\u6700\u65e9\u671f---plan-9-2",children:"\u6700\u65e9\u671f - Plan 9"}),"\n",(0,s.jsx)(n.p,{children:"namespace \u7684\u65e9\u671f\u63d0\u51fa\u53ca\u4f7f\u7528\u8981\u8ffd\u6eaf\u5230 Plan 9 from Bell Labs \uff0c\u8d1d\u5c14\u5b9e\u9a8c\u5ba4\u7684 Plan 9\u3002\u8fd9\u662f\u4e00\u4e2a\u5206\u5e03\u5f0f\u64cd\u4f5c\u7cfb\u7edf\uff0c\u7531\u8d1d\u5c14\u5b9e\u9a8c\u5ba4\u7684\u8ba1\u7b97\u79d1\u5b66\u7814\u7a76\u4e2d\u5fc3\u5728\u516b\u51e0\u5e74\u81f302\u5e74\u5f00\u53d1\u7684\uff0802\u5e74\u53d1\u5e03\u4e86\u7a33\u5b9a\u7684\u7b2c\u56db\u7248\uff0c\u8ddd\u79bb92\u5e74\u53d1\u5e03\u7684\u7b2c\u4e00\u4e2a\u516c\u5f00\u7248\u672c\u5df210\u5e74\u6253\u78e8\uff09\uff0c\u73b0\u5728\u4ecd\u7136\u88ab\u64cd\u4f5c\u7cfb\u7edf\u7684\u7814\u7a76\u8005\u548c\u7231\u597d\u8005\u5f00\u53d1\u4f7f\u7528\u3002\u5728 Plan 9 \u7684\u8bbe\u8ba1\u4e0e\u5b9e\u73b0\u4e2d\uff0c\u6211\u4eec\u7740\u91cd\u63d0\u4ee5\u4e0b3\u70b9\u5185\u5bb9\uff1a"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u6587\u4ef6\u7cfb\u7edf\uff1a\u6240\u6709\u7cfb\u7edf\u8d44\u6e90\u90fd\u5217\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\uff0c\u4ee5 Node \u6807\u8bc6\u3002\u6240\u6709\u7684\u63a5\u53e3\u4e5f\u4f5c\u4e3a\u6587\u4ef6\u7cfb\u7edf\u7684\u4e00\u90e8\u5206\u5448\u73b0\u3002"}),"\n",(0,s.jsx)(n.li,{children:"Namespace\uff1a\u80fd\u66f4\u597d\u7684\u5e94\u7528\u53ca\u5c55\u793a\u6587\u4ef6\u7cfb\u7edf\u7684\u5c42\u6b21\u7ed3\u6784\uff0c\u5b83\u5b9e\u73b0\u4e86\u6240\u8c13\u7684 \u201c\u5206\u79bb\u201d\u548c\u201c\u72ec\u7acb\u201d\u3002"}),"\n",(0,s.jsx)(n.li,{children:"\u6807\u51c6\u901a\u4fe1\u534f\u8bae\uff1a9P\u534f\u8bae\uff08Styx/9P2000\uff09\u3002"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/operator/ye5wSuNMnJoc6TU.jpg",alt:"img"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"\u56fe 2 \uff0cPlan 9 from Bell Labs \u56fe\u6807"})}),"\n",(0,s.jsx)(n.h4,{id:"\u5f00\u59cb\u52a0\u5165-linux-kernel",children:"\u5f00\u59cb\u52a0\u5165 Linux Kernel"}),"\n",(0,s.jsx)(n.p,{children:"Namespace \u5f00\u59cb\u8fdb\u5165 Linux Kernel \u7684\u7248\u672c\u662f\u5728 2.4.X\uff0c\u6700\u521d\u59cb\u4e8e 2.4.19 \u7248\u672c\u3002\u4f46\u662f\uff0c\u81ea 2.4.2 \u7248\u672c\u624d\u5f00\u59cb\u5b9e\u73b0\u6bcf\u4e2a\u8fdb\u7a0b\u7684 namespace\u3002"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/operator/KeakXfEFsMjoLPz.jpg",alt:"img"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"\u56fe 3 \uff0cLinux Kernel Note"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/operator/YlNU6uBeWdEJhgG.png",alt:"img"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"\u56fe 4 \uff0cLinux Kernel \u5bf9\u5e94\u7684\u5404\u64cd\u4f5c\u7cfb\u7edf\u7248\u672c"})}),"\n",(0,s.jsx)(n.h4,{id:"linux-38-\u57fa\u672c\u5b9e\u73b0",children:"Linux 3.8 \u57fa\u672c\u5b9e\u73b0"}),"\n",(0,s.jsxs)(n.p,{children:["Linux 3.8 \u4e2d\u7ec8\u4e8e\u5b8c\u5168\u5b9e\u73b0\u4e86 ",(0,s.jsx)(n.code,{children:"User"})," Namespace \u7684\u76f8\u5173\u529f\u80fd\u96c6\u6210\u5230\u5185\u6838\u3002\u8fd9\u6837 Docker \u53ca\u5176\u4ed6\u5bb9\u5668\u6280\u672f\u6240\u7528\u5230\u7684 namespace \u76f8\u5173\u7684\u80fd\u529b\u5c31\u57fa\u672c\u90fd\u5b9e\u73b0\u4e86\u3002"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/operator/5HBV3ylXepPijvD.png",alt:"img"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"\u56fe 5 \uff0cLinux Kernel \u4ece 2001 \u52302013 \u9010\u6b65\u6f14\u53d8\uff0c\u5b8c\u6210\u4e86 namespace \u7684\u5b9e\u73b0"})}),"\n",(0,s.jsx)(n.h4,{id:"namespace-\u7c7b\u578b",children:"Namespace \u7c7b\u578b"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"namespace\u540d\u79f0"}),(0,s.jsx)(n.th,{children:"\u4f7f\u7528\u7684\u6807\u8bc6 - Flag"}),(0,s.jsx)(n.th,{children:"\u63a7\u5236\u5185\u5bb9"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Cgroup"}),(0,s.jsx)(n.td,{children:"CLONE_NEWCGROUP"}),(0,s.jsx)(n.td,{children:"Cgroup root directory cgroup \u6839\u76ee\u5f55"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"IPC"}),(0,s.jsx)(n.td,{children:"CLONE_NEWIPC"}),(0,s.jsx)(n.td,{children:"System V IPC, POSIX message queues\u4fe1\u53f7\u91cf\uff0c\u6d88\u606f\u961f\u5217"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Network"}),(0,s.jsx)(n.td,{children:"CLONE_NEWNET"}),(0,s.jsx)(n.td,{children:"Network devices, stacks, ports, etc.\u7f51\u7edc\u8bbe\u5907\uff0c\u534f\u8bae\u6808\uff0c\u7aef\u53e3\u7b49\u7b49"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Mount"}),(0,s.jsx)(n.td,{children:"CLONE_NEWNS"}),(0,s.jsx)(n.td,{children:"Mount points\u6302\u8f7d\u70b9"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"PID"}),(0,s.jsx)(n.td,{children:"CLONE_NEWPID"}),(0,s.jsx)(n.td,{children:"Process IDs\u8fdb\u7a0b\u53f7"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Time"}),(0,s.jsx)(n.td,{children:"CLONE_NEWTIME"}),(0,s.jsx)(n.td,{children:"\u65f6\u949f"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"User"}),(0,s.jsx)(n.td,{children:"CLONE_NEWUSER"}),(0,s.jsx)(n.td,{children:"\u7528\u6237\u548c\u7ec4 ID"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"UTS"}),(0,s.jsx)(n.td,{children:"CLONE_NEWUTS"}),(0,s.jsx)(n.td,{children:"\u7cfb\u7edf\u4e3b\u673a\u540d\u548c NIS(Network Information Service) \u4e3b\u673a\u540d\uff08\u6709\u65f6\u79f0\u4e3a\u57df\u540d\uff09"})]})]})]}),"\n",(0,s.jsx)(n.h4,{id:"cgroup-namespaces",children:"Cgroup namespaces"}),"\n",(0,s.jsxs)(n.p,{children:["Cgroup namespace \u662f\u8fdb\u7a0b\u7684 cgroups \u7684\u865a\u62df\u5316\u89c6\u56fe\uff0c\u901a\u8fc7 ",(0,s.jsx)(n.code,{children:"/proc/[pid]/cgroup"})," \u548c ",(0,s.jsx)(n.code,{children:"/proc/[pid]/mountinfo"})," \u5c55\u793a\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:["\u4f7f\u7528 cgroup namespace \u9700\u8981\u5185\u6838\u5f00\u542f ",(0,s.jsx)(n.code,{children:"CONFIG_CGROUPS"})," \u9009\u9879\u3002\u53ef\u901a\u8fc7\u4ee5\u4e0b\u65b9\u5f0f\u9a8c\u8bc1\uff1a"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:"(MoeLove) \u279c grep CONFIG_CGROUPS /boot/config-$(uname -r)\r\nCONFIG_CGROUPS=y\n"})}),"\n",(0,s.jsx)(n.p,{children:"cgroup namespace \u63d0\u4f9b\u7684\u4e86\u4e00\u7cfb\u5217\u7684\u9694\u79bb\u652f\u6301\uff1a"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u9632\u6b62\u4fe1\u606f\u6cc4\u6f0f\uff08\u5bb9\u5668\u4e0d\u5e94\u8be5\u770b\u5230\u5bb9\u5668\u5916\u7684\u4efb\u4f55\u4fe1\u606f\uff09\u3002"}),"\n",(0,s.jsx)(n.li,{children:"\u7b80\u5316\u4e86\u5bb9\u5668\u8fc1\u79fb\u3002"}),"\n",(0,s.jsx)(n.li,{children:"\u9650\u5236\u5bb9\u5668\u8fdb\u7a0b\u8d44\u6e90\uff0c\u56e0\u4e3a\u5b83\u4f1a\u628a cgroup \u6587\u4ef6\u7cfb\u7edf\u8fdb\u884c\u6302\u8f7d\uff0c\u4f7f\u5f97\u5bb9\u5668\u8fdb\u7a0b\u65e0\u6cd5\u83b7\u53d6\u4e0a\u5c42\u7684\u8bbf\u95ee\u6743\u9650\u3002"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["\u6bcf\u4e2a cgroup namespace \u90fd\u6709\u81ea\u5df1\u7684\u4e00\u7ec4 cgroup \u6839\u76ee\u5f55\u3002\u8fd9\u4e9b cgroup \u7684\u6839\u76ee\u5f55\u662f\u5728 ",(0,s.jsx)(n.code,{children:"/proc/[pid]/cgroup"})," \u6587\u4ef6\u4e2d\u5bf9\u5e94\u8bb0\u5f55\u7684\u76f8\u5bf9\u4f4d\u7f6e\u7684\u57fa\u70b9\u3002\u5f53\u4e00\u4e2a\u8fdb\u7a0b\u7528 ",(0,s.jsx)(n.code,{children:"CLONE_NEWCGROUP"}),"\uff08clone(2) \u6216\u8005 unshare(2)\uff09 \u521b\u5efa\u4e00\u4e2a\u65b0\u7684 cgroup namespace\u65f6\uff0c\u5b83\u5f53\u524d\u7684 cgroups \u7684\u76ee\u5f55\u5c31\u53d8\u6210\u4e86\u65b0 namespace \u7684 cgroup \u6839\u76ee\u5f55\u3002"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"(MoeLove) \u279c cat /proc/self/cgroup \r\n0::/user.slice/user-1000.slice/session-2.scope\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u5f53\u4e00\u4e2a\u76ee\u6807\u8fdb\u7a0b\u4ece ",(0,s.jsx)(n.code,{children:"/proc/[pid]/cgroup"})," \u4e2d\u8bfb\u53d6 cgroup \u5173\u7cfb\u65f6\uff0c\u6bcf\u4e2a\u8bb0\u5f55\u7684\u8def\u5f84\u540d\u4f1a\u5728\u7b2c\u4e09\u5b57\u6bb5\u4e2d\u5c55\u793a\uff0c\u4f1a\u5173\u8054\u5230\u6b63\u5728\u8bfb\u53d6\u7684\u8fdb\u7a0b\u7684\u76f8\u5173 cgroup \u5206\u5c42\u7ed3\u6784\u7684\u6839\u76ee\u5f55\u3002\u5982\u679c\u76ee\u6807\u8fdb\u7a0b\u7684 cgroup \u76ee\u5f55\u4f4d\u4e8e\u6b63\u5728\u8bfb\u53d6\u7684\u8fdb\u7a0b\u7684 cgroup namespace \u6839\u76ee\u5f55\u4e4b\u5916\u65f6\uff0c\u90a3\u4e48\uff0c\u8def\u5f84\u540d\u79f0\u5c06\u4f1a\u5bf9\u6bcf\u4e2a cgroup \u5c42\u6b21\u4e2d\u7684\u4e0a\u5c42\u8282\u70b9\u663e\u793a ",(0,s.jsx)(n.code,{children:"../"})," \u3002"]}),"\n",(0,s.jsx)(n.p,{children:"\u6211\u4eec\u6765\u770b\u770b\u4e0b\u9762\u7684\u793a\u4f8b\uff08\u8fd9\u91cc\u4ee5 cgroup v1 \u4e3a\u4f8b\uff0c\u5982\u679c\u4f60\u60f3\u770b v2 \u7248\u672c\u7684\u793a\u4f8b\uff0c\u8bf7\u5728\u7559\u8a00\u4e2d\u544a\u8bc9\u6211\uff09\uff1a"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\u5728\u521d\u59cb\u7684 cgroup namespace \u4e2d\uff0c\u6211\u4eec\u4f7f\u7528 root \uff08\u6216\u8005\u6709 root \u6743\u9650\u7684\u7528\u6237\uff09\uff0c\u5728 freezer \u5c42\u4e0b\u521b\u5efa\u4e00\u4e2a\u5b50 cgroup \u540d\u4e3a ",(0,s.jsx)(n.code,{children:"moelove-sub"}),"\uff0c\u540c\u65f6\uff0c\u5c06\u8fdb\u7a0b\u653e\u5165\u8be5 cgroup \u8fdb\u884c\u9650\u5236\u3002"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plain",children:"(MoeLove) \u279c mkdir -p /sys/fs/cgroup/freezer/moelove-sub\r\n(MoeLove) \u279c sleep 6666666 & \r\n[1] 1489125                  \r\n(MoeLove) \u279c echo 1489125 > /sys/fs/cgroup/freezer/moelove-sub/cgroup.procs\n"})}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\u6211\u4eec\u5728 freezer \u5c42\u4e0b\u521b\u5efa\u53e6\u5916\u4e00\u4e2a\u5b50 cgroup\uff0c\u540d\u4e3a ",(0,s.jsx)(n.code,{children:"moelove-sub2"}),"\uff0c \u5e76\u4e14\u518d\u653e\u5165\u6267\u884c\u8fdb\u7a0b\u53f7\u3002\u53ef\u4ee5\u770b\u5230\u5f53\u524d\u7684\u8fdb\u7a0b\u5df2\u7ecf\u7eb3\u5165\u5230 ",(0,s.jsx)(n.code,{children:"moelove-sub2"}),"\u7684 cgroup \u4e0b\u7ba1\u7406\u4e86\u3002"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plain",children:"(MoeLove) \u279c mkdir -p /sys/fs/cgroup/freezer/moelove-sub2\r\n(MoeLove) \u279c echo $$\r\n1488899\r\n(MoeLove) \u279c echo 1488899 > /sys/fs/cgroup/freezer/moelove-sub2/cgroup.procs \r\n(MoeLove) \u279c cat /proc/self/cgroup |grep freezer\r\n7:freezer:/moelove-sub2\n"})}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\u6211\u4eec\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"unshare(1)"})," \u521b\u5efa\u4e00\u4e2a\u8fdb\u7a0b\uff0c\u8fd9\u91cc\u4f7f\u7528\u4e86 ",(0,s.jsx)(n.code,{children:"-C"}),"\u53c2\u6570\u8868\u793a\u662f\u65b0\u7684 cgroup namespace\uff0c \u4f7f\u7528\u4e86 ",(0,s.jsx)(n.code,{children:"-m"}),"\u53c2\u6570\u8868\u793a\u662f\u65b0\u7684 mount namespace\u3002"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plain",children:"(MoeLove) \u279c unshare -Cm bash\r\nroot@moelove:~#\n"})}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\u4ece\u7528 unshare(1) \u542f\u52a8\u7684\u65b0 shell \u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u5728 ",(0,s.jsx)(n.code,{children:"/proc/[pid]/cgroup"})," \u6587\u4ef6\u4e2d\u770b\u5230\uff0c\u65b0 shell \u548c\u4ee5\u4e0a\u793a\u4f8b\u4e2d\u7684\u8fdb\u7a0b\uff1a"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plain",children:"root@moelove:~# cat /proc/self/cgroup | grep freezer\r\n7:freezer:/\r\nroot@moelove:~# cat /proc/1/cgroup | grep freezer\r\n7:freezer:/..\r\n\r\n# \u7b2c\u4e00\u4e2a\u793a\u4f8b\u8fdb\u7a0b\r\nroot@moelove:~# cat /proc/1489125/cgroup | grep freezer\r\n7:freezer:/../moelove-sub\n"})}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"\u4ece\u4e0a\u9762\u7684\u793a\u4f8b\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u65b0 shell \u7684 freezer cgroup \u5173\u7cfb\u4e2d\uff0c\u5f53\u65b0\u7684 cgroup namespace \u521b\u5efa\u65f6\uff0cfreezer cgroup \u7684\u6839\u76ee\u5f55\u4e0e\u5b83\u7684\u5173\u7cfb\u4e5f\u5c31\u5efa\u7acb\u4e86\u3002"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plain",children:"root@moelove:~# cat /proc/self/mountinfo | grep freezer\r\n1238 1230 0:37 /.. /sys/fs/cgroup/freezer rw,nosuid,nodev,noexec,relatime - cgroup cgroup rw,freezer\n"})}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\u7b2c\u56db\u4e2a\u5b57\u6bb5 ( ",(0,s.jsx)(n.code,{children:"/.."}),") \u663e\u793a\u4e86\u5728 cgroup \u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u6302\u8f7d\u76ee\u5f55\u3002\u4ece cgroup namespaces \u7684\u5b9a\u4e49\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u77e5\u9053\uff0c\u8fdb\u7a0b\u5f53\u524d\u7684 freezer cgroup \u76ee\u5f55\u53d8\u6210\u4e86\u5b83\u7684\u6839\u76ee\u5f55\uff0c\u6240\u4ee5\u8fd9\u4e2a\u5b57\u6bb5\u663e\u793a ",(0,s.jsx)(n.code,{children:"/.."})," \u3002\u6211\u4eec\u53ef\u4ee5\u91cd\u65b0\u6302\u8f7d\u6765\u5904\u7406\u5b83\u3002"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plain",children:"root@moelove:~# mount --make-rslave /\r\nroot@moelove:~# umount /sys/fs/cgroup/freezer\r\nroot@moelove:~# mount -t cgroup -o freezer freezer /sys/fs/cgroup/freezer\r\nroot@moelove:~# cat /proc/self/mountinfo | grep freezer\r\n1238 1230 0:37 / /sys/fs/cgroup/freezer rw,relatime - cgroup freezer rw,freezer\r\nroot@moelove:~# mount |grep freezer\r\nfreezer on /sys/fs/cgroup/freezer type cgroup (rw,relatime,freezer)\n"})}),"\n",(0,s.jsx)(n.h4,{id:"ipc-namespaces",children:"IPC namespaces"}),"\n",(0,s.jsx)(n.p,{children:"IPC namespaces \u9694\u79bb\u4e86 IPC \u8d44\u6e90\uff0c\u5982 System V IPC objects\u3001 POSIX message queues\u3002\u6bcf\u4e2a IPC namespace \u90fd\u6709\u7740\u81ea\u5df1\u7684\u4e00\u7ec4 System V IPC \u6807\u8bc6\u7b26\uff0c\u4ee5\u53ca POSIX \u6d88\u606f\u961f\u5217\u7cfb\u7edf\u3002\u5728\u4e00\u4e2a IPC namespace \u4e2d\u521b\u5efa\u7684\u5bf9\u8c61\uff0c\u5bf9\u6240\u6709\u8be5 namespace \u4e0b\u7684\u6210\u5458\u5747\u53ef\u89c1\uff08\u5bf9\u5176\u4ed6 namespace \u4e0b\u7684\u6210\u5458\u5747\u4e0d\u53ef\u89c1\uff09\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u4f7f\u7528 IPC namespace \u9700\u8981\u5185\u6838\u652f\u6301 CONFIG_IPC_NS \u9009\u9879\u3002\u5982\u4e0b\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:"(MoeLove) \u279c grep CONFIG_IPC_NS /boot/config-$(uname -r)\r\nCONFIG_IPC_NS=y\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u53ef\u4ee5\u5728 IPC namespace \u4e2d\u8bbe\u7f6e\u4ee5\u4e0b ",(0,s.jsx)(n.code,{children:"/proc"})," \u63a5\u53e3\uff1a"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"/proc/sys/fs/mqueue"})," - POSIX \u6d88\u606f\u961f\u5217\u63a5\u53e3"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"/proc/sys/kernel"})," - System V IPC \u63a5\u53e3 \uff08msgmax, msgmnb, msgmni, sem, shmall, shmmax, shmmni, shm_rmid_forced\uff09"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"/proc/sysvipc"})," - System V IPC \u63a5\u53e3"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u5f53 IPC namespace \u88ab\u9500\u6bc1\u65f6\uff08\u7a7a\u95f4\u91cc\u7684\u6700\u540e\u4e00\u4e2a\u8fdb\u7a0b\u90fd\u88ab\u505c\u6b62\u5220\u9664\u65f6\uff09\uff0c\u5728 IPC namespace \u4e2d\u521b\u5efa\u7684 object \u4e5f\u4f1a\u88ab\u9500\u6bc1\u3002"}),"\n",(0,s.jsx)(n.h4,{id:"network-namespaces",children:"Network namespaces"}),"\n",(0,s.jsx)(n.p,{children:"Network namespaces \u9694\u79bb\u4e86\u4e0e\u7f51\u7edc\u76f8\u5173\u7684\u7cfb\u7edf\u8d44\u6e90\uff08\u8fd9\u91cc\u7f57\u5217\u4e00\u4e9b\uff09\uff1a"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"network devices - \u7f51\u7edc\u8bbe\u5907"}),"\n",(0,s.jsx)(n.li,{children:"IPv4 and IPv6 protocol stacks - IPv4\u3001IPv6 \u7684\u534f\u8bae\u6808"}),"\n",(0,s.jsx)(n.li,{children:"IP routing tables - IP \u8def\u7531\u8868"}),"\n",(0,s.jsx)(n.li,{children:"firewall rules - \u9632\u706b\u5899\u89c4\u5219"}),"\n",(0,s.jsx)(n.li,{children:"/proc/net \uff08\u5373 /proc/PID/net\uff09"}),"\n",(0,s.jsx)(n.li,{children:"/sys/class/net"}),"\n",(0,s.jsx)(n.li,{children:"/proc/sys/net \u76ee\u5f55\u4e0b\u7684\u6587\u4ef6"}),"\n",(0,s.jsx)(n.li,{children:"\u7aef\u53e3\u3001socket"}),"\n",(0,s.jsx)(n.li,{children:"UNIX domain abstract socket namespace"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u4f7f\u7528 Network namespaces \u9700\u8981\u5185\u6838\u652f\u6301 CONFIG_NET_NS \u9009\u9879\u3002\u5982\u4e0b\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"(MoeLove) \u279c grep CONFIG_NET_NS /boot/config-$(uname -r)\r\nCONFIG_NET_NS=y\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u4e00\u4e2a\u7269\u7406\u7f51\u7edc\u8bbe\u5907\u53ea\u80fd\u5b58\u5728\u4e8e\u4e00\u4e2a Network namespace \u4e2d\u3002\u5f53\u4e00\u4e2a Network namespace \u88ab\u91ca\u653e\u65f6\uff08\u7a7a\u95f4\u91cc\u7684\u6700\u540e\u4e00\u4e2a\u8fdb\u7a0b\u90fd\u88ab\u505c\u6b62\u5220\u9664\u65f6\uff09\uff0c\u7269\u7406\u7f51\u7edc\u8bbe\u5907\u5c06\u88ab\u79fb\u52a8\u5230\u521d\u59cb\u7684 Network namespace \u800c\u4e0d\u662f\u4e0a\u5c42\u7684 Network namespace\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u4e00\u4e2a\u865a\u62df\u7684\u7f51\u7edc\u8bbe\u5907(veth(4)) \uff0c\u5728 Network namespace \u95f4\u901a\u8fc7\u4e00\u4e2a\u7c7b\u4f3c\u7ba1\u9053\u7684\u65b9\u5f0f\u8fdb\u884c\u8fde\u63a5\u3002\u8fd9\u4f7f\u5f97\u5b83\u80fd\u5b58\u5728\u4e8e\u591a\u4e2a Network namespace\uff0c\u4f46\u662f\uff0c\u5f53 Network namespace \u88ab\u6467\u6bc1\u65f6\uff0c\u8be5\u7a7a\u95f4\u4e0b\u5305\u542b\u7684 veth(4) \u8bbe\u5907\u53ef\u80fd\u88ab\u7834\u574f\u3002"}),"\n",(0,s.jsx)(n.h4,{id:"mount-namespaces",children:"Mount namespaces"}),"\n",(0,s.jsx)(n.p,{children:"Mount namespaces \u6700\u65e9\u51fa\u73b0\u5728 Linux 2.4.19 \u7248\u672c\u3002Mount namespaces \u9694\u79bb\u4e86\u5404\u7a7a\u95f4\u4e2d\u6302\u8f7d\u7684\u8fdb\u7a0b\u5b9e\u4f8b\u3002\u6bcf\u4e2a mount namespace \u7684\u5b9e\u4f8b\u4e0b\u7684\u8fdb\u7a0b\u4f1a\u770b\u5230\u4e0d\u540c\u7684\u76ee\u5f55\u5c42\u6b21\u7ed3\u6784\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u6bcf\u4e2a\u8fdb\u7a0b\u5728 mount namespace \u4e2d\u7684\u63cf\u8ff0\u53ef\u4ee5\u5728\u4e0b\u9762\u7684\u6587\u4ef6\u89c6\u56fe\u4e2d\u770b\u5230\uff1a"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"/proc/[pid]/mounts"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"/proc/[pid]/mountinfo"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"/proc/[pid]/mountstats"})}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u4e00\u4e2a\u65b0\u7684 Mount namespace \u7684\u521b\u5efa\u6807\u8bc6\u662f CLONE_NEWNS \uff0c\u4f7f\u7528\u4e86 clone(2) \u6216\u8005 unshare(2) \u3002"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u5982\u679c Mount namespace \u7528 clone(2) \u521b\u5efa\uff0c\u5b50 namespace \u7684\u6302\u8f7d\u5217\u8868\u662f\u4ece\u7236\u8fdb\u7a0b\u7684 mount namespace \u62f7\u8d1d\u7684\u3002"}),"\n",(0,s.jsx)(n.li,{children:"\u5982\u679c Mount namespace \u7528 unshare(2) \u521b\u5efa\uff0c\u65b0 namespace \u7684\u6302\u8f7d\u5217\u8868\u662f\u4ece\u8c03\u7528\u8005\u4e4b\u524d\u7684 moun namespace \u62f7\u8d1d\u7684\u3002"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["\u5982\u679c mount namespace \u53d1\u751f\u4e86\u4fee\u6539\uff0c\u4f1a\u5f15\u8d77\u4ec0\u4e48\u6837\u7684\u8fde\u9501\u53cd\u5e94\uff1f\u4e0b\u9762\uff0c\u6211\u4eec\u5c31\u5728 ",(0,s.jsx)(n.strong,{children:"\u5171\u4eab\u5b50\u6811"}),"\u4e2d\u8c08\u8c08\u3002"]}),"\n",(0,s.jsx)(n.p,{children:"\u6bcf\u4e2a mount \u90fd\u88ab\u53ef\u4ee5\u6709\u5982\u4e0b\u6807\u8bb0 \uff1a"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"MS_SHARED - \u4e0e\u7ec4\u5185\u6bcf\u4e2a\u6210\u5458\u5206\u4eab events \u3002\u4e5f\u5c31\u662f\u8bf4\u76f8\u540c\u7684 mount \u6216\u8005 unmount \u5c06\u81ea\u52a8\u53d1\u751f\u5728\u7ec4\u5185\u5176\u4ed6\u7684 mounts \u4e2d\u3002\u53cd\u4e4b\uff0cmount \u6216\u8005 unmount \u4e8b\u4ef6 \u4e5f\u4f1a\u5f71\u54cd\u8fd9\u6b21\u7684 event \u52a8\u4f5c\u3002"}),"\n",(0,s.jsx)(n.li,{children:"MS_PRIVATE - \u8fd9\u4e2a mount \u662f\u79c1\u6709\u7684\u3002mount \u6216\u8005 unmount events \u90fd\u4e0d\u4f1a\u5f71\u54cd\u8fd9\u6b21\u7684 event \u52a8\u4f5c\u3002"}),"\n",(0,s.jsx)(n.li,{children:"MS_SLAVE - mount \u6216\u8005 unmount events \u4f1a\u4ece master \u8282\u70b9\u4f20\u5165\u5f71\u54cd\u8be5\u8282\u70b9\u3002\u4f46\u662f\u8fd9\u4e2a\u8282\u70b9\u4e0b\u7684 mount \u6216\u8005 unmount events \u4e0d\u4f1a\u5f71\u54cd\u7ec4\u5185\u7684\u5176\u4ed6\u8282\u70b9\u3002"}),"\n",(0,s.jsx)(n.li,{children:"MS_UNBINDABLE - \u8fd9\u4e5f\u662f\u4e2a\u79c1\u6709\u7684 mount \u3002\u4efb\u4f55\u5c1d\u8bd5\u7ed1\u5b9a\u7684 mount \u5728\u8fd9\u4e2a\u8bbe\u7f6e\u4e0b\u90fd\u5c06\u5931\u8d25\u3002"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["\u5728\u6587\u4ef6 ",(0,s.jsx)(n.code,{children:"/proc/[pid]/mountinfo"})," \u4e2d\u53ef\u4ee5\u770b\u5230 ",(0,s.jsx)(n.code,{children:"propagation"})," \u7c7b\u578b\u7684\u5b57\u6bb5\u3002\u6bcf\u4e2a\u5bf9\u7b49\u7ec4\u90fd\u4f1a\u7531\u5185\u6838\u751f\u6210\u552f\u4e00\u7684 ID \uff0c\u540c\u4e00\u5bf9\u7b49\u7ec4\u7684 mount \u90fd\u662f\u8fd9\u4e2a ID\uff08\u5373\uff0c\u4e0b\u6587\u4e2d\u7684 X \uff09\u3002"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"(MoeLove) \u279c cat /proc/self/mountinfo  |grep root  \r\n65 1 0:33 /root / rw,relatime shared:1 - btrfs /dev/nvme0n1p6 rw,seclabel,compress=zstd:1,ssd,space_cache,subvolid=256,subvol=/root\r\n1210 65 0:33 /root/var/lib/docker/btrfs /var/lib/docker/btrfs rw,relatime shared:1 - btrfs /dev/nvme0n1p6 rw,seclabel,compress=zstd:1,ssd,space_cache,subvolid=256,subvol=/root\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["shared",":X"," - \u5728\u7ec4 X \u4e2d\u5171\u4eab\u3002"]}),"\n",(0,s.jsxs)(n.li,{children:["master",":X"," - \u5bf9\u4e8e\u7ec4 X \u800c\u8a00\u662f slave\uff0c\u5373\uff0c\u4ece\u5c5e\u4e8e ID \u4e3a X \u7684\u4e3b\u3002"]}),"\n",(0,s.jsxs)(n.li,{children:["propagate_from",":X"," - \u63a5\u6536\u4ece\u7ec4 X \u53d1\u51fa\u7684\u5171\u4eab mount\u3002\u8fd9\u4e2a\u6807\u7b7e\u603b\u662f\u4e2a master",":X"," \u4e00\u540c\u51fa\u73b0\u3002"]}),"\n",(0,s.jsx)(n.li,{children:"unbindable - \u8868\u793a\u4e0d\u80fd\u88ab\u7ed1\u5b9a\uff0c\u5373\uff0c\u4e0d\u4e0e\u5176\u4ed6\u5173\u8054\u4ece\u5c5e\u3002"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u65b0 mount namespace \u7684\u4f20\u64ad\u7c7b\u578b\u53d6\u51b3\u4e8e\u5b83\u7684\u7236\u8282\u70b9\u3002\u5982\u679c\u7236\u8282\u70b9\u7684\u4f20\u64ad\u7c7b\u578b\u662f MS_SHARED \uff0c\u90a3\u4e48\u65b0 mount namespace \u7684\u4f20\u64ad\u7c7b\u578b\u662f MS_SHARED \uff0c\u4e0d\u7136\u4f1a\u9ed8\u8ba4\u4e3a MS_PRIVATE\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u5173\u4e8e mount namespaces \u6211\u4eec\u8fd8\u9700\u8981\u6ce8\u610f\u4ee5\u4e0b\u51e0\u70b9\uff1a"}),"\n",(0,s.jsx)(n.p,{children:"\uff081\uff09\u6bcf\u4e2a mount namespace \u90fd\u6709\u4e00\u4e2a owner user namespace\u3002\u5982\u679c\u65b0\u7684 mount namespace \u548c\u62f7\u8d1d\u7684 mount namespace \u5206\u5c5e\u4e8e\u4e0d\u540c\u7684 user namespace \uff0c\u90a3\u4e48\uff0c\u65b0\u7684 mount namespace \u4f18\u5148\u7ea7\u4f4e\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\uff082\uff09\u5f53\u521b\u5efa\u7684 mount namespace \u4f18\u5148\u7ea7\u4f4e\u65f6\uff0c\u90a3\u4e48\uff0cslave \u7684 mount events \u4f1a\u4f18\u5148\u4e8e shared \u7684 mount events\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\uff083\uff09\u9ad8\u4f18\u5148\u7ea7\u548c\u4f4e\u4f18\u5148\u7ea7\u7684 mount namespace \u6709\u5173\u8054\u88ab\u9501\u5b9a\u5728\u4e00\u8d77\u65f6\uff0c\u4ed6\u4eec\u90fd\u4e0d\u80fd\u88ab\u5355\u72ec\u5378\u8f7d\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\uff084\uff09mount(2) \u6807\u8bc6\u548c atime \u6807\u8bc6\u4f1a\u88ab\u9501\u5b9a\uff0c\u5373\uff0c\u4e0d\u80fd\u88ab\u4f20\u64ad\u5f71\u54cd\u800c\u4fee\u6539\u3002"}),"\n",(0,s.jsx)(n.h4,{id:"cgroup-\u76f8\u5173\u53c2\u8003\u7f51\u53cb\u6587\u6863",children:"cgroup \u76f8\u5173\u53c2\u8003\u7f51\u53cb\u6587\u6863"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://zhuanlan.zhihu.com/p/434731896",children:"https://zhuanlan.zhihu.com/p/434731896"})}),"\n",(0,s.jsx)(n.h2,{id:"\u65e5\u5fd7\u6e05\u7406",children:"\u65e5\u5fd7\u6e05\u7406"}),"\n",(0,s.jsx)(n.p,{children:"\u6e05\u74065\u5929\u524d\u65e5\u5fd7"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:'find ./* -mtime +5 -name "*.log.gz" -exec rm -f {} \\;\r\n\r\n\u67e5\u627e\u5f53\u524d\u76ee\u5f55\u4e0b\u6240\u6709\u4ee5.tar\u7ed3\u5c3e\u7684\u6587\u4ef6\u7136\u540e\u79fb\u52a8\u5230\u6307\u5b9a\u76ee\u5f55\uff1a\r\nfind ./ -name "*.tar"  -exec mv {} ./backup;\r\n\r\n\u67e5\u627e\u5f53\u524d\u76ee\u5f5530\u5929\u4ee5\u524d\u5927\u4e8e100M\u7684LOG\u6587\u4ef6\u5e76\u5220\u9664\uff1a\r\nfind ./ -name "*.log" -mtime +30 -type f -size  +100M|xargs rm -rf {};\r\n\r\n\u6e05\u7406\u5bb9\u5668\u65e5\u5fd7\r\ncat /data/scripts/clean_docker_log.sh \r\ntruncate -s 0   /var/lib/docker/containers/*/*-json.log\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/operator/image-20231102190225684.png",alt:"image-20231102190225684"})}),"\n",(0,s.jsx)(n.h2,{id:"tcpip\u534f\u8bae\u6808",children:"TCP/IP\u534f\u8bae\u6808"}),"\n",(0,s.jsx)(n.h4,{id:"\u4e09\u6b21\u63e1\u624b",children:"\u4e09\u6b21\u63e1\u624b"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://www.cnblogs.com/dbhui/p/9596465.html",children:"https://www.cnblogs.com/dbhui/p/9596465.html"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/operator/image-20231102190429487.png",alt:"image-20231102190429487"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/operator/image-20231102190452559.png",alt:"image-20231102190452559"})}),"\n",(0,s.jsx)(n.p,{children:"\uff081\uff09\u7b2c\u4e00\u6b21\u63e1\u624b\uff1aClient\u5c06\u6807\u5fd7\u4f4dSYN\u7f6e\u4e3a1\uff0c\u968f\u673a\u4ea7\u751f\u4e00\u4e2a\u503cseq=J\uff0c\u5e76\u5c06\u8be5\u6570\u636e\u5305\u53d1\u9001\u7ed9Server\uff0cClient\u8fdb\u5165SYN_SENT\u72b6\u6001\uff0c\u7b49\u5f85Server\u786e\u8ba4\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\uff082\uff09\u7b2c\u4e8c\u6b21\u63e1\u624b\uff1aServer\u6536\u5230\u6570\u636e\u5305\u540e\u7531\u6807\u5fd7\u4f4dSYN=1\u77e5\u9053Client\u8bf7\u6c42\u5efa\u7acb\u8fde\u63a5\uff0cServer\u5c06\u6807\u5fd7\u4f4dSYN\u548cACK\u90fd\u7f6e\u4e3a1\uff0cack=J+1\uff0c\u968f\u673a\u4ea7\u751f\u4e00\u4e2a\u503cseq=K\uff0c\u5e76\u5c06\u8be5\u6570\u636e\u5305\u53d1\u9001\u7ed9Client\u4ee5\u786e\u8ba4\u8fde\u63a5\u8bf7\u6c42\uff0cServer\u8fdb\u5165SYN_RCVD\u72b6\u6001\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\uff083\uff09\u7b2c\u4e09\u6b21\u63e1\u624b\uff1aClient\u6536\u5230\u786e\u8ba4\u540e\uff0c\u68c0\u67e5ack\u662f\u5426\u4e3aJ+1\uff0cACK\u662f\u5426\u4e3a1\uff0c\u5982\u679c\u6b63\u786e\u5219\u5c06\u6807\u5fd7\u4f4dACK\u7f6e\u4e3a1\uff0cack=K+1\uff0c\u5e76\u5c06\u8be5\u6570\u636e\u5305\u53d1\u9001\u7ed9Server\uff0cServer\u68c0\u67e5ack\u662f\u5426\u4e3aK+1\uff0cACK\u662f\u5426\u4e3a1\uff0c\u5982\u679c\u6b63\u786e\u5219\u8fde\u63a5\u5efa\u7acb\u6210\u529f\uff0cClient\u548cServer\u8fdb\u5165ESTABLISHED\u72b6\u6001\uff0c\u5b8c\u6210\u4e09\u6b21\u63e1\u624b\uff0c\u968f\u540eClient\u4e0eServer\u4e4b\u95f4\u53ef\u4ee5\u5f00\u59cb\u4f20\u8f93\u6570\u636e\u4e86\u3002"}),"\n",(0,s.jsxs)(n.p,{children:["SYN\u653b\u51fb\uff1a\r\n\u5728\u4e09\u6b21\u63e1\u624b\u8fc7\u7a0b\u4e2d\uff0cServer\u53d1\u9001SYN-ACK\u4e4b\u540e\uff0c\u6536\u5230Client\u7684ACK\u4e4b\u524d\u7684TCP\u8fde\u63a5\u79f0\u4e3a\u534a\u8fde\u63a5\uff08half-open connect\uff09\uff0c\u6b64\u65f6Server\u5904\u4e8eSYN_RCVD\u72b6\u6001\uff0c\u5f53\u6536\u5230ACK\u540e\uff0cServer\u8f6c\u5165ESTABLISHED\u72b6\u6001\u3002SYN\u653b\u51fb\u5c31\u662fClient\u5728\u77ed\u65f6\u95f4\u5185\u4f2a\u9020\u5927\u91cf\u4e0d\u5b58\u5728\u7684IP\u5730\u5740\uff0c\u5e76\u5411Server\u4e0d\u65ad\u5730\u53d1\u9001SYN\u5305\uff0cServer\u56de\u590d\u786e\u8ba4\u5305\uff0c\u5e76\u7b49\u5f85Client\u7684\u786e\u8ba4\uff0c\u7531\u4e8e\u6e90\u5730\u5740\u662f\u4e0d\u5b58\u5728\u7684\uff0c\u56e0\u6b64\uff0cServer\u9700\u8981\u4e0d\u65ad\u91cd\u53d1\u76f4\u81f3\u8d85\u65f6\uff0c\u8fd9\u4e9b\u4f2a\u9020\u7684SYN\u5305\u5c06\u4ea7\u65f6\u95f4\u5360\u7528\u672a\u8fde\u63a5\u961f\u5217\uff0c\u5bfc\u81f4\u6b63\u5e38\u7684SYN\u8bf7\u6c42\u56e0\u4e3a\u961f\u5217\u6ee1\u800c\u88ab\u4e22\u5f03\uff0c\u4ece\u800c\u5f15\u8d77\u7f51\u7edc\u5835\u585e\u751a\u81f3",(0,s.jsx)(n.a,{href:"http://www.2cto.com/os/",children:"\u7cfb\u7edf"}),"\u762b\u75ea\u3002SYN\u653b\u51fb\u65f6\u4e00\u79cd\u5178\u578b\u7684DDOS\u653b\u51fb\uff0c\u68c0\u6d4bSYN\u653b\u51fb\u7684\u65b9\u5f0f\u975e\u5e38\u7b80\u5355\uff0c\u5373\u5f53Server\u4e0a\u6709\u5927\u91cf\u534a\u8fde\u63a5\u72b6\u6001\u4e14\u6e90IP\u5730\u5740\u662f\u968f\u673a\u7684\uff0c\u5219\u53ef\u4ee5\u65ad\u5b9a\u906d\u5230SYN\u653b\u51fb\u4e86\uff0c\u4f7f\u7528\u5982\u4e0b\u547d\u4ee4\u53ef\u4ee5\u8ba9\u4e4b\u73b0\u884c\uff1a"]}),"\n",(0,s.jsx)(n.p,{children:"#netstat -nap | grep SYN_RECV"}),"\n",(0,s.jsx)(n.h4,{id:"\u56db\u5c42\u63e1\u624b\u7684\u51e0\u79cd\u72b6\u6001",children:"\u56db\u5c42\u63e1\u624b\u7684\u51e0\u79cd\u72b6\u6001"}),"\n",(0,s.jsx)(n.p,{children:"\u5f85\u8865\u5145"}),"\n",(0,s.jsx)(n.h5,{id:"11\u79cd\u72b6\u6001",children:"11\u79cd\u72b6\u6001"}),"\n",(0,s.jsx)(n.h5,{id:"prometheus\u4e2d\u90fd\u6709metrics\u76d1\u63a7\u53ef\u4ee5\u6839\u636e\u60c5\u51b5\u8fdb\u884c\u76d1\u63a7",children:"prometheus\u4e2d\u90fd\u6709metrics\u76d1\u63a7,\u53ef\u4ee5\u6839\u636e\u60c5\u51b5\u8fdb\u884c\u76d1\u63a7"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-txt",children:"LISTEN\uff1a\u7b49\u5f85\u4ece\u4efb\u4f55\u8fdc\u7aef TCP \u548c\u7aef\u53e3\u7684\u8fde\u63a5\u8bf7\u6c42\r\nSYN_SENT\uff1a\u53d1\u9001\u5b8c\u4e00\u4e2a\u8fde\u63a5\u8bf7\u6c42\u540e\u7b49\u5f85\u4e00\u4e2a\u5339\u914d\u7684\u8fde\u63a5\u8bf7\u6c42\r\nSYN_RECEIVED\uff1a\u53d1\u9001\u8fde\u63a5\u8bf7\u6c42\u5e76\u4e14\u63a5\u6536\u5230\u5339\u914d\u7684\u8fde\u63a5\u8bf7\u6c42\u4ee5\u540e\u7b49\u5f85\u8fde\u63a5\u8bf7\u6c42\u786e\u8ba4\r\nESTABLISHED\uff1a\u8868\u793a\u4e00\u4e2a\u6253\u5f00\u7684\u8fde\u63a5\uff0c\u63a5\u6536\u5230\u7684\u6570\u636e\u53ef\u4ee5\u88ab\u6295\u9012\u7ed9\u7528\u6237\u3002\u8fde\u63a5\u7684\u6570\u636e\u4f20\u8f93\u9636\u6bb5\u7684\u6b63\u5e38\u72b6\u6001\r\nFIN_WAIT_1\uff1a\u7b49\u5f85\u8fdc\u7aef TCP \u7684\u8fde\u63a5\u7ec8\u6b62\u8bf7\u6c42\uff0c\u6216\u8005\u7b49\u5f85\u4e4b\u524d\u53d1\u9001\u7684\u8fde\u63a5\u7ec8\u6b62\u8bf7\u6c42\u7684\u786e\u8ba4\r\nFIN_WAIT_2\uff1a\u7b49\u5f85\u8fdc\u7aef TCP \u7684\u8fde\u63a5\u7ec8\u6b62\u8bf7\u6c42\r\nCLOSE_WAIT\uff1a\u7b49\u5f85\u672c\u5730\u7528\u6237\u7684\u8fde\u63a5\u7ec8\u6b62\u8bf7\u6c42\r\nCLOSING\uff1a\u7b49\u5f85\u8fdc\u7aef TCP \u7684\u8fde\u63a5\u7ec8\u6b62\u8bf7\u6c42\u786e\u8ba4\r\nLAST_ACK\uff1a\u7b49\u5f85\u5148\u524d\u53d1\u9001\u7ed9\u8fdc\u7aef TCP \u7684\u8fde\u63a5\u7ec8\u6b62\u8bf7\u6c42\u7684\u786e\u8ba4\uff08\u5305\u62ec\u5b83\u5b57\u8282\u7684\u8fde\u63a5\u7ec8\u6b62\u8bf7\u6c42\u7684\u786e\u8ba4\uff09\r\nTIME_WAIT\uff1a\u7b49\u5f85\u8db3\u591f\u7684\u65f6\u95f4\u8fc7\u53bb\u4ee5\u786e\u4fdd\u8fdc\u7aef TCP \u63a5\u6536\u5230\u5b83\u7684\u8fde\u63a5\u7ec8\u6b62\u8bf7\u6c42\u7684\u786e\u8ba4\r\nTIME_WAIT \u4e24\u4e2a\u5b58\u5728\u7684\u7406\u7531\uff1a\r\n          1.\u53ef\u9760\u7684\u5b9e\u73b0 TCP \u5168\u53cc\u5de5\u8fde\u63a5\u7684\u7ec8\u6b62\r\n          2.\u5141\u8bb8\u8001\u7684\u91cd\u590d\u5206\u8282\u5728\u7f51\u7edc\u4e2d\u6d88\u901d\r\n\r\nCLOSED\uff1a\u4e0d\u5728\u8fde\u63a5\u72b6\u6001\uff08\u8fd9\u662f\u4e3a\u65b9\u4fbf\u63cf\u8ff0\u5047\u60f3\u7684\u72b6\u6001\uff0c\u5b9e\u9645\u4e0d\u5b58\u5728\uff09\n"})}),"\n",(0,s.jsx)(n.h2,{id:"mysql\u76f8\u5173",children:"mysql\u76f8\u5173"}),"\n",(0,s.jsx)(n.p,{children:"\u4e00\u3001MySQL5.6.16\u7248\u672c\u7684\u4e3b\u4ece\u590d\u5236\u642d\u5efa\uff1a\r\n\u4e3b\u673aA IP\uff1a192.168.233.131\r\n\u4e3b\u673aB IP\uff1a192.168.233.132\r\n1\uff09\u4fee\u6539mysql\u7684\u914d\u7f6e\u6587\u4ef6\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"\uff081\uff09\u5f00\u542f\u4e8c\u8fdb\u5236\u65e5\u5fd7\u529f\u80fd\r\n\uff082\uff09server-id = 1  //\u53e6\u5916\u4e00\u53f0\u8bbe\u7f6e\u4e3a2\n"})}),"\n",(0,s.jsx)(n.p,{children:"2\uff09\u5728slave\u6570\u636e\u5e93\u4e0a\u6dfb\u52a0\u6388\u6743\u590d\u5236\u7528\u6237\uff0c\u5728master\u6570\u636e\u5e93\u4e0a\u8fdb\u884c\u6388\u6743\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"create user 'repl'@'192.168.1.%' identified by 'your-password';\r\nGRANT REPLICATION SLAVE ON *.* TO 'repl'@'192.168.1.%';\r\nflush privileges;\n"})}),"\n",(0,s.jsxs)(n.p,{children:["3\uff09\u5728master\u6570\u636e\u5e93\u4e0a\u6267\u884c",(0,s.jsx)(n.code,{children:"show master status;"}),"\u547d\u4ee4\uff1a\uff08\u67e5\u770b\uff09"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"mysql> show master status\\G;\r\n*************************** 1. row ***************************\r\nFile: mysql-master-bin.000005\r\nPosition: 120\r\nBinlog_Do_DB:\r\nBinlog_Ignore_DB:\r\nExecuted_Gtid_Set:\r\n1 row in set (0.00 sec)\r\n4\uff09\u5728slave\u6570\u636e\u5e93\u4e0a\u6267\u884c\uff1a\r\nmysql> change master to master_host='192.168.233.131', master_user='repl',master_password='your-password',master_auto_position=1;\r\nQuery OK, 0 rows affected, 2 warnings (0.24 sec)\r\nmysql> start slave;\r\nQuery OK, 0 rows affected, 1 warning (0.04 sec)\r\n5\uff09\u5728slave\u4e0a\u6267\u884c`show slave status;`\u67e5\u770bslave\u7684\u72b6\u6001\uff1a\u5982\u679c\u4e0b\u9762\u8fd9\u4fe9\u4e2a\u6587\u4ef6\u90fd\u4e3aYES\uff0c\u5219\u8868\u793amysql\u4e3b\u4ece\u590d\u5236\u642d\u5efa\u6210\u529f\uff1a\r\nSlave_IO_Running: Yes\r\nSlave_SQL_Running: Yes\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u4e8c\u3001mysql \u4e3b\u4ece\u4e0d\u4e00\u81f4\u89e3\u51b3\u65b9\u6cd5\r\n\u65b9\u6cd5\u4e00\uff1a\u5ffd\u7565\u9519\u8bef\uff0c\u540c\u6b65\r\n\u8be5\u65b9\u6cd5\u9002\u7528\u4e8e\u4e3b\u4ece\u5e93\u6570\u636e\u76f8\u5dee\u4e0d\u5927\uff0c\u6216\u8005\u8981\u6c42\u6570\u636e\u53ef\u4ee5\u4e0d\u5b8c\u5168\u7edf\u4e00\u7684\u60c5\u51b5\uff0c\u6570\u636e\u8981\u6c42\u4e0d\u4e25\u683c\u7684\u60c5\u51b5\r\n\u89e3\u51b3\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"stop slave;\r\n#\u8868\u793a\u8df3\u8fc7\u4e00\u6b65\u9519\u8bef\uff0c\u540e\u9762\u7684\u6570\u5b57\u53ef\u53d8\r\nset global sql_slave_skip_counter =1;\r\nstart slave;\r\n\u4e4b\u540e\u518d\u7528mysql> show slave status\\G  \u67e5\u770b\uff1a\r\nSlave_IO_Running: Yes\r\nSlave_SQL_Running: Yes\r\nok\uff0c\u73b0\u5728\u4e3b\u4ece\u540c\u6b65\u72b6\u6001\u6b63\u5e38\u4e86\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u4e3b\u4ece\u590d\u5236\u539f\u7406"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"\u4e3b\u4ece\u590d\u5236\u662fMySQL\u63d0\u4f9b\u7684\u57fa\u672c\u7684\u6280\u672f\uff0c\u4e3b\u4ece\u590d\u5236\u7684\u6d41\u7a0b\uff1abinlog\u4e8c\u8fdb\u5236\u65e5\u5fd7\uff08\u9664\u4e86\u67e5\u8be2\u5176\u4ed6\u7684\u66f4\u6539\u76f8\u5173\u7684\u64cd\u4f5c\u90fd\u4f1a\u8bb0\u5f55\u5728binlog\u91cc\u9762\uff09\u3001relay log\u65e5\u5fd7\u548c\u4e09\u4e2a\u7ebf\u7a0b\uff08master\u7684\u4e00\u4e2a\u7ebf\u7a0b\u548cslave\u7684\u4e24\u4e2a\u7ebf\u7a0b\uff09\r\n\r\n\u4e3b\u4ece\u590d\u5236\u7684\u597d\u5904\uff1a\u6570\u636e\u5907\u4efd\uff0c\u6211\u4eec\u751a\u81f3\u53ef\u4ee5\u7ed9\u5b83\u505a\u4e00\u4e2a\u70ed\u5907\u4efd\uff0c\u5c31\u662f\u901a\u8fc7MySQL\u4e2d\u95f4\u4ef6mycat\uff0c\u53ef\u4ee5\u5b9e\u73b0\u5bb9\u707e\uff0c\u5bb9\u707e\u4e5f\u4f53\u73b0\u4e86\u9ad8\u53ef\u7528\u3002\r\n\r\n\r\n\u4e3b\u4ece\u590d\u5236\u7684\u6d41\u7a0b\uff1a\r\n\u4e24\u4e2a\u65e5\u5fd7\uff08binlog\u4e8c\u8fdb\u5236\u65e5\u5fd7\u548crelay log\u65e5\u5fd7\uff09\u548c\u4e09\u4e2a\u7ebf\u7a0b\uff08master\u7684\u4e00\u4e2a\u7ebf\u7a0b\u548cslave\u7684\u4e24\u4e2a\u7ebf\u7a0b\uff09\u3002\r\n\r\n\u4e3b\u5e93\u7684\u66f4\u65b0\u64cd\u4f5c\u5199\u5165binlog\u4e8c\u8fdb\u5236\u65e5\u5fd7\u4e2d\uff08\u4e3b\u5e93\u9700\u8981\u6253\u5f00binlog\u5f00\u5173\uff09\r\n\r\nmaster\u670d\u52a1\u5668\u521b\u5efa\u4e00\u4e2abinlog\u8f6c\u50a8\u7ebf\u7a0b\uff0c\u5c06\u4e8c\u8fdb\u5236\u65e5\u5fd7\u5185\u5bb9\u53d1\u9001\u5230\u4ece\u670d\u52a1\u5668\r\n\r\nslave\u673a\u5668\u6267\u884cSTART SLAVE\u547d\u4ee4\u4f1a\u5728\u4ece\u670d\u52a1\u5668\u521b\u5efa\u4e00\u4e2aIO\u7ebf\u7a0b\uff0c\u63a5\u6536master\u7684binary log\u590d\u5236\u5230\u5176\u4e2d\u7ee7\u65e5\u5fd7\uff08\u5904\u4e8e\u5185\u5b58\u4e2d\uff0c\u8bfb\u5199\u5feb\uff09\u3002 \u9996\u5148slave\u5f00\u59cb\u4e00\u4e2a\u5de5\u4f5c\u7ebf\u7a0b\uff08I/O\u7ebf\u7a0b\uff09\uff0cI/O\u7ebf\u7a0b\u4f1a\u4e3b\u52a8\u8fde\u63a5master \uff0c\u7136\u540e\u4e3b\u5e93\u4f1a\u5f00\u542fdump\u7ebf\u7a0b\uff0cdump\u7ebf\u7a0b\u4ecemaster\u7684binlog\u4e2d\u8bfb\u53d6\u4e8b\u4ef6\u5e76\u53d1\u9001\u7ed9slave\u7684I/O\u7ebf\u7a0b\uff0c\u5982\u679cdump\u7ebf\u7a0b\u5df2\u7ecf\u8ddf\u4e0amaster\uff08\u4e3b\u5e93\u4e0a\u7684dump\u7ebf\u7a0b\u5df2\u7ecf\u628abinlog\u7684\u5185\u5bb9\u53d1\u5b8c\u4e86\uff0c\u800c\u4e14\u4e3b\u5e93\u4e0abinlog\u6ca1\u6709\u4ea7\u751f\u66f4\u591a\u7684\u5185\u5bb9\uff09\uff0cdump\u7ebf\u7a0b\u4f1a\u7761\u7720\u5e76\u7b49\u5f85binlog\u4ea7\u751f\u65b0\u7684\u4e8b\u4ef6\uff0cslave\u7684I/O\u7ebf\u7a0b\u63a5\u6536\u7684\u4e8b\u4ef6\u5199\u5165\u4e2d\u7ee7\u65e5\u5fd7\r\n\r\nslave\u7684SQL\u7ebf\u7a0b\u5904\u7406\u8be5\u8fc7\u7a0b\u7684\u6700\u540e\u4e00\u6b65\uff0cSQL\u7ebf\u7a0b\u4ecerelay log\u4e2d\u8bfb\u53d6\u4e8b\u4ef6\uff0c\u5e76\u6267\u884c\u5176\u4e2d\u7684\u4e8b\u4ef6\u66f4\u65b0slave\u7684\u6570\u636e\uff0c\u4f7f\u5176\u4e0emaster\u7684\u6570\u636e\u540c\u6b65\u3002\u53ea\u8981SQL\u7ebf\u7a0b\u4e0eI/O\u7ebf\u7a0b\u4fdd\u6301\u4e00\u81f4\uff0c\u4e2d\u7ee7\u65e5\u5fd7\u901a\u5e38\u4f1a\u4f4d\u4e8eos\u7f13\u5b58\u4e2d\uff0c\u6240\u4ee5\u4e2d\u7ee7\u65e5\u5fd7\u7684\u5f00\u9500\u5f88\u5c0f\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://iteshell.oss-cn-beijing.aliyuncs.com/bookshell/operator/image-20240508010949153.png",alt:"image-20240508010949153"})}),"\n",(0,s.jsx)(n.h2,{id:"\u5b89\u5168\u5ba1\u8ba1",children:"\u5b89\u5168\u5ba1\u8ba1"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u5206\u6790\u4e1a\u52a1\u9700\u6c42\u548c\u6570\u636e\u5206\u7c7b"}),"\uff1a"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"\u4e0e\u4e1a\u52a1\u90e8\u95e8\u5408\u4f5c\uff0c\u4e86\u89e3\u54ea\u4e9b\u6570\u636e\u662f\u654f\u611f\u7684\uff0c\u9700\u8981\u52a0\u5bc6\u548c\u4fdd\u62a4\u3002\u5206\u7c7b\u6570\u636e\uff0c\u4ee5\u4fbf\u77e5\u9053\u5982\u4f55\u5904"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"\u53c2\u4e0e\u5b89\u5168\u5ba1\u8ba1\u548c\u6f0f\u6d1e\u626b\u63cf\uff0c\u4ee5\u53d1\u73b0\u548c\u7ea0\u6b63\u6f5c\u5728\u7684\u5b89\u5168\u95ee\u9898"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"\u7d27\u6025\u54cd\u5e94\uff1a"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u534f\u52a9\u5efa\u7acb\u7d27\u6025\u54cd\u5e94\u8ba1\u5212\uff0c\u4ee5\u5e94\u5bf9\u6570\u636e\u6cc4\u9732\u6216\u5176\u4ed6\u5b89\u5168\u4e8b\u4ef6"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"\u90e8\u7f72\u52a0\u5bc6\u7cfb\u7edf\uff1a"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u534f\u52a9\u4fe1\u606f\u5b89\u5168\u56e2\u961f\u90e8\u7f72\u52a0\u5bc6\u7cfb\u7edf\uff0c\u786e\u4fdd\u5176\u6b63\u786e\u8fd0\u884c\u3002"}),"\n",(0,s.jsx)(n.li,{children:"\u76d1\u63a7\u52a0\u5bc6\u7cfb\u7edf\u7684\u6027\u80fd\u548c\u5b89\u5168\u6027\uff0c\u53ca\u65f6\u53d1\u73b0\u5e76\u5e94\u5bf9\u6f5c\u5728\u7684\u95ee\u9898\u3002"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"nginx",children:"nginx"}),"\n",(0,s.jsx)(n.p,{children:"\u8bf7\u89e3\u91caNginx\u670d\u52a1\u5668\u4e0a\u7684Master\u548cWorker\u8fdb\u7a0b\u5206\u522b\u662f\u4ec0\u4e48?"}),"\n",(0,s.jsx)(n.p,{children:"Master\u8fdb\u7a0b\uff1a\u8bfb\u53d6\u53ca\u8bc4\u4f30\u914d\u7f6e\u548c\u7ef4\u6301"}),"\n",(0,s.jsx)(n.p,{children:"Worker\u8fdb\u7a0b\uff1a\u5904\u7406\u8bf7\u6c42"}),"\n",(0,s.jsx)(n.h4,{id:"mirror",children:"mirror"}),"\n",(0,s.jsx)(n.p,{children:"\u5b9e\u73b0\u7b80\u5355\u6d41\u91cf\u590d\u5236"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"location / {                        # location /\u6307\u5b9a\u4e86\u6e90uri\u4e3a/\uff0c\u4e5f\u53ef\u4ee5\u5b9a\u4e49\u4e3a\u5176\u4ed6\u6307\u5b9a\u63a5\u53e3\r\n    mirror /mirrorone;                # mirror /mirror\u6307\u5b9a\u955c\u50cfuri\u4e3a/mirror\r\n    mirror /mirrortwo;                # \u6709\u591a\u4e2a\u9700\u8981\u590d\u5236\u6d41\u91cf\u7684\uff0c\u53ef\u4ee5\u914d\u7f6e\u591a\u6761\r\n    mirror /mirrortwo;                # \u914d\u7f6e\u591a\u6761\u60c5\u51b5\u4e0b\uff0c\u5c06\u4f1a\u8d77\u5230\u6d41\u91cf\u653e\u5927\u7684\u4f5c\u7528\uff0c\u5373\u4e3b\u914d\u7f6e\u8bf7\u6c42\u4e00\u6b21\uff0c\u955c\u50cf\u7aef\u4f1a\u6709\u4e24\u6b21\r\n  # mirror_request_body on;         # \u6307\u5b9a\u662f\u5426\u955c\u50cf\u8bf7\u6c42body\u90e8\u5206\uff0c\u8bf7\u6c42\u81ea\u52a8\u7f13\u5b58;\r\n    proxy_pass http://backend;      # \u6307\u5b9a\u5904\u7406\u4e3b\u6d41\u91cf\u7684\u540e\u7aefServer\r\n}\r\nlocation = /mirrorone {\r\n    internal;       # \u6307\u5b9a\u6b64location\u53ea\u80fd\u88ab\u201c\u5185\u90e8\u7684\u201d\u8bf7\u6c42\u8c03\u7528\uff0c\u5916\u90e8\u7684\u8c03\u7528\u8bf7\u6c42\u4f1a\u8fd4\u56de\u201dNot found\u201d (404)\r\n    proxy_pass http://test_backend1$request_uri;    # \u6307\u5b9a\u5c06\u8981\u590d\u5236\u6d41\u91cf\u7684Server1\r\n}\r\nlocation = /mirrortwo {\r\n    internal;\r\n    proxy_pass http://test_backend2$request_uri;\r\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://cloud.tencent.com/developer/article/1842884",children:"https://cloud.tencent.com/developer/article/1842884"})}),"\n",(0,s.jsx)(n.h4,{id:"rewrite",children:"rewrite"}),"\n",(0,s.jsx)(n.p,{children:"rewrite\u529f\u80fd\u5c31\u662f\uff0c\u4f7f\u7528nginx\u63d0\u4f9b\u7684\u5168\u5c40\u53d8\u91cf\u6216\u81ea\u5df1\u8bbe\u7f6e\u7684\u53d8\u91cf\uff0c\u7ed3\u5408\u6b63\u5219\u8868\u8fbe\u5f0f\u548c\u6807\u8bb0\u4f4d\u5b9e\u73b0URL\u91cd\u5199\u4ee5\u53ca\u91cd\u5b9a\u5411\u3002\r\n\u6bd4\u5982\uff1a\u66f4\u6362\u57df\u540d\u540e\u9700\u8981\u4fdd\u6301\u65e7\u7684\u57df\u540d\u80fd\u8df3\u8f6c\u5230\u65b0\u7684\u57df\u540d\u4e0a\u3001\u67d0\u7f51\u9875\u53d1\u751f\u6539\u53d8\u9700\u8981\u8df3\u8f6c\u5230\u65b0\u7684\u9875\u9762\u3001\u7f51\u7ad9\u9632\u76d7\u94fe\u7b49\u7b49\u9700\u6c42\u3002"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:["rewrite\u53ea\u80fd\u653e\u5728server",",location",",if","\u4e2d\uff0c\u5e76\u4e14\u9ed8\u8ba4\u53ea\u80fd\u5bf9\u57df\u540d\u540e\u8fb9\u7684\u9664\u53bb\u4f20\u9012\u7684\u53c2\u6570\u5916\u7684\u5b57\u7b26\u4e32\u8d77\u4f5c\u7528"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsxs)(n.strong,{children:["\u4f8b\u5982\uff1a",(0,s.jsx)(n.a,{href:"http://www.kgc.com/abc/%5Bbbs",children:"http://www.kgc.com/abc/[bbs"}),"](",(0,s.jsx)(n.a,{href:"https://so.csdn.net/so/search?q=bbs&spm=1001.2101.3001.7020)/index.php?a=1&b=2",children:"https://so.csdn.net/so/search?q=bbs&spm=1001.2101.3001.7020)/index.php?a=1&b=2"})," \u53ea\u5bf9/abc/bbs/index.php\u91cd\u5199"]})}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u7248\u6743\u58f0\u660e\uff1a\u672c\u6587\u4e3a\u535a\u4e3b\u539f\u521b\u6587\u7ae0\uff0c\u9075\u5faa CC 4.0 BY-SA \u7248\u6743\u534f\u8bae\uff0c\u8f6c\u8f7d\u8bf7\u9644\u4e0a\u539f\u6587\u51fa\u5904\u94fe\u63a5\u548c\u672c\u58f0\u660e\u3002"}),"\n",(0,s.jsxs)(n.p,{children:["\u539f\u6587\u94fe\u63a5\uff1a",(0,s.jsx)(n.a,{href:"https://blog.csdn.net/SmileLife_/article/details/125014507",children:"https://blog.csdn.net/SmileLife_/article/details/125014507"})]}),"\n",(0,s.jsx)(n.h4,{id:"location",children:"location"}),"\n",(0,s.jsx)(n.p,{children:"1location\u5927\u81f4\u5206\u4e3a\u4e09\u7c7b"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"\u7cbe\u51c6\u5339\u914d\uff1alocation = / {...}\r\n\u4e00\u822c\u5339\u914d\uff1alocation / {...} \r\n\u6b63\u5219\u5339\u914d\uff1alocation ~ / {...}\n"})}),"\n",(0,s.jsx)(n.p,{children:"2 location \u5e38\u7528\u7684\u5339\u914d\u89c4\u5219"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"= \uff1a\u8fdb\u884c\u666e\u901a\u5b57\u7b26\u7cbe\u786e\u5339\u914d\uff0c\u4e5f\u5c31\u662f\u5b8c\u5168\u5339\u914d\u3002\r\n^~ \uff1a\u8868\u793a\u666e\u901a\u5b57\u7b26\u5339\u914d\u3002\u4f7f\u7528\u524d\u7f00\u5339\u914d\u3002\u5982\u679c\u5339\u914d\u6210\u529f\uff0c\u5219\u4e0d\u518d\u5339\u914d\u5176\u5b83 location\u3002\r\n~ \uff1a\u533a\u5206\u5927\u5c0f\u5199\u7684\u5339\u914d\u3002\r\n~* \uff1a\u4e0d\u533a\u5206\u5927\u5c0f\u5199\u7684\u5339\u914d\u3002\r\n!~ \uff1a\u533a\u5206\u5927\u5c0f\u5199\u7684\u5339\u914d\u53d6\u975e\u3002\r\n!~* \uff1a\u4e0d\u533a\u5206\u5927\u5c0f\u5199\u7684\u5339\u914d\u53d6\u975e\u3002\n"})}),"\n",(0,s.jsx)(n.p,{children:"3 location\u7684\u4f18\u5148\u7ea7"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"\u76f8\u540c\u7c7b\u578b\u7684\u8868\u8fbe\u5f0f\uff0c\u5b57\u7b26\u4e32\u957f\u7684\u4f1a\u4f18\u5148\u5339\u914d\r\n\r\n\u9996\u5148\u7cbe\u786e\u5339\u914d =\r\n\u5176\u6b21\u524d\u7f00\u5339\u914d ^~\r\n\u5176\u6b21\u662f\u6309\u6587\u4ef6\u4e2d\u987a\u5e8f\u7684\u6b63\u5219\u5339\u914d ~\u6216~*\r\n\u7136\u540e\u5339\u914d\u4e0d\u5e26\u4efb\u4f55\u4fee\u9970\u7684\u524d\u7f00\u5339\u914d\r\n\u6700\u540e\u662f\u4ea4\u7ed9 / \u901a\u7528\u5339\u914d\n"})}),"\n",(0,s.jsx)(n.p,{children:"4 location \u5339\u914d"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"\u9996\u5148\u770b \u4f18\u5148\u7ea7\uff1a\u7cbe\u786e>\u524d\u7f00>\u6b63\u5219>\u4e00\u822c>\u901a\u7528\r\n\u4f18\u5148\u7ea7\u76f8\u540c\uff1a\u6b63\u5219\u770b\u4e0a\u4e0b\u987a\u5e8f\uff0c\u4e0a\u9762\u7684\u4f18\u5148\uff1b\u4e00\u822c\u5339\u914d\u770b\u957f\u5ea6\uff0c\u6700\u957f\u5339\u914d\u7684\u4f18\u5148\r\n\u7cbe\u786e\u3001\u524d\u7f00\u3001\u6b63\u5219\u3001\u4e00\u822c \u90fd\u6ca1\u6709\u5339\u914d\u5230\uff0c\u6700\u540e\u518d\u770b\u901a\u7528\u5339\u914d\n"})}),"\n",(0,s.jsx)(n.p,{children:"5 \u5b9e\u9645\u7f51\u7ad9\u4f7f\u7528\u4e2d\uff0c\u81f3\u5c11\u6709\u4e09\u4e2a\u5339\u914d\u89c4\u5219\u5b9a\u4e49"}),"\n",(0,s.jsx)(n.p,{children:"1\u3001\u7b2c\u4e00\u4e2a\u5fc5\u9009\u89c4\u5219"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u76f4\u63a5\u5339\u914d\u7f51\u7ad9\u6839\uff0c\u901a\u8fc7\u57df\u540d\u8bbf\u95ee\u7f51\u7ad9\u9996\u9875\u6bd4\u8f83\u9891\u7e41\uff0c\u4f7f\u7528\u8fd9\u4e2a\u4f1a\u52a0\u901f\u5904\u7406\uff0c\u6bd4\u5982\u8bf4\u5b98\u7f51\u3002"}),"\n",(0,s.jsx)(n.li,{children:"\u53ef\u4ee5\u662f\u4e00\u4e2a\u9759\u6001\u9996\u9875\uff0c\u4e5f\u53ef\u4ee5\u76f4\u63a5\u8f6c\u53d1\u7ed9\u540e\u7aef\u5e94\u7528\u670d\u52a1\u5668"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"location = / {\r\n    root   html;\r\n\tindex  index.html index.htm;\r\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"2\u3001\u7b2c\u4e8c\u4e2a\u5fc5\u9009\u89c4\u5219"}),"\n",(0,s.jsx)(n.p,{children:"\u5904\u7406\u9759\u6001\u6587\u4ef6\u8bf7\u6c42\uff0c\u8fd9\u662fnginx\u4f5c\u4e3ahttp\u670d\u52a1\u5668\u7684\u5f3a\u9879\uff1b\u6709\u4e24\u79cd\u914d\u7f6e\u6a21\u5f0f\uff0c\u76ee\u5f55\u5339\u914d\u6216\u540e\u7f00\u5339\u914d,\u4efb\u9009\u5176\u4e00\u6216\u642d\u914d\u4f7f\u7528"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-cobol",children:"location ^~ /static/ {\r\n    root /webroot/static/;\r\n}\r\n \r\nlocation ~* \\.(html|gif|jpg|jpeg|png|css|js|ico)$ {\r\n    root /webroot/res/;\r\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"3\u3001\u7b2c\u4e09\u4e2a\u5fc5\u9009\u89c4\u5219"}),"\n",(0,s.jsx)(n.p,{children:"\u5c31\u662f\u901a\u7528\u89c4\u5219\uff0c\u6bd4\u5982\u7528\u6765\u8f6c\u53d1\u5e26.php\u3001.jsp\u540e\u7f00\u7684\u52a8\u6001\u8bf7\u6c42\u5230\u540e\u7aef\u5e94\u7528\u670d\u52a1\u5668\u975e\u9759\u6001\u6587\u4ef6\u8bf7\u6c42\u5c31\u9ed8\u8ba4\u662f\u52a8\u6001\u8bf7\u6c42"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-cobol",children:"location / {\r\n    proxy_pass http://tomcat_server;\r\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u4e8c\u3001rewrite\u5b9e\u4f8b"}),"\n",(0,s.jsx)(n.p,{children:"1\u3001\u57fa\u4e8e\u57df\u540d\u7684\u8df3\u8f6c"}),"\n",(0,s.jsx)(n.p,{children:"2\u3001\u57fa\u4e8e\u5ba2\u6237\u7aef IP \u8bbf\u95ee\u8df3\u8f6c"}),"\n",(0,s.jsx)(n.p,{children:"3\u3001 \u57fa\u4e8e\u65e7\u57df\u540d\u8df3\u8f6c\u5230\u65b0\u57df\u540d\u540e\u9762\u52a0\u76ee\u5f55"}),"\n",(0,s.jsx)(n.p,{children:"4\u3001\u57fa\u4e8e\u53c2\u6570\u5339\u914d\u7684\u8df3\u8f6c"}),"\n",(0,s.jsx)(n.p,{children:"5\u3001\u57fa\u4e8e\u76ee\u5f55\u4e0b\u6240\u6709 php \u7ed3\u5c3e\u7684\u6587\u4ef6\u8df3\u8f6c"}),"\n",(0,s.jsx)(n.p,{children:"6\u3001\u57fa\u4e8e\u6700\u666e\u901a\u4e00\u6761 url \u8bf7\u6c42\u7684\u8df3\u8f6c"}),"\n",(0,s.jsx)(n.h4,{id:"\u6bd4\u8f83rewrite\u548clocation",children:"\u6bd4\u8f83rewrite\u548clocation"}),"\n",(0,s.jsx)(n.p,{children:"1\u3001\u76f8\u540c\u70b9\uff1a\u90fd\u80fd\u5b9e\u73b0\u8df3\u8f6c"}),"\n",(0,s.jsx)(n.p,{children:"2\u3001\u4e0d\u540c\u70b9\uff1a"}),"\n",(0,s.jsx)(n.p,{children:"\u2460\u3001rewrite\u662f\u5728\u540c\u4e00\u57df\u540d\u5185\u66f4\u6539\u83b7\u53d6\u8d44\u6e90\u7684\u8def\u5f84"}),"\n",(0,s.jsx)(n.p,{children:"\u2461\u3001location\u662f\u5bf9\u4e00\u7c7b\u8def\u5f84\u63a7\u5236\u8bbf\u95ee\u6216\u53cd\u5411\u4ee3\u7406\uff0c\u8fd8\u53ef\u4ee5proxy_pass\u5230\u5176\u4ed6\u673a\u5668"}),"\n",(0,s.jsx)(n.p,{children:"3\u3001rewrite\u4f1a\u5199\u5728location\u91cc\uff0c\u6267\u884c\u987a\u5e8f"}),"\n",(0,s.jsx)(n.p,{children:"\u2460\u3001\u6267\u884cserver\u5757\u91cc\u9762\u7684rewrite\u6307\u4ee4"}),"\n",(0,s.jsx)(n.p,{children:"\u2461\u3001\u6267\u884clocation\u5339\u914d"}),"\n",(0,s.jsx)(n.p,{children:"\u2462\u3001\u6267\u884c\u9009\u5b9a\u7684location\u4e2d\u7684rewrite\u6307\u4ee4"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"localtion\u4f18\u5148\u7ea7"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"\u5339\u914d\u67d0\u4e2a\u5177\u4f53\u6587\u4ef6\r\n\uff08location = \u5b8c\u6574\u8def\u5f84\uff09>\uff08location ^~ \u5b8c\u6574\u8def\u5f84\uff09>\uff08location ~* \u5b8c\u6574\u8def\u5f84\uff09=\uff08location ~ \u5b8c\u6574\u8def\u5f84\uff09>\uff08location /\uff09\r\n\r\n\u7528\u76ee\u5f55\u505a\u5339\u914d\u8bbf\u95ee\u67d0\u4e2a\u6587\u4ef6\r\n\uff08location = \u76ee\u5f55\uff09>\uff08location ^~ \u76ee\u5f55\uff09>\uff08location ~* \u76ee\u5f55\uff09=\uff08location ~ \u76ee\u5f55\uff09>\uff08location /\uff09\n"})}),"\n",(0,s.jsx)(n.h4,{id:"nginx\u9650\u6d41",children:"nginx\u9650\u6d41"}),"\n",(0,s.jsx)(n.p,{children:"\u4e24\u4e2a\u547d\u4ee4"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"\u9650\u6d41\u7531\u4e24\u4e2a\u4e3b\u8981\u6307\u4ee4limit_req_zone\u548c\u8fdb\u884c\u914d\u7f6elimit_req\uff0c\u5982\u4e0b\u4f8b\u6240\u793a:\r\nlimit_req_zone $binary_remote_addr zone=mylimit:10m rate=10r/s;\r\n \r\nserver {\r\n    location /qhyu/ {\r\n        limit_req zone=mylimit;\r\n        \r\n        proxy_pass http://my_upstream;\r\n    }\r\n}\r\nlimit_req_zone\u6307\u4ee4\u5b9a\u4e49\u4e86\u901f\u7387\u9650\u5236\u7684\u53c2\u6570,zone-\u8bf7\u6c42\u9650\u5236URL\u7684\u9891\u7387\u7684\u5171\u4eab\u5185\u5b58\u533a\u57df,rate-\u8bbe\u7f6e\u6700\u5927\u8bf7\u6c42\u901f\u7387\r\nlimit_req\u5728\u5b83\u51fa\u73b0\u7684\u4e0a\u4e0b\u6587\u4e2d\u542f\u7528\u901f\u7387\u9650\u5236,\u901f\u7387\u4e0d\u80fd\u8d85\u8fc7\u6bcf\u79d210\u4e2a\u8bf7\u6c42\r\n\n"})}),"\n",(0,s.jsx)(n.h4,{id:"nginx\u4e03\u5c42\u4ee3\u7406",children:"nginx\u4e03\u5c42\u4ee3\u7406"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"\u53ea\u80fd\u5199\u5728http\u6a21\u5757\u7684\u5168\u5c40\u914d\u7f6e\u5f53\u4e2d\u3002\r\nupstream: \u7528\u4e8e\u5904\u7406http\u8bf7\u6c42\uff0c\u652f\u6301\u53cd\u5411\u4ee3\u7406\uff0c\u8d1f\u8f7d\u5747\u8861\uff0c\u7f13\u5b58\u529f\u80fd\r\n\u5728upstream\u6a21\u5757\u4e2d\u53ef\u4ee5\u914d\u7f6e\u5bf9\u4e2a\u670d\u52a1\u5668"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"upstream liu {\r\n        server 192.168.10.30;\r\n        server 192.168.10.20;\r\n}\r\nlocation {\r\n        proxy_pass http://test;\r\n}\n"})}),"\n",(0,s.jsx)(n.h4,{id:"nginx\u56db\u5c42\u4ee3\u7406",children:"nginx\u56db\u5c42\u4ee3\u7406"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"stream\u53ea\u80fd\u5199\u5728\u5168\u5c40\u6a21\u5757\u5f53\u4e2d\u7684\u5355\u72ec\u914d\u7f6e\u3002stream\u4ee3\u7406\u65e0\u8c13\u534f\u8bae\uff0c\u53ea\u7ba1\u6d41\u91cf\u3002"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"stream {\r\n   upstream ilync{\r\n    server 192.168.10.20:8080;\r\n    server 192.168.10.21:8080;\r\n   }\r\n   server {\r\n       listen 80;\r\n       proxy_pass ilync;\r\n   }\r\n\r\n}\r\n\u4e0d\u80fd\u7528 hash\uff08\u54c8\u5e0c\uff09\uff0c\u53ea\u53ef\u4ee5\u4f7f\u7528weight \u548c least_conn\u3002\n"})}),"\n",(0,s.jsx)(n.h4,{id:"\u57fa\u4e8e\u57df\u540d\u7684\u53cd\u5411\u4ee3\u7406",children:"\u57fa\u4e8e\u57df\u540d\u7684\u53cd\u5411\u4ee3\u7406"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"upstream ky32 (\r\nserver www.kgc.com;\r\nserver www.benet.com;\r\n}\r\n \r\nlocation {\r\nproxy_pass http://ky32\r\nproxy_set_header HoST $host\r\n#\u628a\u8bf7\u6c42\u7684\u4e3b\u673a\u540d\u53d1\u9001\u7ed9\u540e\u7aef\r\nproxy_set header X-Real-IP $remote_addr;\r\n#\u540e\u7aef\u670d\u52a1\u5668\u83b7\u53d6\u5ba2\u6237\u7aef\u7684\u771f\u5b9eip\u5730\u5740\u3002\r\n}\n"})}),"\n",(0,s.jsx)(n.h4,{id:"\u6b63\u5411\u4ee3\u7406\u548c\u53cd\u5411\u4ee3\u7406",children:"\u6b63\u5411\u4ee3\u7406\u548c\u53cd\u5411\u4ee3\u7406"}),"\n",(0,s.jsx)(n.p,{children:"\u4ee3\u7406\u5bf9\u8c61\u4e0d\u540c\u3002\u6b63\u5411\u4ee3\u7406\u4ee3\u7406\u7684\u662f\u5ba2\u6237\u7aef(\u6bd4\u5982qq\u901a\u8fc7\u4ee3\u7406\u5b9e\u73b0\u4e0a\u7f51,\u670d\u52a1\u5668\u7aef\u901a\u8fc7socket5\u6765\u5b9e\u73b0\u4ee3\u7406)\uff0c\u53cd\u5411\u4ee3\u7406\u4ee3\u7406\u7684\u662f\u670d\u52a1\u5668\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u6b63\u5411\u4ee3\u7406\u5e2e\u52a9\u5ba2\u6237\u8bbf\u95ee\u5176\u65e0\u6cd5\u8bbf\u95ee\u7684\u670d\u52a1\u5668\u8d44\u6e90\uff0c\u53cd\u5411\u4ee3\u7406\u5e2e\u52a9\u670d\u52a1\u5668\u505a\u8d1f\u8f7d\u5747\u8861\uff0c\u53e6\u5916\uff0c\u7531\u4e8e\u5ba2\u6237\u7aef\u8ddf\u771f\u5b9e\u670d\u52a1\u5668\u4e0d\u76f4\u63a5\u63a5\u89e6\uff0c\u80fd\u8d77\u5230\u4e00\u5b9a\u5b89\u5168\u9632\u62a4\u7684\u4f5c\u7528\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u67b6\u8bbe\u4e3b\u4f53\u4e0d\u540c\u3002\u6b63\u5411\u4ee3\u7406\u4e00\u822c\u662f\u5ba2\u6237\u7aef\u67b6\u8bbe\u7684\uff0c\u6bd4\u5982\u5728\u81ea\u5df1\u7684\u673a\u5668\u4e0a\u88c5\u4e00\u4e2a\u4ee3\u7406\u8f6f\u4ef6\uff0c\u53cd\u5411\u4ee3\u7406\u4e00\u822c\u662f\u670d\u52a1\u5668\u67b6\u8bbe\u7684\uff0c\u901a\u5e38\u662f\u5728\u673a\u5668\u96c6\u7fa4\u4e2d\u90e8\u7f72\u4e2a\u53cd\u5411\u4ee3\u7406\u670d\u52a1\u5668"})]})}function t(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>c,x:()=>o});var s=r(6540);const l={},i=s.createContext(l);function c(e){const n=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:c(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);